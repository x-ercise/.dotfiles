{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"vscode\"","webpack:///./node_modules/lodash-es/_arrayMap.js","webpack:///./node_modules/lodash-es/isFunction.js","webpack:///./node_modules/lodash-es/_isMasked.js","webpack:///./node_modules/lodash-es/_coreJsData.js","webpack:///./node_modules/lodash-es/_toSource.js","webpack:///./node_modules/lodash-es/_baseIsNative.js","webpack:///./node_modules/lodash-es/_getValue.js","webpack:///./node_modules/lodash-es/_getNative.js","webpack:///./node_modules/lodash-es/_nativeCreate.js","webpack:///./node_modules/lodash-es/_hashClear.js","webpack:///./node_modules/lodash-es/_hashDelete.js","webpack:///./node_modules/lodash-es/_hashGet.js","webpack:///./node_modules/lodash-es/_hashHas.js","webpack:///./node_modules/lodash-es/_hashSet.js","webpack:///./node_modules/lodash-es/_Hash.js","webpack:///./node_modules/lodash-es/_listCacheClear.js","webpack:///./node_modules/lodash-es/eq.js","webpack:///./node_modules/lodash-es/_assocIndexOf.js","webpack:///./node_modules/lodash-es/_listCacheDelete.js","webpack:///./node_modules/lodash-es/_listCacheGet.js","webpack:///./node_modules/lodash-es/_listCacheHas.js","webpack:///./node_modules/lodash-es/_listCacheSet.js","webpack:///./node_modules/lodash-es/_ListCache.js","webpack:///./node_modules/lodash-es/_Map.js","webpack:///./node_modules/lodash-es/_mapCacheClear.js","webpack:///./node_modules/lodash-es/_isKeyable.js","webpack:///./node_modules/lodash-es/_getMapData.js","webpack:///./node_modules/lodash-es/_mapCacheDelete.js","webpack:///./node_modules/lodash-es/_mapCacheGet.js","webpack:///./node_modules/lodash-es/_mapCacheHas.js","webpack:///./node_modules/lodash-es/_mapCacheSet.js","webpack:///./node_modules/lodash-es/_MapCache.js","webpack:///./node_modules/lodash-es/_setCacheAdd.js","webpack:///./node_modules/lodash-es/_setCacheHas.js","webpack:///./node_modules/lodash-es/_SetCache.js","webpack:///./node_modules/lodash-es/_baseFindIndex.js","webpack:///./node_modules/lodash-es/_baseIsNaN.js","webpack:///./node_modules/lodash-es/_strictIndexOf.js","webpack:///./node_modules/lodash-es/_baseIndexOf.js","webpack:///./node_modules/lodash-es/_arrayIncludes.js","webpack:///./node_modules/lodash-es/_arrayIncludesWith.js","webpack:///./node_modules/lodash-es/_baseUnary.js","webpack:///./node_modules/lodash-es/_cacheHas.js","webpack:///./node_modules/lodash-es/_baseIntersection.js","webpack:///./node_modules/lodash-es/identity.js","webpack:///./node_modules/lodash-es/_apply.js","webpack:///./node_modules/lodash-es/_overRest.js","webpack:///./node_modules/lodash-es/constant.js","webpack:///./node_modules/lodash-es/_defineProperty.js","webpack:///./node_modules/lodash-es/_baseSetToString.js","webpack:///./node_modules/lodash-es/_shortOut.js","webpack:///./node_modules/lodash-es/_setToString.js","webpack:///./node_modules/lodash-es/_baseRest.js","webpack:///./node_modules/lodash-es/isLength.js","webpack:///./node_modules/lodash-es/isArrayLike.js","webpack:///./node_modules/lodash-es/isArrayLikeObject.js","webpack:///./node_modules/lodash-es/_castArrayLikeObject.js","webpack:///./node_modules/lodash-es/last.js","webpack:///./node_modules/lodash-es/intersectionWith.js","webpack:///./node_modules/lodash-es/_stackClear.js","webpack:///./node_modules/lodash-es/_stackDelete.js","webpack:///./node_modules/lodash-es/_stackGet.js","webpack:///./node_modules/lodash-es/_stackHas.js","webpack:///./node_modules/lodash-es/_stackSet.js","webpack:///./node_modules/lodash-es/_Stack.js","webpack:///./node_modules/lodash-es/_arraySome.js","webpack:///./node_modules/lodash-es/_equalArrays.js","webpack:///./node_modules/lodash-es/_Uint8Array.js","webpack:///./node_modules/lodash-es/_mapToArray.js","webpack:///./node_modules/lodash-es/_setToArray.js","webpack:///./node_modules/lodash-es/_equalByTag.js","webpack:///./node_modules/lodash-es/_arrayPush.js","webpack:///./node_modules/lodash-es/isArray.js","webpack:///./node_modules/lodash-es/_baseGetAllKeys.js","webpack:///./node_modules/lodash-es/_arrayFilter.js","webpack:///./node_modules/lodash-es/stubArray.js","webpack:///./node_modules/lodash-es/_getSymbols.js","webpack:///./node_modules/lodash-es/_baseTimes.js","webpack:///./node_modules/lodash-es/_baseIsArguments.js","webpack:///./node_modules/lodash-es/isArguments.js","webpack:///./node_modules/lodash-es/_isIndex.js","webpack:///./node_modules/lodash-es/_baseIsTypedArray.js","webpack:///./node_modules/lodash-es/isTypedArray.js","webpack:///./node_modules/lodash-es/_arrayLikeKeys.js","webpack:///./node_modules/lodash-es/_isPrototype.js","webpack:///./node_modules/lodash-es/_overArg.js","webpack:///./node_modules/lodash-es/_nativeKeys.js","webpack:///./node_modules/lodash-es/_baseKeys.js","webpack:///./node_modules/lodash-es/keys.js","webpack:///./node_modules/lodash-es/_getAllKeys.js","webpack:///./node_modules/lodash-es/_equalObjects.js","webpack:///./node_modules/lodash-es/_DataView.js","webpack:///./node_modules/lodash-es/_Promise.js","webpack:///./node_modules/lodash-es/_Set.js","webpack:///./node_modules/lodash-es/_WeakMap.js","webpack:///./node_modules/lodash-es/_getTag.js","webpack:///./node_modules/lodash-es/_baseIsEqualDeep.js","webpack:///./node_modules/lodash-es/_baseIsEqual.js","webpack:///./node_modules/lodash-es/isEqual.js","webpack:///./node_modules/lodash-es/_baseDifference.js","webpack:///./node_modules/lodash-es/_isFlattenable.js","webpack:///./node_modules/lodash-es/_baseFlatten.js","webpack:///./node_modules/lodash-es/noop.js","webpack:///./node_modules/lodash-es/_createSet.js","webpack:///./node_modules/lodash-es/_baseUniq.js","webpack:///./node_modules/lodash-es/_baseXor.js","webpack:///./src/system/array.ts","webpack:///./node_modules/lodash-es/xor.js","webpack:///./src/system/date.ts","webpack:///./src/system/decorators/gate.ts","webpack:///./src/system/decorators/memoize.ts","webpack:///./src/system/iterable.ts","webpack:///./src/system/object.ts","webpack:///./src/system/searchTree.ts","webpack:///./src/system/version.ts","webpack:///./src/system.ts","webpack:///./src/constants.ts","webpack:///./src/annotations/annotationProvider.ts","webpack:///./src/webviews/apps/shared/colors.ts","webpack:///./src/annotations/annotations.ts","webpack:///./src/annotations/fileAnnotationController.ts","webpack:///./src/annotations/blameAnnotationProvider.ts","webpack:///./src/annotations/gutterBlameAnnotationProvider.ts","webpack:///./src/annotations/heatmapBlameAnnotationProvider.ts","webpack:///./src/annotations/recentChangesAnnotationProvider.ts","webpack:///./src/annotations/lineAnnotationController.ts","webpack:///./src/codelens/codeLensProvider.ts","webpack:///./src/codelens/codeLensController.ts","webpack:///./src/hovers/lineHoverController.ts","webpack:///./src/statusbar/statusBarController.ts","webpack:///./src/trackers/lineTracker.ts","webpack:///./src/trackers/gitLineTracker.ts","webpack:///./src/views/viewBase.ts","webpack:///./src/views/compareView.ts","webpack:///./src/views/fileHistoryView.ts","webpack:///./src/views/lineHistoryView.ts","webpack:///./src/views/repositoriesView.ts","webpack:///./src/views/searchView.ts","webpack:///./src/views/viewCommands.ts","webpack:///./src/webviews/protocol.ts","webpack:///./src/webviews/webviewBase.ts","webpack:///./src/webviews/helpers.ts","webpack:///./src/webviews/settingsWebview.ts","webpack:///./src/webviews/welcomeWebview.ts","webpack:///./src/container.ts","webpack:///./src/git/gitService.ts","webpack:///./src/commands/common.ts","webpack:///./src/configuration.ts","webpack:///./src/logger.ts","webpack:///./src/quickpicks/referencesQuickPick.ts","webpack:///./src/quickpicks/commonQuickPicks.ts","webpack:///./src/quickpicks/remotesQuickPick.ts","webpack:///./src/quickpicks/branchHistoryQuickPick.ts","webpack:///./src/quickpicks/commitFileQuickPick.ts","webpack:///./src/quickpicks/commitQuickPick.ts","webpack:///./src/quickpicks/fileHistoryQuickPick.ts","webpack:///./src/quickpicks/modesQuickPick.ts","webpack:///./src/quickpicks/repositoriesQuickPick.ts","webpack:///./src/quickpicks/repoStatusQuickPick.ts","webpack:///./src/quickpicks.ts","webpack:///./src/git/git.ts","webpack:///./src/views/nodes/viewNode.ts","webpack:///./src/views/nodes/common.ts","webpack:///./src/views/nodes/commitFileNode.ts","webpack:///./src/views/nodes/folderNode.ts","webpack:///./src/views/nodes/commitNode.ts","webpack:///./src/views/nodes/helpers.ts","webpack:///./src/views/nodes/branchTrackingStatusNode.ts","webpack:///./src/views/nodes/resultsCommitsNode.ts","webpack:///./src/views/nodes/resultsFileNode.ts","webpack:///./src/views/nodes/resultsFilesNode.ts","webpack:///./src/views/nodes/compareBranchNode.ts","webpack:///./src/views/nodes/contributorNode.ts","webpack:///./src/views/nodes/contributorsNode.ts","webpack:///./src/views/nodes/reflogRecordNode.ts","webpack:///./src/views/nodes/reflogNode.ts","webpack:///./src/views/nodes/branchOrTagFolderNode.ts","webpack:///./src/views/nodes/remoteNode.ts","webpack:///./src/views/nodes/remotesNode.ts","webpack:///./src/views/nodes/stashFileNode.ts","webpack:///./src/views/nodes/stashNode.ts","webpack:///./src/views/nodes/stashesNode.ts","webpack:///./src/views/nodes/statusFileNode.ts","webpack:///./src/views/nodes/statusFilesNode.ts","webpack:///./src/views/nodes/tagNode.ts","webpack:///./src/views/nodes/tagsNode.ts","webpack:///./src/views/nodes/repositoryNode.ts","webpack:///./src/views/nodes/branchNode.ts","webpack:///./src/views/nodes/branchesNode.ts","webpack:///./src/views/nodes/comparePickerNode.ts","webpack:///./src/views/nodes/compareNode.ts","webpack:///./src/views/nodes/compareResultsNode.ts","webpack:///./src/views/nodes/fileHistoryNode.ts","webpack:///./src/views/nodes/fileHistoryTrackerNode.ts","webpack:///./src/views/nodes/lineHistoryNode.ts","webpack:///./src/views/nodes/lineHistoryTrackerNode.ts","webpack:///./src/views/nodes/repositoriesNode.ts","webpack:///./src/views/nodes/searchNode.ts","webpack:///./src/views/nodes/searchResultsCommitsNode.ts","webpack:///./src/views/nodes.ts","webpack:///./src/commands/annotations.ts","webpack:///./src/commands/closeUnchangedFiles.ts","webpack:///./src/commands/copyMessageToClipboard.ts","webpack:///./src/commands/copyRemoteFileUrlToClipboard.ts","webpack:///./src/commands/copyShaToClipboard.ts","webpack:///./src/commands/diffBranchWith.ts","webpack:///./src/commands/diffDirectory.ts","webpack:///./src/commands/diffLineWithPrevious.ts","webpack:///./src/commands/diffLineWithWorking.ts","webpack:///./src/commands/diffWith.ts","webpack:///./src/commands/diffWithNext.ts","webpack:///./src/commands/diffWithPrevious.ts","webpack:///./src/commands/diffWithRef.ts","webpack:///./src/commands/diffWithRevision.ts","webpack:///./src/commands/diffWithWorking.ts","webpack:///./src/commands/exploreRepoAtRevision.ts","webpack:///./src/commands/externalDiff.ts","webpack:///./src/commands/inviteToLiveShare.ts","webpack:///./src/commands/openBranchesInRemote.ts","webpack:///./src/commands/openBranchInRemote.ts","webpack:///./src/commands/openChangedFiles.ts","webpack:///./src/commands/openCommitInRemote.ts","webpack:///./src/commands/openFileInRemote.ts","webpack:///./src/commands/openFileRevision.ts","webpack:///./src/commands/openFileRevisionFrom.ts","webpack:///./src/commands/openInRemote.ts","webpack:///./src/commands/openRepoInRemote.ts","webpack:///./src/commands/openRevisionFile.ts","webpack:///./src/commands/openWorkingFile.ts","webpack:///./src/commands/quickCommand.helpers.ts","webpack:///./src/commands/quickCommand.ts","webpack:///./src/commands/git/cherry-pick.ts","webpack:///./src/commands/git/fetch.ts","webpack:///./src/commands/git/merge.ts","webpack:///./src/commands/git/pull.ts","webpack:///./src/commands/git/push.ts","webpack:///./src/commands/git/rebase.ts","webpack:///./src/commands/git/reset.ts","webpack:///./src/commands/git/revert.ts","webpack:///./src/commands/git/search.ts","webpack:///./src/commands/git/stash.ts","webpack:///./src/commands/git/switch.ts","webpack:///./src/commands/gitCommands.ts","webpack:///./src/commands/repositories.ts","webpack:///./src/commands/resetSuppressedWarnings.ts","webpack:///./src/commands/searchCommits.ts","webpack:///./src/commands/showCommitsInView.ts","webpack:///./src/commands/showLastQuickPick.ts","webpack:///./src/commands/showQuickBranchHistory.ts","webpack:///./src/commands/showQuickCommitDetails.ts","webpack:///./src/commands/showQuickCommitFileDetails.ts","webpack:///./src/commands/showQuickCurrentBranchHistory.ts","webpack:///./src/commands/showQuickFileHistory.ts","webpack:///./src/commands/showQuickRepoStatus.ts","webpack:///./src/commands/showQuickStashList.ts","webpack:///./src/commands/showView.ts","webpack:///./src/commands/stashApply.ts","webpack:///./src/commands/stashDelete.ts","webpack:///./src/commands/stashSave.ts","webpack:///./src/commands/supportGitLens.ts","webpack:///./src/commands/switchMode.ts","webpack:///./src/commands/toggleCodeLens.ts","webpack:///./src/commands.ts","webpack:///./src/messages.ts","webpack:///./src/git/gitUri.ts","webpack:///external \"path\"","webpack:///./src/quickpicks/gitQuickPicks.ts","webpack:///./node_modules/lodash-es/_root.js","webpack:///./src/keyboard.ts","webpack:///./src/terminal.ts","webpack:///./src/git/remotes/provider.ts","webpack:///./src/comparers.ts","webpack:///./src/system/decorators/log.ts","webpack:///./node_modules/lodash-es/isObjectLike.js","webpack:///./src/git/models/file.ts","webpack:///./src/git/parsers/blameParser.ts","webpack:///./src/git/parsers/branchParser.ts","webpack:///./src/git/parsers/logParser.ts","webpack:///./src/git/parsers/reflogParser.ts","webpack:///./src/git/parsers/remoteParser.ts","webpack:///./src/git/parsers/shortlogParser.ts","webpack:///./src/git/parsers/stashParser.ts","webpack:///./src/git/parsers/statusParser.ts","webpack:///./src/git/parsers/tagParser.ts","webpack:///./src/git/parsers/treeParser.ts","webpack:///./src/git/parsers/parsers.ts","webpack:///./node_modules/lodash-es/_Symbol.js","webpack:///./node_modules/lodash-es/_getRawTag.js","webpack:///./node_modules/lodash-es/_objectToString.js","webpack:///./node_modules/lodash-es/_baseGetTag.js","webpack:///external \"fs\"","webpack:///./src/config.ts","webpack:///./src/git/models/commit.ts","webpack:///./node_modules/lodash-es/isObject.js","webpack:///./src/system/string.ts","webpack:///./src/avatars.ts","webpack:///./src/git/remotes/azure-devops.ts","webpack:///./src/git/remotes/bitbucket.ts","webpack:///./src/git/remotes/bitbucket-server.ts","webpack:///./src/git/remotes/custom.ts","webpack:///./src/git/remotes/github.ts","webpack:///./src/git/remotes/gitlab.ts","webpack:///./src/git/remotes/factory.ts","webpack:///./src/git/shell.ts","webpack:///./node_modules/safer-buffer/safer.js","webpack:///./src/git/models/branch.ts","webpack:///./src/trackers/trackedDocument.ts","webpack:///./src/trackers/documentTracker.ts","webpack:///./src/trackers/gitDocumentTracker.ts","webpack:///./src/system/promise.ts","webpack:///./src/emojis.ts","webpack:///external \"buffer\"","webpack:///./node_modules/lodash-es/isBuffer.js","webpack:///./node_modules/iconv-lite/lib/index.js","webpack:///./src/git/models/models.ts","webpack:///./src/git/models/status.ts","webpack:///./src/git/parsers/diffParser.ts","webpack:///./src/git/models/reflog.ts","webpack:///./src/git/models/logCommit.ts","webpack:///./node_modules/lodash-es/now.js","webpack:///./node_modules/lodash-es/isSymbol.js","webpack:///./node_modules/lodash-es/toNumber.js","webpack:///./node_modules/lodash-es/debounce.js","webpack:///./node_modules/lodash-es/toFinite.js","webpack:///./node_modules/lodash-es/toInteger.js","webpack:///./node_modules/lodash-es/before.js","webpack:///./node_modules/lodash-es/once.js","webpack:///./src/system/function.ts","webpack:///./src/git/formatters/formatter.ts","webpack:///./src/git/formatters/commitFormatter.ts","webpack:///./src/git/formatters/statusFormatter.ts","webpack:///./src/git/formatters/formatters.ts","webpack:///./node_modules/lodash-es/_freeGlobal.js","webpack:///./src/git/fsProvider.ts","webpack:///./src/vsls/protocol.ts","webpack:///./src/vsls/host.ts","webpack:///./src/vsls/guest.ts","webpack:///./src/vsls/vsls.ts","webpack:///./node_modules/dayjs/dayjs.min.js","webpack:///./node_modules/vsls/vscode.js","webpack:///external \"stream\"","webpack:///./node_modules/lodash-es/_nodeUtil.js","webpack:///external \"crypto\"","webpack:///(webpack)/buildin/harmony-module.js","webpack:///./src/git/models/blameCommit.ts","webpack:///./src/git/models/contributor.ts","webpack:///./src/git/models/diff.ts","webpack:///./src/git/models/remote.ts","webpack:///./src/git/models/repository.ts","webpack:///./src/git/models/stashCommit.ts","webpack:///./src/git/models/tag.ts","webpack:///./node_modules/lodash-es/stubFalse.js","webpack:///./node_modules/dayjs/plugin/advancedFormat.js","webpack:///./node_modules/dayjs/plugin/relativeTime.js","webpack:///./src/git/locator.ts","webpack:///external \"child_process\"","webpack:///./src/extension.ts","webpack:///./node_modules/iconv-lite/lib/bom-handling.js","webpack:///./node_modules/iconv-lite/encodings/index.js","webpack:///./node_modules/iconv-lite/encodings/internal.js","webpack:///external \"string_decoder\"","webpack:///./node_modules/iconv-lite/encodings/utf32.js","webpack:///./node_modules/iconv-lite/encodings/utf16.js","webpack:///./node_modules/iconv-lite/encodings/utf7.js","webpack:///./node_modules/iconv-lite/encodings/sbcs-codec.js","webpack:///./node_modules/iconv-lite/encodings/sbcs-data.js","webpack:///./node_modules/iconv-lite/encodings/sbcs-data-generated.js","webpack:///./node_modules/iconv-lite/encodings/dbcs-codec.js","webpack:///./node_modules/iconv-lite/encodings/dbcs-data.js","webpack:///./node_modules/iconv-lite/lib/streams.js","webpack:///./node_modules/iconv-lite/lib/extend-node.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","array","iteratee","index","length","result","Array","asyncTag","funcTag","genTag","proxyTag","uid","isObject","tag","maskSrcKey","exec","keys","IE_PROTO","func","funcToString","Function","toString","e","reIsHostCtor","objectProto","reIsNative","RegExp","replace","test","undefined","this","__data__","size","has","HASH_UNDEFINED","data","Hash","entries","clear","entry","set","other","splice","pop","push","ListCache","type","map","MapCache","SetCache","values","add","predicate","fromIndex","fromRight","comparator","cache","nativeMin","Math","min","arrays","includes","othLength","othIndex","caches","maxLength","Infinity","seen","outer","computed","thisArg","args","apply","nativeMax","max","start","transform","arguments","otherArgs","string","HOT_COUNT","HOT_SPAN","nativeNow","Date","now","count","lastCalled","stamp","remaining","MAX_SAFE_INTEGER","isObjectLike","mapped","LARGE_ARRAY_SIZE","pairs","Stack","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","bitmask","customizer","equalFunc","stack","isPartial","arrLength","stacked","arrValue","othValue","compared","Uint8Array","forEach","boolTag","dateTag","errorTag","mapTag","numberTag","regexpTag","setTag","stringTag","symbolTag","arrayBufferTag","dataViewTag","symbolProto","symbolValueOf","valueOf","byteLength","byteOffset","buffer","message","convert","offset","isArray","keysFunc","symbolsFunc","resIndex","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","symbol","argsTag","reIsUint","typedArrayTags","nodeIsTypedArray","isTypedArray","inherited","isArr","isArg","isBuff","isBuffer","isType","skipIndexes","String","Ctor","constructor","arg","objProps","objLength","skipCtor","objValue","objCtor","othCtor","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","getTag","ArrayBuffer","resolve","ctorString","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","baseIsEqual","isCommon","valuesLength","valuesIndex","spreadableSymbol","isConcatSpreadable","baseFlatten","depth","isStrict","seenIndex","Arrays","compactHierarchy","root","joinPath","isRoot","children","every","siblings","parent","delete","child","relativePath","countUniques","source","accessor","uniqueCounts","item","filterMap","predicateMapper","reduce","accumulator","current","filterMapAsync","async","groupBy","groupings","groupByMap","group","Map","groupByFilterMap","intersection","isEqual","areEquivalent","makeHierarchical","splitPath","compact","seed","descendants","hierarchy","folder","folderName","f","uniqueBy","uniqueValues","filter","Dates","advancedFormat","relativeTime","MillisecondsPerMinute","MillisecondsPerHour","MillisecondsPerDay","getFormatter","date","emptyStr","defaultResolver","arg0","JSON","stringify","gate","resolver","target","descriptor","fn","Error","gateKey","prop","configurable","writable","promise","is","then","memoize","fnKey","memoizeKey","Iterables","some","next","done","find","first","iterator","flatMap","mapper","isIterable","join","separator","last","skip","take","union","sources","Objects","flatten","prefix","flattened","_flatten","len","isEmpty","paths","path","results","FIN","StringIterator","_value","_pos","a","charCodeAt","_from","_to","justSeps","ch","CharCode","Slash","Backslash","aPos","aLen","thisPos","cmp","substring","TernarySearchTreeNode","left","mid","right","segments","_iter","_root","element","iter","reset","node","segment","val","hasNext","oldElement","dir","candidate","limit","_nodeIterator","res","idx","_forEach","callback","_iterator","Versions","from","major","minor","patch","pre","parseInt","fromString","version","ver","split","compare","v1","v2","localeCompare","extensionId","extensionOutputChannelName","extensionQualifiedId","extensionTerminalName","BuiltInCommands","CommandContext","DocumentSchemes","GlyphChars","GlobalState","setCommandContext","executeCommand","SetContext","getEditorIfActive","document","editor","activeTextEditor","isActiveDocument","isTextEditor","scheme","uri","Output","DebugConsole","ImageMimetypes","WorkspaceState","AnnotationStatus","trackedDocument","decoration","highlightDecoration","correlationKey","getCorrelationKey","disposable","onDidChangeTextEditorSelection","onTextEditorSelectionChanged","id","dispose","equals","textEditor","selection","selections","active","line","status","setDecorations","additionalDecorations","changes","_resetDebounced","debounce","onReset","provideAnnotation","_disposed","Computing","decorations","ranges","Computed","shaOrLine","onProvideAnnotation","cssColorRegex","toRgba","color","trim","hex","parseFloat","defaultHeatmapHotColor","defaultHeatmapColdColor","computedHeatmapColor","heatmap","getHeatmapColor","renderOptions","before","borderColor","commit","editorLine","hunkLine","documentRef","sha","ref","isUncommitted","isUncommittedStaged","commitLine","lines","originalFileName","fsPath","fileName","originalLine","git","getDiffForLine","uncommittedStagedSha","previousSha","diff","getDiffFromHunkLine","previous","diffUris","getPreviousLineDiffUris","getMarkdownCommandArgs","lhs","documentUri","rhs","repoPath","shortenSha","strings","working","previousShortSha","shortSha","Dash","ArrowLeftRightLong","markdown","isTrusted","dateFormat","annotationType","presence","previousLineDiffUris","remotes","Promise","all","vsls","getContactPresence","email","getRemotes","sort","fromTemplate","config","hovers","detailsMarkdownFormat","format","dateFormatOrFormatOptions","uncommittedColor","contentText","pad","Space","separateLines","options","chars","token","tokenOptions","truncateTo","getWidth","interpolate","width","borderStyle","borderWidth","enabled","location","spacing","configuration","getAny","round","backgroundColor","fontWeight","fontStyle","height","margin","textDecoration","applyHeatmap","scrollable","getBranchAndTagTips","truncateMessageAtNewLine","after","changesDiff","hunk","baseColor","cold","colors","hot","age","computeAge","rgba","g","b","rgb","toFixed","AnnotationClearReason","super","_uri","_blame","isDirty","getBlameForFileContents","getText","getBlameForFile","setForceDirtyStateChangeOnNextDocumentChange","_hoverProviderDisposable","blame","commits","highlightDecorationRanges","validateRange","Number","dates","getTime","half","floor","median","lookup","newest","step","oldest","setDate","getDate","ageThreshold","coldColor","hotColor","time","providers","annotations","details","subscriptions","registerHoverProvider","pattern","provideHover","provideChangesHover","provideDetailsHover","position","getCommitForHover","logCommit","getCommitForFile","previousFileName","detailsHoverMessage","fromUri","defaultDateFormat","changesHoverMessage","over","character","getBlame","cc","getCorrelationContext","Blame","process","hrtime","cfg","getTokensFromTemplate","getBranchesAndTagsTipsFn","avatars","gravatarDefault","defaultGravatarsStyle","gutterRenderOptions","decorationsMap","avatarDecorationsMap","gutter","computedHeatmap","compacted","getComputedHeatmap","range","addOrUpdateGravatarDecoration","repeat","log","getDurationMilliseconds","registerHoverProviders","avatarDecoration","createTextEditorDecorationType","gutterIconPath","getGravatarUri","gutterIconSize","Heatmap","heatmapRenderOptions","RecentChanges","getDiffForFile","hunks","currentPosition","state","hoverMessage","Decorations","blameAnnotation","rangeBehavior","ClosedOpen","blameHighlight","heatmapAnnotation","ZeroWidthSpace","heatmapHighlight","recentChangesAnnotation","recentChangesHighlight","_onDidToggleAnnotations","_annotationProviders","_keyboardScope","_annotationType","_disposable","onDidChange","onConfigurationChanged","_toggleModes","initializingChangeEvent","event","clearAll","_annotationsDisposable","changed","cfgHighlight","highlight","isWholeLine","overviewRulerLane","Right","locations","Line","overviewRulerColor","Overview","dark","Gutter","context","asAbsolutePath","light","recentChanges","initializing","toggleMode","File","provider","show","_editor","isInWindowToggle","getProvider","detachKeyboardHook","attachKeyboardHook","blameable","BlameabilityChanged","clearCore","DocumentChanged","isTrackable","DocumentClosed","restore","fuzzyProvider","ColumnChanged","editors","getToggleMode","Window","reason","User","Disposing","tracker","isBlameable","visibleTextEditors","getOrAdd","currentProvider","withProgress","progress","computingAnnotations","showAnnotationsCore","on","isTracked","reopen","keyboard","beginScope","escape","onDidPressKey","fire","annotationsLabel","report","validate","onDidChangeActiveTextEditor","onActiveTextEditorChanged","onDidChangeTextEditorViewColumn","onTextEditorViewColumnChanged","onDidChangeVisibleTextEditors","onVisibleTextEditorsChanged","onDidCloseTextDocument","onTextDocumentClosed","onDidChangeBlameState","onBlameStateChanged","onDidChangeDirtyState","onDirtyStateChanged","annotationDecoration","_enabled","_suspended","fileAnnotations","onDidToggleAnnotations","onFileAnnotationsToggled","clearAnnotations","lineTracker","stop","currentLine","resume","setLineTracker","refresh","pending","suspended","suspend","includesAll","exitDetails","Dot","getState","trailing","isSubscribed","onDidChangeActiveLines","onActiveLinesChanged","languageId","blameRange","isFullRange","desiredCommand","command","_git","_tracker","_onDidChangeCodeLenses","dirty","isDirtyIdle","maxLines","advanced","sizeThresholdAfterEdit","lineCount","languageScope","scopesByLanguage","ll","language","toLowerCase","scopes","symbolScopes","lenses","gitUri","symbols","Document","ExecuteDocumentSymbolProvider","isCancellationRequested","documentRangeFn","once","dirtyCommand","title","getDirtyTitle","sym","provideCodeLens","end","blameForRangeFn","recentChange","getBlameForRangeSync","fileSymbol","getRangeFromSymbol","authors","includeSingleLineSymbols","valid","symbolName","kind","Containers","Package","Class","Interface","Module","Namespace","Struct","isSingleLine","Constructor","Enum","Method","Property","Blocks","getValidateSymbolRange","lineAt","lineNumber","startChar","with","multiline","isDocumentSymbol","lens","resolveGitRecentChangeCodeLens","resolveGitAuthorsCodeLens","reject","recentCommit","author","formattedDate","debug","containerName","DiffWithPrevious","applyDiffWithPreviousCommand","RevealCommitInView","applyRevealCommitInViewCommand","ShowCommitsInView","applyShowCommitsInViewCommand","ShowQuickCommitDetails","applyShowQuickCommitDetailsCommand","ShowQuickCommitFileDetails","applyShowQuickCommitFileDetailsCommand","ShowQuickCurrentBranchHistory","applyShowQuickCurrentBranchHistoryCommand","ShowQuickFileHistory","applyShowQuickFileHistoryCommand","ToggleFileBlame","applyToggleFileBlameCommand","commandArgs","toFileUri","refs","codeLens","unsavedChanges","recentChangeAndAuthors","recentChangeOnly","authorsOnly","selector","Vsls","Git","GitLens","_canToggle","_providerDisposable","_provider","createProvider","CanToggleCodeLens","registerCodeLensProvider","onDidTriggerDirtyIdle","onDirtyIdleTriggered","unregister","register","registered","lineState","getAnnotationType","wholeLine","lineAnnotations","clearBlame","_blameStatusBarItem","_modeStatusBarItem","statusBar","modes","statusBarItemName","alignment","Left","createStatusBarItem","SwitchMode","text","tooltip","reduceFlicker","updateBlame","hide","DiffLineWithPrevious","DiffWithWorking","DiffLineWithWorking","ToggleCodeLens","_onDidChangeActiveLines","_state","_lines","trigger","subscriber","subscription","setImmediate","_linesChangedDebounced","cancel","onLinesChanged","fireLinesChanged","track","lines1","lines2","v","GitLineState","_count","_subscriptions","updated","updateState","force","blameLine","getBlameForLineContents","getBlameForLine","setState","_onDidChangeTreeData","_onDidChangeVisibility","_onDidChangeNodeState","_lastMaxCounts","isDebugging","getTreeItem","label","contextValue","registerCommands","container","_tree","createTreeView","treeDataProvider","onDidChangeVisibility","onVisibilityChanged","onDidCollapseElement","onElementCollapsed","onDidExpandElement","onElementExpanded","getRoot","getChildren","ensureRoot","getParent","resetNodeLastMaxCount","Collapsed","Expanded","visible","allowPaging","canTraverse","maxDepth","findNodeCoreBFS","queue","defaultPageSize","maxListItems","shift","maxCount","pageSize","showMoreNodeChildren","triggerNodeChange","reveal","ex","error","section","splitSingle","actions","isCloseAffordance","showErrorMessage","update","Global","rememberLastMaxCount","previousNode","select","refreshNode","0","1","opts","3","ViewsCompareKeepResults","keepResults","viewCommands","registerCommand","getQualifiedCommand","setFilesLayout","Auto","List","Tree","setKeepResults","pinComparison","unpinComparison","swapComparison","selectForCompare","compareWithSelected","initialize","showCollapseAll","views","workspaceState","canDismiss","dismiss","ref1","ref2","addResults","pinned","PinnedComparisons","notation","pin","_","rest","addOrReplace","expand","focus","layout","updateEffective","swap","unpin","changeBase","setEditorFollowing","setRenameFollowing","ViewsFileHistoryEditorFollowing","fileHistory","baseRef","showHistoryForUri","ViewsLineHistoryEditorFollowing","lineHistory","_onDidChangeAutoRefresh","setAutoRefresh","repositories","autoRefresh","setBranchComparison","Working","Branch","ViewsRepositoriesAutoRefresh","repoNodeId","getId","findNode","startsWith","stash","Notification","cancellable","findCommitNode","nodes","reverse","stashName","findStashNode","workspaceEnabled","comparisonType","setComparisonType","ViewsSearchKeepResults","search","searchQueryFn","getSearchQueryFn","getLogForSearch","getSearchLabel","cachedOnce","truncated","resultsType","singular","plural","pluralize","number","zero","useCacheOnce","query","toClipboard","clipboard","writeText","view","dismissNode","showMore","showAll","fetch","pull","closeRepository","setAsDefault","unsetAsDefault","openInTerminal","star","unstar","exploreRepoAtRevision","contributorAddCoAuthoredBy","contributorCopyToClipboard","openChanges","openChangesWithWorking","openFile","openFileRevision","openFileRevisionInRemote","openChangedFiles","openChangedFileDiffs","openChangedFileDiffsWithWorking","openChangedFileRevisions","applyChanges","switch","addRemote","pruneRemote","stageDirectory","stageFile","unstageDirectory","unstageFile","compareAncestryWithWorking","compareWithHead","compareWithRemote","compareFileWithSelected","selectFileForCompare","compareWithWorking","setComparisonNotation","cherryPick","merge","rebase","rebaseToRemote","revert","terminalPushCommit","terminalCreateBranch","terminalDeleteBranch","terminalRemoveRemote","terminalCreateTag","terminalDeleteTag","showInputBox","prompt","placeHolder","ignoreFocusOut","url","repo","remote","applyChangesToWorkingFile","getRepository","references","GitCommands","closed","gitApi","getBuiltInGitApi","normalizePath","rootUri","contributor","coauthor","inputBox","newlines","endsWith","ExploreRepoAtRevision","repos","reference","branch","OpenInTerminal","file","remoteName","flags","upstream","tracking","refType","checkout","comparisonNotation","triggerChange","unStageFile","unStageDirectory","compareView","getBranch","commonAncestor","getMergeBase","_selectedFile","selected","ViewsCanCompareFile","diffArgs","DiffWith","getCommand","showOptions","preview","preserveFocus","OpenWorkingFile","toRevisionUri","previousUri","OpenFileInRemote","toGitUri","files","getFilesQueryResults","showWarningMessage","fromFile","deletedOrMissingSha","uri1","previousFileSha","remoteBranch","getName","getRemoteName","IpcNotificationType","method","IpcCommandType","onIpcCommand","params","DidChangeConfigurationNotificationType","ReadyCommandType","UpdateConfigurationCommandType","SettingsDidRequestJumpToNotificationType","ipcSequence","emptyCommands","showCommand","_column","onShowCommand","_disposablePanel","notifyDidChangeConfiguration","_panel","webviewPanel","scope","Workspace","inspect","workspaceValue","globalValue","defaultValue","removes","onMessageReceived","column","Active","html","getHtml","createWebviewPanel","viewColumn","retainContextWhenHidden","enableFindWidget","enableCommandUris","enableScripts","iconPath","onDidDispose","onPanelDisposed","onDidChangeViewState","onViewStateChanged","webview","onDidReceiveMessage","onMessageReceivedCore","filename","content","err","_html","openTextDocument","renderHead","renderBody","renderEndOfBody","postMessage","nextIpcId","notify","applyViewLayoutPreset","preset","histories","compareAndSearch","SourceControl","Explorer","anchorRegex","ShowSettingsPage","ShowSettingsPageAndJumpToCompareView","ShowSettingsPageAndJumpToFileHistoryView","ShowSettingsPageAndJumpToLineHistoryView","ShowSettingsPageAndJumpToRepositoriesView","ShowSettingsPageAndJumpToSearchCommitsView","anchor","match","_pendingJumpToAnchor","workspaceFolders","bootstrap","ShowWelcomePage","_context","_config","applyMode","_lineTracker","_vsls","_fileAnnotationController","_lineAnnotationController","_lineHoverController","_statusBarController","_codeLensController","_keyboard","_settingsWebview","_welcomeWebview","_compareView","_fileHistoryView","_lineHistoryView","_repositoriesView","_searchView","onWillChange","onConfigurationChanging","change","level","_applyModeConfigurationTransformBound","applyModeConfigurationTransform","_viewCommands","ToggleFileHeatmap","ToggleFileRecentChanges","setTimeout","_configsAffectedByMode","original","affectsConfiguration","resource","slash","RepoSearchWarnings","doesNotExist","doubleQuoteRegex","userConfigRegex","mappedAuthorRegex","searchMessageOperationRegex","searchMessageValuesRegex","searchOperationRegex","emptyPromise","reflogCommands","searchOperators","Set","SearchPattern","fromCommit","refOrCommit","GitService","fromCommits","refsOrCommits","toKey","matchAll","matchCase","matchRegex","normalizeSearchOperatorsMap","_onDidChangeRepositories","_branchesCache","_tagsCache","_tagsWithRefsCache","_trackedCache","_userMapCache","_repositoryTree","forPaths","onDidChangeWindowState","onWindowStateChanged","onDidChangeWorkspaceFolders","onWorkspaceFoldersChanged","_repositoriesLoadingPromise","gitPath","setOrFindGitPath","readonly","caching","Config","Closed","updateContext","fireRepositoriesChanged","focused","added","removed","isMaybeGuest","guest","getRepositoriesInFolder","onAnyRepositoryChanged","repositorySearch","findSuperstr","reposToDelete","k","anyRepoChangedFn","rootPath","getRepoPathCore","excludes","repoPaths","repositorySearchCore","rp","withFileTypes","isDirectory","repositoryTree","hasRepository","any","Enabled","hasRemotes","HasRemotes","watcher","createFileSystemWatcher","onDidCreate","getWorkspaceFolder","remote__add","remote__prune","similarityThreshold","allowConflicts","showGenericErrorMessage","getOrderedRepositories","getActiveRepoPath","doc","getHighlanderRepoPath","highlander","useCaching","cachedBlame","getBlameForFileCore","customArguments","ignoreWhitespace","parse","getCurrentUser","msg","errorMessage","setBlameFailure","contents","sha1","getBlameForFileContentsCore","blame__contents","skipCache","lineToBlame","startLine","endLine","currentUser","allLines","slice","shas","sortedAuthors","rev_parse__currentBranch","committerDate","log__recent_committerdate","branches","for_each_ref__branch","supportsChangeEvents","filterBranches","filterTags","include","tags","getBranches","getTags","currentName","includeRefs","branchesAndTagsBySha","concat","bt","branchesAndTags","diff__shortstat","parseShortStat","getLog","rev_list","getLogForFile","firstIfNotFound","isSha","config__get","shortlog","contributors","user","config__get_regex","local","substr","mappedAuthor","check_mailmap","cachedDiff","getDiffForFileCore","encoding","getEncoding","show__diff","diff__name_status","parseNameStatus","show__name_status","merges","Log","maxSearchItems","operations","parseSearchOperations","searchArgs","op","useShow","log__search","renames","fileHistoryFollowsRenames","cachedLog","getLogForFileCore","log__file","LogFile","repository","hasTrackingBranch","merge_base","relativeTo","getNextUri","getStatusForFile","indexStatus","filters","simple","nextRef","parseSimple","nextRenamedRef","renamedFile","parseSimpleRenamed","firstParent","workingTreeStatus","getPreviousUri","resolveToUri","uncommittedSha","invalidLineCount","log__file_recent","previousRef","reflog","getRemotesCore","includeAll","loadProviders","factory","filePathOrUri","skipCacheUpdate","isVslsScheme","findRepositoryForPath","parts","filePath","rev_parse__show_toplevel","getRepoPath","getRepositoryTree","getRepositories","repoPathOrUri","findSubstr","vslsPath","stash__list","porcelainVersion","validateVersion","status__file","show_ref__tags","parseWithRef","ls_tree","trees","ls_files","untracked","renamedRef","schemeOruri","fileNameOrUri","cacheKey","tracked","isTrackedCore","Boolean","tool","getDiffTool","difftool","difftool__dir_diff","isShaLike","rev_parse","shaParentRegex","parentRef","ensuredRef","cat_file__resolve","check_ref_format","cat_file__validate","directoryOrUri","deleteAfter","stash__apply","stash__delete","uris","stash__push","ensureGitVersion","pathspecs","u","getGitVersion","feature","gitVersion","extension","getExtension","isActive","activate","getAPI","parseSearchMessageOperations","getGitPath","isShaParent","singleLine","exit","2","toLoggable","Commands","registrableCommands","getCommandUri","getRepoPathOrActiveOrPrompt","placeholder","goBackCommand","getRepoPathOrActive","pick","execute","getRepoPathOrPrompt","isCommandViewContextWithBranch","isCommandViewContextWithCommit","isCommandViewContextWithContributor","isCommandViewContextWithFile","isCommandViewContextWithFileCommit","isCommandViewContextWithFileRefs","isCommandViewContextWithRef","isCommandViewContextWithRemote","isCommandViewContextWithRepo","isCommandViewContextWithRepoPath","isScmResourceGroup","handle","resourceStates","isScmResourceState","resourceUri","Command","contextParsingOptions","_execute","cmd","encodeURIComponent","parseContext","preExecute","firstArg","edit","states","scmResourceStates","groups","scmResourceGroups","ActiveEditorCommand","lastCommand","getLastCommand","ActiveEditorCachedCommand","EditorCommand","registerTextEditorCommand","executeCore","openEditor","rethrow","Open","showTextDocument","openWorkspace","openInNewWindow","OpenFolder","updateWorkspaceFolders","emptyConfig","Proxy","Configuration","_onDidChange","_onDidChangeAny","_onWillChange","onDidChangeConfiguration","evt","getConfiguration","to","inspection","migrated","migrationFn","workspaceFolderValue","WorkspaceFolder","fallbackValue","fromInspection","toInspection","TraceLevel","ConsolePrefix","isDebuggingRegex","Logger","loggableFn","customLoggableFn","_level","Silent","output","createOutputChannel","contextOrMessage","Debug","console","timestamp","appendLine","toLoggableParams","Verbose","warn","sanitize","loggable","instance","indexOf","toISOString","getUTCMilliseconds","debugOnly","loggableParams","_isDebugging","env","VSCODE_DEBUGGING_EXTENSION","gitOutput","ReferencesQuickPickIncludes","checkmarks","cancellation","autoPick","goBack","items","getItems","itms","allowEnteringRefs","quickpick","createQuickPick","busy","getQuickPickIgnoreFocusOut","onCancellationRequested","onDidHide","onDidAccept","selectedItems","validateReference","showQuickPick","checked","BranchesAndTags","Branches","Tags","findIndex","WorkingTree","showQuickPickProgress","mapping","_getInfiniteCancellablePromise","_showQuickPickProgress","commandOrArgs","assign","KeyCommandQuickPickItem","description","searchView","isStash","fileHistoryView","repositoriesView","revealStash","revealCommit","_goBack","copy","open","Commit","getFormattedPath","Repo","Revision","isFile","shortFileSha","default","OpenInRemote","Ellipsis","progressCancellation","nextPageCommand","currentCommandArgs","currentCommand","ArrowBack","ShowQuickBranchHistory","previousPageCommand","fromRepoPath","npc","matchOnDescription","matchOnDetail","_commit","fileLog","workingUri","getWorkingUri","resolveReference","copyShaCommandArgs","CopyShaToClipboard","copyMessageCommandArgs","CopyMessageToClipboard","copyRemoteUrlCommandArgs","CopyRemoteFileUrlToClipboard","fileHistoryCommandArgs","commitDetailsCommandArgs","previousCommand","nextCommand","previousCommandArgs","nextUri","nextCommandArgs","ArrowRightHollow","getShortMessage","onDidSelectItem","setKeyCommand","_file","getStatusOcticon","getFormattedDirectory","toFileCommit","showChanges","repoLog","nextSha","nextLog","onDidSelect","stashApplyCommmandArgs","stashItem","StashApply","stashDeleteCommmandArgs","StashDelete","diffDirectoryCommmandArgs","DiffDirectory","getFormattedDiffStatus","fs","pickerOnly","showInViewCommand","showAllCommand","goBackCommandArgs","SpaceThin","modeCfg","_status","realIndexStatus","staged","getOcticon","OpenChangedFiles","stagedAdds","unstagedAdds","stagedChanges","unstagedChanges","stagedDeletes","unstagedDeletes","stagedAddsAndChanges","unstagedAddsAndChanges","unstaged","stagedStatus","unstagedStatus","workTreeStatus","numeric","sensitivity","repoStatusCommandArgs","ShowQuickRepoStatus","computeStatus","unstagedIndex","CloseUnchangedFiles","stashListCommandArgs","ShowQuickStashList","ahead","branchHistoryCommandArgs","behind","ArrowsRightLeft","emptyArray","freeze","emptyObj","rootSha","GitErrors","badRevision","notAValidObjectName","GitWarnings","notARepository","outsideRepository","noPath","noCommits","notFound","foundButNotInRevision","headNotABranch","noUpstream","unknownRevision","mustRunInWorkTree","patchWithConflicts","noRemoteRepositorySpecified","remoteConnectionError","notAGitCommand","GitErrorHandling","pendingCommands","cwd","configs","errors","errorHandling","runOpts","GCM_INTERACTIVE","GCM_PRESERVE_CREDS","LC_ALL","gitCommand","waiting","exception","gitInfo","Ignore","Throw","defaultExceptionHandler","duration","logGitCommand","warning","isMatch","shaRegex","shaLikeRegex","uncommittedRegex","uncommittedStagedRegex","uncommittedStaged","uncommitted","abbreviatedShaLength","shaShortenRegex","rev","suffix","extract","normalizedRepoPath","gitMajor","gitMinor","regex","pathspec","stdin","createBranch","prune","defaultFormat","simpleFormat","forkPoint","since","stdout","log__recent","includeUntracked","keepIndex","GIT_OPTIONAL_LOCKS","ResourceType","unknownGitUri","ViewNode","toLoggableName","ViewRefNode","ViewRefFileNode","nodeSupportsConditionalDismissal","_canSubscribe","disposables","onDidChangeNodeState","onNodeStateChanged","viewSupportsAutoRefresh","onDidChangeAutoRefresh","onAutoRefreshChanged","unsubscribe","ensureSubscription","_subscription","subscriptionPromise","onStateChanged","onParentStateChanged","canSubscribe","subscribe","viewSupportsNodeDismissal","_message","_description","_tooltip","_iconPath","None","Message","_command","_previousNode","_pageSize","pageItemLimit","Pager","itemType","_options","displayAsCommit","resourceType","icon","getStatusIcon","_label","getCommitDescriptionTemplate","getCommitFileDescriptionTemplate","_folderName","getCommitTemplate","getCommitFileTemplate","_relativePath","inFileHistory","commitFormat","commitDescriptionFormat","commitFileFormat","commitFileDescriptionFormat","containsWorkingFiles","priority","getFileNesting","Folder","nesting","nestingThreshold","threshold","markers","insertDateMarkers","iterable","showRelativeDateMarkers","daysAgo","marker","setUTCHours","nextDate","direction","supportsPaging","getNodeLastMaxCount","defaultItemLimit","previousLog","StatusAheadOfUpstream","StatusBehindUpstream","BranchStatusAheadOfUpstream","BranchStatusBehindUpstream","iconSuffix","_commitsQuery","includeDescription","ResultsCommits","getCommitsQueryResults","timeout","TimeoutError","getRepositoryCount","formattedName","_commitsQueryResults","ResultsFile","statusIcon","_filesQuery","ResultsFiles","_filesQueryResults","comparisons","BranchComparisons","compareWith","_compareWith","useSymmetricDifferenceNotation","showBranchComparison","_children","getCommitsQuery","compareWithWorkingTree","getFilesQuery","CompareBranch","updateCompareWith","getDiffStatus","diffComparisonNotation","Contributor","statusText","getContributors","Contributors","record","HEAD","ReflogRecord","formatDateFromNow","formatDate","ArrowRight","getIncomingActivity","records","Reflog","_key","_expanded","expanded","branchNodes","treeHierarchy","arrows","types","Fetch","Push","ArrowLeft","Check","displayPath","domain","Remote","Remotes","StashFile","stashFormat","stashDescriptionFormat","stashFileFormat","stashFileDescriptionFormat","Stash","getStashList","Stashes","hasStagedChanges","hasUnstagedChanges","_hasStagedChanges","_hasUnstagedChanges","collapsibleState","StatusFileCommits","getChangedIn","statusFileDescriptionFormat","statusFileFormat","changedIn","includeWorkingTree","older","setMilliseconds","getMilliseconds","toStatusFile","aheadFiles","uniques","stats","getChangedFilesCount","StatusFiles","getBasename","Tag","annotation","tagNodes","hasTimeRegex","_lastFetched","getStatus","detached","insiders","getLastFetched","lastFetchedTooltip","formatLastFetched","includeTime","workingStatus","Repository","starred","upstreamStatus","getUpstreamStatus","empty","onRepoChanged","onDidChangeFileSystem","onFileSystemChanged","stopWatchingFileSystem","startWatchingFileSystem","defaultDateShortFormat","branchName","showTrackingBranch","getRemote","getTrackingStatus","selectedRef","ComparePicker","ComparePickerWithRef","_selectedRef","_comparePickerNode","getPinnedComparisons","Compare","ViewsCanCompare","promises","getRefName","autoCompare","_ref","_pinned","_comparisonNotation","_instanceId","instanceId","getDiffRefs","CompareResults","updatePinnedComparison","getPinnableId","currentId","comparison","FileHistory","directory","onRepoFileSystemChanged","resetChild","_child","_fileUri","commitish","_baseRef","fileUri","ActiveFileHistory","onActiveEditorChanged","_editorContents","getBlameForRangeContents","getBlameForRange","authorDate","firstLine","lastLine","firstActive","LineHistory","_base","_selection","ActiveLineHistory","resetChildren","Repositories","normalizedPath","onDidChangeRepositories","onRepositoriesChanged","autoReveal","containsUri","getCommandArgs","prefillOnly","Search","commitsQuery","SearchResults","showInView","SearchCommitsInView","ClearFileAnnotationsCommand","ClearFileAnnotations","ComputingFileAnnotations","ToggleFileBlameCommand","toggle","ToggleFileHeatmapCommand","copyArgs","ToggleFileRecentChangesCommand","ToggleLineBlameCommand","ToggleLineBlame","CloseUnchangedFilesCommand","getStatusForRepo","CloseAllEditors","_onEditorChangedFn","loopCount","found","useId","usePosition","nextEditor","closeEditor","CloseActiveEditor","waitForEditorChange","NextEditor","timer","clearTimeout","CopyMessageToClipboardCommand","blameline","getCommit","CopyRemoteFileUrlToClipboardCommand","CopyShaToClipboardCommand","DiffBranchWithCommand","DiffHeadWith","DiffWorkingWith","DiffHeadWithBranch","DiffWorkingWithBranch","DiffDirectoryCommand","DiffDirectoryWithHead","ViewsOpenDirectoryDiff","ViewsOpenDirectoryDiffWithWorking","openDirectoryDiff","openExternal","DiffLineWithPreviousCommand","showCommitHasNoPreviousCommitWarningMessage","DiffLineWithWorkingCommand","showFileNotUnderSourceControlWarningMessage","DiffWithCommand","argsOrCommit","getMarkdownCommandArgsCore","lhsSha","rhsSha","getFileStatusForCommit","getVersionedUri","rhsSuffix","lhsSuffix","Diff","DiffWithNextCommand","DiffWithNext","DiffWithNextInDiffLeft","inDiffLeftEditor","getNextDiffUris","DiffWithPreviousCommand","DiffWithPreviousInDiffRight","inDiffRightEditor","originalUri","getPreviousDiffUris","DiffWithRefCommand","DiffWithRef","DiffWithBranch","showNoRepositoryWarningMessage","renamedUri","renamedTitle","rename","DiffWithRevisionCommand","DiffWithRevision","showProgress","isOfRefType","DiffWithWorkingCommand","showInformationMessage","ExploreRepoAtRevisionCommand","fromRevisionUri","FocusFilesExplorer","Status","ResourceGroupType","ExternalDiffCommand","ExternalDiff","ExternalDiffAll","resourceGroupType","Index","isModified","BOTH_MODIFIED","INDEX_MODIFIED","MODIFIED","openDiffTool","InviteToLiveShareCommand","argsOrEmail","InviteToLiveShare","contact","getContact","invite","startSession","OpenBranchesInRemoteCommand","OpenBranchesInRemote","OpenBranchInRemoteCommand","OpenBranchInRemote","OpenChangedFilesCommand","OpenCommitInRemoteCommand","argsOrSha","OpenCommitInRemote","OpenFileInRemoteCommand","remotePart","branchPart","OpenFileRevisionCommand","argsOrUri","OpenFileRevision","OpenFileRevisionFromCommand","OpenFileRevisionFrom","OpenFileRevisionFromBranch","OpenInRemoteCommand","ensureRemoteBranchName","verb","shaSuffix","OpenRepoInRemoteCommand","OpenRepoInRemote","OpenRevisionFileCommand","OpenRevisionFile","OpenWorkingFileCommand","getBranchesAndOrTags","includeTags","picked","singleRepo","branchesByRepo","tagsByRepo","b1","b2","t1","t2","getValidateGitReferenceFn","_off","_on","_toggled","getIconPath","SelectableQuickInputButton","BreakQuickCommand","isQuickInputStep","_picked","_pickedVia","detail","pickedVia","override","canConfirm","canSkipConfirm","gitCommands","skipConfirmations","skipConfirmKey","Back","_stepsIterator","steps","_current","_initialState","confirmations","createPickStep","Cancel","counter","confirm","selectedBranchOrTag","getActiveRepository","fetched","canPickStepMoveNext","destination","destId","onValidateValue","multiselect","createConfirmStep","fetchAll","actives","fetchedOn","lastFetched","fromNow","getCommitCount","Buttons","pullAll","getSingleRepoConfirmStep","additionalButtons","onDidClickButton","button","pushAll","PickBranchOrCommit","pickCommit","pickBranchOrCommitButton","searchOperatorToTitleMap","MatchCase","MatchAll","MatchRegex","RevealInView","ShowInView","ShowResultsInView","pickedCommit","resultsKey","resultsPromise","showResultsInView","titleSuffix","matchCaseButton","matchAllButton","matchRegexButton","showResultsInViewButton","onDidChangeValue","searchKey","activeItems","subcommandToSubtitleMap","getSubtitle","subcommand","_subcommand","buttons","applyOrPop","drop","list","revealStashes","stashApply","stashDelete","pickedStash","createInputStep","canInputStepMoveNext","stashSave","ShowTags","showTags","showTagsButton","validateBranchName","sanitizeLabel","GitCommandsCommand","CloseOnFocusOut","KeepOpen","WillConfirm","WillConfirmForced","WillSkipConfirm","commandsStep","setCommand","showInputStep","showPickStep","input","createInputBox","createScope","onDidTriggerButton","getButtons","toggleKeepOpen","toggleConfirmation","pause","validationMessage","nextStep","_onDidChangeValueEmitter","overrideItems","canSelectMany","onDidChangeActive","directive","quickInput","closeOnFocusOut","correlate","timed","_active","commandName","fuzzy","FetchRepositoriesCommand","FetchRepositories","PullRepositoriesCommand","PullRepositories","PushRepositoriesCommand","PushRepositories","ResetSuppressedWarningsCommand","ResetSuppressedWarnings","SearchCommitsCommand","SearchCommits","gitCommandArgs","ShowCommitsInViewCommand","ShowCommitInView","ShowLastQuickPickCommand","ShowLastQuickPick","ShowQuickBranchHistoryCommand","ShowQuickCommitDetailsCommand","revealInView","showLineUncommittedWarningMessage","showCommitNotFoundWarningMessage","ShowQuickCommitFileDetailsCommand","ShowQuickRevisionDetails","revisionUri","ShowQuickCurrentBranchHistoryCommand","ShowQuickFileHistoryCommand","ShowFileHistoryInView","ShowQuickRepoStatusCommand","ShowQuickStashListCommand","ShowViewCommand","ShowCompareView","ShowFileHistoryView","ShowLineHistoryView","ShowRepositoriesView","ShowSearchView","lineHistoryView","StashApplyCommand","StashDeleteCommand","StashSaveCommand","StashSave","StashSaveFiles","keepStaged","SupportGitLensCommand","SupportGitLens","showSupportGitLensMessage","SwitchModeCommand","activeAnnotations","ToggleReviewModeCommand","ToggleReviewMode","ToggleZenModeCommand","ToggleZenMode","ToggleCodeLensCommand","toggleCodeLens","SuppressedMessages","Messages","showMessage","CommitHasNoPreviousCommitWarning","CommitNotFoundWarning","showOutputChannel","FileNotUnderSourceControlWarning","GitDisabledWarning","GitVersionWarning","LineUncommittedWarning","NoRepositoryWarning","ViewsHideSupportGitLens","suppressedMessage","SupportGitLensNotification","suppressionKey","dontShowAgain","messages","GitUri","commitOrRepoPath","authority","fragment","ensureValidUNCPath","versionedPath","getDirectory","relativeFsPath","useVersionedPath","useVslsScheme","fileOrName","normalizedFileName","uriOrRef","fileNameOrFile","addLeadingSlash","FlagsQuickPickItem","Directive","DirectiveQuickPickItem","BranchQuickPickItem","CommitQuickPickItem","RefQuickPickItem","RepositoryQuickPickItem","TagQuickPickItem","hasFlags","SpaceThinnest","gitRef","repoStatus","freeSelf","self","keyNoopCommand","mappings","KeyboardScope","_paused","_mapping","updateKeyCommandsContext","Key","Keyboard","_terminal","_terminalCwd","runGitCommandInTerminal","terminal","createTerminal","onDidCloseTerminal","sendText","ensureTerminal","RemoteResourceType","getNameFromRemoteResource","RemoteProvider","protocol","custom","_name","baseUrl","openUrl","getUrlForBranch","getUrlForBranches","getUrlForCommit","getUrlForFile","getUrlForRepository","Comparer","textDocumentComparer","TextDocumentComparer","textEditorComparer","TextEditorComparer","uriComparer","UriComparer","exact","correlationContext","correlationCounter","clearCorrelationContext","correlationId","setCorrelationContext","LogInstanceNameFn","logName","logFn","parameters","getParameters","condition","instanceName","enter","argFns","argFn","logWithDebugParams","logError","timing","logResult","catch","GitFile","includeOriginal","getOriginalRelativePath","getRelativePath","statusIconsMap","A","C","D","M","R","T","U","X","B","statusOcticonsMap","missing","statusTextMap","getStatusText","relativeFileName","lineParts","authorEmail","authorTimeZone","committerTimeZone","summary","parseEntry","branchWithTrackingRegex","emptyEntry","diffRegex","diffRangeRegex","fileStatusRegex","fileStatusAndSummaryRegex","fileStatusAndSummaryRenamedFileRegex","fileStatusAndSummaryRenamedFilePathRegex","logFileSimpleRegex","logFileSimpleRenamedRegex","logFileSimpleRenamedFilesRegex","renamedFileName","renamedMatch","truncationCount","committedDate","parentShas","fileStats","insertions","deletions","nextFileName","skipRef","diffFile","diffRenamed","renamed","lastIndex","reflogRegex","reflogHEADRegex","commands","head","headDate","headSha","recordDate","remoteRegex","urlRegex","providerFactory","uniqueness","parseGitUrl","shortlogRegex","fileNames","aheadStatusV1Regex","behindStatusV1Regex","parseV1","parseV2","aheadStatus","behindStatus","rawStatus","file1","file2","parseStatusFile","tagWithRefRegex","tagWithAnnotationRegex","treeRegex","GitTreeParser","commitSha","nativeObjectToString","symToStringTag","isOwn","unmasked","nullTag","undefinedTag","AnnotationsToggleMode","BranchSorting","CodeLensCommand","CodeLensScopes","CustomRemoteType","DateSource","DateStyle","FileAnnotationType","GravatarDefaultStyle","HighlightLocations","KeyMap","StatusBarCommand","TagSorting","ViewBranchesLayout","ViewFilesLayout","ViewLocation","ViewShowBranchComparison","GitCommitType","CommitDateFormatting","dateSource","dateStyle","GitCommit","_fileName","Committed","Absolute","committerDateFormatter","authorDateFormatter","dateFormatter","fallback","Strings","escapeMarkdownRegex","escapeMarkdownHeaderRegex","markdownQuotedRegex","escapeMarkdown","quoted","getCommonBase","s1","s2","delimiter","char","secs","nanosecs","pathNormalizeRegex","pathStripTrailingSlashRegex","tokenRegex","tokenSanitizeRegex","tokenSanitizeReplacement","template","tokens","option","collapseWhitespace","padDirection","interpolationMap","padLeft","padTo","padding","padRight","j","md5","digest","stripTrailingSlash","normalized","padLeftOrTruncate","truncate","padOrTruncate","abs","padRightOrTruncate","illegalCharsForFSRegex","ellipsis","sanitizeForFileSystem","replacement","splitLast","splitter","lastIndexOf","ansiRegex","containsNonAsciiRegex","emoji","joiners","graphemes","code","codePointAt","isFullwidthCodePoint","cp","avatarCache","missingGravatarHash","presenceCache","gitHubNoReplyAddressRegex","clearAvatarCache","getAvatarUri","hash","avatar","userId","userName","getAvatarUriFromGitHubNoReplyAddress","getPresenceDataUri","dataUri","encodeURI","issueEnricherRegex","gitRegex","legacyDefaultCollectionRegex","orgAndProjectRegex","sshDomainRegex","sshPathRegex","legacy","org","project","_displayPath","prEnricherRegex","formatName","urls","getContext","fileLine","fileRange","fileInCommit","fileInBranch","repoBase","issueEnricher3rdParyRegex","defaultProviders","matcher","creator","rc","getCustomProvider","Bitbucket","BitbucketServer","Custom","GitHub","GitLab","isWindows","platform","slashesRegex","ps1Regex","batOrCmdRegex","jsRegex","runDownPath","exe","isExecutable","PATH","haystack","needle","isGroup","gid","getgid","isUser","getuid","findExecutable","possibleExts","ext","possibleFullPath","SYSTEMROOT","execPath","bufferExceededRegex","run","stdinEncoding","maxBuffer","proc","stderr","Buffer","safer","Safer","encodingOrOffset","TypeError","alloc","fill","RangeError","buf","kStringMaxLength","binding","constants","MAX_LENGTH","kMaxLength","MAX_STRING_LENGTH","whitespaceRegex","BranchDateFormatting","GitBranch","isDetached","formatDetached","DateAsc","DateDesc","NameAsc","StarredBranches","updateStarred","_document","_eventDelegates","_onDidBlameStateChange","_forceDirtyStateChangeOnNextDocumentChange","_hasRemotes","_isDirtyIdle","_isTracked","_blameFailed","_repo","waitUntil","onRepositoryChanged","ActiveFileStatus","wasBlameable","forceBlameChange","onDidBlameStateChange","isRevision","_onDidChangeBlameState","_onDidChangeDirtyState","_onDidTriggerDirtyIdle","_documentMap","onDidChangeTextDocument","onTextDocumentChanged","onDidSaveTextDocument","onTextDocumentSaved","_dirtyIdleTriggerDelay","_dirtyIdleTriggeredDebounced","_timer","addCore","forceDirtyStateChangeOnNextDocumentChange","resetForceDirtyStateChangeOnNextDocumentChange","fireDocumentDirtyStateChanged","documentOrId","_add","_get","BinaryTextDocument","MissingRevisionTextDocument","ensureInitialized","_dirtyStateChangedDebounced","eol","LF","isClosed","isUntitled","GitDocumentState","Promises","obj","ms","emojiMap","emojiRegex","emojify","freeExports","nodeType","freeModule","bomHandling","iconv","encodings","defaultCharUnicode","defaultCharSingleByte","encode","str","encoder","getEncoder","write","trail","decode","skipDecodeWarning","decoder","getDecoder","encodingExists","enc","getCodec","toEncoding","fromEncoding","_codecDataCache","_canonicalizeEncoding","codecOptions","codec","codecDef","encodingName","bomAware","addBOM","PrependBOM","stripBOM","StripBOM","nodeVer","versions","nodeVerArr","GitReference","GitStatus","deleted","ArrowDown","ArrowUp","GitStatusFile","getChangedValue","nameStatusDiffRegex","shortStatDiffRegex","unifiedDiffRegex","GitDiffParser","previousStart","previousCount","currentStart","currentCount","currentLines","previousLines","hunkLines","GitReflogRecord","_selector","_previousSha","emptyStats","GitLogCommit","_fileStats","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","FUNC_ERROR_TEXT","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","flush","INFINITY","MAX_INTEGER","remainder","Functions","cached","comma","openBrace","openParen","closeParen","fnBodyRegex","fnBodyStripCommentsRegex","fnBodyStripParamDefaultValueRegex","fnBody","close","param","propOrMatcher","propOf","propOfCore","interval","clearInterval","setInterval","spaceReplacementRegex","collapsableWhitespace","_item","formatter","dateFormatOrOptions","_formatter","hasTokenRegexMap","formatAuthorDate","formatAuthorDateFromNow","defaultDateStyle","_authorDate","_authorDateAgo","formatCommitterDate","formatCommitterDateFromNow","_committerDate","_committerDateAgo","_date","_dateAgo","_padOrTruncate","ago","_dateOrAgo","agoOrDate","authorAgo","_authorDateOrAgo","authorAgoOrDate","toLocaleLowerCase","changesShort","MuchLessThan","EqualsTriple","ArrowUpRight","Envelope","MiddleEllipsis","committerAgo","_committerDateOrAgo","committerAgoOrDate","enrichMessage","branchAndTagTips","tips","fromTemplateCore","originalPath","statusFile","Pencil","EnDash","freeGlobal","global","fromGitLensFSUri","toGitLensFSUri","GitFileSystemProvider","_searchTreeMap","_onDidChangeFile","registerFileSystemProvider","isCaseSensitive","isReadonly","NoPermissions","tree","getTree","FileNotFound","typeToFileType","getVersionedFileBuffer","ctime","mtime","treeItem","searchTree","Directory","getTreeFileForRevision","getTreeForRevision","createSearchTree","getOrCreateSearchTree","Unknown","RequestType","GitCommandRequestType","RepositoriesInFolderRequestType","defaultWhitelistFn","gitWhitelist","leadingSlashRegex","_api","_service","_localToSharedPaths","_sharedToLocalPaths","onDidChangeIsServiceAvailable","onAvailabilityChanged","onRequest","onGitCommandRequest","onRepositoriesInFolderRequest","api","service","shareService","ServiceId","unshareService","requestType","handler","available","localPath","sharedPath","convertLocalUriToShared","localPaths","_localPathsRegex","sharedPaths","_sharedPathsRegex","request","isRootWorkspace","shared","localCwd","convertSharedUriToLocal","folderUri","vslsUri","localUri","sharedUri","vslsUriRootRegex","isServiceAvailable","getSharedService","response","sendRequest","vslsUriPrefixRegex","_readonly","_host","_guest","setReadonly","_waitForReady","_onReady","onDidChangeSession","onLiveShareSessionChanged","Readonly","getContacts","contacts","share","session","role","Host","liveshare","allowGuestAccess","Guest","connect","h","z","utcOffset","year","month","clone","ceil","y","w","Q","$","weekdays","months","pl","locale","$L","utc","$u","$d","NaN","UTC","init","$y","getFullYear","$M","getMonth","$D","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","$utils","isValid","isSame","startOf","endOf","isAfter","isBefore","$g","day","hour","minute","second","millisecond","unix","toDate","$locale","weekStart","$set","daysInMonth","subtract","meridiem","YY","YYYY","MM","MMM","monthsShort","MMMM","DD","dd","weekdaysMin","ddd","weekdaysShort","dddd","H","HH","hh","mm","ss","SSS","Z","getTimezoneOffset","toJSON","toUTCString","extend","isDayjs","en","Ls","vscode","liveShareApiVersion","getApi","liveshareExtension","extensions","extensionApi","getApiAsync","Role","Access","View","ViewItem","freeProcess","nodeUtil","originalModule","webpackPolyfill","GitBlameCommit","GitContributor","GitDiffHunk","previousPosition","parseHunk","GitRemoteType","GitRemote","defaultRemote","DefaultRemote","RepositoryChange","RepositoryChangeEvent","solely","_onDidChangeFileSystem","_fireChangeDebounced","_fireFileSystemChangeDebounced","_fsWatchCounter","_pendingChanges","_closed","onDidDelete","_providers","_remotes","fireChange","fireFileSystemChange","_branch","checkoutCore","fetchCore","stat","remotesCfg","pullCore","pushCore","StarredRepositories","_fsWatcherDisposable","reasons","fireChangeCore","fireFileSystemChangeCore","stashNumberRegex","GitStashCommit","GitTag","ordinal","weekYear","week","future","past","yy","toNow","findSpecificGit","foundPath","raw","findSystemGitWin32","basePath","findGitPath","findGitDarwin","configure","gitlensVersion","packageJSON","showGitDisabledErrorMessage","previousVersion","globalState","GitLensVersion","migrate","formatMigrationFn","migrateSettings","compareGitVersion","showGitVersionUnsupportedErrorMessage","notifyOnUnsupportedGitVersion","prevMajor","prevMinor","showWhatsNewAfterUpgrades","showWhatsNewMessage","showWelcomeOrWhatsNew","deactivate","PrependBOMWrapper","StripBOMWrapper","pass","InternalCodec","InternalEncoderBase64","InternalEncoderCesu8","InternalDecoderCesu8","utf8","cesu8","unicode11utf8","ucs2","utf16le","binary","base64","_internal","InternalEncoder","InternalDecoder","StringDecoder","prevStr","acc","contBytes","accBytes","completeQuads","bufIdx","charCode","curByte","fromCharCode","Utf32Codec","isLE","Utf32Encoder","highSurrogate","Utf32Decoder","badChar","overflow","Utf32AutoCodec","Utf32AutoEncoder","defaultEncoding","Utf32AutoDecoder","initialBytes","initialBytesLen","detectEncoding","readUInt32BE","readUInt32LE","invalidLE","invalidBE","asciiCharsLE","asciiCharsBE","_len","b0","b3","_utf32","utf32le","utf32be","ucs4le","ucs4be","src","dst","write32","writeUInt32LE","writeUInt32BE","readUInt16LE","isHighSurrogate","isLowSurrogate","codepoint","goodLength","writeUInt16LE","high","low","utf32","ucs4","Utf16BECodec","Utf16BEEncoder","Utf16BEDecoder","overflowByte","Utf16Codec","Utf16Encoder","Utf16Decoder","utf16be","tmp","buf2","utf16","Utf7Codec","utf7","unicode11utf7","Utf7Encoder","Utf7Decoder","nonDirectChars","inBase64","base64Accum","chunk","base64Regex","base64Chars","plusChar","minusChar","andChar","Utf7IMAPCodec","Utf7IMAPEncoder","base64AccumIdx","Utf7IMAPDecoder","lastI","b64str","canBeDecoded","utf7imap","uChar","base64IMAPChars","SBCSCodec","asciiString","decodeBuf","encodeBuf","SBCSEncoder","SBCSDecoder","_sbcs","newBuf","idx1","idx2","_dbcs","DBCSCodec","UNASSIGNED","GB18030_CODE","NODE_START","UNASSIGNED_NODE","table","mappingTable","decodeTables","decodeTableSeq","_addDecodeChunk","encodeTable","encodeTableSeq","skipEncodeChars","encodeSkipVals","_fillEncodeTable","encodeAdd","_setEncodeChar","defCharSB","gb18030","thirdByteNodeIdx","thirdByteNode","fourthByteNodeIdx","fourthByteNode","secondByteNodeIdx","secondByteNode","DBCSEncoder","leadSurrogate","seqObj","DBCSDecoder","nodeIdx","prevBuf","findIdx","_getDecodeTrieNode","addr","bytes","curAddr","writeTable","part","codeTrail","seq","_getEncodeBucket","uCode","dbcsCode","bucket","_setEncodeSequence","oldVal","mbCode","nextChar","resCode","subtable","uChars","gbChars","prevBufOffset","seqStart","curSeq","ptr","uCodeLead","ret","Transform","IconvLiteEncoderStream","conv","decodeStrings","IconvLiteDecoderStream","encodeStream","decodeStream","supportsStreams","_collect","collect","_transform","_flush","cb","chunks","supportsNodeEncodingsExtension","extendNodeEncodings","nodeNativeEncodings","isNativeEncoding","SlowBuffer","SlowBufferToString","SlowBufferWrite","isFinite","BufferIsEncoding","isEncoding","BufferByteLength","BufferToString","BufferWrite","_offset","_length","_encoding","Readable","ReadableSetEncoding","setEncoding","_readableState","undoExtendNodeEncodings"],"mappings":"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GADC,e,2CAoBD,GADC,e,oDAcD,GADC,e,oCA0CD,GADC,e,6CA2GD,GADC,e,2CA+LD,GADC,e,wCAWD,GADC,e,+CAWD,GADC,e,0CAgBD,GADC,e,6CAgDD,GADC,e,wCAqDD,GADC,e,iDA8ED,GADC,e,qDAyHD,GADC,e,4CAyDD,GADC,e,iDA0BD,GADC,e,wCA+CD,GAHC,YAA+B,CAC/Bm9B,KAAMlsC,eAAoBA,O,yCAuE3B,GADC,e,iDASD,GADC,e,6CASD,GADC,e,oDAgCD,GAHC,YAAiC,CACjCksC,KAAMra,oBAA6BhiC,IAATgiC,KAAwBA,EAAK7xB,OAAS,iB,2CA+DjE,GADC,e,0CAYD,GADC,e,8CAcD,GADC,e,8CAcD,GADC,e,qCAqDD,GADC,e,oDAUD,GADC,e,gDASD,GADC,e,oDAMD,GADC,e,6CA4BD,GADC,e,2CA4DD,GAJC,YAA6B,CAC7BksC,KAAMpC,eAAuBA,IAC7BmC,YAAY,K,uCA4Eb,GADC,e,yCASD,GADC,e,0CAoBD,GADC,e,+CAeD,GADC,e,8CAyBD,GADC,e,gDAMD,GADC,e,+CAQD,GADC,e,uCAWD,GADC,e,4CAWD,GADC,e,yCAWD,GADC,e,8CASD,GADC,e,wCAMD,GADC,e,yCAMD,GADC,e,uCApjFD,GADC,e,8BAklFD,GADC,e,qDC/xFF,80BAwBYI,EAxBZ,2DAwBA,SAAYA,GACX,sDACA,oDACA,8DACA,0DACA,sEACA,kDACA,wCACA,wDACA,sCAEA,kDACA,4CAEA,wDACA,4CACA,8BAEA,0CACA,oCACA,sCACA,0DACA,8CACA,oEACA,sDACA,8CACA,4CACA,oDACA,wDACA,sCACA,gDACA,gDACA,8CACA,sDACA,kDACA,kDACA,8CACA,8CACA,sDAEA,kEACA,sCACA,8CACA,8CACA,4CACA,8CACA,8CACA,oCACA,4DACA,kDACA,2CACA,2DACA,8CACA,gDACA,4CACA,oDACA,wDACA,oDACA,gDACA,0DACA,0DACA,kEACA,+DACA,sDACA,oDACA,8DACA,kDACA,sDACA,0CACA,4CACA,8CACA,+EACA,wFACA,wFACA,yFACA,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","file":"extension.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 81);\n","module.exports = require(\"vscode\");","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport arrayMap from './_arrayMap.js';\nimport baseUnary from './_baseUnary.js';\nimport cacheHas from './_cacheHas.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * The base implementation of methods like `_.intersection`, without support\n * for iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of shared values.\n */\nfunction baseIntersection(arrays, iteratee, comparator) {\n  var includes = comparator ? arrayIncludesWith : arrayIncludes,\n      length = arrays[0].length,\n      othLength = arrays.length,\n      othIndex = othLength,\n      caches = Array(othLength),\n      maxLength = Infinity,\n      result = [];\n\n  while (othIndex--) {\n    var array = arrays[othIndex];\n    if (othIndex && iteratee) {\n      array = arrayMap(array, baseUnary(iteratee));\n    }\n    maxLength = nativeMin(array.length, maxLength);\n    caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n      ? new SetCache(othIndex && array)\n      : undefined;\n  }\n  array = arrays[0];\n\n  var index = -1,\n      seen = caches[0];\n\n  outer:\n  while (++index < length && result.length < maxLength) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (!(seen\n          ? cacheHas(seen, computed)\n          : includes(result, computed, comparator)\n        )) {\n      othIndex = othLength;\n      while (--othIndex) {\n        var cache = caches[othIndex];\n        if (!(cache\n              ? cacheHas(cache, computed)\n              : includes(arrays[othIndex], computed, comparator))\n            ) {\n          continue outer;\n        }\n      }\n      if (seen) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseIntersection;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","import isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Casts `value` to an empty array if it's not an array like object.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array|Object} Returns the cast array-like object.\n */\nfunction castArrayLikeObject(value) {\n  return isArrayLikeObject(value) ? value : [];\n}\n\nexport default castArrayLikeObject;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nexport default last;\n","import arrayMap from './_arrayMap.js';\nimport baseIntersection from './_baseIntersection.js';\nimport baseRest from './_baseRest.js';\nimport castArrayLikeObject from './_castArrayLikeObject.js';\nimport last from './last.js';\n\n/**\n * This method is like `_.intersection` except that it accepts `comparator`\n * which is invoked to compare elements of `arrays`. The order and references\n * of result values are determined by the first array. The comparator is\n * invoked with two arguments: (arrVal, othVal).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of intersecting values.\n * @example\n *\n * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n *\n * _.intersectionWith(objects, others, _.isEqual);\n * // => [{ 'x': 1, 'y': 2 }]\n */\nvar intersectionWith = baseRest(function(arrays) {\n  var comparator = last(arrays),\n      mapped = arrayMap(arrays, castArrayLikeObject);\n\n  comparator = typeof comparator == 'function' ? comparator : undefined;\n  if (comparator) {\n    mapped.pop();\n  }\n  return (mapped.length && mapped[0] === arrays[0])\n    ? baseIntersection(mapped, undefined, comparator)\n    : [];\n});\n\nexport default intersectionWith;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport arrayMap from './_arrayMap.js';\nimport baseUnary from './_baseUnary.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseDifference;\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","import arrayPush from './_arrayPush.js';\nimport isFlattenable from './_isFlattenable.js';\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nexport default baseFlatten;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseDifference from './_baseDifference.js';\nimport baseFlatten from './_baseFlatten.js';\nimport baseUniq from './_baseUniq.js';\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nexport default baseXor;\n","'use strict';\nimport { intersectionWith as _intersectionWith, isEqual as _isEqual, xor as _xor } from 'lodash-es';\n\nexport namespace Arrays {\n\texport function countUniques<T>(source: T[], accessor: (item: T) => string): { [key: string]: number } {\n\t\tconst uniqueCounts = Object.create(null);\n\t\tfor (const item of source) {\n\t\t\tconst value = accessor(item);\n\t\t\tuniqueCounts[value] = (uniqueCounts[value] || 0) + 1;\n\t\t}\n\t\treturn uniqueCounts;\n\t}\n\n\texport function filterMap<T, TMapped>(\n\t\tsource: T[],\n\t\tpredicateMapper: (item: T) => TMapped | null | undefined\n\t): TMapped[] {\n\t\treturn source.reduce(\n\t\t\t(accumulator, current) => {\n\t\t\t\tconst mapped = predicateMapper(current);\n\t\t\t\tif (mapped != null) {\n\t\t\t\t\taccumulator.push(mapped);\n\t\t\t\t}\n\t\t\t\treturn accumulator;\n\t\t\t},\n\t\t\t[] as TMapped[]\n\t\t);\n\t}\n\n\texport function filterMapAsync<T, TMapped>(\n\t\tsource: T[],\n\t\tpredicateMapper: (item: T) => Promise<TMapped | null | undefined>\n\t): Promise<TMapped[]> {\n\t\treturn source.reduce(\n\t\t\tasync (accumulator, current) => {\n\t\t\t\tconst mapped = await predicateMapper(current);\n\t\t\t\tif (mapped != null) {\n\t\t\t\t\taccumulator.push(mapped);\n\t\t\t\t}\n\t\t\t\treturn accumulator;\n\t\t\t},\n\t\t\t[] as any\n\t\t);\n\t}\n\n\texport function groupBy<T>(source: T[], accessor: (item: T) => string): { [key: string]: T[] } {\n\t\treturn source.reduce((groupings, current) => {\n\t\t\tconst value = accessor(current);\n\t\t\tgroupings[value] = groupings[value] || [];\n\t\t\tgroupings[value].push(current);\n\t\t\treturn groupings;\n\t\t}, Object.create(null));\n\t}\n\n\texport function groupByMap<TKey, TValue>(source: TValue[], accessor: (item: TValue) => TKey): Map<TKey, TValue[]> {\n\t\treturn source.reduce((groupings, current) => {\n\t\t\tconst value = accessor(current);\n\t\t\tconst group = groupings.get(value) || [];\n\t\t\tgroupings.set(value, group);\n\t\t\tgroup.push(current);\n\t\t\treturn groupings;\n\t\t}, new Map<TKey, TValue[]>());\n\t}\n\n\texport function groupByFilterMap<TKey, TValue, TMapped>(\n\t\tsource: TValue[],\n\t\taccessor: (item: TValue) => TKey,\n\t\tpredicateMapper: (item: TValue) => TMapped | null | undefined\n\t): Map<TKey, TMapped[]> {\n\t\treturn source.reduce((groupings, current) => {\n\t\t\tconst mapped = predicateMapper(current);\n\t\t\tif (mapped != null) {\n\t\t\t\tconst value = accessor(current);\n\t\t\t\tconst group = groupings.get(value) || [];\n\t\t\t\tgroupings.set(value, group);\n\t\t\t\tgroup.push(mapped);\n\t\t\t}\n\t\t\treturn groupings;\n\t\t}, new Map<TKey, TMapped[]>());\n\t}\n\n\texport const intersection = _intersectionWith;\n\texport const isEqual = _isEqual;\n\n\texport function areEquivalent<T>(value: T[], other: T[]) {\n\t\treturn _xor(value, other).length === 0;\n\t}\n\n\texport interface HierarchicalItem<T> {\n\t\tname: string;\n\t\trelativePath: string;\n\t\tvalue?: T;\n\n\t\tparent?: HierarchicalItem<T>;\n\t\tchildren: Map<string, HierarchicalItem<T>> | undefined;\n\t\tdescendants: T[] | undefined;\n\t}\n\n\texport function makeHierarchical<T>(\n\t\tvalues: T[],\n\t\tsplitPath: (i: T) => string[],\n\t\tjoinPath: (...paths: string[]) => string,\n\t\tcompact: boolean = false\n\t): HierarchicalItem<T> {\n\t\tconst seed = {\n\t\t\tname: '',\n\t\t\trelativePath: '',\n\t\t\tchildren: new Map(),\n\t\t\tdescendants: []\n\t\t};\n\n\t\tconst hierarchy = values.reduce((root: HierarchicalItem<T>, value) => {\n\t\t\tlet folder = root;\n\n\t\t\tlet relativePath = '';\n\t\t\tfor (const folderName of splitPath(value)) {\n\t\t\t\trelativePath = joinPath(relativePath, folderName);\n\n\t\t\t\tif (folder.children === undefined) {\n\t\t\t\t\tfolder.children = new Map();\n\t\t\t\t}\n\n\t\t\t\tlet f = folder.children.get(folderName);\n\t\t\t\tif (f === undefined) {\n\t\t\t\t\tf = {\n\t\t\t\t\t\tname: folderName,\n\t\t\t\t\t\trelativePath: relativePath,\n\t\t\t\t\t\tparent: folder,\n\t\t\t\t\t\tchildren: undefined,\n\t\t\t\t\t\tdescendants: undefined\n\t\t\t\t\t};\n\t\t\t\t\tfolder.children.set(folderName, f);\n\t\t\t\t}\n\n\t\t\t\tif (folder.descendants === undefined) {\n\t\t\t\t\tfolder.descendants = [];\n\t\t\t\t}\n\t\t\t\tfolder.descendants.push(value);\n\t\t\t\tfolder = f;\n\t\t\t}\n\n\t\t\tfolder.value = value;\n\n\t\t\treturn root;\n\t\t}, seed);\n\n\t\tif (compact) return compactHierarchy(hierarchy, joinPath, true);\n\t\treturn hierarchy;\n\t}\n\n\texport function compactHierarchy<T>(\n\t\troot: HierarchicalItem<T>,\n\t\tjoinPath: (...paths: string[]) => string,\n\t\tisRoot: boolean = true\n\t): HierarchicalItem<T> {\n\t\tif (root.children === undefined) return root;\n\n\t\tconst children = [...root.children.values()];\n\n\t\t// Less nesting but duplicate roots\n\t\tif (!isRoot && children.every(c => c.value === undefined)) {\n\t\t\tconst siblings = root.parent && root.parent.children;\n\t\t\tif (siblings !== undefined) {\n\t\t\t\tif (siblings.get(root.name) !== undefined) {\n\t\t\t\t\tsiblings.delete(root.name);\n\n\t\t\t\t\tfor (const child of children) {\n\t\t\t\t\t\tchild.name = joinPath(root.name, child.name);\n\t\t\t\t\t\tsiblings.set(child.name, child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const child of children) {\n\t\t\tcompactHierarchy(child, joinPath, false);\n\t\t}\n\n\t\tif (!isRoot && children.length === 1) {\n\t\t\tconst child = children[0];\n\t\t\tif (child.value === undefined) {\n\t\t\t\troot.name = joinPath(root.name, child.name);\n\t\t\t\troot.relativePath = child.relativePath;\n\t\t\t\troot.children = child.children;\n\t\t\t}\n\t\t}\n\n\t\treturn root;\n\t}\n\n\texport function uniqueBy<T>(source: T[], accessor: (item: T) => any, predicate?: (item: T) => boolean): T[] {\n\t\tconst uniqueValues = Object.create(null);\n\t\treturn source.filter(item => {\n\t\t\tconst value = accessor(item);\n\t\t\tif (uniqueValues[value]) return false;\n\n\t\t\tuniqueValues[value] = accessor;\n\t\t\treturn predicate ? predicate(item) : true;\n\t\t});\n\t}\n}\n","import arrayFilter from './_arrayFilter.js';\nimport baseRest from './_baseRest.js';\nimport baseXor from './_baseXor.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nexport default xor;\n","'use strict';\nimport * as dayjs from 'dayjs';\nimport * as advancedFormat from 'dayjs/plugin/advancedFormat';\nimport * as relativeTime from 'dayjs/plugin/relativeTime';\n\ndayjs.extend(advancedFormat);\ndayjs.extend(relativeTime);\n\nexport namespace Dates {\n\texport const MillisecondsPerMinute = 60000; // 60 * 1000\n\texport const MillisecondsPerHour = 3600000; // 60 * 60 * 1000\n\texport const MillisecondsPerDay = 86400000; // 24 * 60 * 60 * 1000\n\n\texport interface DateFormatter {\n\t\tfromNow(): string;\n\t\tformat(format: string): string;\n\t}\n\n\texport function getFormatter(date: Date): DateFormatter {\n\t\treturn dayjs(date);\n\t}\n}\n","'use strict';\nimport { Promises } from '../promise';\n\nconst emptyStr = '';\n\nfunction defaultResolver(...args: any[]): string {\n\tif (args.length === 1) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 == null) return emptyStr;\n\t\tif (typeof arg0 === 'string') return arg0;\n\t\tif (typeof arg0 === 'number' || typeof arg0 === 'boolean') {\n\t\t\treturn String(arg0);\n\t\t}\n\n\t\treturn JSON.stringify(arg0);\n\t}\n\n\treturn JSON.stringify(args);\n}\n\nexport function gate<T extends (...arg: any) => any>(resolver?: (...args: Parameters<T>) => string) {\n\treturn (target: any, key: string, descriptor: PropertyDescriptor) => {\n\t\tlet fn: Function | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t}\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tconst gateKey = `$gate$${key}`;\n\n\t\tdescriptor.value = function(this: any, ...args: any[]) {\n\t\t\tconst prop =\n\t\t\t\targs.length === 0 ? gateKey : `${gateKey}$${(resolver || defaultResolver)(...(args as Parameters<T>))}`;\n\n\t\t\tif (!Object.prototype.hasOwnProperty.call(this, prop)) {\n\t\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\t\tconfigurable: false,\n\t\t\t\t\tenumerable: false,\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: undefined\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet promise = this[prop];\n\t\t\tif (promise === undefined) {\n\t\t\t\tconst result = fn!.apply(this, args);\n\t\t\t\tif (result == null || !Promises.is(result)) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tthis[prop] = promise = result.then((r: any) => {\n\t\t\t\t\tthis[prop] = undefined;\n\t\t\t\t\treturn r;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn promise;\n\t\t};\n\t};\n}\n","'use strict';\n\nconst emptyStr = '';\n\nfunction defaultResolver(...args: any[]): string {\n\tif (args.length === 1) {\n\t\tconst arg0 = args[0];\n\t\tif (arg0 == null) return emptyStr;\n\t\tif (typeof arg0 === 'string') return arg0;\n\t\tif (typeof arg0 === 'number' || typeof arg0 === 'boolean') {\n\t\t\treturn String(arg0);\n\t\t}\n\n\t\treturn JSON.stringify(arg0);\n\t}\n\n\treturn JSON.stringify(args);\n}\n\nexport function memoize<T extends (...arg: any) => any>(resolver?: (...args: Parameters<T>) => string) {\n\treturn (target: any, key: string, descriptor: PropertyDescriptor & { [key: string]: any }) => {\n\t\tlet fn: Function | undefined;\n\t\tlet fnKey: string | undefined;\n\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t\tfnKey = 'value';\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t\tfnKey = 'get';\n\t\t} else {\n\t\t\tthrow new Error('Not supported');\n\t\t}\n\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tconst memoizeKey = `$memoize$${key}`;\n\n\t\tlet result;\n\t\tdescriptor[fnKey] = function(...args: any[]) {\n\t\t\tconst prop =\n\t\t\t\tfnKey === 'get' || args.length === 0\n\t\t\t\t\t? memoizeKey\n\t\t\t\t\t: `${memoizeKey}$${(resolver || defaultResolver)(...(args as Parameters<T>))}`;\n\n\t\t\tif (Object.prototype.hasOwnProperty.call(this, prop)) {\n\t\t\t\tresult = this[prop];\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tresult = fn!.apply(this, args);\n\t\t\tObject.defineProperty(this, prop, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: result\n\t\t\t});\n\n\t\t\treturn result;\n\t\t};\n\t};\n}\n","'use strict';\n\nexport namespace Iterables {\n\texport function count<T>(source: Iterable<T> | IterableIterator<T>, predicate?: (item: T) => boolean): number {\n\t\tlet count = 0;\n\t\tlet next: IteratorResult<T>;\n\n\t\twhile (true) {\n\t\t\tnext = (source as IterableIterator<T>).next();\n\t\t\tif (next.done) break;\n\n\t\t\tif (predicate === undefined || predicate(next.value)) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\n\t\treturn count;\n\t}\n\n\texport function every<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): boolean {\n\t\tfor (const item of source) {\n\t\t\tif (!predicate(item)) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\texport function filter<T>(\n\t\tsource: Iterable<T | undefined | null> | IterableIterator<T | undefined | null>\n\t): Iterable<T>;\n\texport function filter<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): Iterable<T>;\n\texport function* filter<T>(\n\t\tsource: Iterable<T> | IterableIterator<T>,\n\t\tpredicate?: (item: T) => boolean\n\t): Iterable<T> {\n\t\tif (predicate === undefined) {\n\t\t\tfor (const item of source) {\n\t\t\t\tif (item != null) yield item;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const item of source) {\n\t\t\t\tif (predicate(item)) yield item;\n\t\t\t}\n\t\t}\n\t}\n\n\texport function* filterMap<T, TMapped>(\n\t\tsource: Iterable<T> | IterableIterator<T>,\n\t\tpredicateMapper: (item: T) => TMapped | undefined | null\n\t): Iterable<TMapped> {\n\t\tfor (const item of source) {\n\t\t\tconst mapped = predicateMapper(item);\n\t\t\tif (mapped != null) yield mapped;\n\t\t}\n\t}\n\n\texport function forEach<T>(source: Iterable<T> | IterableIterator<T>, fn: (item: T, index: number) => void): void {\n\t\tlet i = 0;\n\t\tfor (const item of source) {\n\t\t\tfn(item, i);\n\t\t\ti++;\n\t\t}\n\t}\n\n\texport function find<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): T | null {\n\t\tfor (const item of source) {\n\t\t\tif (predicate(item)) return item;\n\t\t}\n\t\treturn null;\n\t}\n\n\texport function first<T>(source: Iterable<T>): T {\n\t\treturn source[Symbol.iterator]().next().value;\n\t}\n\n\texport function* flatMap<T, TMapped>(\n\t\tsource: Iterable<T> | IterableIterator<T>,\n\t\tmapper: (item: T) => Iterable<TMapped>\n\t): Iterable<TMapped> {\n\t\tfor (const item of source) {\n\t\t\tyield* mapper(item);\n\t\t}\n\t}\n\n\texport function has<T>(source: Iterable<T> | IterableIterator<T>, item: T): boolean {\n\t\treturn some(source, i => i === item);\n\t}\n\n\texport function isIterable(source: Iterable<any>): boolean {\n\t\treturn typeof source[Symbol.iterator] === 'function';\n\t}\n\n\texport function join(source: Iterable<any>, separator: string): string {\n\t\tlet value = '';\n\n\t\tconst iterator = source[Symbol.iterator]();\n\t\tlet next = iterator.next();\n\t\tif (next.done) return value;\n\n\t\twhile (true) {\n\t\t\tconst s = next.value.toString();\n\n\t\t\tnext = iterator.next();\n\t\t\tif (next.done) {\n\t\t\t\tvalue += s;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvalue += `${s}${separator}`;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\texport function last<T>(source: Iterable<T>): T | undefined {\n\t\tlet item: T | undefined;\n\t\tfor (item of source) {\n\t\t\t/* noop */\n\t\t}\n\t\treturn item;\n\t}\n\n\texport function* map<T, TMapped>(\n\t\tsource: Iterable<T> | IterableIterator<T>,\n\t\tmapper: (item: T) => TMapped\n\t): Iterable<TMapped> {\n\t\tfor (const item of source) {\n\t\t\tyield mapper(item);\n\t\t}\n\t}\n\n\texport function next<T>(source: IterableIterator<T>): T {\n\t\treturn source.next().value;\n\t}\n\n\texport function* skip<T>(source: Iterable<T> | IterableIterator<T>, count: number): IterableIterator<T> {\n\t\tlet i = 0;\n\t\tfor (const item of source) {\n\t\t\tif (i >= count) yield item;\n\t\t\ti++;\n\t\t}\n\t}\n\n\texport function some<T>(source: Iterable<T> | IterableIterator<T>, predicate: (item: T) => boolean): boolean {\n\t\tfor (const item of source) {\n\t\t\tif (predicate(item)) return true;\n\t\t}\n\t\treturn false;\n\t}\n\n\texport function* take<T>(source: Iterable<T> | IterableIterator<T>, count: number): Iterable<T> {\n\t\tif (count > 0) {\n\t\t\tlet i = 0;\n\t\t\tfor (const item of source) {\n\t\t\t\tyield item;\n\t\t\t\ti++;\n\t\t\t\tif (i >= count) break;\n\t\t\t}\n\t\t}\n\t}\n\n\texport function* union<T>(...sources: (Iterable<T> | IterableIterator<T>)[]): Iterable<T> {\n\t\tfor (const source of sources) {\n\t\t\tfor (const item of source) {\n\t\t\t\tyield item;\n\t\t\t}\n\t\t}\n\t}\n}\n","'use strict';\nimport { isEqual as _isEqual } from 'lodash-es';\nimport { Arrays } from './array';\n\nexport namespace Objects {\n\texport function entries<T>(o: { [key: string]: T }): IterableIterator<[string, T]>;\n\texport function entries<T>(o: { [key: number]: T }): IterableIterator<[string, T]>;\n\texport function* entries<T>(o: any): IterableIterator<[string, T]> {\n\t\tfor (const key in o) {\n\t\t\tyield [key, o[key]];\n\t\t}\n\t}\n\n\texport function flatten(o: any, prefix: string = '', stringify: boolean = false): { [key: string]: any } {\n\t\tconst flattened = Object.create(null);\n\t\t_flatten(flattened, prefix, o, stringify);\n\t\treturn flattened;\n\t}\n\n\tfunction _flatten(flattened: { [key: string]: any }, key: string, value: any, stringify: boolean = false) {\n\t\tif (Object(value) !== value) {\n\t\t\tif (stringify) {\n\t\t\t\tif (value == null) {\n\t\t\t\t\tflattened[key] = null;\n\t\t\t\t} else if (typeof value === 'string') {\n\t\t\t\t\tflattened[key] = value;\n\t\t\t\t} else {\n\t\t\t\t\tflattened[key] = JSON.stringify(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tflattened[key] = value;\n\t\t\t}\n\t\t} else if (Array.isArray(value)) {\n\t\t\tconst len = value.length;\n\t\t\tfor (let i = 0; i < len; i++) {\n\t\t\t\t_flatten(flattened, `${key}[${i}]`, value[i], stringify);\n\t\t\t}\n\t\t\tif (len === 0) {\n\t\t\t\tflattened[key] = null;\n\t\t\t}\n\t\t} else {\n\t\t\tlet isEmpty = true;\n\t\t\tfor (const p in value) {\n\t\t\t\tisEmpty = false;\n\t\t\t\t_flatten(flattened, key ? `${key}.${p}` : p, value[p], stringify);\n\t\t\t}\n\t\t\tif (isEmpty && key) {\n\t\t\t\tflattened[key] = null;\n\t\t\t}\n\t\t}\n\t}\n\n\texport function isEqual(value: any, other: any) {\n\t\treturn _isEqual(value, other);\n\t}\n\n\texport function areEquivalent(value: any, other: any) {\n\t\tif (Array.isArray(value) && Array.isArray(other)) {\n\t\t\treturn Arrays.areEquivalent(value, other);\n\t\t}\n\t\treturn isEqual(value, other);\n\t}\n\n\texport function paths(o: { [key: string]: any }, path?: string): string[] {\n\t\tconst results = [];\n\n\t\tfor (const key in o) {\n\t\t\tconst child = o[key];\n\t\t\tif (typeof child === 'object') {\n\t\t\t\tresults.push(...paths(child, path === undefined ? key : `${path}.${key}`));\n\t\t\t} else {\n\t\t\t\tresults.push(path === undefined ? key : `${path}.${key}`);\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t}\n\n\texport function values<T>(o: { [key: string]: T }): IterableIterator<T>;\n\texport function values<T>(o: { [key: number]: T }): IterableIterator<T>;\n\texport function* values<T>(o: any): IterableIterator<T> {\n\t\tfor (const key in o) {\n\t\t\tyield o[key];\n\t\t}\n\t}\n}\n","'use strict';\nimport { Iterables } from './iterable';\nimport { Strings } from './string';\n\n// Code stolen from https://github.com/Microsoft/vscode/blob/b3e6d5bb039a4a9362b52a2c8726267ca68cf64e/src/vs/base/common/map.ts#L352\n\nconst FIN = { done: true, value: undefined };\n\n// eslint-disable-next-line @typescript-eslint/interface-name-prefix\nexport interface IKeyIterator {\n\treset(key: string): this;\n\tnext(): this;\n\n\thasNext(): boolean;\n\tcmp(a: string): number;\n\tvalue(): string;\n}\n\nexport class StringIterator implements IKeyIterator {\n\tprivate _value: string = '';\n\tprivate _pos: number = 0;\n\n\treset(key: string): this {\n\t\tthis._value = key;\n\t\tthis._pos = 0;\n\t\treturn this;\n\t}\n\n\tnext(): this {\n\t\tthis._pos += 1;\n\t\treturn this;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._pos < this._value.length - 1;\n\t}\n\n\tcmp(a: string): number {\n\t\tconst aCode = a.charCodeAt(0);\n\t\tconst thisCode = this._value.charCodeAt(this._pos);\n\t\treturn aCode - thisCode;\n\t}\n\n\tvalue(): string {\n\t\treturn this._value[this._pos];\n\t}\n}\n\nexport class PathIterator implements IKeyIterator {\n\tprivate _value!: string;\n\tprivate _from!: number;\n\tprivate _to!: number;\n\n\treset(key: string): this {\n\t\tthis._value = key.replace(/\\\\$|\\/$/, '');\n\t\tthis._from = 0;\n\t\tthis._to = 0;\n\t\treturn this.next();\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._to < this._value.length;\n\t}\n\n\tnext(): this {\n\t\t// this._data = key.split(/[\\\\/]/).filter(s => !!s);\n\t\tthis._from = this._to;\n\t\tlet justSeps = true;\n\t\tfor (; this._to < this._value.length; this._to++) {\n\t\t\tconst ch = this._value.charCodeAt(this._to);\n\t\t\tif (ch === Strings.CharCode.Slash || ch === Strings.CharCode.Backslash) {\n\t\t\t\tif (justSeps) {\n\t\t\t\t\tthis._from++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjustSeps = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tcmp(a: string): number {\n\t\tlet aPos = 0;\n\t\tconst aLen = a.length;\n\t\tlet thisPos = this._from;\n\n\t\twhile (aPos < aLen && thisPos < this._to) {\n\t\t\tconst cmp = a.charCodeAt(aPos) - this._value.charCodeAt(thisPos);\n\t\t\tif (cmp !== 0) {\n\t\t\t\treturn cmp;\n\t\t\t}\n\n\t\t\taPos += 1;\n\t\t\tthisPos += 1;\n\t\t}\n\n\t\tif (aLen === this._to - this._from) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (aPos < aLen) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn 1;\n\t}\n\n\tvalue(): string {\n\t\treturn this._value.substring(this._from, this._to);\n\t}\n}\n\nclass TernarySearchTreeNode<E> {\n\tsegment!: string;\n\tvalue: E | undefined;\n\tkey!: string;\n\tleft: TernarySearchTreeNode<E> | undefined;\n\tmid: TernarySearchTreeNode<E> | undefined;\n\tright: TernarySearchTreeNode<E> | undefined;\n\n\tisEmpty(): boolean {\n\t\treturn !this.left && !this.mid && !this.right && !this.value;\n\t}\n}\n\nexport class TernarySearchTree<E> {\n\tstatic forPaths<E>(): TernarySearchTree<E> {\n\t\treturn new TernarySearchTree<E>(new PathIterator());\n\t}\n\n\tstatic forStrings<E>(): TernarySearchTree<E> {\n\t\treturn new TernarySearchTree<E>(new StringIterator());\n\t}\n\n\tprivate _iter: IKeyIterator;\n\tprivate _root: TernarySearchTreeNode<E> | undefined;\n\n\tconstructor(segments: IKeyIterator) {\n\t\tthis._iter = segments;\n\t}\n\n\tclear(): void {\n\t\tthis._root = undefined;\n\t}\n\n\tset(key: string, element: E): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node: TernarySearchTreeNode<E>;\n\n\t\tif (!this._root) {\n\t\t\tthis._root = new TernarySearchTreeNode<E>();\n\t\t\tthis._root.segment = iter.value();\n\t\t}\n\n\t\tnode = this._root;\n\t\twhile (true) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tif (!node.left) {\n\t\t\t\t\tnode.left = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.left.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tif (!node.right) {\n\t\t\t\t\tnode.right = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.right.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\tnode.mid = new TernarySearchTreeNode<E>();\n\t\t\t\t\tnode.mid.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst oldElement = node.value;\n\t\tnode.value = element;\n\t\tnode.key = key;\n\t\treturn oldElement;\n\t}\n\n\tget(key: string): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node ? node.value : undefined;\n\t}\n\n\tdelete(key: string): void {\n\t\tconst iter = this._iter.reset(key);\n\t\tconst stack: [-1 | 0 | 1, TernarySearchTreeNode<E>][] = [];\n\t\tlet node = this._root;\n\n\t\t// find and unset node\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tstack.push([1, node]);\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tstack.push([-1, node]);\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tstack.push([0, node]);\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// remove element\n\t\t\t\tnode.value = undefined;\n\n\t\t\t\t// clean up empty nodes\n\t\t\t\twhile (stack.length > 0 && node.isEmpty()) {\n\t\t\t\t\tconst [dir, parent] = stack.pop()!;\n\t\t\t\t\tswitch (dir) {\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tparent.left = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\tparent.mid = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase -1:\n\t\t\t\t\t\t\tparent.right = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tnode = parent;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tfindSubstr(key: string): E | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\tlet candidate: E | undefined;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tcandidate = node.value || candidate;\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn (node && node.value) || candidate;\n\t}\n\n\tfindSuperstr(key: string, limit: boolean = false): Iterable<E> | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// collect\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tnode = node.mid;\n\t\t\t\treturn {\n\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\t[Symbol.iterator]: () => this._nodeIterator(node!, limit)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate _nodeIterator(node: TernarySearchTreeNode<E>, limit: boolean = false): Iterator<E> {\n\t\tlet res: { done: false; value: E };\n\t\tlet idx: number;\n\t\tlet data: E[];\n\t\tconst next = (): IteratorResult<E> => {\n\t\t\tif (!data) {\n\t\t\t\t// lazy till first invocation\n\t\t\t\tdata = [];\n\t\t\t\tidx = 0;\n\t\t\t\tthis._forEach(node, value => data.push(value), limit);\n\t\t\t}\n\t\t\tif (idx >= data.length) {\n\t\t\t\treturn (FIN as unknown) as IteratorResult<E>;\n\t\t\t}\n\n\t\t\tif (!res) {\n\t\t\t\tres = { done: false, value: data[idx++] };\n\t\t\t} else {\n\t\t\t\tres.value = data[idx++];\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\t\treturn { next: next };\n\t}\n\n\tforEach(callback: (value: E, index: string) => any) {\n\t\tthis._forEach(this._root, callback);\n\t}\n\n\tprivate _forEach(\n\t\tnode: TernarySearchTreeNode<E> | undefined,\n\t\tcallback: (value: E, index: string) => any,\n\t\tlimit: boolean = false\n\t) {\n\t\tif (node === undefined) return;\n\n\t\t// left\n\t\tthis._forEach(node.left, callback, limit);\n\n\t\t// node\n\t\tif (node.value) {\n\t\t\tcallback(node.value, node.key);\n\t\t}\n\n\t\tif (!limit) {\n\t\t\t// mid\n\t\t\tthis._forEach(node.mid, callback, limit);\n\t\t}\n\n\t\t// right\n\t\tthis._forEach(node.right, callback, limit);\n\t}\n\n\tany(): boolean {\n\t\treturn this._root !== undefined && !this._root.isEmpty();\n\t}\n\n\tcount(predicate?: (entry: E) => boolean): number {\n\t\tif (this._root === undefined || this._root.isEmpty()) return 0;\n\n\t\treturn Iterables.count(this.entries(), predicate === undefined ? undefined : ([e]) => predicate(e));\n\t}\n\n\tentries(): Iterable<[E, string]> {\n\t\treturn this._iterator(this._root);\n\t}\n\n\tvalues(): Iterable<E> {\n\t\treturn Iterables.map(this.entries(), ([e]) => e);\n\t}\n\n\thighlander(): [E, string] | undefined {\n\t\tif (this._root === undefined || this._root.isEmpty()) return undefined;\n\n\t\tconst entries = this.entries() as IterableIterator<[E, string]>;\n\n\t\tlet count = 0;\n\t\tlet next: IteratorResult<[E, string]>;\n\t\tlet value: [E, string] | undefined;\n\n\t\twhile (true) {\n\t\t\tnext = entries.next();\n\t\t\tif (next.done) break;\n\n\t\t\tvalue = next.value;\n\n\t\t\tcount++;\n\t\t\tif (count > 1) return undefined;\n\t\t}\n\n\t\treturn value;\n\t}\n\n\tsome(predicate: (entry: E) => boolean): boolean {\n\t\tif (this._root === undefined || this._root.isEmpty()) return false;\n\n\t\treturn Iterables.some(this.entries(), ([e]) => predicate(e));\n\t}\n\n\tprivate *_iterator(node: TernarySearchTreeNode<E> | undefined): IterableIterator<[E, string]> {\n\t\tif (node !== undefined) {\n\t\t\t// left\n\t\t\tyield* this._iterator(node.left);\n\n\t\t\t// node\n\t\t\tif (node.value) {\n\t\t\t\tyield [node.value, node.key];\n\t\t\t}\n\n\t\t\t// mid\n\t\t\tyield* this._iterator(node.mid);\n\n\t\t\t// right\n\t\t\tyield* this._iterator(node.right);\n\t\t}\n\t}\n}\n","'use strict';\n\nexport namespace Versions {\n\tdeclare type VersionComparisonResult = -1 | 0 | 1;\n\n\texport interface Version {\n\t\tmajor: number;\n\t\tminor: number;\n\t\tpatch: number;\n\t\tpre?: string;\n\t}\n\n\texport function compare(v1: string | Version, v2: string | Version): VersionComparisonResult {\n\t\tif (typeof v1 === 'string') {\n\t\t\tv1 = fromString(v1);\n\t\t}\n\t\tif (typeof v2 === 'string') {\n\t\t\tv2 = fromString(v2);\n\t\t}\n\n\t\tif (v1.major > v2.major) return 1;\n\t\tif (v1.major < v2.major) return -1;\n\n\t\tif (v1.minor > v2.minor) return 1;\n\t\tif (v1.minor < v2.minor) return -1;\n\n\t\tif (v1.patch > v2.patch) return 1;\n\t\tif (v1.patch < v2.patch) return -1;\n\n\t\tif (v1.pre === undefined && v2.pre !== undefined) return 1;\n\t\tif (v1.pre !== undefined && v2.pre === undefined) return -1;\n\n\t\tif (v1.pre !== undefined && v2.pre !== undefined) {\n\t\t\treturn v1.pre.localeCompare(v2.pre) as VersionComparisonResult;\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\texport function from(\n\t\tmajor: string | number,\n\t\tminor: string | number,\n\t\tpatch?: string | number,\n\t\tpre?: string\n\t): Version {\n\t\treturn {\n\t\t\tmajor: typeof major === 'string' ? parseInt(major, 10) : major,\n\t\t\tminor: typeof minor === 'string' ? parseInt(minor, 10) : minor,\n\t\t\tpatch: patch == null ? 0 : typeof patch === 'string' ? parseInt(patch, 10) : patch,\n\t\t\tpre: pre\n\t\t};\n\t}\n\n\texport function fromString(version: string): Version {\n\t\tconst [ver, pre] = version.split('-');\n\t\tconst [major, minor, patch] = ver.split('.');\n\t\treturn from(major, minor, patch, pre);\n\t}\n}\n","'use strict';\n\nexport type PartialDeep<T> = T extends object ? { [K in keyof T]?: PartialDeep<T[K]> } : T;\nexport type PickPartialDeep<T, K extends keyof T> = Omit<Partial<T>, K> & { [P in K]?: Partial<T[P]> };\n\nexport type Mutable<T> = { -readonly [P in keyof T]: T[P] };\nexport type PickMutable<T, K extends keyof T> = Omit<T, K> & { -readonly [P in K]: T[P] };\n\nexport * from './system/array';\nexport * from './system/date';\nexport * from './system/decorators/gate';\nexport * from './system/decorators/log';\nexport * from './system/decorators/memoize';\nexport * from './system/function';\nexport * from './system/iterable';\nexport * from './system/object';\nexport * from './system/promise';\nexport * from './system/searchTree';\nexport * from './system/string';\nexport * from './system/version';\n","'use strict';\nimport { commands, TextDocument, TextEditor, window } from 'vscode';\nimport { ViewShowBranchComparison } from './config';\n\nexport const applicationInsightsKey = 'a9c302f8-6483-4d01-b92c-c159c799c679';\nexport const extensionId = 'gitlens';\nexport const extensionOutputChannelName = 'GitLens';\nexport const extensionQualifiedId = `eamodio.${extensionId}`;\nexport const extensionTerminalName = 'GitLens';\n\nexport enum BuiltInCommands {\n\tCloseActiveEditor = 'workbench.action.closeActiveEditor',\n\tCloseAllEditors = 'workbench.action.closeAllEditors',\n\tCursorMove = 'cursorMove',\n\tDiff = 'vscode.diff',\n\tEditorScroll = 'editorScroll',\n\tExecuteDocumentSymbolProvider = 'vscode.executeDocumentSymbolProvider',\n\tExecuteCodeLensProvider = 'vscode.executeCodeLensProvider',\n\tFocusFilesExplorer = 'workbench.files.action.focusFilesExplorer',\n\tOpen = 'vscode.open',\n\tOpenFolder = 'vscode.openFolder',\n\tOpenInTerminal = 'openInTerminal',\n\tNextEditor = 'workbench.action.nextEditor',\n\tPreviewHtml = 'vscode.previewHtml',\n\tRevealLine = 'revealLine',\n\tSetContext = 'setContext',\n\tShowExplorerActivity = 'workbench.view.explorer',\n\tShowReferences = 'editor.action.showReferences'\n}\n\nexport enum CommandContext {\n\tActiveFileStatus = 'gitlens:activeFileStatus',\n\tAnnotationStatus = 'gitlens:annotationStatus',\n\tCanToggleCodeLens = 'gitlens:canToggleCodeLens',\n\tEnabled = 'gitlens:enabled',\n\tHasRemotes = 'gitlens:hasRemotes',\n\tKey = 'gitlens:key',\n\tReadonly = 'gitlens:readonly',\n\tViewsCanCompare = 'gitlens:views:canCompare',\n\tViewsCanCompareFile = 'gitlens:views:canCompare:file',\n\tViewsCompareKeepResults = 'gitlens:views:compare:keepResults',\n\tViewsHideSupportGitLens = 'gitlens:views:supportGitLens:hide',\n\tViewsFileHistoryEditorFollowing = 'gitlens:views:fileHistory:editorFollowing',\n\tViewsLineHistoryEditorFollowing = 'gitlens:views:lineHistory:editorFollowing',\n\tViewsRepositoriesAutoRefresh = 'gitlens:views:repositories:autoRefresh',\n\tViewsSearchKeepResults = 'gitlens:views:search:keepResults',\n\tVsls = 'gitlens:vsls'\n}\n\nexport function setCommandContext(key: CommandContext | string, value: any) {\n\treturn commands.executeCommand(BuiltInCommands.SetContext, key, value);\n}\n\nexport enum DocumentSchemes {\n\tDebugConsole = 'debug',\n\tFile = 'file',\n\tGit = 'git',\n\tGitLens = 'gitlens',\n\tOutput = 'output',\n\tVsls = 'vsls'\n}\n\nexport function getEditorIfActive(document: TextDocument): TextEditor | undefined {\n\tconst editor = window.activeTextEditor;\n\treturn editor != null && editor.document === document ? editor : undefined;\n}\n\nexport function isActiveDocument(document: TextDocument): boolean {\n\tconst editor = window.activeTextEditor;\n\treturn editor != null && editor.document === document;\n}\n\nexport function isTextEditor(editor: TextEditor): boolean {\n\tconst scheme = editor.document.uri.scheme;\n\treturn scheme !== DocumentSchemes.Output && scheme !== DocumentSchemes.DebugConsole;\n}\n\nexport function hasVisibleTextEditor(): boolean {\n\tif (window.visibleTextEditors.length === 0) return false;\n\n\treturn window.visibleTextEditors.some(e => isTextEditor(e));\n}\n\nexport enum GlyphChars {\n\tAngleBracketLeftHeavy = '\\u2770',\n\tAngleBracketRightHeavy = '\\u2771',\n\tArrowBack = '\\u21a9',\n\tArrowDown = '\\u2193',\n\tArrowDropRight = '\\u2937',\n\tArrowHeadRight = '\\u27A4',\n\tArrowLeft = '\\u2190',\n\tArrowLeftDouble = '\\u21d0',\n\tArrowLeftRight = '\\u2194',\n\tArrowLeftRightDouble = '\\u21d4',\n\tArrowLeftRightDoubleStrike = '\\u21ce',\n\tArrowLeftRightLong = '\\u27f7',\n\tArrowRight = '\\u2192',\n\tArrowRightDouble = '\\u21d2',\n\tArrowRightHollow = '\\u21e8',\n\tArrowUp = '\\u2191',\n\tArrowUpRight = '\\u2197',\n\tArrowsHalfLeftRight = '\\u21cb',\n\tArrowsHalfRightLeft = '\\u21cc',\n\tArrowsLeftRight = '\\u21c6',\n\tArrowsRightLeft = '\\u21c4',\n\tAsterisk = '\\u2217',\n\tCheck = '\\u2713',\n\tDash = '\\u2014',\n\tDot = '\\u2022',\n\tEllipsis = '\\u2026',\n\tEnDash = '\\u2013',\n\tEnvelope = '\\u2709',\n\tEqualsTriple = '\\u2261',\n\tFlag = '\\u2691',\n\tFlagHollow = '\\u2690',\n\tMiddleEllipsis = '\\u22EF',\n\tMuchLessThan = '\\u226A',\n\tMuchGreaterThan = '\\u226B',\n\tPencil = '\\u270E',\n\tSpace = '\\u00a0',\n\tSpaceThin = '\\u2009',\n\tSpaceThinnest = '\\u200A',\n\tSquareWithBottomShadow = '\\u274F',\n\tSquareWithTopShadow = '\\u2750',\n\tZeroWidthSpace = '\\u200b'\n}\n\nexport enum GlobalState {\n\tGitLensVersion = 'gitlensVersion'\n}\n\nexport const ImageMimetypes: { [key: string]: string } = {\n\t'.png': 'image/png',\n\t'.gif': 'image/gif',\n\t'.jpg': 'image/jpeg',\n\t'.jpeg': 'image/jpeg',\n\t'.jpe': 'image/jpeg',\n\t'.webp': 'image/webp',\n\t'.tif': 'image/tiff',\n\t'.tiff': 'image/tiff',\n\t'.bmp': 'image/bmp'\n};\n\nexport interface BranchComparison {\n\tref: string;\n\tnotation: '...' | '..' | undefined;\n\ttype: Exclude<ViewShowBranchComparison, false> | undefined;\n}\n\nexport interface BranchComparisons {\n\t[id: string]: string | BranchComparison;\n}\n\nexport interface NamedRef {\n\tlabel?: string;\n\tref: string;\n}\n\nexport interface PinnedComparison {\n\tpath: string;\n\tref1: NamedRef;\n\tref2: NamedRef;\n\tnotation: '...' | '..' | undefined;\n}\n\nexport interface PinnedComparisons {\n\t[id: string]: PinnedComparison;\n}\n\nexport interface StarredBranches {\n\t[id: string]: boolean;\n}\n\nexport interface StarredRepositories {\n\t[id: string]: boolean;\n}\n\nexport enum WorkspaceState {\n\tBranchComparisons = 'gitlens:branch:comparisons',\n\tDefaultRemote = 'gitlens:remote:default',\n\tPinnedComparisons = 'gitlens:pinned:comparisons',\n\tStarredBranches = 'gitlens:starred:branches',\n\tStarredRepositories = 'gitlens:starred:repositories',\n\tViewsCompareKeepResults = 'gitlens:views:compare:keepResults',\n\tViewsRepositoriesAutoRefresh = 'gitlens:views:repositories:autoRefresh',\n\tViewsSearchKeepResults = 'gitlens:views:search:keepResults'\n}\n","'use strict';\nimport {\n\tDecorationOptions,\n\tDisposable,\n\tRange,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType,\n\tTextEditorSelectionChangeEvent,\n\tUri,\n\twindow\n} from 'vscode';\nimport { TextDocumentComparer } from '../comparers';\nimport { FileAnnotationType } from '../configuration';\nimport { CommandContext, setCommandContext } from '../constants';\nimport { Functions } from '../system';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\n\nexport enum AnnotationStatus {\n\tComputing = 'computing',\n\tComputed = 'computed'\n}\n\nexport type TextEditorCorrelationKey = string;\n\nexport abstract class AnnotationProviderBase implements Disposable {\n\tstatic getCorrelationKey(editor: TextEditor | undefined): TextEditorCorrelationKey {\n\t\treturn editor !== undefined ? (editor as any).id : '';\n\t}\n\n\tannotationType: FileAnnotationType | undefined;\n\tcorrelationKey: TextEditorCorrelationKey;\n\tdocument: TextDocument;\n\tstatus: AnnotationStatus | undefined;\n\n\tprotected decorations: DecorationOptions[] | undefined;\n\tprotected disposable: Disposable;\n\n\tconstructor(\n\t\tpublic editor: TextEditor,\n\t\tprotected readonly trackedDocument: TrackedDocument<GitDocumentState>,\n\t\tprotected decoration: TextEditorDecorationType,\n\t\tprotected highlightDecoration: TextEditorDecorationType | undefined\n\t) {\n\t\tthis.correlationKey = AnnotationProviderBase.getCorrelationKey(this.editor);\n\t\tthis.document = this.editor.document;\n\n\t\tthis.disposable = Disposable.from(\n\t\t\twindow.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged, this)\n\t\t);\n\t}\n\n\tdispose() {\n\t\tthis.clear();\n\n\t\tthis.disposable && this.disposable.dispose();\n\t}\n\n\tprivate onTextEditorSelectionChanged(e: TextEditorSelectionChangeEvent) {\n\t\tif (!TextDocumentComparer.equals(this.document, e.textEditor && e.textEditor.document)) return;\n\n\t\tthis.selection(e.selections[0].active.line);\n\t}\n\n\tget editorId(): string {\n\t\tif (this.editor === undefined || this.editor.document === undefined) return '';\n\t\treturn (this.editor as any).id;\n\t}\n\n\tget editorUri(): Uri | undefined {\n\t\tif (this.editor === undefined || this.editor.document === undefined) return undefined;\n\t\treturn this.editor.document.uri;\n\t}\n\n\tprotected additionalDecorations: { decoration: TextEditorDecorationType; ranges: Range[] }[] | undefined;\n\n\tclear() {\n\t\tthis.status = undefined;\n\t\tif (this.editor === undefined) return;\n\n\t\tif (this.decoration !== undefined) {\n\t\t\ttry {\n\t\t\t\tthis.editor.setDecorations(this.decoration, []);\n\t\t\t} catch {}\n\t\t}\n\n\t\tif (this.additionalDecorations !== undefined && this.additionalDecorations.length > 0) {\n\t\t\tfor (const d of this.additionalDecorations) {\n\t\t\t\ttry {\n\t\t\t\t\tthis.editor.setDecorations(d.decoration, []);\n\t\t\t\t} catch {}\n\t\t\t}\n\n\t\t\tthis.additionalDecorations = undefined;\n\t\t}\n\n\t\tif (this.highlightDecoration !== undefined) {\n\t\t\ttry {\n\t\t\t\tthis.editor.setDecorations(this.highlightDecoration, []);\n\t\t\t} catch {}\n\t\t}\n\t}\n\n\tprivate _resetDebounced:\n\t\t| ((changes?: {\n\t\t\t\tdecoration: TextEditorDecorationType;\n\t\t\t\thighlightDecoration: TextEditorDecorationType | undefined;\n\t\t  }) => void)\n\t\t| undefined;\n\n\treset(changes?: {\n\t\tdecoration: TextEditorDecorationType;\n\t\thighlightDecoration: TextEditorDecorationType | undefined;\n\t}) {\n\t\tif (this._resetDebounced === undefined) {\n\t\t\tthis._resetDebounced = Functions.debounce(this.onReset.bind(this), 250);\n\t\t}\n\n\t\tthis._resetDebounced(changes);\n\t}\n\n\tasync onReset(changes?: {\n\t\tdecoration: TextEditorDecorationType;\n\t\thighlightDecoration: TextEditorDecorationType | undefined;\n\t}) {\n\t\tif (changes !== undefined) {\n\t\t\tthis.clear();\n\n\t\t\tthis.decoration = changes.decoration;\n\t\t\tthis.highlightDecoration = changes.highlightDecoration;\n\t\t}\n\n\t\tawait this.provideAnnotation(this.editor === undefined ? undefined : this.editor.selection.active.line);\n\t}\n\n\tasync restore(editor: TextEditor) {\n\t\t// If the editor isn't disposed then we don't need to do anything\n\t\t// Explicitly check for `false`\n\t\tif ((this.editor as any)._disposed === false) return;\n\n\t\tthis.status = AnnotationStatus.Computing;\n\t\tif (editor === window.activeTextEditor) {\n\t\t\tawait setCommandContext(CommandContext.AnnotationStatus, this.status);\n\t\t}\n\n\t\tthis.editor = editor;\n\t\tthis.correlationKey = AnnotationProviderBase.getCorrelationKey(editor);\n\t\tthis.document = editor.document;\n\n\t\tif (this.decorations !== undefined && this.decorations.length) {\n\t\t\tthis.editor.setDecorations(this.decoration, this.decorations);\n\n\t\t\tif (this.additionalDecorations !== undefined && this.additionalDecorations.length) {\n\t\t\t\tfor (const d of this.additionalDecorations) {\n\t\t\t\t\tthis.editor.setDecorations(d.decoration, d.ranges);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.status = AnnotationStatus.Computed;\n\t\tif (editor === window.activeTextEditor) {\n\t\t\tawait setCommandContext(CommandContext.AnnotationStatus, this.status);\n\t\t}\n\t}\n\n\tasync provideAnnotation(shaOrLine?: string | number): Promise<boolean> {\n\t\tthis.status = AnnotationStatus.Computing;\n\t\tif (await this.onProvideAnnotation(shaOrLine)) {\n\t\t\tthis.status = AnnotationStatus.Computed;\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.status = undefined;\n\t\treturn false;\n\t}\n\n\tabstract onProvideAnnotation(shaOrLine?: string | number): Promise<boolean>;\n\tabstract selection(shaOrLine?: string | number): Promise<void>;\n\tabstract validate(): Promise<boolean>;\n}\n","'use strict';\n\nconst cssColorRegex = /^(?:(#?)([0-9a-f]{3}|[0-9a-f]{6})|((?:rgb|hsl)a?)\\((-?\\d+%?)[,\\s]+(-?\\d+%?)[,\\s]+(-?\\d+%?)[,\\s]*(-?[\\d.]+%?)?\\))$/i;\n\nfunction adjustLight(color: number, amount: number) {\n\tconst cc = color + amount;\n\tconst c = amount < 0 ? (cc < 0 ? 0 : cc) : cc > 255 ? 255 : cc;\n\n\treturn Math.round(c);\n}\n\nexport function darken(color: string, percentage: number) {\n\treturn lighten(color, -percentage);\n}\n\nexport function lighten(color: string, percentage: number) {\n\tconst rgba = toRgba(color);\n\tif (rgba == null) return color;\n\n\tconst [r, g, b, a] = rgba;\n\tconst amount = (255 * percentage) / 100;\n\treturn `rgba(${adjustLight(r, amount)}, ${adjustLight(g, amount)}, ${adjustLight(b, amount)}, ${a})`;\n}\n\nexport function opacity(color: string, percentage: number) {\n\tconst rgba = toRgba(color);\n\tif (rgba == null) return color;\n\n\tconst [r, g, b, a] = rgba;\n\treturn `rgba(${r}, ${g}, ${b}, ${a * (percentage / 100)})`;\n}\n\nexport function toRgba(color: string) {\n\tcolor = color.trim();\n\n\tconst result = cssColorRegex.exec(color);\n\tif (result == null) return null;\n\n\tif (result[1] === '#') {\n\t\tconst hex = result[2];\n\t\tswitch (hex.length) {\n\t\t\tcase 3:\n\t\t\t\treturn [parseInt(hex[0] + hex[0], 16), parseInt(hex[1] + hex[1], 16), parseInt(hex[2] + hex[2], 16), 1];\n\t\t\tcase 6:\n\t\t\t\treturn [\n\t\t\t\t\tparseInt(hex.substring(0, 2), 16),\n\t\t\t\t\tparseInt(hex.substring(2, 4), 16),\n\t\t\t\t\tparseInt(hex.substring(4, 6), 16),\n\t\t\t\t\t1\n\t\t\t\t];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tswitch (result[3]) {\n\t\tcase 'rgb':\n\t\t\treturn [parseInt(result[4], 10), parseInt(result[5], 10), parseInt(result[6], 10), 1];\n\t\tcase 'rgba':\n\t\t\treturn [parseInt(result[4], 10), parseInt(result[5], 10), parseInt(result[6], 10), parseFloat(result[7])];\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n","import {\n\tDecorationInstanceRenderOptions,\n\tDecorationOptions,\n\tMarkdownString,\n\tThemableDecorationAttachmentRenderOptions,\n\tThemableDecorationRenderOptions,\n\tThemeColor\n} from 'vscode';\nimport { DiffWithCommand, ShowQuickCommitDetailsCommand } from '../commands';\nimport { configuration, FileAnnotationType } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tCommitFormatOptions,\n\tCommitFormatter,\n\tGitBlameCommit,\n\tGitCommit,\n\tGitDiffHunkLine,\n\tGitLogCommit,\n\tGitService,\n\tGitUri\n} from '../git/gitService';\nimport { Objects, Strings } from '../system';\nimport { toRgba } from '../webviews/apps/shared/colors';\n\nexport interface ComputedHeatmap {\n\tcold: boolean;\n\tcolors: { hot: string; cold: string };\n\tmedian: number;\n\tnewest: number;\n\toldest: number;\n\tcomputeAge(date: Date): number;\n}\n\ninterface HeatmapConfig {\n\tenabled: boolean;\n\tlocation?: 'left' | 'right';\n}\n\ninterface RenderOptions\n\textends DecorationInstanceRenderOptions,\n\t\tThemableDecorationRenderOptions,\n\t\tThemableDecorationAttachmentRenderOptions {\n\theight?: string;\n\tuncommittedColor?: string | ThemeColor;\n}\n\nconst defaultHeatmapHotColor = '#f66a0a';\nconst defaultHeatmapColdColor = '#0a60f6';\n\nlet computedHeatmapColor: {\n\tcolor: string;\n\trgb: string;\n};\n\nexport class Annotations {\n\tstatic applyHeatmap(decoration: Partial<DecorationOptions>, date: Date, heatmap: ComputedHeatmap) {\n\t\tconst color = this.getHeatmapColor(date, heatmap);\n\t\tdecoration.renderOptions!.before!.borderColor = color;\n\t}\n\n\tstatic async changesHoverMessage(\n\t\tcommit: GitBlameCommit,\n\t\turi: GitUri,\n\t\teditorLine: number\n\t): Promise<MarkdownString | undefined>;\n\tstatic async changesHoverMessage(\n\t\tcommit: GitLogCommit,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t\thunkLine: GitDiffHunkLine\n\t): Promise<MarkdownString | undefined>;\n\tstatic async changesHoverMessage(\n\t\tcommit: GitBlameCommit | GitLogCommit,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t\thunkLine?: GitDiffHunkLine\n\t): Promise<MarkdownString | undefined> {\n\t\tconst documentRef = uri.sha;\n\t\tif (GitBlameCommit.is(commit)) {\n\t\t\t// TODO: Figure out how to optimize this\n\t\t\tlet ref;\n\t\t\tif (commit.isUncommitted) {\n\t\t\t\tif (GitService.isUncommittedStaged(documentRef)) {\n\t\t\t\t\tref = documentRef;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tref = commit.sha;\n\t\t\t}\n\n\t\t\tconst line = editorLine + 1;\n\t\t\tconst commitLine = commit.lines.find(l => l.line === line) || commit.lines[0];\n\n\t\t\tlet originalFileName = commit.originalFileName;\n\t\t\tif (originalFileName === undefined) {\n\t\t\t\tif (uri.fsPath !== commit.uri.fsPath) {\n\t\t\t\t\toriginalFileName = commit.fileName;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\teditorLine = commitLine.originalLine - 1;\n\t\t\thunkLine = await Container.git.getDiffForLine(uri, editorLine, ref, undefined, originalFileName);\n\n\t\t\t// If we didn't find a diff & ref is undefined (meaning uncommitted), check for a staged diff\n\t\t\tif (hunkLine === undefined && ref === undefined) {\n\t\t\t\thunkLine = await Container.git.getDiffForLine(\n\t\t\t\t\turi,\n\t\t\t\t\teditorLine,\n\t\t\t\t\tundefined,\n\t\t\t\t\tGitService.uncommittedStagedSha,\n\t\t\t\t\toriginalFileName\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (hunkLine === undefined || commit.previousSha === undefined) return undefined;\n\n\t\tconst diff = this.getDiffFromHunkLine(hunkLine);\n\n\t\tlet message;\n\t\tlet previous;\n\t\tlet current;\n\t\tif (commit.isUncommitted) {\n\t\t\tconst diffUris = await commit.getPreviousLineDiffUris(uri, editorLine, documentRef);\n\t\t\tif (diffUris === undefined || diffUris.previous === undefined) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tmessage = `[\\`Changes\\`](${DiffWithCommand.getMarkdownCommandArgs({\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha || '',\n\t\t\t\t\turi: diffUris.previous.documentUri()\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha || '',\n\t\t\t\t\turi: diffUris.current.documentUri()\n\t\t\t\t},\n\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\tline: editorLine\n\t\t\t})} \"Open Changes\")`;\n\n\t\t\tprevious =\n\t\t\t\tdiffUris.previous.sha === undefined || diffUris.previous.isUncommitted\n\t\t\t\t\t? `_${GitService.shortenSha(diffUris.previous.sha, {\n\t\t\t\t\t\t\tstrings: {\n\t\t\t\t\t\t\t\tworking: 'Working Tree'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  })}_`\n\t\t\t\t\t: `[\\`${GitService.shortenSha(\n\t\t\t\t\t\t\tdiffUris.previous.sha || ''\n\t\t\t\t\t  )}\\`](${ShowQuickCommitDetailsCommand.getMarkdownCommandArgs(\n\t\t\t\t\t\t\tdiffUris.previous.sha || ''\n\t\t\t\t\t  )} \"Show Commit Details\")`;\n\n\t\t\tcurrent =\n\t\t\t\tdiffUris.current.sha === undefined || diffUris.current.isUncommitted\n\t\t\t\t\t? `_${GitService.shortenSha(diffUris.current.sha, {\n\t\t\t\t\t\t\tstrings: {\n\t\t\t\t\t\t\t\tworking: 'Working Tree'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t  })}_`\n\t\t\t\t\t: `[\\`${GitService.shortenSha(\n\t\t\t\t\t\t\tdiffUris.current.sha || ''\n\t\t\t\t\t  )}\\`](${ShowQuickCommitDetailsCommand.getMarkdownCommandArgs(\n\t\t\t\t\t\t\tdiffUris.current.sha || ''\n\t\t\t\t\t  )} \"Show Commit Details\")`;\n\t\t} else {\n\t\t\tmessage = `[\\`Changes\\`](${DiffWithCommand.getMarkdownCommandArgs(commit, editorLine)} \"Open Changes\")`;\n\n\t\t\tprevious = `[\\`${commit.previousShortSha}\\`](${ShowQuickCommitDetailsCommand.getMarkdownCommandArgs(\n\t\t\t\tcommit.previousSha\n\t\t\t)} \"Show Commit Details\")`;\n\n\t\t\tcurrent = `[\\`${commit.shortSha}\\`](${ShowQuickCommitDetailsCommand.getMarkdownCommandArgs(\n\t\t\t\tcommit.sha\n\t\t\t)} \"Show Commit Details\")`;\n\t\t}\n\n\t\tmessage += ` &nbsp; ${GlyphChars.Dash} &nbsp; ${previous} &nbsp;${GlyphChars.ArrowLeftRightLong}&nbsp; ${current}\\n${diff}`;\n\n\t\tconst markdown = new MarkdownString(message);\n\t\tmarkdown.isTrusted = true;\n\t\treturn markdown;\n\t}\n\n\tstatic async detailsHoverMessage(\n\t\tcommit: GitCommit,\n\t\turi: GitUri,\n\t\teditorLine: number,\n\t\tdateFormat: string | null,\n\t\tannotationType: FileAnnotationType | undefined\n\t): Promise<MarkdownString> {\n\t\tif (dateFormat === null) {\n\t\t\tdateFormat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\tconst [presence, previousLineDiffUris, remotes] = await Promise.all([\n\t\t\tContainer.vsls.getContactPresence(commit.email),\n\t\t\tcommit.isUncommitted ? commit.getPreviousLineDiffUris(uri, editorLine, uri.sha) : undefined,\n\t\t\tContainer.git.getRemotes(commit.repoPath, { sort: true })\n\t\t]);\n\n\t\tconst markdown = new MarkdownString(\n\t\t\tCommitFormatter.fromTemplate(Container.config.hovers.detailsMarkdownFormat, commit, {\n\t\t\t\tannotationType: annotationType,\n\t\t\t\tdateFormat: dateFormat,\n\t\t\t\tline: editorLine,\n\t\t\t\tmarkdown: true,\n\t\t\t\tpresence: presence,\n\t\t\t\tpreviousLineDiffUris: previousLineDiffUris,\n\t\t\t\tremotes: remotes\n\t\t\t})\n\t\t);\n\t\tmarkdown.isTrusted = true;\n\t\treturn markdown;\n\t}\n\n\tstatic gutter(\n\t\tcommit: GitCommit,\n\t\tformat: string,\n\t\tdateFormatOrFormatOptions: string | null | CommitFormatOptions,\n\t\trenderOptions: RenderOptions\n\t): Partial<DecorationOptions> {\n\t\tconst decoration: Partial<DecorationOptions> = {\n\t\t\trenderOptions: {\n\t\t\t\tbefore: { ...renderOptions }\n\t\t\t}\n\t\t};\n\n\t\tif (commit.isUncommitted) {\n\t\t\tdecoration.renderOptions!.before!.color = renderOptions.uncommittedColor;\n\t\t}\n\n\t\tconst message = CommitFormatter.fromTemplate(format, commit, dateFormatOrFormatOptions);\n\t\tdecoration.renderOptions!.before!.contentText = Strings.pad(message.replace(/ /g, GlyphChars.Space), 1, 1);\n\n\t\treturn decoration;\n\t}\n\n\tstatic gutterRenderOptions(\n\t\tseparateLines: boolean,\n\t\theatmap: HeatmapConfig,\n\t\tformat: string,\n\t\toptions: CommitFormatOptions\n\t): RenderOptions {\n\t\t// Get the character count of all the tokens, assuming there there is a cap (bail if not)\n\t\tlet chars = 0;\n\t\tfor (const token of Objects.values(options.tokenOptions!)) {\n\t\t\tif (token === undefined) continue;\n\n\t\t\t// If any token is uncapped, kick out and set no max\n\t\t\tif (token.truncateTo == null) {\n\t\t\t\tchars = -1;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tchars += token.truncateTo;\n\t\t}\n\n\t\tif (chars >= 0) {\n\t\t\t// Add the chars of the template string (without tokens)\n\t\t\tchars += Strings.getWidth(Strings.interpolate(format, undefined));\n\t\t\t// If we have chars, add a bit of padding\n\t\t\tif (chars > 0) {\n\t\t\t\tchars += 3;\n\t\t\t}\n\t\t}\n\n\t\tlet borderStyle = undefined;\n\t\tlet borderWidth = undefined;\n\t\tif (heatmap.enabled) {\n\t\t\tborderStyle = 'solid';\n\t\t\tborderWidth = heatmap.location === 'left' ? '0 0 0 2px' : '0 2px 0 0';\n\t\t}\n\n\t\tlet width;\n\t\tif (chars >= 0) {\n\t\t\tconst spacing = configuration.getAny<number>('editor.letterSpacing');\n\t\t\tif (spacing != null && spacing !== 0) {\n\t\t\t\twidth = `calc(${chars}ch + ${Math.round(chars * spacing)}px)`;\n\t\t\t} else {\n\t\t\t\twidth = `${chars}ch`;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tbackgroundColor: new ThemeColor('gitlens.gutterBackgroundColor'),\n\t\t\tborderStyle: borderStyle,\n\t\t\tborderWidth: borderWidth,\n\t\t\tcolor: new ThemeColor('gitlens.gutterForegroundColor'),\n\t\t\tfontWeight: 'normal',\n\t\t\tfontStyle: 'normal',\n\t\t\theight: '100%',\n\t\t\tmargin: '0 26px -1px 0',\n\t\t\ttextDecoration: separateLines ? 'overline solid rgba(0, 0, 0, .2)' : 'none',\n\t\t\twidth: width,\n\t\t\tuncommittedColor: new ThemeColor('gitlens.gutterUncommittedForegroundColor')\n\t\t};\n\t}\n\n\tstatic heatmap(\n\t\tcommit: GitCommit,\n\t\theatmap: ComputedHeatmap,\n\t\trenderOptions: RenderOptions\n\t): Partial<DecorationOptions> {\n\t\tconst decoration: Partial<DecorationOptions> = {\n\t\t\trenderOptions: {\n\t\t\t\tbefore: { ...renderOptions }\n\t\t\t}\n\t\t};\n\n\t\tAnnotations.applyHeatmap(decoration, commit.date, heatmap);\n\n\t\treturn decoration;\n\t}\n\n\tstatic heatmapRenderOptions(): RenderOptions {\n\t\treturn {\n\t\t\tborderStyle: 'solid',\n\t\t\tborderWidth: '0 0 0 2px'\n\t\t};\n\t}\n\n\tstatic trailing(\n\t\tcommit: GitCommit,\n\t\t// uri: GitUri,\n\t\t// editorLine: number,\n\t\tformat: string,\n\t\tdateFormat: string | null,\n\t\tscrollable: boolean = true,\n\t\tgetBranchAndTagTips?: (sha: string) => string | undefined\n\t): Partial<DecorationOptions> {\n\t\t// TODO: Enable this once there is better caching\n\t\t// let diffUris;\n\t\t// if (commit.isUncommitted) {\n\t\t//     diffUris = await commit.getPreviousLineDiffUris(uri, editorLine, uri.sha);\n\t\t// }\n\n\t\tconst message = CommitFormatter.fromTemplate(format, commit, {\n\t\t\tdateFormat: dateFormat,\n\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\t// previousLineDiffUris: diffUris,\n\t\t\ttruncateMessageAtNewLine: true\n\t\t});\n\n\t\treturn {\n\t\t\trenderOptions: {\n\t\t\t\tafter: {\n\t\t\t\t\tbackgroundColor: new ThemeColor('gitlens.trailingLineBackgroundColor'),\n\t\t\t\t\tcolor: new ThemeColor('gitlens.trailingLineForegroundColor'),\n\t\t\t\t\tcontentText: Strings.pad(message.replace(/ /g, GlyphChars.Space), 1, 1),\n\t\t\t\t\tfontWeight: 'normal',\n\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t// Pull the decoration out of the document flow if we want to be scrollable\n\t\t\t\t\ttextDecoration: `none;${scrollable ? '' : ' position: absolute;'}`\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate static getDiffFromHunkLine(hunkLine: GitDiffHunkLine): string {\n\t\tif (Container.config.hovers.changesDiff === 'hunk') {\n\t\t\treturn `\\`\\`\\`diff\\n${hunkLine.hunk.diff}\\n\\`\\`\\``;\n\t\t}\n\n\t\treturn `\\`\\`\\`diff${hunkLine.previous === undefined ? '' : `\\n-${hunkLine.previous.line}`}${\n\t\t\thunkLine.current === undefined ? '' : `\\n+${hunkLine.current.line}`\n\t\t}\\n\\`\\`\\``;\n\t}\n\n\tprivate static getHeatmapColor(date: Date, heatmap: ComputedHeatmap) {\n\t\tconst baseColor = heatmap.cold ? heatmap.colors.cold : heatmap.colors.hot;\n\n\t\tconst age = heatmap.computeAge(date);\n\t\tif (age === 0) return baseColor;\n\n\t\tif (computedHeatmapColor === undefined || computedHeatmapColor.color !== baseColor) {\n\t\t\tlet rgba = toRgba(baseColor);\n\t\t\tif (rgba == null) {\n\t\t\t\trgba = toRgba(heatmap.cold ? defaultHeatmapColdColor : defaultHeatmapHotColor)!;\n\t\t\t}\n\n\t\t\tconst [r, g, b] = rgba;\n\t\t\tcomputedHeatmapColor = {\n\t\t\t\tcolor: baseColor,\n\t\t\t\trgb: `${r}, ${g}, ${b}`\n\t\t\t};\n\t\t}\n\n\t\treturn `rgba(${computedHeatmapColor.rgb}, ${(1 - age / 10).toFixed(2)})`;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tConfigurationChangeEvent,\n\tDecorationRangeBehavior,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tOverviewRulerLane,\n\tProgress,\n\tProgressLocation,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType,\n\tTextEditorViewColumnChangeEvent,\n\tThemeColor,\n\twindow,\n\tworkspace\n} from 'vscode';\nimport { AnnotationsToggleMode, configuration, FileAnnotationType, HighlightLocations } from '../configuration';\nimport { CommandContext, GlyphChars, isTextEditor, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { KeyboardScope } from '../keyboard';\nimport { Logger } from '../logger';\nimport { Functions, Iterables } from '../system';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentDirtyStateChangeEvent,\n\tGitDocumentState\n} from '../trackers/gitDocumentTracker';\nimport { AnnotationProviderBase, AnnotationStatus, TextEditorCorrelationKey } from './annotationProvider';\nimport { GutterBlameAnnotationProvider } from './gutterBlameAnnotationProvider';\nimport { HeatmapBlameAnnotationProvider } from './heatmapBlameAnnotationProvider';\nimport { RecentChangesAnnotationProvider } from './recentChangesAnnotationProvider';\n\nexport enum AnnotationClearReason {\n\tUser = 'User',\n\tBlameabilityChanged = 'BlameabilityChanged',\n\tColumnChanged = 'ColumnChanged',\n\tDisposing = 'Disposing',\n\tDocumentChanged = 'DocumentChanged',\n\tDocumentClosed = 'DocumentClosed'\n}\n\nexport const Decorations = {\n\tblameAnnotation: window.createTextEditorDecorationType({\n\t\trangeBehavior: DecorationRangeBehavior.ClosedOpen,\n\t\ttextDecoration: 'none'\n\t}),\n\tblameHighlight: undefined as TextEditorDecorationType | undefined,\n\theatmapAnnotation: window.createTextEditorDecorationType({\n\t\tbefore: {\n\t\t\tcontentText: GlyphChars.ZeroWidthSpace,\n\t\t\theight: '100%',\n\t\t\tmargin: '0 26px -1px 0'\n\t\t}\n\t}),\n\theatmapHighlight: undefined as TextEditorDecorationType | undefined,\n\trecentChangesAnnotation: undefined as TextEditorDecorationType | undefined,\n\trecentChangesHighlight: undefined as TextEditorDecorationType | undefined\n};\n\nexport class FileAnnotationController implements Disposable {\n\tprivate _onDidToggleAnnotations = new EventEmitter<void>();\n\tget onDidToggleAnnotations(): Event<void> {\n\t\treturn this._onDidToggleAnnotations.event;\n\t}\n\n\tprivate _annotationsDisposable: Disposable | undefined;\n\tprivate _annotationProviders: Map<TextEditorCorrelationKey, AnnotationProviderBase> = new Map();\n\tprivate _disposable: Disposable;\n\tprivate _editor: TextEditor | undefined;\n\tprivate _keyboardScope: KeyboardScope | undefined = undefined;\n\tprivate readonly _toggleModes: Map<FileAnnotationType, AnnotationsToggleMode>;\n\tprivate _annotationType: FileAnnotationType | undefined = undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\n\t\tthis._toggleModes = new Map();\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tvoid this.clearAll();\n\n\t\tDecorations.blameAnnotation && Decorations.blameAnnotation.dispose();\n\t\tDecorations.blameHighlight && Decorations.blameHighlight.dispose();\n\n\t\tthis._annotationsDisposable && this._annotationsDisposable.dispose();\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tconst cfg = Container.config;\n\n\t\tif (configuration.changed(e, 'blame', 'highlight')) {\n\t\t\tDecorations.blameHighlight && Decorations.blameHighlight.dispose();\n\n\t\t\tconst cfgHighlight = cfg.blame.highlight;\n\n\t\t\tif (cfgHighlight.enabled) {\n\t\t\t\tDecorations.blameHighlight = window.createTextEditorDecorationType({\n\t\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\t\tisWholeLine: true,\n\t\t\t\t\toverviewRulerLane: OverviewRulerLane.Right,\n\t\t\t\t\tbackgroundColor: cfgHighlight.locations.includes(HighlightLocations.Line)\n\t\t\t\t\t\t? new ThemeColor('gitlens.lineHighlightBackgroundColor')\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\toverviewRulerColor: cfgHighlight.locations.includes(HighlightLocations.Overview)\n\t\t\t\t\t\t? new ThemeColor('gitlens.lineHighlightOverviewRulerColor')\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tdark: {\n\t\t\t\t\t\tgutterIconPath: cfgHighlight.locations.includes(HighlightLocations.Gutter)\n\t\t\t\t\t\t\t? Container.context.asAbsolutePath('images/dark/highlight-gutter.svg')\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t},\n\t\t\t\t\tlight: {\n\t\t\t\t\t\tgutterIconPath: cfgHighlight.locations.includes(HighlightLocations.Gutter)\n\t\t\t\t\t\t\t? Container.context.asAbsolutePath('images/light/highlight-gutter.svg')\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tDecorations.blameHighlight = undefined;\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'recentChanges', 'highlight')) {\n\t\t\tDecorations.recentChangesAnnotation && Decorations.recentChangesAnnotation.dispose();\n\n\t\t\tconst cfgHighlight = cfg.recentChanges.highlight;\n\n\t\t\tDecorations.recentChangesAnnotation = window.createTextEditorDecorationType({\n\t\t\t\tgutterIconSize: 'contain',\n\t\t\t\tisWholeLine: true,\n\t\t\t\toverviewRulerLane: OverviewRulerLane.Right,\n\t\t\t\tbackgroundColor: cfgHighlight.locations.includes(HighlightLocations.Line)\n\t\t\t\t\t? new ThemeColor('gitlens.lineHighlightBackgroundColor')\n\t\t\t\t\t: undefined,\n\t\t\t\toverviewRulerColor: cfgHighlight.locations.includes(HighlightLocations.Overview)\n\t\t\t\t\t? new ThemeColor('gitlens.lineHighlightOverviewRulerColor')\n\t\t\t\t\t: undefined,\n\t\t\t\tdark: {\n\t\t\t\t\tgutterIconPath: cfgHighlight.locations.includes(HighlightLocations.Gutter)\n\t\t\t\t\t\t? Container.context.asAbsolutePath('images/dark/highlight-gutter.svg')\n\t\t\t\t\t\t: undefined\n\t\t\t\t},\n\t\t\t\tlight: {\n\t\t\t\t\tgutterIconPath: cfgHighlight.locations.includes(HighlightLocations.Gutter)\n\t\t\t\t\t\t? Container.context.asAbsolutePath('images/light/highlight-gutter.svg')\n\t\t\t\t\t\t: undefined\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst initializing = configuration.initializing(e);\n\n\t\tif (configuration.changed(e, 'blame', 'toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.Blame, cfg.blame.toggleMode);\n\t\t\tif (!initializing && cfg.blame.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'heatmap', 'toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.Heatmap, cfg.heatmap.toggleMode);\n\t\t\tif (!initializing && cfg.heatmap.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'recentChanges', 'toggleMode')) {\n\t\t\tthis._toggleModes.set(FileAnnotationType.RecentChanges, cfg.recentChanges.toggleMode);\n\t\t\tif (!initializing && cfg.recentChanges.toggleMode === AnnotationsToggleMode.File) {\n\t\t\t\tvoid this.clearAll();\n\t\t\t}\n\t\t}\n\n\t\tif (initializing) return;\n\n\t\tif (\n\t\t\tconfiguration.changed(e, 'blame') ||\n\t\t\tconfiguration.changed(e, 'recentChanges') ||\n\t\t\tconfiguration.changed(e, 'heatmap') ||\n\t\t\tconfiguration.changed(e, 'hovers')\n\t\t) {\n\t\t\t// Since the configuration has changed -- reset any visible annotations\n\t\t\tfor (const provider of this._annotationProviders.values()) {\n\t\t\t\tif (provider === undefined) continue;\n\n\t\t\t\tif (provider.annotationType === FileAnnotationType.RecentChanges) {\n\t\t\t\t\tprovider.reset({\n\t\t\t\t\t\tdecoration: Decorations.recentChangesAnnotation!,\n\t\t\t\t\t\thighlightDecoration: Decorations.recentChangesHighlight\n\t\t\t\t\t});\n\t\t\t\t} else if (provider.annotationType === FileAnnotationType.Blame) {\n\t\t\t\t\tprovider.reset({\n\t\t\t\t\t\tdecoration: Decorations.blameAnnotation,\n\t\t\t\t\t\thighlightDecoration: Decorations.blameHighlight\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tvoid this.show(provider.editor, FileAnnotationType.Heatmap);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor !== undefined && !isTextEditor(editor)) return;\n\n\t\tthis._editor = editor;\n\t\t// Logger.log('AnnotationController.onActiveTextEditorChanged', editor && editor.document.uri.fsPath);\n\n\t\tif (this.isInWindowToggle()) {\n\t\t\tawait this.show(editor, this._annotationType!);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider === undefined) {\n\t\t\tsetCommandContext(CommandContext.AnnotationStatus, undefined);\n\t\t\tvoid this.detachKeyboardHook();\n\t\t} else {\n\t\t\tsetCommandContext(CommandContext.AnnotationStatus, provider.status);\n\t\t\tvoid this.attachKeyboardHook();\n\t\t}\n\t}\n\n\tprivate onBlameStateChanged(e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\t// Only care if we are becoming un-blameable\n\t\tif (e.blameable) return;\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor === undefined) return;\n\n\t\tvoid this.clear(editor, AnnotationClearReason.BlameabilityChanged);\n\t}\n\n\tprivate onDirtyStateChanged(e: DocumentDirtyStateChangeEvent<GitDocumentState>) {\n\t\tfor (const [key, p] of this._annotationProviders) {\n\t\t\tif (!e.document.is(p.document)) continue;\n\n\t\t\tvoid this.clearCore(key, AnnotationClearReason.DocumentChanged);\n\t\t}\n\t}\n\n\tprivate onTextDocumentClosed(document: TextDocument) {\n\t\tif (!Container.git.isTrackable(document.uri)) return;\n\n\t\tfor (const [key, p] of this._annotationProviders) {\n\t\t\tif (p.document !== document) continue;\n\n\t\t\tvoid this.clearCore(key, AnnotationClearReason.DocumentClosed);\n\t\t}\n\t}\n\n\tprivate onTextEditorViewColumnChanged(e: TextEditorViewColumnChangeEvent) {\n\t\t// FYI https://github.com/Microsoft/vscode/issues/35602\n\t\tconst provider = this.getProvider(e.textEditor);\n\t\tif (provider === undefined) {\n\t\t\t// If we don't find an exact match, do a fuzzy match (since we can't properly track editors)\n\t\t\tconst fuzzyProvider = Iterables.find(\n\t\t\t\tthis._annotationProviders.values(),\n\t\t\t\tp => p.editor.document === e.textEditor.document\n\t\t\t);\n\t\t\tif (fuzzyProvider == null) return;\n\n\t\t\tvoid this.clearCore(fuzzyProvider.correlationKey, AnnotationClearReason.ColumnChanged);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid provider.restore(e.textEditor);\n\t}\n\n\tprivate onVisibleTextEditorsChanged(editors: TextEditor[]) {\n\t\tlet provider: AnnotationProviderBase | undefined;\n\t\tfor (const e of editors) {\n\t\t\tprovider = this.getProvider(e);\n\t\t\tif (provider === undefined) continue;\n\n\t\t\tvoid provider.restore(e);\n\t\t}\n\t}\n\n\tisInWindowToggle(): boolean {\n\t\treturn this.getToggleMode(this._annotationType) === AnnotationsToggleMode.Window;\n\t}\n\n\tprivate getToggleMode(annotationType: FileAnnotationType | undefined): AnnotationsToggleMode {\n\t\tif (annotationType === undefined) return AnnotationsToggleMode.File;\n\n\t\treturn this._toggleModes.get(annotationType) || AnnotationsToggleMode.File;\n\t}\n\n\tclear(editor: TextEditor, reason: AnnotationClearReason = AnnotationClearReason.User) {\n\t\tif (this.isInWindowToggle()) {\n\t\t\treturn this.clearAll();\n\t\t}\n\n\t\treturn this.clearCore(AnnotationProviderBase.getCorrelationKey(editor), reason);\n\t}\n\n\tasync clearAll() {\n\t\tthis._annotationType = undefined;\n\t\tfor (const [key] of this._annotationProviders) {\n\t\t\tawait this.clearCore(key, AnnotationClearReason.Disposing);\n\t\t}\n\t}\n\n\tasync getAnnotationType(editor: TextEditor | undefined): Promise<FileAnnotationType | undefined> {\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider === undefined) return undefined;\n\n\t\tconst trackedDocument = await Container.tracker.get(editor!.document);\n\t\tif (trackedDocument === undefined || !trackedDocument.isBlameable) return undefined;\n\n\t\treturn provider.annotationType;\n\t}\n\n\tgetProvider(editor: TextEditor | undefined): AnnotationProviderBase | undefined {\n\t\tif (editor === undefined || editor.document === undefined) return undefined;\n\t\treturn this._annotationProviders.get(AnnotationProviderBase.getCorrelationKey(editor));\n\t}\n\n\tasync show(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType,\n\t\tshaOrLine?: string | number\n\t): Promise<boolean> {\n\t\tif (this.getToggleMode(type) === AnnotationsToggleMode.Window) {\n\t\t\tlet first = this._annotationType === undefined;\n\t\t\tconst reset = !first && this._annotationType !== type;\n\n\t\t\tthis._annotationType = type;\n\n\t\t\tif (reset) {\n\t\t\t\tawait this.clearAll();\n\t\t\t\tfirst = true;\n\t\t\t}\n\n\t\t\tif (first) {\n\t\t\t\tfor (const e of window.visibleTextEditors) {\n\t\t\t\t\tif (e === editor) continue;\n\n\t\t\t\t\tvoid this.show(e, type);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (editor === undefined) return false; // || editor.viewColumn === undefined) return false;\n\t\tthis._editor = editor;\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable) return false;\n\n\t\tconst currentProvider = this.getProvider(editor);\n\t\tif (currentProvider !== undefined && currentProvider.annotationType === type) {\n\t\t\tawait currentProvider.selection(shaOrLine);\n\t\t\treturn true;\n\t\t}\n\n\t\tconst provider = await window.withProgress(\n\t\t\t{ location: ProgressLocation.Window },\n\t\t\tasync (progress: Progress<{ message: string }>) => {\n\t\t\t\tawait setCommandContext(CommandContext.AnnotationStatus, AnnotationStatus.Computing);\n\n\t\t\t\tconst computingAnnotations = this.showAnnotationsCore(\n\t\t\t\t\tcurrentProvider,\n\t\t\t\t\teditor,\n\t\t\t\t\ttype,\n\t\t\t\t\tshaOrLine,\n\t\t\t\t\tprogress\n\t\t\t\t);\n\t\t\t\tconst provider = await computingAnnotations;\n\n\t\t\t\tif (editor === this._editor) {\n\t\t\t\t\tawait setCommandContext(CommandContext.AnnotationStatus, provider && provider.status);\n\t\t\t\t}\n\n\t\t\t\treturn computingAnnotations;\n\t\t\t}\n\t\t);\n\n\t\treturn provider !== undefined;\n\t}\n\n\tasync toggle(\n\t\teditor: TextEditor | undefined,\n\t\ttype: FileAnnotationType,\n\t\tshaOrLine?: string | number,\n\t\ton?: boolean\n\t): Promise<boolean> {\n\t\tif (editor !== undefined) {\n\t\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\t\tif (\n\t\t\t\t(type === FileAnnotationType.RecentChanges && !trackedDocument.isTracked) ||\n\t\t\t\t!trackedDocument.isBlameable\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tconst provider = this.getProvider(editor);\n\t\tif (provider === undefined) return this.show(editor, type, shaOrLine);\n\n\t\tconst reopen = provider.annotationType !== type;\n\t\tif (on === true && !reopen) return true;\n\n\t\tif (this.isInWindowToggle()) {\n\t\t\tawait this.clearAll();\n\t\t} else {\n\t\t\tawait this.clearCore(provider.correlationKey, AnnotationClearReason.User);\n\t\t}\n\n\t\tif (!reopen) return false;\n\n\t\treturn this.show(editor, type, shaOrLine);\n\t}\n\n\tprivate async attachKeyboardHook() {\n\t\t// Allows pressing escape to exit the annotations\n\t\tif (this._keyboardScope === undefined) {\n\t\t\tthis._keyboardScope = await Container.keyboard.beginScope({\n\t\t\t\tescape: {\n\t\t\t\t\tonDidPressKey: async () => {\n\t\t\t\t\t\tconst e = this._editor;\n\t\t\t\t\t\tif (e === undefined) return undefined;\n\n\t\t\t\t\t\tawait this.clear(e, AnnotationClearReason.User);\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async clearCore(key: TextEditorCorrelationKey, reason: AnnotationClearReason) {\n\t\tconst provider = this._annotationProviders.get(key);\n\t\tif (provider === undefined) return;\n\n\t\tLogger.log(`${reason}:`, `Clear annotations for ${key}`);\n\n\t\tthis._annotationProviders.delete(key);\n\t\tprovider.dispose();\n\n\t\tif (this._annotationProviders.size === 0 || key === AnnotationProviderBase.getCorrelationKey(this._editor)) {\n\t\t\tawait setCommandContext(CommandContext.AnnotationStatus, undefined);\n\t\t\tawait this.detachKeyboardHook();\n\t\t}\n\n\t\tif (this._annotationProviders.size === 0) {\n\t\t\tLogger.log('Remove all listener registrations for annotations');\n\n\t\t\tthis._annotationsDisposable && this._annotationsDisposable.dispose();\n\t\t\tthis._annotationsDisposable = undefined;\n\t\t}\n\n\t\tthis._onDidToggleAnnotations.fire();\n\t}\n\n\tprivate async detachKeyboardHook() {\n\t\tif (this._keyboardScope === undefined) return;\n\n\t\tawait this._keyboardScope.dispose();\n\t\tthis._keyboardScope = undefined;\n\t}\n\n\tprivate async showAnnotationsCore(\n\t\tcurrentProvider: AnnotationProviderBase | undefined,\n\t\teditor: TextEditor,\n\t\ttype: FileAnnotationType,\n\t\tshaOrLine?: string | number,\n\t\tprogress?: Progress<{ message: string }>\n\t): Promise<AnnotationProviderBase | undefined> {\n\t\tif (progress !== undefined) {\n\t\t\tlet annotationsLabel = 'annotations';\n\t\t\tswitch (type) {\n\t\t\t\tcase FileAnnotationType.Blame:\n\t\t\t\t\tannotationsLabel = 'blame annotations';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase FileAnnotationType.Heatmap:\n\t\t\t\t\tannotationsLabel = 'heatmap annotations';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase FileAnnotationType.RecentChanges:\n\t\t\t\t\tannotationsLabel = 'recent changes annotations';\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tprogress.report({\n\t\t\t\tmessage: `Computing ${annotationsLabel} for ${paths.basename(editor.document.fileName)}`\n\t\t\t});\n\t\t}\n\n\t\t// Allows pressing escape to exit the annotations\n\t\tawait this.attachKeyboardHook();\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\n\t\tlet provider: AnnotationProviderBase | undefined = undefined;\n\t\tswitch (type) {\n\t\t\tcase FileAnnotationType.Blame:\n\t\t\t\tprovider = new GutterBlameAnnotationProvider(\n\t\t\t\t\teditor,\n\t\t\t\t\ttrackedDocument,\n\t\t\t\t\tDecorations.blameAnnotation,\n\t\t\t\t\tDecorations.blameHighlight\n\t\t\t\t);\n\t\t\t\tbreak;\n\n\t\t\tcase FileAnnotationType.Heatmap:\n\t\t\t\tprovider = new HeatmapBlameAnnotationProvider(\n\t\t\t\t\teditor,\n\t\t\t\t\ttrackedDocument,\n\t\t\t\t\tDecorations.heatmapAnnotation,\n\t\t\t\t\tDecorations.heatmapHighlight\n\t\t\t\t);\n\t\t\t\tbreak;\n\n\t\t\tcase FileAnnotationType.RecentChanges:\n\t\t\t\tprovider = new RecentChangesAnnotationProvider(\n\t\t\t\t\teditor,\n\t\t\t\t\ttrackedDocument,\n\t\t\t\t\tDecorations.recentChangesAnnotation!,\n\t\t\t\t\tDecorations.recentChangesHighlight\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\t\tif (provider === undefined || !(await provider.validate())) return undefined;\n\n\t\tif (currentProvider !== undefined) {\n\t\t\tawait this.clearCore(currentProvider.correlationKey, AnnotationClearReason.User);\n\t\t}\n\n\t\tif (!this._annotationsDisposable && this._annotationProviders.size === 0) {\n\t\t\tLogger.log('Add listener registrations for annotations');\n\n\t\t\tthis._annotationsDisposable = Disposable.from(\n\t\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveTextEditorChanged, 50), this),\n\t\t\t\twindow.onDidChangeTextEditorViewColumn(this.onTextEditorViewColumnChanged, this),\n\t\t\t\twindow.onDidChangeVisibleTextEditors(Functions.debounce(this.onVisibleTextEditorsChanged, 50), this),\n\t\t\t\tworkspace.onDidCloseTextDocument(this.onTextDocumentClosed, this),\n\t\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\t\tContainer.tracker.onDidChangeDirtyState(this.onDirtyStateChanged, this)\n\t\t\t);\n\t\t}\n\n\t\tthis._annotationProviders.set(provider.correlationKey, provider);\n\t\tif (await provider.provideAnnotation(shaOrLine)) {\n\t\t\tthis._onDidToggleAnnotations.fire();\n\t\t\treturn provider;\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tDisposable,\n\tHover,\n\tlanguages,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tTextEditor,\n\tTextEditorDecorationType\n} from 'vscode';\nimport { Container } from '../container';\nimport { GitBlame, GitBlameCommit, GitCommit, GitUri } from '../git/gitService';\nimport { Arrays, Iterables, log } from '../system';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { AnnotationProviderBase } from './annotationProvider';\nimport { Annotations, ComputedHeatmap } from './annotations';\n\nexport abstract class BlameAnnotationProviderBase extends AnnotationProviderBase {\n\tprotected _blame: Promise<GitBlame | undefined>;\n\tprotected _hoverProviderDisposable: Disposable | undefined;\n\tprotected readonly _uri: GitUri;\n\n\tconstructor(\n\t\teditor: TextEditor,\n\t\ttrackedDocument: TrackedDocument<GitDocumentState>,\n\t\tdecoration: TextEditorDecorationType,\n\t\thighlightDecoration: TextEditorDecorationType | undefined\n\t) {\n\t\tsuper(editor, trackedDocument, decoration, highlightDecoration);\n\n\t\tthis._uri = trackedDocument.uri;\n\t\tthis._blame = editor.document.isDirty\n\t\t\t? Container.git.getBlameForFileContents(this._uri, editor.document.getText())\n\t\t\t: Container.git.getBlameForFile(this._uri);\n\n\t\tif (editor.document.isDirty) {\n\t\t\ttrackedDocument.setForceDirtyStateChangeOnNextDocumentChange();\n\t\t}\n\t}\n\n\tclear() {\n\t\tif (this._hoverProviderDisposable !== undefined) {\n\t\t\tthis._hoverProviderDisposable.dispose();\n\t\t\tthis._hoverProviderDisposable = undefined;\n\t\t}\n\t\tsuper.clear();\n\t}\n\n\tonReset(changes?: {\n\t\tdecoration: TextEditorDecorationType;\n\t\thighlightDecoration: TextEditorDecorationType | undefined;\n\t}) {\n\t\tif (this.editor !== undefined) {\n\t\t\tthis._blame = this.editor.document.isDirty\n\t\t\t\t? Container.git.getBlameForFileContents(this._uri, this.editor.document.getText())\n\t\t\t\t: Container.git.getBlameForFile(this._uri);\n\t\t}\n\n\t\treturn super.onReset(changes);\n\t}\n\n\t@log({ args: false })\n\tasync selection(shaOrLine?: string | number, blame?: GitBlame) {\n\t\tif (!this.highlightDecoration) return;\n\n\t\tif (blame === undefined) {\n\t\t\tblame = await this._blame;\n\t\t\tif (!blame || !blame.lines.length) return;\n\t\t}\n\n\t\tlet sha: string | undefined = undefined;\n\t\tif (typeof shaOrLine === 'string') {\n\t\t\tsha = shaOrLine;\n\t\t} else if (typeof shaOrLine === 'number') {\n\t\t\tif (shaOrLine >= 0) {\n\t\t\t\tconst commitLine = blame.lines[shaOrLine];\n\t\t\t\tsha = commitLine && commitLine.sha;\n\t\t\t}\n\t\t} else {\n\t\t\tsha = Iterables.first(blame.commits.values()).sha;\n\t\t}\n\n\t\tif (!sha) {\n\t\t\tthis.editor.setDecorations(this.highlightDecoration, []);\n\t\t\treturn;\n\t\t}\n\n\t\tconst highlightDecorationRanges = Arrays.filterMap(blame.lines, l =>\n\t\t\tl.sha === sha\n\t\t\t\t? // editor lines are 0-based\n\t\t\t\t  this.editor.document.validateRange(new Range(l.line - 1, 0, l.line - 1, Number.MAX_SAFE_INTEGER))\n\t\t\t\t: undefined\n\t\t);\n\n\t\tthis.editor.setDecorations(this.highlightDecoration, highlightDecorationRanges);\n\t}\n\n\tasync validate(): Promise<boolean> {\n\t\tconst blame = await this._blame;\n\t\treturn blame !== undefined && blame.lines.length !== 0;\n\t}\n\n\tprotected async getBlame(): Promise<GitBlame | undefined> {\n\t\tconst blame = await this._blame;\n\t\tif (blame === undefined || blame.lines.length === 0) return undefined;\n\n\t\treturn blame;\n\t}\n\n\t@log({ args: false })\n\tprotected getComputedHeatmap(blame: GitBlame): ComputedHeatmap {\n\t\tconst dates = [];\n\n\t\tlet commit;\n\t\tlet previousSha;\n\t\tfor (const l of blame.lines) {\n\t\t\tif (previousSha === l.sha) continue;\n\t\t\tpreviousSha = l.sha;\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit === undefined) continue;\n\n\t\t\tdates.push(commit.date);\n\t\t}\n\n\t\tdates.sort((a, b) => a.getTime() - b.getTime());\n\n\t\tconst half = Math.floor(dates.length / 2);\n\t\tconst median =\n\t\t\tdates.length % 2 ? dates[half].getTime() : (dates[half - 1].getTime() + dates[half].getTime()) / 2.0;\n\n\t\tconst lookup: number[] = [];\n\n\t\tconst newest = dates[dates.length - 1].getTime();\n\t\tlet step = (newest - median) / 5;\n\t\tfor (let i = 5; i > 0; i--) {\n\t\t\tlookup.push(median + step * i);\n\t\t}\n\n\t\tlookup.push(median);\n\n\t\tconst oldest = dates[0].getTime();\n\t\tstep = (median - oldest) / 4;\n\t\tfor (let i = 1; i <= 4; i++) {\n\t\t\tlookup.push(median - step * i);\n\t\t}\n\n\t\tconst d = new Date();\n\t\td.setDate(d.getDate() - (Container.config.heatmap.ageThreshold || 90));\n\n\t\treturn {\n\t\t\tcold: newest < d.getTime(),\n\t\t\tcolors: {\n\t\t\t\tcold: Container.config.heatmap.coldColor,\n\t\t\t\thot: Container.config.heatmap.hotColor\n\t\t\t},\n\t\t\tmedian: median,\n\t\t\tnewest: newest,\n\t\t\toldest: oldest,\n\t\t\tcomputeAge: (date: Date) => {\n\t\t\t\tconst time = date.getTime();\n\t\t\t\tlet index = 0;\n\t\t\t\tfor (let i = 0; i < lookup.length; i++) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\tif (time >= lookup[i]) break;\n\t\t\t\t}\n\n\t\t\t\treturn index;\n\t\t\t}\n\t\t};\n\t}\n\n\tregisterHoverProviders(providers: { details: boolean; changes: boolean }) {\n\t\tif (\n\t\t\t!Container.config.hovers.enabled ||\n\t\t\t!Container.config.hovers.annotations.enabled ||\n\t\t\t(!providers.details && !providers.changes)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst subscriptions: Disposable[] = [];\n\t\tif (providers.changes) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: this.document.uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideChangesHover.bind(this)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\tif (providers.details) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: this.document.uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideDetailsHover.bind(this)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._hoverProviderDisposable = Disposable.from(...subscriptions);\n\t}\n\n\tasync provideDetailsHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\ttoken: CancellationToken\n\t): Promise<Hover | undefined> {\n\t\tconst commit = await this.getCommitForHover(position);\n\t\tif (commit === undefined) return undefined;\n\n\t\t// Get the full commit message -- since blame only returns the summary\n\t\tlet logCommit: GitCommit | undefined = undefined;\n\t\tif (!commit.isUncommitted) {\n\t\t\tlogCommit = await Container.git.getCommitForFile(commit.repoPath, commit.uri.fsPath, {\n\t\t\t\tref: commit.sha\n\t\t\t});\n\t\t\tif (logCommit !== undefined) {\n\t\t\t\t// Preserve the previous commit from the blame commit\n\t\t\t\tlogCommit.previousFileName = commit.previousFileName;\n\t\t\t\tlogCommit.previousSha = commit.previousSha;\n\t\t\t}\n\t\t}\n\n\t\tlet editorLine = this.editor.selection.active.line;\n\t\tconst line = editorLine + 1;\n\t\tconst commitLine = commit.lines.find(l => l.line === line) || commit.lines[0];\n\t\teditorLine = commitLine.originalLine - 1;\n\n\t\tconst message = await Annotations.detailsHoverMessage(\n\t\t\tlogCommit || commit,\n\t\t\tawait GitUri.fromUri(document.uri),\n\t\t\teditorLine,\n\t\t\tContainer.config.defaultDateFormat,\n\t\t\tthis.annotationType\n\t\t);\n\t\treturn new Hover(\n\t\t\tmessage,\n\t\t\tdocument.validateRange(new Range(position.line, 0, position.line, Number.MAX_SAFE_INTEGER))\n\t\t);\n\t}\n\n\tasync provideChangesHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\ttoken: CancellationToken\n\t): Promise<Hover | undefined> {\n\t\tconst commit = await this.getCommitForHover(position);\n\t\tif (commit === undefined) return undefined;\n\n\t\tconst message = await Annotations.changesHoverMessage(\n\t\t\tcommit,\n\t\t\tawait GitUri.fromUri(document.uri),\n\t\t\tposition.line\n\t\t);\n\t\tif (message === undefined) return undefined;\n\n\t\treturn new Hover(\n\t\t\tmessage,\n\t\t\tdocument.validateRange(new Range(position.line, 0, position.line, Number.MAX_SAFE_INTEGER))\n\t\t);\n\t}\n\n\tprivate async getCommitForHover(position: Position): Promise<GitBlameCommit | undefined> {\n\t\tif (Container.config.hovers.annotations.over !== 'line' && position.character !== 0) return undefined;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame === undefined) return undefined;\n\n\t\tconst line = blame.lines[position.line];\n\n\t\treturn blame.commits.get(line.sha);\n\t}\n}\n","'use strict';\nimport { DecorationOptions, Range, TextEditorDecorationType, window } from 'vscode';\nimport { FileAnnotationType, GravatarDefaultStyle } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatOptions, CommitFormatter, GitBlameCommit } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { log, Objects, Strings } from '../system';\nimport { Annotations } from './annotations';\nimport { BlameAnnotationProviderBase } from './blameAnnotationProvider';\n\nexport class GutterBlameAnnotationProvider extends BlameAnnotationProviderBase {\n\t@log()\n\tasync onProvideAnnotation(shaOrLine?: string | number, type?: FileAnnotationType): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis.annotationType = FileAnnotationType.Blame;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame === undefined) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst cfg = Container.config.blame;\n\n\t\t// Precalculate the formatting options so we don't need to do it on each iteration\n\t\tconst tokenOptions = Strings.getTokensFromTemplate(cfg.format).reduce<{\n\t\t\t[token: string]: Strings.TokenOptions | undefined;\n\t\t}>((map, token) => {\n\t\t\tmap[token.key] = token.options;\n\t\t\treturn map;\n\t\t}, Object.create(null));\n\n\t\tlet getBranchAndTagTips;\n\t\tif (CommitFormatter.has(cfg.format, 'tips')) {\n\t\t\tgetBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(blame.repoPath);\n\t\t}\n\n\t\tconst options: CommitFormatOptions = {\n\t\t\tdateFormat: cfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat,\n\t\t\tgetBranchAndTagTips: getBranchAndTagTips,\n\t\t\ttokenOptions: tokenOptions\n\t\t};\n\n\t\tconst avatars = cfg.avatars;\n\t\tconst gravatarDefault = Container.config.defaultGravatarsStyle;\n\t\tconst separateLines = cfg.separateLines;\n\t\tconst renderOptions = Annotations.gutterRenderOptions(separateLines, cfg.heatmap, cfg.format, options);\n\n\t\tthis.decorations = [];\n\t\tconst decorationsMap: { [sha: string]: DecorationOptions | undefined } = Object.create(null);\n\t\tconst avatarDecorationsMap:\n\t\t\t| { [email: string]: { decoration: TextEditorDecorationType; ranges: Range[] } }\n\t\t\t| undefined = avatars ? Object.create(null) : undefined;\n\n\t\tlet commit: GitBlameCommit | undefined;\n\t\tlet compacted = false;\n\t\tlet gutter: DecorationOptions | undefined;\n\t\tlet previousSha: string | undefined;\n\n\t\tlet computedHeatmap;\n\t\tif (cfg.heatmap.enabled) {\n\t\t\tcomputedHeatmap = this.getComputedHeatmap(blame);\n\t\t}\n\n\t\tfor (const l of blame.lines) {\n\t\t\t// editor lines are 0-based\n\t\t\tconst editorLine = l.line - 1;\n\n\t\t\tif (previousSha === l.sha) {\n\t\t\t\tif (gutter === undefined) continue;\n\n\t\t\t\t// Use a shallow copy of the previous decoration options\n\t\t\t\tgutter = { ...gutter };\n\n\t\t\t\tif (cfg.compact && !compacted) {\n\t\t\t\t\t// Since we are wiping out the contextText make sure to copy the objects\n\t\t\t\t\tgutter.renderOptions = {\n\t\t\t\t\t\tbefore: {\n\t\t\t\t\t\t\t...gutter.renderOptions!.before,\n\t\t\t\t\t\t\tcontentText: GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t\tStrings.getWidth(gutter.renderOptions!.before!.contentText!)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tif (separateLines) {\n\t\t\t\t\t\tgutter.renderOptions.before!.textDecoration = 'none';\n\t\t\t\t\t}\n\n\t\t\t\t\tcompacted = true;\n\t\t\t\t}\n\n\t\t\t\tgutter.range = new Range(editorLine, 0, editorLine, 0);\n\n\t\t\t\tthis.decorations.push(gutter);\n\n\t\t\t\tif (avatars && !cfg.compact && commit !== undefined && commit.email !== undefined) {\n\t\t\t\t\tthis.addOrUpdateGravatarDecoration(commit, gutter.range, gravatarDefault, avatarDecorationsMap!);\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcompacted = false;\n\t\t\tpreviousSha = l.sha;\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit === undefined) continue;\n\n\t\t\tgutter = decorationsMap[l.sha];\n\t\t\tif (gutter !== undefined) {\n\t\t\t\tgutter = {\n\t\t\t\t\t...gutter,\n\t\t\t\t\trange: new Range(editorLine, 0, editorLine, 0)\n\t\t\t\t};\n\n\t\t\t\tthis.decorations.push(gutter);\n\n\t\t\t\tif (avatars && commit.email !== undefined) {\n\t\t\t\t\tthis.addOrUpdateGravatarDecoration(commit, gutter.range, gravatarDefault, avatarDecorationsMap!);\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tgutter = Annotations.gutter(commit, cfg.format, options, renderOptions) as DecorationOptions;\n\n\t\t\tif (computedHeatmap !== undefined) {\n\t\t\t\tAnnotations.applyHeatmap(gutter, commit.date, computedHeatmap);\n\t\t\t}\n\n\t\t\tgutter.range = new Range(editorLine, 0, editorLine, 0);\n\n\t\t\tthis.decorations.push(gutter);\n\n\t\t\tif (avatars && commit.email !== undefined) {\n\t\t\t\tthis.addOrUpdateGravatarDecoration(commit, gutter.range, gravatarDefault, avatarDecorationsMap!);\n\t\t\t}\n\n\t\t\tdecorationsMap[l.sha] = gutter;\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute gutter blame annotations`);\n\n\t\tif (this.decorations.length) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.editor.setDecorations(this.decoration, this.decorations);\n\n\t\t\tif (avatars) {\n\t\t\t\tthis.additionalDecorations = [];\n\t\t\t\tfor (const d of Objects.values(avatarDecorationsMap!)) {\n\t\t\t\t\tthis.additionalDecorations.push(d);\n\t\t\t\t\tthis.editor.setDecorations(d.decoration, d.ranges);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply all gutter blame annotations`);\n\t\t}\n\n\t\tthis.registerHoverProviders(Container.config.hovers.annotations);\n\t\treturn true;\n\t}\n\n\taddOrUpdateGravatarDecoration(\n\t\tcommit: GitBlameCommit,\n\t\trange: Range,\n\t\tgravatarDefault: GravatarDefaultStyle,\n\t\tmap: { [email: string]: { decoration: TextEditorDecorationType; ranges: Range[] } }\n\t) {\n\t\tconst avatarDecoration = map[commit.email!];\n\t\tif (avatarDecoration !== undefined) {\n\t\t\tavatarDecoration.ranges.push(range);\n\n\t\t\treturn;\n\t\t}\n\n\t\tmap[commit.email!] = {\n\t\t\tdecoration: window.createTextEditorDecorationType({\n\t\t\t\tgutterIconPath: commit.getGravatarUri(gravatarDefault),\n\t\t\t\tgutterIconSize: '16px 16px'\n\t\t\t}),\n\t\t\tranges: [range]\n\t\t};\n\t}\n}\n","'use strict';\nimport { DecorationOptions, Range } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitBlameCommit } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { log, Strings } from '../system';\nimport { Annotations } from './annotations';\nimport { BlameAnnotationProviderBase } from './blameAnnotationProvider';\n\nexport class HeatmapBlameAnnotationProvider extends BlameAnnotationProviderBase {\n\t@log()\n\tasync onProvideAnnotation(shaOrLine?: string | number, type?: FileAnnotationType): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis.annotationType = FileAnnotationType.Heatmap;\n\n\t\tconst blame = await this.getBlame();\n\t\tif (blame === undefined) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst renderOptions = Annotations.heatmapRenderOptions();\n\n\t\tthis.decorations = [];\n\t\tconst decorationsMap: { [sha: string]: DecorationOptions | undefined } = Object.create(null);\n\n\t\tlet commit: GitBlameCommit | undefined;\n\t\tlet heatmap: DecorationOptions | undefined;\n\n\t\tconst computedHeatmap = this.getComputedHeatmap(blame);\n\n\t\tfor (const l of blame.lines) {\n\t\t\t// editor lines are 0-based\n\t\t\tconst editorLine = l.line - 1;\n\n\t\t\theatmap = decorationsMap[l.sha];\n\t\t\tif (heatmap !== undefined) {\n\t\t\t\theatmap = {\n\t\t\t\t\t...heatmap,\n\t\t\t\t\trange: new Range(editorLine, 0, editorLine, 0)\n\t\t\t\t};\n\n\t\t\t\tthis.decorations.push(heatmap);\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcommit = blame.commits.get(l.sha);\n\t\t\tif (commit === undefined) continue;\n\n\t\t\theatmap = Annotations.heatmap(commit, computedHeatmap, renderOptions) as DecorationOptions;\n\t\t\theatmap.range = new Range(editorLine, 0, editorLine, 0);\n\n\t\t\tthis.decorations.push(heatmap);\n\t\t\tdecorationsMap[l.sha] = heatmap;\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute heatmap annotations`);\n\n\t\tif (this.decorations.length) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.editor.setDecorations(this.decoration, this.decorations);\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply recent changes annotations`);\n\t\t}\n\n\t\tthis.registerHoverProviders(Container.config.hovers.annotations);\n\t\treturn true;\n\t}\n}\n","'use strict';\nimport { MarkdownString, Position, Range, TextEditor, TextEditorDecorationType } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { log, Strings } from '../system';\nimport { GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { AnnotationProviderBase } from './annotationProvider';\nimport { Annotations } from './annotations';\n\nexport class RecentChangesAnnotationProvider extends AnnotationProviderBase {\n\tprivate readonly _uri: GitUri;\n\n\tconstructor(\n\t\teditor: TextEditor,\n\t\ttrackedDocument: TrackedDocument<GitDocumentState>,\n\t\tdecoration: TextEditorDecorationType,\n\t\thighlightDecoration: TextEditorDecorationType | undefined\n\t) {\n\t\tsuper(editor, trackedDocument, decoration, highlightDecoration);\n\n\t\tthis._uri = trackedDocument.uri;\n\t}\n\n\t@log()\n\tasync onProvideAnnotation(shaOrLine?: string | number): Promise<boolean> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis.annotationType = FileAnnotationType.RecentChanges;\n\n\t\tconst commit = await Container.git.getCommitForFile(this._uri.repoPath, this._uri.fsPath);\n\t\tif (commit === undefined) return false;\n\n\t\tconst diff = await Container.git.getDiffForFile(this._uri, commit.sha);\n\t\tif (diff === undefined) return false;\n\n\t\tlet start = process.hrtime();\n\n\t\tconst cfg = Container.config;\n\t\tconst dateFormat = cfg.defaultDateFormat;\n\n\t\tthis.decorations = [];\n\n\t\tfor (const hunk of diff.hunks) {\n\t\t\t// Subtract 2 because editor lines are 0-based and we will be adding 1 in the first iteration of the loop\n\t\t\tlet count = hunk.currentPosition.start - 2;\n\t\t\tfor (const hunkLine of hunk.lines) {\n\t\t\t\tif (hunkLine.current === undefined) continue;\n\n\t\t\t\tcount++;\n\n\t\t\t\tif (hunkLine.current.state === 'unchanged') continue;\n\n\t\t\t\tconst range = this.editor.document.validateRange(\n\t\t\t\t\tnew Range(new Position(count, 0), new Position(count, Number.MAX_SAFE_INTEGER))\n\t\t\t\t);\n\n\t\t\t\tlet message: MarkdownString | undefined = undefined;\n\n\t\t\t\tif (cfg.hovers.enabled && cfg.hovers.annotations.enabled) {\n\t\t\t\t\tif (cfg.hovers.annotations.details) {\n\t\t\t\t\t\tthis.decorations.push({\n\t\t\t\t\t\t\thoverMessage: await Annotations.detailsHoverMessage(\n\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\tawait GitUri.fromUri(this.editor.document.uri),\n\t\t\t\t\t\t\t\tcount,\n\t\t\t\t\t\t\t\tdateFormat,\n\t\t\t\t\t\t\t\tthis.annotationType\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\trange: range\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cfg.hovers.annotations.changes) {\n\t\t\t\t\t\tmessage = await Annotations.changesHoverMessage(commit, this._uri, count, hunkLine);\n\t\t\t\t\t\tif (message === undefined) continue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.decorations.push({\n\t\t\t\t\thoverMessage: message,\n\t\t\t\t\trange: range\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to compute recent changes annotations`);\n\n\t\tif (this.decorations.length) {\n\t\t\tstart = process.hrtime();\n\n\t\t\tthis.editor.setDecorations(this.decoration, this.decorations);\n\n\t\t\tLogger.log(cc, `${Strings.getDurationMilliseconds(start)} ms to apply recent changes annotations`);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tselection(shaOrLine?: string | number): Promise<void> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tvalidate(): Promise<boolean> {\n\t\treturn Promise.resolve(true);\n\t}\n}\n","'use strict';\nimport {\n\tConfigurationChangeEvent,\n\tDecorationOptions,\n\tDecorationRangeBehavior,\n\tDisposable,\n\tRange,\n\tTextEditor,\n\tTextEditorDecorationType,\n\twindow\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { GlyphChars, isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { LinesChangeEvent } from '../trackers/gitLineTracker';\nimport { Annotations } from './annotations';\nimport { debug, log } from '../system';\nimport { Logger } from '../logger';\nimport { CommitFormatter } from '../git/gitService';\n\nconst annotationDecoration: TextEditorDecorationType = window.createTextEditorDecorationType({\n\tafter: {\n\t\tmargin: '0 0 0 3em',\n\t\ttextDecoration: 'none'\n\t},\n\trangeBehavior: DecorationRangeBehavior.ClosedOpen\n});\n\nexport class LineAnnotationController implements Disposable {\n\tprivate _disposable: Disposable;\n\tprivate _editor: TextEditor | undefined;\n\tprivate _enabled: boolean = false;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\tContainer.fileAnnotations.onDidToggleAnnotations(this.onFileAnnotationsToggled, this)\n\t\t);\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis.clearAnnotations(this._editor);\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (!configuration.changed(e, 'currentLine')) return;\n\n\t\tif (configuration.changed(e, 'currentLine', 'enabled')) {\n\t\t\tif (Container.config.currentLine.enabled) {\n\t\t\t\tthis._enabled = true;\n\t\t\t\tthis.resume();\n\t\t\t} else {\n\t\t\t\tthis._enabled = false;\n\t\t\t\tthis.setLineTracker(false);\n\t\t\t}\n\t\t}\n\n\t\tvoid this.refresh(window.activeTextEditor);\n\t}\n\n\tprivate _suspended: boolean = false;\n\tget suspended() {\n\t\treturn !this._enabled || this._suspended;\n\t}\n\n\t@log()\n\tresume() {\n\t\tthis.setLineTracker(true);\n\n\t\tif (this._suspended) {\n\t\t\tthis._suspended = false;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t@log()\n\tsuspend() {\n\t\tthis.setLineTracker(false);\n\n\t\tif (!this._suspended) {\n\t\t\tthis._suspended = true;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\tif (!e.pending && e.lines !== undefined) {\n\t\t\tvoid this.refresh(e.editor);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clear(e.editor);\n\t}\n\n\tprivate onFileAnnotationsToggled() {\n\t\tvoid this.refresh(window.activeTextEditor);\n\t}\n\n\t@debug({ args: false })\n\tclear(editor: TextEditor | undefined) {\n\t\tif (this._editor !== editor && this._editor !== undefined) {\n\t\t\tthis.clearAnnotations(this._editor);\n\t\t}\n\t\tthis.clearAnnotations(editor);\n\t}\n\n\t@log({ args: false })\n\tasync toggle(editor: TextEditor | undefined) {\n\t\tthis._enabled = !(this._enabled && !this.suspended);\n\n\t\tif (this._enabled) {\n\t\t\tif (this.resume()) {\n\t\t\t\tawait this.refresh(editor);\n\t\t\t}\n\t\t} else if (this.suspend()) {\n\t\t\tawait this.refresh(editor);\n\t\t}\n\t}\n\n\tprivate clearAnnotations(editor: TextEditor | undefined) {\n\t\tif (editor === undefined || (editor as any)._disposed === true) return;\n\n\t\teditor.setDecorations(annotationDecoration, []);\n\t}\n\n\t@debug({ args: false })\n\tprivate async refresh(editor: TextEditor | undefined) {\n\t\tif (editor === undefined && this._editor === undefined) return;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst lines = Container.lineTracker.lines;\n\t\tif (editor === undefined || lines === undefined || !isTextEditor(editor)) {\n\t\t\tthis.clear(this._editor);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._editor !== editor) {\n\t\t\t// Clear any annotations on the previously active editor\n\t\t\tthis.clear(this._editor);\n\n\t\t\tthis._editor = editor;\n\t\t}\n\n\t\tconst cfg = Container.config.currentLine;\n\t\tif (this.suspended) {\n\t\t\tthis.clear(editor);\n\t\t\treturn;\n\t\t}\n\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable && this.suspended) {\n\t\t\tthis.clear(editor);\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure the editor hasn't died since the await above and that we are still on the same line(s)\n\t\tif (editor.document === undefined || !Container.lineTracker.includesAll(lines)) {\n\t\t\tif (cc) {\n\t\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} Skipped because ${\n\t\t\t\t\teditor.document === undefined ? 'editor is gone' : `line(s)=${lines.join()} are no longer current`\n\t\t\t\t}`;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (cc) {\n\t\t\tcc.exitDetails = ` ${GlyphChars.Dot} line(s)=${lines.join()}`;\n\t\t}\n\n\t\tlet getBranchAndTagTips;\n\t\tif (CommitFormatter.has(cfg.format, 'tips')) {\n\t\t\tgetBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(trackedDocument.uri.repoPath);\n\t\t}\n\n\t\tconst decorations = [];\n\t\tfor (const l of lines) {\n\t\t\tconst state = Container.lineTracker.getState(l);\n\t\t\tif (state === undefined || state.commit === undefined) continue;\n\n\t\t\tconst decoration = Annotations.trailing(\n\t\t\t\tstate.commit,\n\t\t\t\t// await GitUri.fromUri(editor.document.uri),\n\t\t\t\t// l,\n\t\t\t\tcfg.format,\n\t\t\t\tcfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat,\n\t\t\t\tcfg.scrollable,\n\t\t\t\tgetBranchAndTagTips\n\t\t\t) as DecorationOptions;\n\t\t\tdecoration.range = editor.document.validateRange(\n\t\t\t\tnew Range(l, Number.MAX_SAFE_INTEGER, l, Number.MAX_SAFE_INTEGER)\n\t\t\t);\n\n\t\t\tdecorations.push(decoration);\n\t\t}\n\n\t\teditor.setDecorations(annotationDecoration, decorations);\n\t}\n\n\tprivate setLineTracker(enabled: boolean) {\n\t\tif (enabled) {\n\t\t\tif (!Container.lineTracker.isSubscribed(this)) {\n\t\t\t\tContainer.lineTracker.start(\n\t\t\t\t\tthis,\n\t\t\t\t\tDisposable.from(Container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this))\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tContainer.lineTracker.stop(this);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tCodeLens,\n\tCodeLensProvider,\n\tCommand,\n\tcommands,\n\tDocumentSelector,\n\tDocumentSymbol,\n\tEvent,\n\tEventEmitter,\n\tExtensionContext,\n\tLocation,\n\tPosition,\n\tRange,\n\tSymbolInformation,\n\tSymbolKind,\n\tTextDocument\n} from 'vscode';\nimport {\n\tCommands,\n\tDiffWithPreviousCommandArgs,\n\tShowCommitsInViewCommandArgs,\n\tShowQuickCommitDetailsCommandArgs,\n\tShowQuickCommitFileDetailsCommandArgs,\n\tShowQuickFileHistoryCommandArgs\n} from '../commands';\nimport {\n\tCodeLensCommand,\n\tCodeLensConfig,\n\tCodeLensLanguageScope,\n\tCodeLensScopes,\n\tconfiguration\n} from '../configuration';\nimport { BuiltInCommands, DocumentSchemes } from '../constants';\nimport { Container } from '../container';\nimport { GitBlame, GitBlameCommit, GitBlameLines, GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Functions, Iterables } from '../system';\nimport { DocumentTracker, GitDocumentState } from '../trackers/gitDocumentTracker';\n\nexport class GitRecentChangeCodeLens extends CodeLens {\n\tconstructor(\n\t\tpublic readonly languageId: string,\n\t\tpublic readonly symbol: DocumentSymbol | SymbolInformation,\n\t\tpublic readonly uri: GitUri | undefined,\n\t\tprivate readonly blame: (() => GitBlameLines | undefined) | undefined,\n\t\tpublic readonly blameRange: Range,\n\t\tpublic readonly isFullRange: boolean,\n\t\trange: Range,\n\t\tpublic readonly desiredCommand: CodeLensCommand,\n\t\tcommand?: Command | undefined\n\t) {\n\t\tsuper(range, command);\n\t}\n\n\tgetBlame(): GitBlameLines | undefined {\n\t\treturn this.blame && this.blame();\n\t}\n}\n\nexport class GitAuthorsCodeLens extends CodeLens {\n\tconstructor(\n\t\tpublic readonly languageId: string,\n\t\tpublic readonly symbol: DocumentSymbol | SymbolInformation,\n\t\tpublic readonly uri: GitUri | undefined,\n\t\tprivate readonly blame: () => GitBlameLines | undefined,\n\t\tpublic readonly blameRange: Range,\n\t\tpublic readonly isFullRange: boolean,\n\t\trange: Range,\n\t\tpublic readonly desiredCommand: CodeLensCommand\n\t) {\n\t\tsuper(range);\n\t}\n\n\tgetBlame(): GitBlameLines | undefined {\n\t\treturn this.blame();\n\t}\n}\n\nexport class GitCodeLensProvider implements CodeLensProvider {\n\tprivate _onDidChangeCodeLenses = new EventEmitter<void>();\n\tget onDidChangeCodeLenses(): Event<void> {\n\t\treturn this._onDidChangeCodeLenses.event;\n\t}\n\n\tstatic selector: DocumentSelector = [\n\t\t{ scheme: DocumentSchemes.File },\n\t\t{ scheme: DocumentSchemes.Vsls },\n\t\t{ scheme: DocumentSchemes.Git },\n\t\t{ scheme: DocumentSchemes.GitLens }\n\t];\n\n\tconstructor(\n\t\tcontext: ExtensionContext,\n\t\tprivate readonly _git: GitService,\n\t\tprivate readonly _tracker: DocumentTracker<GitDocumentState>\n\t) {}\n\n\treset(reason?: 'idle' | 'saved') {\n\t\tthis._onDidChangeCodeLenses.fire();\n\t}\n\n\tasync provideCodeLenses(document: TextDocument, token: CancellationToken): Promise<CodeLens[]> {\n\t\tconst trackedDocument = await this._tracker.getOrAdd(document);\n\t\tif (!trackedDocument.isBlameable) return [];\n\n\t\tlet dirty = false;\n\t\tif (document.isDirty) {\n\t\t\t// Only allow dirty blames if we are idle\n\t\t\tif (trackedDocument.isDirtyIdle) {\n\t\t\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\t\t\tif (maxLines > 0 && document.lineCount > maxLines) {\n\t\t\t\t\tdirty = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdirty = true;\n\t\t\t}\n\t\t}\n\n\t\tconst cfg = configuration.get('codeLens', document.uri);\n\n\t\tlet languageScope =\n\t\t\tcfg.scopesByLanguage &&\n\t\t\tcfg.scopesByLanguage.find(\n\t\t\t\tll => ll.language !== undefined && ll.language.toLowerCase() === document.languageId\n\t\t\t);\n\t\tif (languageScope == null) {\n\t\t\tlanguageScope = {\n\t\t\t\tlanguage: undefined\n\t\t\t};\n\t\t}\n\t\tif (languageScope.scopes == null) {\n\t\t\tlanguageScope.scopes = cfg.scopes;\n\t\t}\n\t\tif (languageScope.symbolScopes == null) {\n\t\t\tlanguageScope.symbolScopes = cfg.symbolScopes;\n\t\t}\n\n\t\tlanguageScope.symbolScopes =\n\t\t\tlanguageScope.symbolScopes != null\n\t\t\t\t? (languageScope.symbolScopes = languageScope.symbolScopes.map(s => s.toLowerCase()))\n\t\t\t\t: [];\n\n\t\tconst lenses: CodeLens[] = [];\n\n\t\tconst gitUri = trackedDocument.uri;\n\t\tlet blame: GitBlame | undefined;\n\t\tlet symbols;\n\n\t\tif (!dirty) {\n\t\t\tif (token.isCancellationRequested) return lenses;\n\n\t\t\tif (languageScope.scopes.length === 1 && languageScope.scopes.includes(CodeLensScopes.Document)) {\n\t\t\t\tblame = document.isDirty\n\t\t\t\t\t? await this._git.getBlameForFileContents(gitUri, document.getText())\n\t\t\t\t\t: await this._git.getBlameForFile(gitUri);\n\t\t\t} else {\n\t\t\t\t[blame, symbols] = await Promise.all([\n\t\t\t\t\tdocument.isDirty\n\t\t\t\t\t\t? this._git.getBlameForFileContents(gitUri, document.getText())\n\t\t\t\t\t\t: this._git.getBlameForFile(gitUri),\n\t\t\t\t\tcommands.executeCommand(BuiltInCommands.ExecuteDocumentSymbolProvider, document.uri) as Promise<\n\t\t\t\t\t\tSymbolInformation[]\n\t\t\t\t\t>\n\t\t\t\t]);\n\t\t\t}\n\n\t\t\tif (blame === undefined || blame.lines.length === 0) return lenses;\n\t\t} else if (languageScope.scopes.length !== 1 || !languageScope.scopes.includes(CodeLensScopes.Document)) {\n\t\t\tsymbols = (await commands.executeCommand(\n\t\t\t\tBuiltInCommands.ExecuteDocumentSymbolProvider,\n\t\t\t\tdocument.uri\n\t\t\t)) as SymbolInformation[];\n\t\t}\n\n\t\tif (token.isCancellationRequested) return lenses;\n\n\t\tconst documentRangeFn = Functions.once(() => document.validateRange(new Range(0, 1000000, 1000000, 1000000)));\n\n\t\t// Since blame information isn't valid when there are unsaved changes -- update the lenses appropriately\n\t\tconst dirtyCommand: Command | undefined = dirty\n\t\t\t? { command: undefined!, title: this.getDirtyTitle(cfg) }\n\t\t\t: undefined;\n\n\t\tif (symbols !== undefined) {\n\t\t\tLogger.log('GitCodeLensProvider.provideCodeLenses:', `${symbols.length} symbol(s) found`);\n\t\t\tfor (const sym of symbols) {\n\t\t\t\tthis.provideCodeLens(\n\t\t\t\t\tlenses,\n\t\t\t\t\tdocument,\n\t\t\t\t\tsym,\n\t\t\t\t\tlanguageScope as Required<CodeLensLanguageScope>,\n\t\t\t\t\tdocumentRangeFn,\n\t\t\t\t\tblame,\n\t\t\t\t\tgitUri,\n\t\t\t\t\tcfg,\n\t\t\t\t\tdirty,\n\t\t\t\t\tdirtyCommand\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t(languageScope.scopes.includes(CodeLensScopes.Document) || languageScope.symbolScopes.includes('file')) &&\n\t\t\t!languageScope.symbolScopes.includes('!file')\n\t\t) {\n\t\t\t// Check if we have a lens for the whole document -- if not add one\n\t\t\tif (!lenses.find(l => l.range.start.line === 0 && l.range.end.line === 0)) {\n\t\t\t\tconst blameRange = documentRangeFn();\n\n\t\t\t\tlet blameForRangeFn: (() => GitBlameLines | undefined) | undefined = undefined;\n\t\t\t\tif (dirty || cfg.recentChange.enabled) {\n\t\t\t\t\tif (!dirty) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri, blameRange)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fileSymbol = new SymbolInformation(\n\t\t\t\t\t\tgitUri.fileName,\n\t\t\t\t\t\tSymbolKind.File,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\tnew Location(gitUri.documentUri(), new Range(0, 0, 0, blameRange.start.character))\n\t\t\t\t\t);\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitRecentChangeCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tfileSymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tgetRangeFromSymbol(fileSymbol),\n\t\t\t\t\t\t\tcfg.recentChange.command,\n\t\t\t\t\t\t\tdirtyCommand\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (!dirty && cfg.authors.enabled) {\n\t\t\t\t\tif (blameForRangeFn === undefined) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri, blameRange)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst fileSymbol = new SymbolInformation(\n\t\t\t\t\t\tgitUri.fileName,\n\t\t\t\t\t\tSymbolKind.File,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\tnew Location(gitUri.documentUri(), new Range(0, 1, 0, blameRange.start.character))\n\t\t\t\t\t);\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitAuthorsCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tfileSymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\tgetRangeFromSymbol(fileSymbol),\n\t\t\t\t\t\t\tcfg.authors.command\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn lenses;\n\t}\n\n\tprivate getValidateSymbolRange(\n\t\tsymbol: SymbolInformation | DocumentSymbol,\n\t\tlanguageScope: Required<CodeLensLanguageScope>,\n\t\tdocumentRangeFn: () => Range,\n\t\tincludeSingleLineSymbols: boolean\n\t): Range | undefined {\n\t\tlet valid = false;\n\t\tlet range: Range | undefined;\n\n\t\tconst symbolName = SymbolKind[symbol.kind].toLowerCase();\n\t\tswitch (symbol.kind) {\n\t\t\tcase SymbolKind.File:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\tvalid = !languageScope.symbolScopes.includes(`!${symbolName}`);\n\t\t\t\t}\n\n\t\t\t\tif (valid) {\n\t\t\t\t\t// Adjust the range to be for the whole file\n\t\t\t\t\trange = documentRangeFn();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Package:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\tvalid = !languageScope.symbolScopes.includes(`!${symbolName}`);\n\t\t\t\t}\n\n\t\t\t\tif (valid) {\n\t\t\t\t\t// Adjust the range to be for the whole file\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tif (range.start.line === 0 && range.end.line === 0) {\n\t\t\t\t\t\trange = documentRangeFn();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Class:\n\t\t\tcase SymbolKind.Interface:\n\t\t\tcase SymbolKind.Module:\n\t\t\tcase SymbolKind.Namespace:\n\t\t\tcase SymbolKind.Struct:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Containers) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase SymbolKind.Constructor:\n\t\t\tcase SymbolKind.Enum:\n\t\t\tcase SymbolKind.Function:\n\t\t\tcase SymbolKind.Method:\n\t\t\tcase SymbolKind.Property:\n\t\t\t\tif (\n\t\t\t\t\tlanguageScope.scopes.includes(CodeLensScopes.Blocks) ||\n\t\t\t\t\tlanguageScope.symbolScopes.includes(symbolName)\n\t\t\t\t) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif (languageScope.symbolScopes.includes(symbolName)) {\n\t\t\t\t\trange = getRangeFromSymbol(symbol);\n\t\t\t\t\tvalid =\n\t\t\t\t\t\t!languageScope.symbolScopes.includes(`!${symbolName}`) &&\n\t\t\t\t\t\t(includeSingleLineSymbols || !range.isSingleLine);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn valid ? range || getRangeFromSymbol(symbol) : undefined;\n\t}\n\n\tprivate provideCodeLens(\n\t\tlenses: CodeLens[],\n\t\tdocument: TextDocument,\n\t\tsymbol: SymbolInformation | DocumentSymbol,\n\t\tlanguageScope: Required<CodeLensLanguageScope>,\n\t\tdocumentRangeFn: () => Range,\n\t\tblame: GitBlame | undefined,\n\t\tgitUri: GitUri | undefined,\n\t\tcfg: CodeLensConfig,\n\t\tdirty: boolean,\n\t\tdirtyCommand: Command | undefined\n\t): void {\n\t\ttry {\n\t\t\tconst blameRange = this.getValidateSymbolRange(\n\t\t\t\tsymbol,\n\t\t\t\tlanguageScope,\n\t\t\t\tdocumentRangeFn,\n\t\t\t\tcfg.includeSingleLineSymbols\n\t\t\t);\n\t\t\tif (blameRange === undefined) return;\n\n\t\t\tconst line = document.lineAt(getRangeFromSymbol(symbol).start);\n\t\t\t// Make sure there is only 1 lens per line\n\t\t\tif (lenses.length && lenses[lenses.length - 1].range.start.line === line.lineNumber) return;\n\n\t\t\t// Anchor the code lens to the start of the line -- so that the range won't change with edits (otherwise the code lens will be removed and re-added)\n\t\t\tlet startChar = 0;\n\n\t\t\tlet blameForRangeFn: (() => GitBlameLines | undefined) | undefined;\n\t\t\tif (dirty || cfg.recentChange.enabled) {\n\t\t\t\tif (!dirty) {\n\t\t\t\t\tblameForRangeFn = Functions.once(() => this._git.getBlameForRangeSync(blame!, gitUri!, blameRange));\n\t\t\t\t}\n\t\t\t\tlenses.push(\n\t\t\t\t\tnew GitRecentChangeCodeLens(\n\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\tsymbol,\n\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\tfalse,\n\t\t\t\t\t\tline.range.with(new Position(line.range.start.line, startChar)),\n\t\t\t\t\t\tcfg.recentChange.command,\n\t\t\t\t\t\tdirtyCommand\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tstartChar++;\n\t\t\t}\n\n\t\t\tif (cfg.authors.enabled) {\n\t\t\t\tlet multiline = !blameRange.isSingleLine;\n\t\t\t\t// HACK for Omnisharp, since it doesn't return full ranges\n\t\t\t\tif (!multiline && document.languageId === 'csharp') {\n\t\t\t\t\tswitch (symbol.kind) {\n\t\t\t\t\t\tcase SymbolKind.File:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase SymbolKind.Package:\n\t\t\t\t\t\tcase SymbolKind.Module:\n\t\t\t\t\t\tcase SymbolKind.Namespace:\n\t\t\t\t\t\tcase SymbolKind.Class:\n\t\t\t\t\t\tcase SymbolKind.Interface:\n\t\t\t\t\t\tcase SymbolKind.Constructor:\n\t\t\t\t\t\tcase SymbolKind.Method:\n\t\t\t\t\t\tcase SymbolKind.Function:\n\t\t\t\t\t\tcase SymbolKind.Enum:\n\t\t\t\t\t\t\tmultiline = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (multiline && !dirty) {\n\t\t\t\t\tif (blameForRangeFn === undefined) {\n\t\t\t\t\t\tblameForRangeFn = Functions.once(() =>\n\t\t\t\t\t\t\tthis._git.getBlameForRangeSync(blame!, gitUri!, blameRange)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tlenses.push(\n\t\t\t\t\t\tnew GitAuthorsCodeLens(\n\t\t\t\t\t\t\tdocument.languageId,\n\t\t\t\t\t\t\tsymbol,\n\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\tblameForRangeFn,\n\t\t\t\t\t\t\tblameRange,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tline.range.with(new Position(line.range.start.line, startChar)),\n\t\t\t\t\t\t\tcfg.authors.command\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} finally {\n\t\t\tif (isDocumentSymbol(symbol)) {\n\t\t\t\tfor (const child of symbol.children) {\n\t\t\t\t\tthis.provideCodeLens(\n\t\t\t\t\t\tlenses,\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t\tchild,\n\t\t\t\t\t\tlanguageScope,\n\t\t\t\t\t\tdocumentRangeFn,\n\t\t\t\t\t\tblame,\n\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\tcfg,\n\t\t\t\t\t\tdirty,\n\t\t\t\t\t\tdirtyCommand\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tresolveCodeLens(lens: CodeLens, token: CancellationToken): CodeLens | Thenable<CodeLens> {\n\t\tif (lens instanceof GitRecentChangeCodeLens) return this.resolveGitRecentChangeCodeLens(lens, token);\n\t\tif (lens instanceof GitAuthorsCodeLens) return this.resolveGitAuthorsCodeLens(lens, token);\n\t\treturn Promise.reject<CodeLens>(undefined);\n\t}\n\n\tprivate resolveGitRecentChangeCodeLens(lens: GitRecentChangeCodeLens, token: CancellationToken): CodeLens {\n\t\tconst blame = lens.getBlame();\n\t\tif (blame === undefined) return lens;\n\n\t\tconst recentCommit = Iterables.first(blame.commits.values());\n\n\t\tlet title = `${recentCommit.author}, ${recentCommit.formattedDate}`;\n\t\tif (Container.config.debug) {\n\t\t\ttitle += ` [${lens.languageId}: ${SymbolKind[lens.symbol.kind]}(${lens.range.start.character}-${\n\t\t\t\tlens.range.end.character\n\t\t\t}${\n\t\t\t\t(lens.symbol as SymbolInformation).containerName\n\t\t\t\t\t? `|${(lens.symbol as SymbolInformation).containerName}`\n\t\t\t\t\t: ''\n\t\t\t}), Lines (${lens.blameRange.start.line + 1}-${lens.blameRange.end.line + 1}), Commit (${\n\t\t\t\trecentCommit.shortSha\n\t\t\t})]`;\n\t\t}\n\n\t\tswitch (lens.desiredCommand) {\n\t\t\tcase CodeLensCommand.DiffWithPrevious:\n\t\t\t\treturn this.applyDiffWithPreviousCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.RevealCommitInView:\n\t\t\t\treturn this.applyRevealCommitInViewCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowCommitsInView:\n\t\t\t\treturn this.applyShowCommitsInViewCommand<GitRecentChangeCodeLens>(title, lens, blame, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitDetails:\n\t\t\t\treturn this.applyShowQuickCommitDetailsCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitFileDetails:\n\t\t\t\treturn this.applyShowQuickCommitFileDetailsCommand<GitRecentChangeCodeLens>(title, lens, recentCommit);\n\t\t\tcase CodeLensCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\treturn this.applyShowQuickCurrentBranchHistoryCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ShowQuickFileHistory:\n\t\t\t\treturn this.applyShowQuickFileHistoryCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileBlame:\n\t\t\t\treturn this.applyToggleFileBlameCommand<GitRecentChangeCodeLens>(title, lens);\n\t\t\tdefault:\n\t\t\t\treturn lens;\n\t\t}\n\t}\n\n\tprivate resolveGitAuthorsCodeLens(lens: GitAuthorsCodeLens, token: CancellationToken): CodeLens {\n\t\tconst blame = lens.getBlame();\n\t\tif (blame === undefined) return lens;\n\n\t\tconst count = blame.authors.size;\n\n\t\tconst author = Iterables.first(blame.authors.values()).name;\n\n\t\tlet title = `${count} ${count > 1 ? 'authors' : 'author'} (${author}${count > 1 ? ' and others' : ''})`;\n\t\tif (Container.config.debug) {\n\t\t\ttitle += ` [${lens.languageId}: ${SymbolKind[lens.symbol.kind]}(${lens.range.start.character}-${\n\t\t\t\tlens.range.end.character\n\t\t\t}${\n\t\t\t\t(lens.symbol as SymbolInformation).containerName\n\t\t\t\t\t? `|${(lens.symbol as SymbolInformation).containerName}`\n\t\t\t\t\t: ''\n\t\t\t}), Lines (${lens.blameRange.start.line + 1}-${lens.blameRange.end.line + 1}), Authors (${Iterables.join(\n\t\t\t\tIterables.map(blame.authors.values(), a => a.name),\n\t\t\t\t', '\n\t\t\t)})]`;\n\t\t}\n\n\t\tconst commit =\n\t\t\tIterables.find(blame.commits.values(), c => c.author === author) || Iterables.first(blame.commits.values());\n\n\t\tswitch (lens.desiredCommand) {\n\t\t\tcase CodeLensCommand.DiffWithPrevious:\n\t\t\t\treturn this.applyDiffWithPreviousCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.RevealCommitInView:\n\t\t\t\treturn this.applyRevealCommitInViewCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowCommitsInView:\n\t\t\t\treturn this.applyShowCommitsInViewCommand<GitAuthorsCodeLens>(title, lens, blame);\n\t\t\tcase CodeLensCommand.ShowQuickCommitDetails:\n\t\t\t\treturn this.applyShowQuickCommitDetailsCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowQuickCommitFileDetails:\n\t\t\t\treturn this.applyShowQuickCommitFileDetailsCommand<GitAuthorsCodeLens>(title, lens, commit);\n\t\t\tcase CodeLensCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\treturn this.applyShowQuickCurrentBranchHistoryCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ShowQuickFileHistory:\n\t\t\t\treturn this.applyShowQuickFileHistoryCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tcase CodeLensCommand.ToggleFileBlame:\n\t\t\t\treturn this.applyToggleFileBlameCommand<GitAuthorsCodeLens>(title, lens);\n\t\t\tdefault:\n\t\t\t\treturn lens;\n\t\t}\n\t}\n\n\tprivate applyDiffWithPreviousCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitBlameCommit | undefined\n\t): T {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: commit\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [lens.uri!.toFileUri(), commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyRevealCommitInViewCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitBlameCommit | undefined\n\t): T {\n\t\tconst commandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\tcommit: commit,\n\t\t\tsha: commit === undefined ? undefined : commit.sha\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: commit !== undefined && commit.isUncommitted ? '' : CodeLensCommand.RevealCommitInView,\n\t\t\targuments: [lens.uri!.toFileUri(), commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyShowCommitsInViewCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tblame: GitBlameLines,\n\t\tcommit?: GitBlameCommit\n\t): T {\n\t\tlet refs;\n\t\tif (commit === undefined) {\n\t\t\trefs = [...Iterables.filterMap(blame.commits.values(), c => (c.isUncommitted ? undefined : c.ref))];\n\t\t} else {\n\t\t\trefs = [commit.ref];\n\t\t}\n\n\t\tconst commandArgs: ShowCommitsInViewCommandArgs = {\n\t\t\trepoPath: blame.repoPath,\n\t\t\trefs: refs\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.ShowCommitsInView,\n\t\t\targuments: [commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCommitDetailsCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitBlameCommit | undefined\n\t): T {\n\t\tconst commandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\tcommit: commit,\n\t\t\tsha: commit === undefined ? undefined : commit.sha\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: commit !== undefined && commit.isUncommitted ? '' : CodeLensCommand.ShowQuickCommitDetails,\n\t\t\targuments: [lens.uri!.toFileUri(), commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCommitFileDetailsCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T,\n\t\tcommit: GitBlameCommit | undefined\n\t): T {\n\t\tconst commandArgs: ShowQuickCommitFileDetailsCommandArgs = {\n\t\t\tcommit: commit,\n\t\t\tsha: commit === undefined ? undefined : commit.sha\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: commit !== undefined && commit.isUncommitted ? '' : CodeLensCommand.ShowQuickCommitFileDetails,\n\t\t\targuments: [lens.uri!.toFileUri(), commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickCurrentBranchHistoryCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T\n\t): T {\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: CodeLensCommand.ShowQuickCurrentBranchHistory,\n\t\t\targuments: [lens.uri!.toFileUri()]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyShowQuickFileHistoryCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T\n\t): T {\n\t\tconst commandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\trange: lens.isFullRange ? undefined : lens.blameRange\n\t\t};\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: CodeLensCommand.ShowQuickFileHistory,\n\t\t\targuments: [lens.uri!.toFileUri(), commandArgs]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate applyToggleFileBlameCommand<T extends GitRecentChangeCodeLens | GitAuthorsCodeLens>(\n\t\ttitle: string,\n\t\tlens: T\n\t): T {\n\t\tlens.command = {\n\t\t\ttitle: title,\n\t\t\tcommand: Commands.ToggleFileBlame,\n\t\t\targuments: [lens.uri!.toFileUri()]\n\t\t};\n\t\treturn lens;\n\t}\n\n\tprivate getDirtyTitle(cfg: CodeLensConfig) {\n\t\tif (cfg.recentChange.enabled && cfg.authors.enabled) {\n\t\t\treturn Container.config.strings.codeLens.unsavedChanges.recentChangeAndAuthors;\n\t\t}\n\t\tif (cfg.recentChange.enabled) return Container.config.strings.codeLens.unsavedChanges.recentChangeOnly;\n\t\treturn Container.config.strings.codeLens.unsavedChanges.authorsOnly;\n\t}\n}\n\nfunction getRangeFromSymbol(symbol: DocumentSymbol | SymbolInformation) {\n\treturn isDocumentSymbol(symbol) ? symbol.range : symbol.location.range;\n}\n\nfunction isDocumentSymbol(symbol: DocumentSymbol | SymbolInformation): symbol is DocumentSymbol {\n\treturn Functions.is<DocumentSymbol>(symbol, 'children');\n}\n","'use strict';\nimport { ConfigurationChangeEvent, Disposable, languages } from 'vscode';\nimport { configuration } from '../configuration';\nimport { CommandContext, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentDirtyIdleTriggerEvent,\n\tGitDocumentState\n} from '../trackers/gitDocumentTracker';\nimport { GitCodeLensProvider } from './codeLensProvider';\n\nexport class GitCodeLensController implements Disposable {\n\tprivate _canToggle: boolean = false;\n\tprivate _disposable: Disposable | undefined;\n\tprivate _provider: GitCodeLensProvider | undefined;\n\tprivate _providerDisposable: Disposable | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis._providerDisposable && this._providerDisposable.dispose();\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\tconfiguration.changed(e, 'codeLens', null) ||\n\t\t\tconfiguration.changed(e, 'defaultDateFormat') ||\n\t\t\tconfiguration.changed(e, 'defaultDateSource') ||\n\t\t\tconfiguration.changed(e, 'defaultDateStyle')\n\t\t) {\n\t\t\tif (!configuration.initializing(e)) {\n\t\t\t\tLogger.log('CodeLens config changed; resetting CodeLens provider');\n\t\t\t}\n\n\t\t\tconst cfg = Container.config.codeLens;\n\t\t\tif (cfg.enabled && (cfg.recentChange.enabled || cfg.authors.enabled)) {\n\t\t\t\tif (this._provider !== undefined) {\n\t\t\t\t\tthis._provider.reset();\n\t\t\t\t} else {\n\t\t\t\t\tthis.createProvider();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this._providerDisposable !== undefined) {\n\t\t\t\t\tthis._providerDisposable.dispose();\n\t\t\t\t\tthis._providerDisposable = undefined;\n\t\t\t\t}\n\t\t\t\tthis._provider = undefined;\n\t\t\t}\n\n\t\t\tthis._canToggle = cfg.recentChange.enabled || cfg.authors.enabled;\n\t\t\tsetCommandContext(CommandContext.CanToggleCodeLens, this._canToggle);\n\t\t}\n\t}\n\n\tprivate onBlameStateChanged(e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\t// Only reset if we have saved, since the code lens won't naturally be re-rendered\n\t\tif (this._provider === undefined || !e.blameable) return;\n\n\t\tLogger.log('Blame state changed; resetting CodeLens provider');\n\t\tthis._provider.reset('saved');\n\t}\n\n\tprivate onDirtyIdleTriggered(e: DocumentDirtyIdleTriggerEvent<GitDocumentState>) {\n\t\tif (this._provider === undefined || !e.document.isBlameable) return;\n\n\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\tif (maxLines > 0 && e.document.lineCount > maxLines) return;\n\n\t\tLogger.log('Dirty idle triggered; resetting CodeLens provider');\n\t\tthis._provider.reset('idle');\n\t}\n\n\ttoggleCodeLens() {\n\t\tif (!this._canToggle) return;\n\n\t\tLogger.log('toggleCodeLens()');\n\t\tif (this._provider !== undefined) {\n\t\t\tif (this._providerDisposable !== undefined) {\n\t\t\t\tthis._providerDisposable.dispose();\n\t\t\t\tthis._providerDisposable = undefined;\n\t\t\t}\n\n\t\t\tthis._provider = undefined;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.createProvider();\n\t}\n\n\tprivate createProvider() {\n\t\tthis._provider = new GitCodeLensProvider(Container.context, Container.git, Container.tracker);\n\t\tthis._providerDisposable = Disposable.from(\n\t\t\tlanguages.registerCodeLensProvider(GitCodeLensProvider.selector, this._provider),\n\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\tContainer.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered, this)\n\t\t);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tHover,\n\tlanguages,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tTextEditor,\n\twindow\n} from 'vscode';\nimport { Annotations } from '../annotations/annotations';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { LinesChangeEvent } from '../trackers/gitLineTracker';\n\nexport class LineHoverController implements Disposable {\n\tprivate _disposable: Disposable;\n\tprivate _hoverProviderDisposable: Disposable | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis.unregister();\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'hovers', 'enabled') &&\n\t\t\t!configuration.changed(e, 'hovers', 'currentLine', 'enabled')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (Container.config.hovers.enabled && Container.config.hovers.currentLine.enabled) {\n\t\t\tContainer.lineTracker.start(\n\t\t\t\tthis,\n\t\t\t\tDisposable.from(Container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this))\n\t\t\t);\n\n\t\t\tthis.register(window.activeTextEditor);\n\t\t} else {\n\t\t\tContainer.lineTracker.stop(this);\n\t\t\tthis.unregister();\n\t\t}\n\t}\n\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\tif (e.pending) return;\n\n\t\tif (e.editor === undefined || e.lines === undefined) {\n\t\t\tthis.unregister();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.reason !== 'editor' && this.registered) return;\n\n\t\tthis.register(e.editor);\n\t}\n\n\tget registered() {\n\t\treturn this._hoverProviderDisposable !== undefined;\n\t}\n\n\tasync provideDetailsHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\ttoken: CancellationToken\n\t): Promise<Hover | undefined> {\n\t\tif (!Container.lineTracker.includes(position.line)) return undefined;\n\n\t\tconst lineState = Container.lineTracker.getState(position.line);\n\t\tconst commit = lineState !== undefined ? lineState.commit : undefined;\n\t\tif (commit === undefined) return undefined;\n\n\t\t// Avoid double annotations if we are showing the whole-file hover blame annotations\n\t\tconst fileAnnotations = await Container.fileAnnotations.getAnnotationType(window.activeTextEditor);\n\t\tif (fileAnnotations !== undefined && Container.config.hovers.annotations.details) return undefined;\n\n\t\tconst wholeLine = Container.config.hovers.currentLine.over === 'line';\n\t\t// If we aren't showing the hover over the whole line, make sure the annotation is on\n\t\tif (!wholeLine && Container.lineAnnotations.suspended) return undefined;\n\n\t\tconst range = document.validateRange(\n\t\t\tnew Range(position.line, wholeLine ? 0 : Number.MAX_SAFE_INTEGER, position.line, Number.MAX_SAFE_INTEGER)\n\t\t);\n\t\tif (!wholeLine && range.start.character !== position.character) return undefined;\n\n\t\t// Get the full commit message -- since blame only returns the summary\n\t\tlet logCommit = lineState !== undefined ? lineState.logCommit : undefined;\n\t\tif (logCommit === undefined && !commit.isUncommitted) {\n\t\t\tlogCommit = await Container.git.getCommitForFile(commit.repoPath, commit.uri.fsPath, {\n\t\t\t\tref: commit.sha\n\t\t\t});\n\t\t\tif (logCommit !== undefined) {\n\t\t\t\t// Preserve the previous commit from the blame commit\n\t\t\t\tlogCommit.previousSha = commit.previousSha;\n\t\t\t\tlogCommit.previousFileName = commit.previousFileName;\n\n\t\t\t\tif (lineState !== undefined) {\n\t\t\t\t\tlineState.logCommit = logCommit;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet editorLine = position.line;\n\t\tconst line = editorLine + 1;\n\t\tconst commitLine = commit.lines.find(l => l.line === line) || commit.lines[0];\n\t\teditorLine = commitLine.originalLine - 1;\n\n\t\tconst trackedDocument = await Container.tracker.get(document);\n\t\tif (trackedDocument === undefined) return undefined;\n\n\t\tconst message = await Annotations.detailsHoverMessage(\n\t\t\tlogCommit || commit,\n\t\t\ttrackedDocument.uri,\n\t\t\teditorLine,\n\t\t\tContainer.config.defaultDateFormat,\n\t\t\tfileAnnotations\n\t\t);\n\t\treturn new Hover(message, range);\n\t}\n\n\tasync provideChangesHover(\n\t\tdocument: TextDocument,\n\t\tposition: Position,\n\t\ttoken: CancellationToken\n\t): Promise<Hover | undefined> {\n\t\tif (!Container.lineTracker.includes(position.line)) return undefined;\n\n\t\tconst lineState = Container.lineTracker.getState(position.line);\n\t\tconst commit = lineState !== undefined ? lineState.commit : undefined;\n\t\tif (commit === undefined) return undefined;\n\n\t\t// Avoid double annotations if we are showing the whole-file hover blame annotations\n\t\tif (Container.config.hovers.annotations.changes) {\n\t\t\tconst fileAnnotations = await Container.fileAnnotations.getAnnotationType(window.activeTextEditor);\n\t\t\tif (fileAnnotations !== undefined) return undefined;\n\t\t}\n\n\t\tconst wholeLine = Container.config.hovers.currentLine.over === 'line';\n\t\t// If we aren't showing the hover over the whole line, make sure the annotation is on\n\t\tif (!wholeLine && Container.lineAnnotations.suspended) return undefined;\n\n\t\tconst range = document.validateRange(\n\t\t\tnew Range(position.line, wholeLine ? 0 : Number.MAX_SAFE_INTEGER, position.line, Number.MAX_SAFE_INTEGER)\n\t\t);\n\t\tif (!wholeLine && range.start.character !== position.character) return undefined;\n\n\t\tconst trackedDocument = await Container.tracker.get(document);\n\t\tif (trackedDocument === undefined) return undefined;\n\n\t\tconst message = await Annotations.changesHoverMessage(commit, trackedDocument.uri, position.line);\n\t\tif (message === undefined) return undefined;\n\n\t\treturn new Hover(message, range);\n\t}\n\n\tprivate register(editor: TextEditor | undefined) {\n\t\tthis.unregister();\n\n\t\tif (editor === undefined) return;\n\n\t\tconst cfg = Container.config.hovers;\n\t\tif (!cfg.enabled || !cfg.currentLine.enabled || (!cfg.currentLine.details && !cfg.currentLine.changes)) return;\n\n\t\tconst subscriptions = [];\n\t\tif (cfg.currentLine.changes) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: editor.document.uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideChangesHover.bind(this)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\tif (cfg.currentLine.details) {\n\t\t\tsubscriptions.push(\n\t\t\t\tlanguages.registerHoverProvider(\n\t\t\t\t\t{ pattern: editor.document.uri.fsPath },\n\t\t\t\t\t{\n\t\t\t\t\t\tprovideHover: this.provideDetailsHover.bind(this)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tthis._hoverProviderDisposable = Disposable.from(...subscriptions);\n\t}\n\n\tprivate unregister() {\n\t\tif (this._hoverProviderDisposable !== undefined) {\n\t\t\tthis._hoverProviderDisposable.dispose();\n\t\t\tthis._hoverProviderDisposable = undefined;\n\t\t}\n\t}\n}\n","'use strict';\nimport { ConfigurationChangeEvent, Disposable, StatusBarAlignment, StatusBarItem, TextEditor, window } from 'vscode';\nimport { Commands } from '../commands';\nimport { configuration, StatusBarCommand } from '../configuration';\nimport { isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { CommitFormatter, GitCommit } from '../git/gitService';\nimport { LinesChangeEvent } from '../trackers/gitLineTracker';\n\nexport class StatusBarController implements Disposable {\n\tprivate _blameStatusBarItem: StatusBarItem | undefined;\n\tprivate _disposable: Disposable;\n\tprivate _modeStatusBarItem: StatusBarItem | undefined;\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis.clearBlame();\n\n\t\tthis._blameStatusBarItem && this._blameStatusBarItem.dispose();\n\t\tthis._modeStatusBarItem && this._modeStatusBarItem.dispose();\n\n\t\tContainer.lineTracker.stop(this);\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, 'mode')) {\n\t\t\tconst mode =\n\t\t\t\tContainer.config.mode.active && Container.config.mode.statusBar.enabled\n\t\t\t\t\t? Container.config.modes[Container.config.mode.active]\n\t\t\t\t\t: undefined;\n\t\t\tif (mode && mode.statusBarItemName) {\n\t\t\t\tconst alignment =\n\t\t\t\t\tContainer.config.mode.statusBar.alignment !== 'left'\n\t\t\t\t\t\t? StatusBarAlignment.Right\n\t\t\t\t\t\t: StatusBarAlignment.Left;\n\n\t\t\t\tif (configuration.changed(e, 'mode', 'statusBar', 'alignment')) {\n\t\t\t\t\tif (this._modeStatusBarItem !== undefined && this._modeStatusBarItem.alignment !== alignment) {\n\t\t\t\t\t\tthis._modeStatusBarItem.dispose();\n\t\t\t\t\t\tthis._modeStatusBarItem = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._modeStatusBarItem =\n\t\t\t\t\tthis._modeStatusBarItem ||\n\t\t\t\t\twindow.createStatusBarItem(alignment, alignment === StatusBarAlignment.Right ? 999 : 1);\n\t\t\t\tthis._modeStatusBarItem.command = Commands.SwitchMode;\n\t\t\t\tthis._modeStatusBarItem.text = mode.statusBarItemName;\n\t\t\t\tthis._modeStatusBarItem.tooltip = 'Switch GitLens Mode';\n\t\t\t\tthis._modeStatusBarItem.show();\n\t\t\t} else if (this._modeStatusBarItem !== undefined) {\n\t\t\t\tthis._modeStatusBarItem.dispose();\n\t\t\t\tthis._modeStatusBarItem = undefined;\n\t\t\t}\n\t\t}\n\n\t\tif (!configuration.changed(e, 'statusBar')) return;\n\n\t\tif (Container.config.statusBar.enabled) {\n\t\t\tconst alignment =\n\t\t\t\tContainer.config.statusBar.alignment !== 'left' ? StatusBarAlignment.Right : StatusBarAlignment.Left;\n\n\t\t\tif (configuration.changed(e, 'statusBar', 'alignment')) {\n\t\t\t\tif (this._blameStatusBarItem !== undefined && this._blameStatusBarItem.alignment !== alignment) {\n\t\t\t\t\tthis._blameStatusBarItem.dispose();\n\t\t\t\t\tthis._blameStatusBarItem = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._blameStatusBarItem =\n\t\t\t\tthis._blameStatusBarItem ||\n\t\t\t\twindow.createStatusBarItem(alignment, alignment === StatusBarAlignment.Right ? 1000 : 0);\n\t\t\tthis._blameStatusBarItem.command = Container.config.statusBar.command;\n\n\t\t\tif (configuration.changed(e, 'statusBar', 'enabled')) {\n\t\t\t\tContainer.lineTracker.start(\n\t\t\t\t\tthis,\n\t\t\t\t\tDisposable.from(Container.lineTracker.onDidChangeActiveLines(this.onActiveLinesChanged, this))\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (configuration.changed(e, 'statusBar', 'enabled')) {\n\t\t\tContainer.lineTracker.stop(this);\n\n\t\t\tif (this._blameStatusBarItem !== undefined) {\n\t\t\t\tthis._blameStatusBarItem.dispose();\n\t\t\t\tthis._blameStatusBarItem = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\t// If we need to reduceFlicker, don't clear if only the selected lines changed\n\t\tlet clear = !(\n\t\t\tContainer.config.statusBar.reduceFlicker &&\n\t\t\te.reason === 'selection' &&\n\t\t\t(e.pending || e.lines !== undefined)\n\t\t);\n\t\tif (!e.pending && e.lines !== undefined) {\n\t\t\tconst state = Container.lineTracker.getState(e.lines[0]);\n\t\t\tif (state !== undefined && state.commit !== undefined) {\n\t\t\t\tthis.updateBlame(state.commit, e.editor!);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclear = true;\n\t\t}\n\n\t\tif (clear) {\n\t\t\tthis.clearBlame();\n\t\t}\n\t}\n\n\tclearBlame() {\n\t\tif (this._blameStatusBarItem !== undefined) {\n\t\t\tthis._blameStatusBarItem.hide();\n\t\t}\n\t}\n\n\tprivate updateBlame(commit: GitCommit, editor: TextEditor) {\n\t\tconst cfg = Container.config.statusBar;\n\t\tif (!cfg.enabled || this._blameStatusBarItem === undefined || !isTextEditor(editor)) return;\n\n\t\tthis._blameStatusBarItem.text = `$(git-commit) ${CommitFormatter.fromTemplate(cfg.format, commit, {\n\t\t\ttruncateMessageAtNewLine: true,\n\t\t\tdateFormat: cfg.dateFormat === null ? Container.config.defaultDateFormat : cfg.dateFormat\n\t\t})}`;\n\n\t\tswitch (cfg.command) {\n\t\t\tcase StatusBarCommand.ToggleFileBlame:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Toggle Blame Annotations';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.DiffWithPrevious:\n\t\t\t\tthis._blameStatusBarItem.command = Commands.DiffLineWithPrevious;\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Compare Line Revision with Previous';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.DiffWithWorking:\n\t\t\t\tthis._blameStatusBarItem.command = Commands.DiffLineWithWorking;\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Compare Line Revision with Working';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ToggleCodeLens:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Toggle Git CodeLens';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCommitDetails:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Show Commit Details';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCommitFileDetails:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Show Line Commit Details';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickFileHistory:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Show File History';\n\t\t\t\tbreak;\n\t\t\tcase StatusBarCommand.ShowQuickCurrentBranchHistory:\n\t\t\t\tthis._blameStatusBarItem.tooltip = 'Show Branch History';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._blameStatusBarItem.show();\n\t}\n}\n","'use strict';\nimport { Disposable, Event, EventEmitter, TextEditor, TextEditorSelectionChangeEvent, window } from 'vscode';\nimport { isTextEditor } from '../constants';\nimport { Deferrable, Functions } from '../system';\n\nexport interface LinesChangeEvent {\n\treadonly editor: TextEditor | undefined;\n\treadonly lines: number[] | undefined;\n\n\treadonly reason: 'editor' | 'selection';\n\treadonly pending?: boolean;\n}\n\nexport class LineTracker<T> implements Disposable {\n\tprivate _onDidChangeActiveLines = new EventEmitter<LinesChangeEvent>();\n\tget onDidChangeActiveLines(): Event<LinesChangeEvent> {\n\t\treturn this._onDidChangeActiveLines.event;\n\t}\n\n\tprotected _disposable: Disposable | undefined;\n\tprivate _editor: TextEditor | undefined;\n\n\tprivate readonly _state: Map<number, T | undefined> = new Map();\n\n\tdispose() {\n\t\tthis.stop();\n\t}\n\n\tprivate onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (this._editor === editor) return;\n\t\tif (editor !== undefined && !isTextEditor(editor)) return;\n\n\t\tthis.reset();\n\t\tthis._editor = editor;\n\t\tthis._lines = editor !== undefined ? editor.selections.map(s => s.active.line) : undefined;\n\n\t\tthis.trigger('editor');\n\t}\n\n\tprivate onTextEditorSelectionChanged(e: TextEditorSelectionChangeEvent) {\n\t\t// If this isn't for our cached editor and its not a real editor -- kick out\n\t\tif (this._editor !== e.textEditor && !isTextEditor(e.textEditor)) return;\n\n\t\tconst reason = this._editor === e.textEditor ? 'selection' : 'editor';\n\n\t\tconst lines = e.selections.map(s => s.active.line);\n\t\tif (this._editor === e.textEditor && this.includesAll(lines)) return;\n\n\t\tthis.reset();\n\t\tthis._editor = e.textEditor;\n\t\tthis._lines = lines;\n\t\tthis.trigger(reason);\n\t}\n\n\tgetState(line: number): T | undefined {\n\t\treturn this._state.get(line);\n\t}\n\n\tsetState(line: number, state: T | undefined) {\n\t\tthis._state.set(line, state);\n\t}\n\n\tprivate _lines: number[] | undefined;\n\tget lines(): number[] | undefined {\n\t\treturn this._lines;\n\t}\n\n\tincludes(line: number): boolean {\n\t\treturn this._lines !== undefined && this._lines.includes(line);\n\t}\n\n\tincludesAll(lines: number[] | undefined): boolean {\n\t\treturn LineTracker.includesAll(lines, this._lines);\n\t}\n\n\trefresh() {\n\t\tthis.trigger('editor');\n\t}\n\n\treset() {\n\t\tthis._state.clear();\n\t}\n\n\tstart(subscriber?: any, subscription?: Disposable): void {\n\t\tif (this._disposable !== undefined) return;\n\n\t\tthis._disposable = Disposable.from(\n\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveTextEditorChanged, 0), this),\n\t\t\twindow.onDidChangeTextEditorSelection(this.onTextEditorSelectionChanged, this)\n\t\t);\n\n\t\tsetImmediate(() => this.onActiveTextEditorChanged(window.activeTextEditor));\n\t}\n\n\tstop(subscriber?: any) {\n\t\tif (this._disposable === undefined) return;\n\n\t\tif (this._linesChangedDebounced !== undefined) {\n\t\t\tthis._linesChangedDebounced.cancel();\n\t\t}\n\n\t\tthis._disposable.dispose();\n\t\tthis._disposable = undefined;\n\t}\n\n\tprotected fireLinesChanged(e: LinesChangeEvent) {\n\t\tthis._onDidChangeActiveLines.fire(e);\n\t}\n\n\tprotected trigger(reason: 'editor' | 'selection') {\n\t\tthis.onLinesChanged({ editor: this._editor, lines: this._lines, reason: reason });\n\t}\n\n\tprivate _linesChangedDebounced: (((e: LinesChangeEvent) => void) & Deferrable) | undefined;\n\n\tprivate onLinesChanged(e: LinesChangeEvent) {\n\t\tif (e.lines === undefined) {\n\t\t\tsetImmediate(() => {\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tif (this._linesChangedDebounced !== undefined) {\n\t\t\t\t\tthis._linesChangedDebounced.cancel();\n\t\t\t\t}\n\n\t\t\t\tvoid this.fireLinesChanged(e);\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._linesChangedDebounced === undefined) {\n\t\t\tthis._linesChangedDebounced = Functions.debounce(\n\t\t\t\t(e: LinesChangeEvent) => {\n\t\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\t\t\t\t\t// Make sure we are still on the same lines\n\t\t\t\t\tif (!LineTracker.includesAll(e.lines, e.editor && e.editor.selections.map(s => s.active.line))) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvoid this.fireLinesChanged(e);\n\t\t\t\t},\n\t\t\t\t250,\n\t\t\t\t{ track: true }\n\t\t\t);\n\t\t}\n\n\t\t// If we have no pending moves, then fire an immediate pending event, and defer the real event\n\t\tif (!this._linesChangedDebounced.pending!()) {\n\t\t\tvoid this.fireLinesChanged({ ...e, pending: true });\n\t\t}\n\n\t\tthis._linesChangedDebounced(e);\n\t}\n\n\tstatic includesAll(lines1: number[] | undefined, lines2: number[] | undefined): boolean {\n\t\tif (lines1 === undefined && lines2 === undefined) return true;\n\t\tif (lines1 === undefined || lines2 === undefined) return false;\n\n\t\treturn lines2.length === lines1.length && lines2.every((v, i) => v === lines1[i]);\n\t}\n}\n","'use strict';\nimport { Disposable, TextEditor } from 'vscode';\nimport { Container } from '../container';\nimport { GitBlameCommit, GitLogCommit } from '../git/gitService';\nimport {\n\tDocumentBlameStateChangeEvent,\n\tDocumentDirtyIdleTriggerEvent,\n\tDocumentDirtyStateChangeEvent,\n\tGitDocumentState\n} from './gitDocumentTracker';\nimport { LinesChangeEvent, LineTracker } from './lineTracker';\n\nexport * from './lineTracker';\n\nexport class GitLineState {\n\tconstructor(public readonly commit: GitBlameCommit | undefined, public logCommit?: GitLogCommit) {}\n}\n\nexport class GitLineTracker extends LineTracker<GitLineState> {\n\tprivate _count = 0;\n\tprivate _subscriptions: Map<any, Disposable> = new Map();\n\n\tprotected async fireLinesChanged(e: LinesChangeEvent) {\n\t\tthis.reset();\n\n\t\tlet updated = false;\n\t\tif (!this._suspended && !e.pending && e.lines !== undefined && e.editor !== undefined) {\n\t\t\tupdated = await this.updateState(e.lines, e.editor);\n\t\t}\n\n\t\treturn super.fireLinesChanged(updated ? e : { ...e, lines: undefined });\n\t}\n\n\tprivate onBlameStateChanged(e: DocumentBlameStateChangeEvent<GitDocumentState>) {\n\t\tthis.trigger('editor');\n\t}\n\n\tprivate onDirtyIdleTriggered(e: DocumentDirtyIdleTriggerEvent<GitDocumentState>) {\n\t\tconst maxLines = Container.config.advanced.blame.sizeThresholdAfterEdit;\n\t\tif (maxLines > 0 && e.document.lineCount > maxLines) return;\n\n\t\tthis.resume();\n\t}\n\n\tprivate onDirtyStateChanged(e: DocumentDirtyStateChangeEvent<GitDocumentState>) {\n\t\tif (e.dirty) {\n\t\t\tthis.suspend();\n\t\t} else {\n\t\t\tthis.resume({ force: true });\n\t\t}\n\t}\n\n\tprivate _suspended = false;\n\n\tprivate resume(options: { force?: boolean } = {}) {\n\t\tif (!options.force && !this._suspended) return;\n\n\t\tthis._suspended = false;\n\t\tthis.trigger('editor');\n\t}\n\n\tprivate suspend(options: { force?: boolean } = {}) {\n\t\tif (!options.force && this._suspended) return;\n\n\t\tthis._suspended = true;\n\t\tthis.trigger('editor');\n\t}\n\n\tisSubscribed(subscriber: any) {\n\t\treturn this._subscriptions.has(subscriber);\n\t}\n\n\tstart(subscriber: any, subscription: Disposable): Disposable {\n\t\tconst disposable = {\n\t\t\tdispose: () => this.stop(subscriber)\n\t\t};\n\n\t\tif (this.isSubscribed(subscriber)) return disposable;\n\n\t\tthis._subscriptions.set(subscriber, subscription);\n\n\t\tthis._count++;\n\t\tif (this._count === 1) {\n\t\t\tsuper.start();\n\n\t\t\tthis._disposable = Disposable.from(\n\t\t\t\tthis._disposable!,\n\t\t\t\tContainer.tracker.onDidChangeBlameState(this.onBlameStateChanged, this),\n\t\t\t\tContainer.tracker.onDidChangeDirtyState(this.onDirtyStateChanged, this),\n\t\t\t\tContainer.tracker.onDidTriggerDirtyIdle(this.onDirtyIdleTriggered, this)\n\t\t\t);\n\t\t}\n\n\t\treturn disposable;\n\t}\n\n\tstop(subscriber: any) {\n\t\tconst subscription = this._subscriptions.get(subscriber);\n\t\tif (subscription === undefined) return;\n\n\t\tthis._subscriptions.delete(subscriber);\n\t\tsubscription.dispose();\n\n\t\tif (this._disposable === undefined) {\n\t\t\tthis._count = 0;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._count--;\n\t\tif (this._count === 0) {\n\t\t\tsuper.stop();\n\t\t}\n\t}\n\n\tprivate async updateState(lines: number[], editor: TextEditor): Promise<boolean> {\n\t\tconst trackedDocument = await Container.tracker.getOrAdd(editor.document);\n\t\tif (!trackedDocument.isBlameable || !this.includesAll(lines)) return false;\n\n\t\tif (lines.length === 1) {\n\t\t\tconst blameLine = editor.document.isDirty\n\t\t\t\t? await Container.git.getBlameForLineContents(trackedDocument.uri, lines[0], editor.document.getText())\n\t\t\t\t: await Container.git.getBlameForLine(trackedDocument.uri, lines[0]);\n\t\t\tif (blameLine === undefined) return false;\n\n\t\t\tthis.setState(blameLine.line.line - 1, new GitLineState(blameLine.commit));\n\t\t} else {\n\t\t\tconst blame = editor.document.isDirty\n\t\t\t\t? await Container.git.getBlameForFileContents(trackedDocument.uri, editor.document.getText())\n\t\t\t\t: await Container.git.getBlameForFile(trackedDocument.uri);\n\t\t\tif (blame === undefined) return false;\n\n\t\t\tfor (const line of lines) {\n\t\t\t\tconst commitLine = blame.lines[line];\n\t\t\t\tthis.setState(line, new GitLineState(blame.commits.get(commitLine.sha)));\n\t\t\t}\n\t\t}\n\n\t\tif (!trackedDocument.isBlameable || !this.includesAll(lines)) return false;\n\n\t\tif (editor.document.isDirty) {\n\t\t\ttrackedDocument.setForceDirtyStateChangeOnNextDocumentChange();\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tConfigurationTarget,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tMessageItem,\n\tTreeDataProvider,\n\tTreeItem,\n\tTreeItemCollapsibleState,\n\tTreeView,\n\tTreeViewExpansionEvent,\n\tTreeViewVisibilityChangeEvent,\n\twindow\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { debug, Functions, log, Strings } from '../system';\nimport { CompareView } from './compareView';\nimport { FileHistoryView } from './fileHistoryView';\nimport { LineHistoryView } from './lineHistoryView';\nimport { PageableViewNode, ViewNode } from './nodes';\nimport { RepositoriesView } from './repositoriesView';\nimport { SearchView } from './searchView';\n\nexport type View = RepositoriesView | FileHistoryView | LineHistoryView | CompareView | SearchView;\nexport type ViewWithFiles = RepositoriesView | CompareView | SearchView;\n\nexport interface TreeViewNodeStateChangeEvent<T> extends TreeViewExpansionEvent<T> {\n\tstate: TreeItemCollapsibleState;\n}\n\nexport abstract class ViewBase<TRoot extends ViewNode<View>> implements TreeDataProvider<ViewNode>, Disposable {\n\tprotected _onDidChangeTreeData = new EventEmitter<ViewNode>();\n\tget onDidChangeTreeData(): Event<ViewNode> {\n\t\treturn this._onDidChangeTreeData.event;\n\t}\n\n\tprivate _onDidChangeVisibility = new EventEmitter<TreeViewVisibilityChangeEvent>();\n\tget onDidChangeVisibility(): Event<TreeViewVisibilityChangeEvent> {\n\t\treturn this._onDidChangeVisibility.event;\n\t}\n\n\tprivate _onDidChangeNodeState = new EventEmitter<TreeViewNodeStateChangeEvent<ViewNode>>();\n\tget onDidChangeNodeState(): Event<TreeViewNodeStateChangeEvent<ViewNode>> {\n\t\treturn this._onDidChangeNodeState.event;\n\t}\n\n\tprotected _disposable: Disposable | undefined;\n\tprivate readonly _lastMaxCounts = new Map<string, number | undefined>();\n\tprotected _root: TRoot | undefined;\n\tprotected _tree: TreeView<ViewNode> | undefined;\n\n\tconstructor(public readonly id: string, public readonly name: string) {\n\t\tif (Logger.isDebugging) {\n\t\t\tconst fn = this.getTreeItem;\n\t\t\tthis.getTreeItem = async function(this: ViewBase<TRoot>, node: ViewNode) {\n\t\t\t\tconst item = await fn.apply(this, [node]);\n\n\t\t\t\titem.tooltip = `${item.tooltip || item.label}\\n\\nDBG: ${node.toString()}, ${item.contextValue}`;\n\t\t\t\treturn item;\n\t\t\t};\n\t\t}\n\n\t\tthis.registerCommands();\n\n\t\tContainer.context.subscriptions.push(configuration.onDidChange(this.onConfigurationChanged, this));\n\t\tsetImmediate(() => this.onConfigurationChanged(configuration.initializingChangeEvent));\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tgetQualifiedCommand(command: string) {\n\t\treturn `${this.id}.${command}`;\n\t}\n\n\tprotected abstract get location(): string;\n\n\tprotected abstract getRoot(): TRoot;\n\tprotected abstract registerCommands(): void;\n\tprotected abstract onConfigurationChanged(e: ConfigurationChangeEvent): void;\n\n\tprotected initialize(container?: string, options: { showCollapseAll?: boolean } = {}) {\n\t\tif (this._disposable) {\n\t\t\tthis._disposable.dispose();\n\t\t\tthis._onDidChangeTreeData = new EventEmitter<ViewNode>();\n\t\t}\n\n\t\tthis._tree = window.createTreeView(`${this.id}${container ? `:${container}` : ''}`, {\n\t\t\t...options,\n\t\t\ttreeDataProvider: this\n\t\t});\n\t\tthis._disposable = Disposable.from(\n\t\t\tthis._tree,\n\t\t\tthis._tree.onDidChangeVisibility(Functions.debounce(this.onVisibilityChanged, 250), this),\n\t\t\tthis._tree.onDidCollapseElement(this.onElementCollapsed, this),\n\t\t\tthis._tree.onDidExpandElement(this.onElementExpanded, this)\n\t\t);\n\t}\n\n\tprotected ensureRoot() {\n\t\tif (this._root === undefined) {\n\t\t\tthis._root = this.getRoot();\n\t\t}\n\n\t\treturn this._root;\n\t}\n\n\tgetChildren(node?: ViewNode): ViewNode[] | Promise<ViewNode[]> {\n\t\tif (node !== undefined) return node.getChildren();\n\n\t\tconst root = this.ensureRoot();\n\t\treturn root.getChildren();\n\t}\n\n\tgetParent(node: ViewNode): ViewNode | undefined {\n\t\treturn node.getParent();\n\t}\n\n\tgetTreeItem(node: ViewNode): TreeItem | Promise<TreeItem> {\n\t\treturn node.getTreeItem();\n\t}\n\n\tprotected onElementCollapsed(e: TreeViewExpansionEvent<ViewNode>) {\n\t\t// Clear any last max count if the node was collapsed\n\t\tif (PageableViewNode.is(e.element)) {\n\t\t\tthis.resetNodeLastMaxCount(e.element);\n\t\t}\n\n\t\tthis._onDidChangeNodeState.fire({ ...e, state: TreeItemCollapsibleState.Collapsed });\n\t}\n\n\tprotected onElementExpanded(e: TreeViewExpansionEvent<ViewNode>) {\n\t\tthis._onDidChangeNodeState.fire({ ...e, state: TreeItemCollapsibleState.Expanded });\n\t}\n\n\tprotected onVisibilityChanged(e: TreeViewVisibilityChangeEvent) {\n\t\tthis._onDidChangeVisibility.fire(e);\n\t}\n\n\tget selection(): ViewNode[] {\n\t\tif (this._tree === undefined || this._root === undefined) return [];\n\n\t\treturn this._tree.selection;\n\t}\n\n\tget visible(): boolean {\n\t\treturn this._tree !== undefined ? this._tree.visible : false;\n\t}\n\n\tasync findNode(\n\t\tid: string,\n\t\toptions?: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t}\n\t): Promise<ViewNode | undefined>;\n\tasync findNode(\n\t\tpredicate: (node: ViewNode) => boolean,\n\t\toptions?: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t}\n\t): Promise<ViewNode | undefined>;\n\t@log({\n\t\targs: {\n\t\t\t0: (predicate: string | ((node: ViewNode) => boolean)) =>\n\t\t\t\ttypeof predicate === 'string' ? predicate : 'function',\n\t\t\t1: (opts: {\n\t\t\t\tallowPaging?: boolean;\n\t\t\t\tcanTraverse?: (node: ViewNode) => boolean;\n\t\t\t\tmaxDepth?: number;\n\t\t\t\ttoken?: CancellationToken;\n\t\t\t}) => `options=${JSON.stringify({ ...opts, canTraverse: undefined, token: undefined })}`\n\t\t}\n\t})\n\tasync findNode(\n\t\tpredicate: string | ((node: ViewNode) => boolean),\n\t\t{\n\t\t\tallowPaging = false,\n\t\t\tcanTraverse,\n\t\t\tmaxDepth = 2,\n\t\t\ttoken\n\t\t}: {\n\t\t\tallowPaging?: boolean;\n\t\t\tcanTraverse?: (node: ViewNode) => boolean;\n\t\t\tmaxDepth?: number;\n\t\t\ttoken?: CancellationToken;\n\t\t} = {}\n\t): Promise<ViewNode | undefined> {\n\t\t// If we have no root (e.g. never been initialized) force it so the tree will load properly\n\t\tif (this._root === undefined) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\t// const node = await this.findNodeCoreDFS(\n\t\t// \ttypeof predicate === 'string' ? n => n.id === predicate : predicate,\n\t\t// \tawait this.ensureRoot().getChildren(),\n\t\t// \tallowPaging,\n\t\t// \tcanTraverse,\n\t\t// \tmaxDepth\n\t\t// );\n\n\t\tconst node = await this.findNodeCoreBFS(\n\t\t\ttypeof predicate === 'string' ? n => n.id === predicate : predicate,\n\t\t\tthis.ensureRoot(),\n\t\t\tallowPaging,\n\t\t\tcanTraverse,\n\t\t\tmaxDepth,\n\t\t\ttoken\n\t\t);\n\n\t\treturn node;\n\t}\n\n\t// private async findNodeCoreDFS(\n\t// \tpredicate: (node: ViewNode) => boolean,\n\t// \tnodes: ViewNode[],\n\t// \tallowPaging: boolean,\n\t// \tcanTraverse: ((node: ViewNode) => boolean) | undefined,\n\t// \tdepth: number\n\t// ): Promise<ViewNode | undefined> {\n\t// \tif (depth === 0) return undefined;\n\n\t// \tconst defaultPageSize = Container.config.advanced.maxListItems;\n\n\t// \tlet child;\n\t// \tlet children;\n\t// \tfor (const node of nodes) {\n\t// \t\tif (canTraverse !== undefined && !canTraverse(node)) continue;\n\n\t// \t\tchildren = await node.getChildren();\n\t// \t\tif (children.length === 0) continue;\n\n\t// \t\tchild = children.find(predicate);\n\t// \t\tif (child !== undefined) return child;\n\n\t// \t\tif (PageableViewNode.is(node)) {\n\t// \t\t\tif (node.maxCount !== 0 && allowPaging) {\n\t// \t\t\t\tlet pageSize = defaultPageSize === 0 ? 0 : (node.maxCount || 0) + defaultPageSize;\n\t// \t\t\t\twhile (true) {\n\t// \t\t\t\t\tawait this.showMoreNodeChildren(node, pageSize);\n\n\t// \t\t\t\t\tchild = (await node.getChildren()).find(predicate);\n\t// \t\t\t\t\tif (child !== undefined) return child;\n\n\t// \t\t\t\t\tif (pageSize === 0) break;\n\n\t// \t\t\t\t\tpageSize = 0;\n\t// \t\t\t\t}\n\t// \t\t\t}\n\n\t// \t\t\t// Don't traverse into paged children\n\t// \t\t\tcontinue;\n\t// \t\t}\n\n\t// \t\treturn this.findNodeCoreDFS(predicate, children, allowPaging, canTraverse, depth - 1);\n\t// \t}\n\n\t// \treturn undefined;\n\t// }\n\n\tprivate async findNodeCoreBFS(\n\t\tpredicate: (node: ViewNode) => boolean,\n\t\troot: ViewNode,\n\t\tallowPaging: boolean,\n\t\tcanTraverse: ((node: ViewNode) => boolean) | undefined,\n\t\tmaxDepth: number,\n\t\ttoken: CancellationToken | undefined\n\t): Promise<ViewNode | undefined> {\n\t\tconst queue: (ViewNode | undefined)[] = [root, undefined];\n\n\t\tconst defaultPageSize = Container.config.advanced.maxListItems;\n\n\t\tlet depth = 0;\n\t\tlet node: ViewNode | undefined;\n\t\tlet children: ViewNode[];\n\t\twhile (queue.length > 1) {\n\t\t\tif (token !== undefined && token.isCancellationRequested) return undefined;\n\n\t\t\tnode = queue.shift();\n\t\t\tif (node === undefined) {\n\t\t\t\tdepth++;\n\n\t\t\t\tqueue.push(undefined);\n\t\t\t\tif (depth > maxDepth) break;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (predicate(node)) return node;\n\t\t\tif (canTraverse !== undefined && !canTraverse(node)) continue;\n\n\t\t\tchildren = await node.getChildren();\n\t\t\tif (children.length === 0) continue;\n\n\t\t\tif (PageableViewNode.is(node)) {\n\t\t\t\tlet child = children.find(predicate);\n\t\t\t\tif (child !== undefined) return child;\n\n\t\t\t\tif (node.maxCount !== 0 && allowPaging) {\n\t\t\t\t\tlet pageSize = defaultPageSize === 0 ? 0 : (node.maxCount || 0) + defaultPageSize;\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tif (token !== undefined && token.isCancellationRequested) return undefined;\n\n\t\t\t\t\t\tawait this.showMoreNodeChildren(node, pageSize);\n\n\t\t\t\t\t\tchild = (await node.getChildren()).find(predicate);\n\t\t\t\t\t\tif (child !== undefined) return child;\n\n\t\t\t\t\t\tif (pageSize === 0) break;\n\n\t\t\t\t\t\tpageSize = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Don't traverse into paged children\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tqueue.push(...children);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tasync refresh(reset: boolean = false) {\n\t\tif (this._root !== undefined && this._root.refresh !== undefined) {\n\t\t\tawait this._root.refresh(reset);\n\t\t}\n\n\t\tthis.triggerNodeChange();\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tasync refreshNode(node: ViewNode, reset: boolean = false) {\n\t\tif (node.refresh !== undefined) {\n\t\t\tconst cancel = await node.refresh(reset);\n\t\t\tif (cancel === true) return;\n\t\t}\n\n\t\tthis.triggerNodeChange(node);\n\t}\n\n\t@log({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tasync reveal(\n\t\tnode: ViewNode,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t}\n\t) {\n\t\tif (this._tree === undefined) return;\n\n\t\ttry {\n\t\t\tawait this._tree.reveal(node, options);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\t@log()\n\tasync show() {\n\t\tconst location = this.location;\n\n\t\ttry {\n\t\t\tvoid (await commands.executeCommand(`${this.id}${location ? `:${location}` : ''}.focus`));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\n\t\t\tconst section = Strings.splitSingle(this.id, '.')[1];\n\t\t\tif (!configuration.get(section as any, 'enabled')) {\n\t\t\t\tconst actions: MessageItem[] = [{ title: 'Enable' }, { title: 'Cancel', isCloseAffordance: true }];\n\n\t\t\t\tconst result = await window.showErrorMessage(\n\t\t\t\t\t`Unable to show the ${this.name} view since it's currently disabled. Would you like to enable it?`,\n\t\t\t\t\t...actions\n\t\t\t\t);\n\n\t\t\t\tif (result === actions[0]) {\n\t\t\t\t\tawait configuration.update(section as any, 'enabled', true, ConfigurationTarget.Global);\n\n\t\t\t\t\tvoid (await commands.executeCommand(`${this.id}${location ? `:${location}` : ''}.focus`));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tgetNodeLastMaxCount(node: PageableViewNode) {\n\t\treturn node.id === undefined ? undefined : this._lastMaxCounts.get(node.id);\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tresetNodeLastMaxCount(node: PageableViewNode) {\n\t\tif (node.id === undefined || !node.rememberLastMaxCount) return;\n\n\t\tthis._lastMaxCounts.delete(node.id);\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (n: ViewNode & PageableViewNode) => n.toString(),\n\t\t\t3: (n?: ViewNode) => (n === undefined ? '' : n.toString())\n\t\t}\n\t})\n\tasync showMoreNodeChildren(\n\t\tnode: ViewNode & PageableViewNode,\n\t\tmaxCount: number | undefined,\n\t\tpreviousNode?: ViewNode\n\t) {\n\t\tif (node.maxCount === maxCount) return Promise.resolve();\n\n\t\tif (maxCount === undefined || maxCount === 0) {\n\t\t\tnode.maxCount = maxCount;\n\t\t} else {\n\t\t\tnode.maxCount = (node.maxCount || maxCount) + maxCount;\n\t\t}\n\n\t\tif (node.rememberLastMaxCount) {\n\t\t\tthis._lastMaxCounts.set(node.id!, node.maxCount);\n\t\t}\n\n\t\tif (previousNode !== undefined) {\n\t\t\tvoid (await this.reveal(previousNode, { select: true }));\n\t\t}\n\n\t\treturn this.refreshNode(node);\n\t}\n\n\t@debug({\n\t\targs: { 0: (n: ViewNode) => (n != null ? n.toString() : '') }\n\t})\n\ttriggerNodeChange(node?: ViewNode) {\n\t\t// Since the root node won't actually refresh, force everything\n\t\tthis._onDidChangeTreeData.fire(node !== undefined && node !== this._root ? node : undefined);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { CompareViewConfig, configuration, ViewFilesLayout, ViewsConfig } from '../configuration';\nimport {\n\tCommandContext,\n\tNamedRef,\n\tPinnedComparison,\n\tPinnedComparisons,\n\tsetCommandContext,\n\tWorkspaceState\n} from '../constants';\nimport { Container } from '../container';\nimport { CompareNode, CompareResultsNode, nodeSupportsConditionalDismissal, ViewNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class CompareView extends ViewBase<CompareNode> {\n\tconstructor() {\n\t\tsuper('gitlens.views.compare', 'Compare');\n\n\t\tsetCommandContext(CommandContext.ViewsCompareKeepResults, this.keepResults);\n\t}\n\n\tgetRoot() {\n\t\treturn new CompareNode(this);\n\t}\n\n\tprotected get location(): string {\n\t\treturn this.config.location;\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('clear'), () => this.clear(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setKeepResultsToOn'), () => this.setKeepResults(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setKeepResultsToOff'),\n\t\t\t() => this.setKeepResults(false),\n\t\t\tthis\n\t\t);\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('pinComparison'), this.pinComparison, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('unpinComparison'), this.unpinComparison, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('swapComparison'), this.swapComparison, this);\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('selectForCompare'), this.selectForCompare, this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('compareWithSelected'), this.compareWithSelected, this);\n\t}\n\n\tprotected onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'views', 'compare') &&\n\t\t\t!configuration.changed(e, 'views') &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'compare', 'location')) {\n\t\t\tthis.initialize(this.config.location, { showCollapseAll: true });\n\t\t}\n\n\t\tif (!configuration.initializing(e) && this._root !== undefined) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tget config(): ViewsConfig & CompareViewConfig {\n\t\treturn { ...Container.config.views, ...Container.config.views.compare };\n\t}\n\n\tget keepResults(): boolean {\n\t\treturn Container.context.workspaceState.get<boolean>(WorkspaceState.ViewsCompareKeepResults, false);\n\t}\n\n\tclear() {\n\t\tif (this._root === undefined) return;\n\n\t\tthis._root.clear();\n\t}\n\n\tdismissNode(node: ViewNode) {\n\t\tif (this._root === undefined) return;\n\t\tif (nodeSupportsConditionalDismissal(node) && node.canDismiss() === false) return;\n\n\t\tthis._root.dismiss(node);\n\t}\n\n\tcompare(repoPath: string, ref1: string | NamedRef, ref2: string | NamedRef) {\n\t\treturn this.addResults(\n\t\t\tnew CompareResultsNode(\n\t\t\t\tthis,\n\t\t\t\trepoPath,\n\t\t\t\ttypeof ref1 === 'string' ? { ref: ref1 } : ref1,\n\t\t\t\ttypeof ref2 === 'string' ? { ref: ref2 } : ref2\n\t\t\t)\n\t\t);\n\t}\n\n\tcompareWithSelected(repoPath?: string, ref?: string | NamedRef) {\n\t\tconst root = this.ensureRoot();\n\t\tvoid root.compareWithSelected(repoPath, ref);\n\t}\n\n\tselectForCompare(repoPath?: string, ref?: string | NamedRef) {\n\t\tconst root = this.ensureRoot();\n\t\tvoid root.selectForCompare(repoPath, ref);\n\t}\n\n\tgetPinnedComparisons() {\n\t\tconst pinned = Container.context.workspaceState.get<PinnedComparisons>(WorkspaceState.PinnedComparisons);\n\t\tif (pinned == null) return [];\n\n\t\treturn Object.values(pinned).map(p => new CompareResultsNode(this, p.path, p.ref1, p.ref2, true, p.notation));\n\t}\n\n\tasync updatePinnedComparison(id: string, pin?: PinnedComparison) {\n\t\tlet pinned = Container.context.workspaceState.get<PinnedComparisons>(WorkspaceState.PinnedComparisons);\n\t\tif (pinned == null) {\n\t\t\tpinned = Object.create(null);\n\t\t}\n\n\t\tif (pin !== undefined) {\n\t\t\tpinned![id] = { ...pin };\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\tconst { [id]: _, ...rest } = pinned!;\n\t\t\tpinned = rest;\n\t\t}\n\n\t\tawait Container.context.workspaceState.update(WorkspaceState.PinnedComparisons, pinned);\n\t}\n\n\tprivate async addResults(results: ViewNode) {\n\t\tif (!this.visible) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\tconst root = this.ensureRoot();\n\t\troot.addOrReplace(results, !this.keepResults);\n\n\t\tsetImmediate(() => this.reveal(results, { expand: true, focus: true, select: true }));\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective('views', 'compare', 'files', 'layout', layout);\n\t}\n\n\tprivate setKeepResults(enabled: boolean) {\n\t\tContainer.context.workspaceState.update(WorkspaceState.ViewsCompareKeepResults, enabled);\n\t\tsetCommandContext(CommandContext.ViewsCompareKeepResults, enabled);\n\t}\n\n\tprivate pinComparison(node: ViewNode) {\n\t\tif (!(node instanceof CompareResultsNode)) return undefined;\n\n\t\treturn node.pin();\n\t}\n\n\tprivate swapComparison(node: ViewNode) {\n\t\tif (!(node instanceof CompareResultsNode)) return undefined;\n\n\t\treturn node.swap();\n\t}\n\n\tprivate unpinComparison(node: ViewNode) {\n\t\tif (!(node instanceof CompareResultsNode)) return undefined;\n\n\t\treturn node.unpin();\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { configuration, FileHistoryViewConfig, ViewsConfig } from '../configuration';\nimport { CommandContext, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { FileHistoryTrackerNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class FileHistoryView extends ViewBase<FileHistoryTrackerNode> {\n\tconstructor() {\n\t\tsuper('gitlens.views.fileHistory', 'File History');\n\t}\n\n\tgetRoot() {\n\t\treturn new FileHistoryTrackerNode(this);\n\t}\n\n\tprotected get location(): string {\n\t\treturn this.config.location;\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('changeBase'), () => this.changeBase(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOn'),\n\t\t\t() => this.setEditorFollowing(true),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOff'),\n\t\t\t() => this.setEditorFollowing(false),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOn'),\n\t\t\t() => this.setRenameFollowing(true),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOff'),\n\t\t\t() => this.setRenameFollowing(false),\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'views', 'fileHistory') &&\n\t\t\t!configuration.changed(e, 'views') &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'advanced', 'fileHistoryFollowsRenames')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'fileHistory', 'enabled')) {\n\t\t\tsetCommandContext(CommandContext.ViewsFileHistoryEditorFollowing, true);\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'fileHistory', 'location')) {\n\t\t\tthis.initialize(this.config.location);\n\t\t}\n\n\t\tif (!configuration.initializing(e) && this._root !== undefined) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tget config(): ViewsConfig & FileHistoryViewConfig {\n\t\treturn { ...Container.config.views, ...Container.config.views.fileHistory };\n\t}\n\n\tasync showHistoryForUri(uri: GitUri, baseRef?: string) {\n\t\tconst root = this.ensureRoot();\n\n\t\tthis.setEditorFollowing(false);\n\t\tawait root.showHistoryForUri(uri, baseRef);\n\t\treturn this.show();\n\t}\n\n\tprivate changeBase() {\n\t\tif (this._root !== undefined) {\n\t\t\tvoid this._root.changeBase();\n\t\t}\n\t}\n\n\tprivate setEditorFollowing(enabled: boolean) {\n\t\tsetCommandContext(CommandContext.ViewsFileHistoryEditorFollowing, enabled);\n\t\tif (this._root !== undefined) {\n\t\t\tthis._root.setEditorFollowing(enabled);\n\t\t}\n\t}\n\n\tprivate setRenameFollowing(enabled: boolean) {\n\t\treturn configuration.updateEffective('advanced', 'fileHistoryFollowsRenames', enabled);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { configuration, LineHistoryViewConfig, ViewsConfig } from '../configuration';\nimport { CommandContext, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { LineHistoryTrackerNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\nexport class LineHistoryView extends ViewBase<LineHistoryTrackerNode> {\n\tconstructor() {\n\t\tsuper('gitlens.views.lineHistory', 'Line History');\n\t}\n\n\tgetRoot() {\n\t\treturn new LineHistoryTrackerNode(this);\n\t}\n\n\tprotected get location(): string {\n\t\treturn this.config.location;\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(this.getQualifiedCommand('changeBase'), () => this.changeBase(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOn'),\n\t\t\t() => this.setEditorFollowing(true),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setEditorFollowingOff'),\n\t\t\t() => this.setEditorFollowing(false),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOn'),\n\t\t\t() => this.setRenameFollowing(true),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setRenameFollowingOff'),\n\t\t\t() => this.setRenameFollowing(false),\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'views', 'lineHistory') &&\n\t\t\t!configuration.changed(e, 'views') &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'advanced', 'fileHistoryFollowsRenames')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'lineHistory', 'enabled')) {\n\t\t\tsetCommandContext(CommandContext.ViewsLineHistoryEditorFollowing, true);\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'lineHistory', 'location')) {\n\t\t\tthis.initialize(this.config.location);\n\t\t}\n\n\t\tif (!configuration.initializing(e) && this._root !== undefined) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tget config(): ViewsConfig & LineHistoryViewConfig {\n\t\treturn { ...Container.config.views, ...Container.config.views.lineHistory };\n\t}\n\n\tprivate changeBase() {\n\t\tif (this._root !== undefined) {\n\t\t\tvoid this._root.changeBase();\n\t\t}\n\t}\n\n\tprivate setEditorFollowing(enabled: boolean) {\n\t\tsetCommandContext(CommandContext.ViewsLineHistoryEditorFollowing, enabled);\n\t\tif (this._root !== undefined) {\n\t\t\tthis._root.setEditorFollowing(enabled);\n\t\t}\n\t}\n\n\tprivate setRenameFollowing(enabled: boolean) {\n\t\treturn configuration.updateEffective('advanced', 'fileHistoryFollowsRenames', enabled);\n\t}\n}\n","'use strict';\nimport {\n\tCancellationToken,\n\tcommands,\n\tConfigurationChangeEvent,\n\tEvent,\n\tEventEmitter,\n\tProgressLocation,\n\twindow\n} from 'vscode';\nimport {\n\tconfiguration,\n\tRepositoriesViewConfig,\n\tViewFilesLayout,\n\tViewsConfig,\n\tViewShowBranchComparison\n} from '../configuration';\nimport { CommandContext, setCommandContext, WorkspaceState } from '../constants';\nimport { Container } from '../container';\nimport { GitLogCommit, GitService, GitStashCommit } from '../git/gitService';\nimport {\n\tBranchesNode,\n\tBranchNode,\n\tBranchOrTagFolderNode,\n\tCompareBranchNode,\n\tRepositoriesNode,\n\tRepositoryNode,\n\tStashesNode,\n\tStashNode,\n\tViewNode\n} from './nodes';\nimport { gate } from '../system';\nimport { ViewBase } from './viewBase';\n\nexport class RepositoriesView extends ViewBase<RepositoriesNode> {\n\tconstructor() {\n\t\tsuper('gitlens.views.repositories', 'Repositories');\n\t}\n\n\tprivate _onDidChangeAutoRefresh = new EventEmitter<void>();\n\tget onDidChangeAutoRefresh(): Event<void> {\n\t\treturn this._onDidChangeAutoRefresh.event;\n\t}\n\n\tgetRoot() {\n\t\treturn new RepositoriesNode(this);\n\t}\n\n\tprotected get location(): string {\n\t\treturn this.config.location;\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setAutoRefreshToOn'),\n\t\t\t() => this.setAutoRefresh(Container.config.views.repositories.autoRefresh, true),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setAutoRefreshToOff'),\n\t\t\t() => this.setAutoRefresh(Container.config.views.repositories.autoRefresh, false),\n\t\t\tthis\n\t\t);\n\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchComparisonToWorking'),\n\t\t\tn => this.setBranchComparison(n, ViewShowBranchComparison.Working),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setBranchComparisonToBranch'),\n\t\t\tn => this.setBranchComparison(n, ViewShowBranchComparison.Branch),\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'views', 'repositories') &&\n\t\t\t!configuration.changed(e, 'views') &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle') &&\n\t\t\t!configuration.changed(e, 'sortBranchesBy') &&\n\t\t\t!configuration.changed(e, 'sortTagsBy')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'repositories', 'autoRefresh')) {\n\t\t\tvoid this.setAutoRefresh(Container.config.views.repositories.autoRefresh);\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'repositories', 'location')) {\n\t\t\tthis.initialize(this.config.location, { showCollapseAll: true });\n\t\t}\n\n\t\tif (!configuration.initializing(e) && this._root !== undefined) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tget autoRefresh() {\n\t\treturn (\n\t\t\tthis.config.autoRefresh &&\n\t\t\tContainer.context.workspaceState.get<boolean>(WorkspaceState.ViewsRepositoriesAutoRefresh, true)\n\t\t);\n\t}\n\n\tget config(): ViewsConfig & RepositoriesViewConfig {\n\t\treturn { ...Container.config.views, ...Container.config.views.repositories };\n\t}\n\n\tfindCommitNode(commit: GitLogCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(commit.repoPath);\n\n\t\treturn this.findNode((n: any) => n.commit !== undefined && n.commit.ref === commit.ref, {\n\t\t\tallowPaging: true,\n\t\t\tmaxDepth: 6,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for commit nodes in the same repo within BranchNodes\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (\n\t\t\t\t\tn instanceof RepositoryNode ||\n\t\t\t\t\tn instanceof BranchesNode ||\n\t\t\t\t\tn instanceof BranchOrTagFolderNode ||\n\t\t\t\t\tn instanceof BranchNode\n\t\t\t\t) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token\n\t\t});\n\t}\n\n\tfindStashNode(stash: GitStashCommit | { repoPath: string; ref: string }, token?: CancellationToken) {\n\t\tconst repoNodeId = RepositoryNode.getId(stash.repoPath);\n\n\t\treturn this.findNode(StashNode.getId(stash.repoPath, stash.ref), {\n\t\t\tmaxDepth: 3,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for stash nodes in the same repo within a StashesNode\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode || n instanceof StashesNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttoken: token\n\t\t});\n\t}\n\n\t@gate<RepositoriesView['revealCommit']>(() => '')\n\trevealCommit(\n\t\tcommit: GitLogCommit | { repoPath: string; ref: string },\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t}\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing commit '${GitService.shortenSha(commit.ref)}' in the Repositories view...`,\n\t\t\t\tcancellable: true\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findCommitNode(commit, token);\n\t\t\t\tif (node === undefined) return node;\n\n\t\t\t\t// Not sure why I need to reveal each parent, but without it the node won't be revealed\n\t\t\t\tconst nodes: ViewNode[] = [];\n\n\t\t\t\tlet parent: ViewNode | undefined = node;\n\t\t\t\twhile (parent !== undefined) {\n\t\t\t\t\tnodes.push(parent);\n\t\t\t\t\tparent = parent.getParent();\n\t\t\t\t}\n\t\t\t\tnodes.pop();\n\n\t\t\t\tfor (const n of nodes.reverse()) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.reveal(n, options);\n\t\t\t\t\t} catch {}\n\t\t\t\t}\n\n\t\t\t\treturn node;\n\t\t\t}\n\t\t);\n\t}\n\n\t@gate<RepositoriesView['revealStash']>(() => '')\n\tasync revealStash(\n\t\tstash: GitStashCommit | { repoPath: string; ref: string; stashName: string },\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t}\n\t) {\n\t\treturn window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Revealing stash '${stash.stashName}' in the Repositories view...`,\n\t\t\t\tcancellable: true\n\t\t\t},\n\t\t\tasync (progress, token) => {\n\t\t\t\tconst node = await this.findStashNode(stash, token);\n\t\t\t\tif (node !== undefined) {\n\t\t\t\t\tawait this.reveal(node, options);\n\t\t\t\t}\n\n\t\t\t\treturn node;\n\t\t\t}\n\t\t);\n\t}\n\n\t@gate<RepositoriesView['revealStashes']>(() => '')\n\tasync revealStashes(\n\t\trepoPath: string,\n\t\toptions?: {\n\t\t\tselect?: boolean;\n\t\t\tfocus?: boolean;\n\t\t\texpand?: boolean | number;\n\t\t}\n\t) {\n\t\tconst repoNodeId = RepositoryNode.getId(repoPath);\n\n\t\tconst node = await this.findNode(StashesNode.getId(repoPath), {\n\t\t\tmaxDepth: 2,\n\t\t\tcanTraverse: n => {\n\t\t\t\t// Only search for stashes nodes in the same repo\n\t\t\t\tif (n instanceof RepositoriesNode) return true;\n\n\t\t\t\tif (n instanceof RepositoryNode) {\n\t\t\t\t\treturn n.id.startsWith(repoNodeId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\tif (node !== undefined) {\n\t\t\tawait this.reveal(node, options);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tprivate async setAutoRefresh(enabled: boolean, workspaceEnabled?: boolean) {\n\t\tif (enabled) {\n\t\t\tif (workspaceEnabled === undefined) {\n\t\t\t\tworkspaceEnabled = Container.context.workspaceState.get<boolean>(\n\t\t\t\t\tWorkspaceState.ViewsRepositoriesAutoRefresh,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tawait Container.context.workspaceState.update(\n\t\t\t\t\tWorkspaceState.ViewsRepositoriesAutoRefresh,\n\t\t\t\t\tworkspaceEnabled\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tsetCommandContext(CommandContext.ViewsRepositoriesAutoRefresh, enabled && workspaceEnabled);\n\n\t\tthis._onDidChangeAutoRefresh.fire();\n\t}\n\n\tprivate setBranchComparison(node: ViewNode, comparisonType: Exclude<ViewShowBranchComparison, false>) {\n\t\tif (!(node instanceof CompareBranchNode)) return undefined;\n\n\t\treturn node.setComparisonType(comparisonType);\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective('views', 'repositories', 'files', 'layout', layout);\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent } from 'vscode';\nimport { configuration, SearchViewConfig, ViewFilesLayout, ViewsConfig } from '../configuration';\nimport { CommandContext, setCommandContext, WorkspaceState } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, SearchPattern } from '../git/gitService';\nimport { Functions, Strings } from '../system';\nimport { nodeSupportsConditionalDismissal, SearchNode, SearchResultsCommitsNode, ViewNode } from './nodes';\nimport { ViewBase } from './viewBase';\n\ninterface SearchQueryResult {\n\tlabel: string;\n\tlog: GitLog | undefined;\n}\n\nexport class SearchView extends ViewBase<SearchNode> {\n\tconstructor() {\n\t\tsuper('gitlens.views.search', 'Search Commits');\n\n\t\tsetCommandContext(CommandContext.ViewsSearchKeepResults, this.keepResults);\n\t}\n\n\tgetRoot() {\n\t\treturn new SearchNode(this);\n\t}\n\n\tprotected get location(): string {\n\t\treturn this.config.location;\n\t}\n\n\tprotected registerCommands() {\n\t\tvoid Container.viewCommands;\n\n\t\tcommands.registerCommand(this.getQualifiedCommand('clear'), () => this.clear(), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('copy'),\n\t\t\t() => commands.executeCommand('gitlens.views.copy', this.selection),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('refresh'), () => this.refresh(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToAuto'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Auto),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToList'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.List),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setFilesLayoutToTree'),\n\t\t\t() => this.setFilesLayout(ViewFilesLayout.Tree),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(this.getQualifiedCommand('setKeepResultsToOn'), () => this.setKeepResults(true), this);\n\t\tcommands.registerCommand(\n\t\t\tthis.getQualifiedCommand('setKeepResultsToOff'),\n\t\t\t() => this.setKeepResults(false),\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\t!configuration.changed(e, 'views', 'search') &&\n\t\t\t!configuration.changed(e, 'views') &&\n\t\t\t!configuration.changed(e, 'defaultDateFormat') &&\n\t\t\t!configuration.changed(e, 'defaultDateSource') &&\n\t\t\t!configuration.changed(e, 'defaultDateStyle') &&\n\t\t\t!configuration.changed(e, 'defaultGravatarsStyle')\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (configuration.changed(e, 'views', 'search', 'location')) {\n\t\t\tthis.initialize(this.config.location, { showCollapseAll: true });\n\t\t}\n\n\t\tif (!configuration.initializing(e) && this._root !== undefined) {\n\t\t\tvoid this.refresh(true);\n\t\t}\n\t}\n\n\tget config(): ViewsConfig & SearchViewConfig {\n\t\treturn { ...Container.config.views, ...Container.config.views.search };\n\t}\n\n\tget keepResults(): boolean {\n\t\treturn Container.context.workspaceState.get<boolean>(WorkspaceState.ViewsSearchKeepResults, false);\n\t}\n\n\tclear() {\n\t\tif (this._root === undefined) return;\n\n\t\tthis._root.clear();\n\t}\n\n\tdismissNode(node: ViewNode) {\n\t\tif (this._root === undefined) return;\n\t\tif (nodeSupportsConditionalDismissal(node) && node.canDismiss() === false) return;\n\n\t\tthis._root.dismiss(node);\n\t}\n\n\tasync search(\n\t\trepoPath: string,\n\t\tsearch: SearchPattern,\n\t\t{\n\t\t\tlabel,\n\t\t\t...options\n\t\t}: {\n\t\t\tlabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t\tmaxCount?: number;\n\t\t},\n\t\tresults?: Promise<GitLog | undefined> | GitLog\n\t) {\n\t\tif (!this.visible) {\n\t\t\tawait this.show();\n\t\t}\n\n\t\tconst searchQueryFn = this.getSearchQueryFn(\n\t\t\tresults || Container.git.getLogForSearch(repoPath, search, options),\n\t\t\t{ label: label }\n\t\t);\n\n\t\treturn this.addResults(\n\t\t\tnew SearchResultsCommitsNode(\n\t\t\t\tthis,\n\t\t\t\tthis._root!,\n\t\t\t\trepoPath,\n\t\t\t\tsearch,\n\t\t\t\t`${typeof label === 'string' ? label : label.label}`,\n\t\t\t\tsearchQueryFn\n\t\t\t)\n\t\t);\n\t}\n\n\tshowSearchResults(\n\t\trepoPath: string,\n\t\tsearch: SearchPattern,\n\t\tresults: GitLog,\n\t\t{\n\t\t\tlabel,\n\t\t\t...options\n\t\t}: {\n\t\t\tlabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t\tmaxCount?: number;\n\t\t}\n\t) {\n\t\tlabel = this.getSearchLabel(label, results);\n\t\tconst searchQueryFn = Functions.cachedOnce(this.getSearchQueryFn(results, { label: label, ...options }), {\n\t\t\tlabel: label,\n\t\t\tlog: results\n\t\t});\n\n\t\treturn this.addResults(new SearchResultsCommitsNode(this, this._root!, repoPath, search, label, searchQueryFn));\n\t}\n\n\tprivate addResults(results: ViewNode) {\n\t\tconst root = this.ensureRoot();\n\t\troot.addOrReplace(results, !this.keepResults);\n\n\t\tsetImmediate(() => void this.reveal(results, { select: true, expand: true }));\n\t}\n\n\tprivate getSearchLabel(\n\t\tlabel:\n\t\t\t| string\n\t\t\t| {\n\t\t\t\t\tlabel: string;\n\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t  },\n\t\tlog: GitLog | undefined\n\t) {\n\t\tif (typeof label === 'string') return label;\n\n\t\tconst count = log !== undefined ? log.count : 0;\n\t\tconst truncated = log !== undefined ? log.truncated : false;\n\n\t\tconst resultsType =\n\t\t\tlabel.resultsType === undefined ? { singular: 'result', plural: 'results' } : label.resultsType;\n\n\t\treturn `${Strings.pluralize(resultsType.singular, count, {\n\t\t\tnumber: truncated ? `${count}+` : undefined,\n\t\t\tplural: resultsType.plural,\n\t\t\tzero: 'No'\n\t\t})} ${label.label}`;\n\t}\n\n\tprivate getSearchQueryFn(\n\t\tresults: Promise<GitLog | undefined> | GitLog | undefined,\n\t\toptions: {\n\t\t\tlabel:\n\t\t\t\t| string\n\t\t\t\t| {\n\t\t\t\t\t\tlabel: string;\n\t\t\t\t\t\tresultsType?: { singular: string; plural: string };\n\t\t\t\t  };\n\t\t}\n\t): (maxCount: number | undefined) => Promise<SearchQueryResult> {\n\t\tlet useCacheOnce = true;\n\n\t\treturn async (maxCount: number | undefined) => {\n\t\t\tlet log = await results;\n\n\t\t\tif (!useCacheOnce && log !== undefined && log.query !== undefined) {\n\t\t\t\tlog = await log.query(maxCount);\n\t\t\t}\n\t\t\tuseCacheOnce = false;\n\n\t\t\tconst label = this.getSearchLabel(options.label, log);\n\t\t\treturn {\n\t\t\t\tlabel: label,\n\t\t\t\tlog: log\n\t\t\t};\n\t\t};\n\t}\n\n\tprivate setFilesLayout(layout: ViewFilesLayout) {\n\t\treturn configuration.updateEffective('views', 'search', 'files', 'layout', layout);\n\t}\n\n\tprivate setKeepResults(enabled: boolean) {\n\t\tContainer.context.workspaceState.update(WorkspaceState.ViewsSearchKeepResults, enabled);\n\t\tsetCommandContext(CommandContext.ViewsSearchKeepResults, enabled);\n\t}\n}\n","'use strict';\nimport { commands, env, TextDocumentShowOptions, Uri, window } from 'vscode';\nimport {\n\tCommands,\n\tDiffWithCommandArgs,\n\tDiffWithPreviousCommandArgs,\n\tDiffWithWorkingCommandArgs,\n\tGitCommandsCommandArgs,\n\topenEditor,\n\tOpenFileInRemoteCommandArgs,\n\tOpenFileRevisionCommandArgs,\n\tOpenWorkingFileCommandArgs\n} from '../commands';\nimport { BuiltInCommands, CommandContext, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { GitReference, GitService, GitUri } from '../git/gitService';\nimport {\n\tBranchNode,\n\tBranchTrackingStatusNode,\n\tCommitFileNode,\n\tCommitNode,\n\tCompareBranchNode,\n\tCompareResultsNode,\n\tContributorNode,\n\tFileHistoryNode,\n\tFolderNode,\n\tLineHistoryNode,\n\tPageableViewNode,\n\tPagerNode,\n\tRemoteNode,\n\tRepositoryNode,\n\tResultsFileNode,\n\tResultsFilesNode,\n\tStashFileNode,\n\tStashNode,\n\tStatusFileNode,\n\tTagNode,\n\tViewNode,\n\tViewRefFileNode,\n\tViewRefNode,\n\tviewSupportsNodeDismissal\n} from './nodes';\nimport { debug, Strings } from '../system';\nimport { runGitCommandInTerminal } from '../terminal';\n\ninterface CompareSelectedInfo {\n\tref: string;\n\trepoPath: string | undefined;\n\turi?: Uri;\n}\n\nexport class ViewCommands {\n\tconstructor() {\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.copy',\n\t\t\tasync (selection: ViewNode[]) => {\n\t\t\t\tif (selection.length === 0) return;\n\n\t\t\t\tconst data = selection\n\t\t\t\t\t.filter(n => n.toClipboard !== undefined)\n\t\t\t\t\t.map(n => n.toClipboard!())\n\t\t\t\t\t.join(',');\n\t\t\t\tawait env.clipboard.writeText(data);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.refreshNode',\n\t\t\t(node: ViewNode, reset?: boolean) => {\n\t\t\t\tif (reset == null && PageableViewNode.is(node)) {\n\t\t\t\t\tnode.maxCount = undefined;\n\t\t\t\t\tnode.view.resetNodeLastMaxCount(node);\n\t\t\t\t}\n\n\t\t\t\treturn node.view.refreshNode(node, reset == null ? true : reset);\n\t\t\t},\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.expandNode',\n\t\t\t(node: ViewNode) => node.view.reveal(node, { select: false, focus: false, expand: 3 }),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.dismissNode',\n\t\t\t(node: ViewNode) => viewSupportsNodeDismissal(node.view) && node.view.dismissNode(node),\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand('gitlens.views.executeNodeCallback', (fn: <R>() => Promise<R>) => fn(), this);\n\t\tcommands.registerCommand('gitlens.views.showMoreChildren', (node: PagerNode) => node.showMore(), this);\n\t\tcommands.registerCommand('gitlens.views.showAllChildren', (node: PagerNode) => node.showAll(), this);\n\n\t\tcommands.registerCommand('gitlens.views.fetch', this.fetch, this);\n\t\tcommands.registerCommand('gitlens.views.pull', this.pull, this);\n\t\tcommands.registerCommand('gitlens.views.push', this.push, this);\n\t\tcommands.registerCommand('gitlens.views.pushWithForce', n => this.push(n, true), this);\n\t\tcommands.registerCommand('gitlens.views.closeRepository', this.closeRepository, this);\n\n\t\tcommands.registerCommand('gitlens.views.setAsDefault', this.setAsDefault, this);\n\t\tcommands.registerCommand('gitlens.views.unsetAsDefault', this.unsetAsDefault, this);\n\n\t\tcommands.registerCommand('gitlens.views.openInTerminal', this.openInTerminal, this);\n\t\tcommands.registerCommand('gitlens.views.star', this.star, this);\n\t\tcommands.registerCommand('gitlens.views.unstar', this.unstar, this);\n\n\t\tcommands.registerCommand('gitlens.views.exploreRepoAtRevision', this.exploreRepoAtRevision, this);\n\n\t\tcommands.registerCommand('gitlens.views.contributor.addCoauthoredBy', this.contributorAddCoAuthoredBy, this);\n\t\tcommands.registerCommand('gitlens.views.contributor.copyToClipboard', this.contributorCopyToClipboard, this);\n\n\t\tcommands.registerCommand('gitlens.views.openChanges', this.openChanges, this);\n\t\tcommands.registerCommand('gitlens.views.openChangesWithWorking', this.openChangesWithWorking, this);\n\t\tcommands.registerCommand('gitlens.views.openFile', this.openFile, this);\n\t\tcommands.registerCommand('gitlens.views.openFileRevision', this.openFileRevision, this);\n\t\tcommands.registerCommand('gitlens.views.openFileRevisionInRemote', this.openFileRevisionInRemote, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFiles', this.openChangedFiles, this);\n\t\tcommands.registerCommand('gitlens.views.openChangedFileDiffs', this.openChangedFileDiffs, this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.openChangedFileDiffsWithWorking',\n\t\t\tthis.openChangedFileDiffsWithWorking,\n\t\t\tthis\n\t\t);\n\t\tcommands.registerCommand('gitlens.views.openChangedFileRevisions', this.openChangedFileRevisions, this);\n\t\tcommands.registerCommand('gitlens.views.applyChanges', this.applyChanges, this);\n\t\tcommands.registerCommand('gitlens.views.restore', this.restore, this);\n\t\tcommands.registerCommand('gitlens.views.switchToBranch', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.switchToCommit', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.switchToTag', this.switch, this);\n\t\tcommands.registerCommand('gitlens.views.addRemote', this.addRemote, this);\n\t\tcommands.registerCommand('gitlens.views.pruneRemote', this.pruneRemote, this);\n\n\t\tcommands.registerCommand('gitlens.views.stageDirectory', this.stageDirectory, this);\n\t\tcommands.registerCommand('gitlens.views.stageFile', this.stageFile, this);\n\t\tcommands.registerCommand('gitlens.views.unstageDirectory', this.unstageDirectory, this);\n\t\tcommands.registerCommand('gitlens.views.unstageFile', this.unstageFile, this);\n\n\t\tcommands.registerCommand('gitlens.views.compareAncestryWithWorking', this.compareAncestryWithWorking, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithHead', this.compareWithHead, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithRemote', this.compareWithRemote, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithSelected', this.compareWithSelected, this);\n\t\tcommands.registerCommand('gitlens.views.selectForCompare', this.selectForCompare, this);\n\t\tcommands.registerCommand('gitlens.views.compareFileWithSelected', this.compareFileWithSelected, this);\n\t\tcommands.registerCommand('gitlens.views.selectFileForCompare', this.selectFileForCompare, this);\n\t\tcommands.registerCommand('gitlens.views.compareWithWorking', this.compareWithWorking, this);\n\n\t\tcommands.registerCommand('gitlens.views.setComparisonToTwoDot', n => this.setComparisonNotation(n, '..'), this);\n\t\tcommands.registerCommand(\n\t\t\t'gitlens.views.setComparisonToThreeDot',\n\t\t\tn => this.setComparisonNotation(n, '...'),\n\t\t\tthis\n\t\t);\n\n\t\tcommands.registerCommand('gitlens.views.cherryPick', this.cherryPick, this);\n\n\t\tcommands.registerCommand('gitlens.views.mergeBranchInto', this.merge, this);\n\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoBranch', this.rebase, this);\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoUpstream', this.rebaseToRemote, this);\n\t\tcommands.registerCommand('gitlens.views.rebaseOntoCommit', this.rebase, this);\n\n\t\tcommands.registerCommand('gitlens.views.reset', this.reset, this);\n\t\tcommands.registerCommand('gitlens.views.revert', this.revert, this);\n\n\t\tcommands.registerCommand('gitlens.views.terminalPushCommit', this.terminalPushCommit, this);\n\n\t\tcommands.registerCommand('gitlens.views.terminalCreateBranch', this.terminalCreateBranch, this);\n\t\tcommands.registerCommand('gitlens.views.terminalDeleteBranch', this.terminalDeleteBranch, this);\n\t\tcommands.registerCommand('gitlens.views.terminalRemoveRemote', this.terminalRemoveRemote, this);\n\t\tcommands.registerCommand('gitlens.views.terminalCreateTag', this.terminalCreateTag, this);\n\t\tcommands.registerCommand('gitlens.views.terminalDeleteTag', this.terminalDeleteTag, this);\n\t}\n\n\t@debug()\n\tprivate async addRemote(node: RemoteNode) {\n\t\tconst name = await window.showInputBox({\n\t\t\tprompt: 'Please provide a name for the remote',\n\t\t\tplaceHolder: 'Remote name',\n\t\t\tvalue: undefined,\n\t\t\tignoreFocusOut: true\n\t\t});\n\t\tif (name === undefined || name.length === 0) return undefined;\n\n\t\tconst url = await window.showInputBox({\n\t\t\tprompt: 'Please provide the repository url for the remote',\n\t\t\tplaceHolder: 'Remote repository url',\n\t\t\tvalue: undefined,\n\t\t\tignoreFocusOut: true\n\t\t});\n\t\tif (url === undefined || url.length === 0) return undefined;\n\n\t\tvoid (await Container.git.addRemote(node.repo.path, name, url));\n\t\tvoid (await node.repo.fetch({ remote: name }));\n\n\t\treturn name;\n\t}\n\n\t@debug()\n\tprivate async applyChanges(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode)) return;\n\n\t\tvoid (await this.openFile(node));\n\n\t\tif (node instanceof ResultsFileNode) {\n\t\t\tvoid (await Container.git.applyChangesToWorkingFile(node.uri, node.ref1, node.ref2));\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (node.uri.sha !== undefined && node.uri.sha !== 'HEAD') {\n\t\t\tvoid (await Container.git.applyChangesToWorkingFile(node.uri));\n\t\t}\n\t}\n\n\t@debug()\n\tprivate async cherryPick(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'cherry-pick',\n\t\t\tstate: { repo: repo!, references: [GitReference.create(node.ref)] }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate closeRepository(node: RepositoryNode) {\n\t\tif (!(node instanceof RepositoryNode)) return;\n\n\t\tnode.repo.closed = true;\n\t}\n\n\t@debug()\n\tprivate async contributorAddCoAuthoredBy(node: ContributorNode) {\n\t\tif (!(node instanceof ContributorNode)) return;\n\n\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\tif (gitApi === undefined) return;\n\n\t\tconst repo = gitApi.repositories.find(\n\t\t\tr => Strings.normalizePath(r.rootUri.fsPath) === node.contributor.repoPath\n\t\t);\n\t\tif (repo === undefined) return;\n\n\t\tconst coauthor = `${node.contributor.name}${node.contributor.email ? ` <${node.contributor.email}>` : ''}`;\n\n\t\tconst message = repo.inputBox.value;\n\t\tif (message.includes(coauthor)) return;\n\n\t\tlet newlines;\n\t\tif (message.includes('Co-authored-by: ')) {\n\t\t\tnewlines = '\\n';\n\t\t} else if (message.length !== 0 && message.endsWith('\\n')) {\n\t\t\tnewlines = '\\n\\n';\n\t\t} else {\n\t\t\tnewlines = '\\n\\n\\n';\n\t\t}\n\n\t\trepo.inputBox.value = `${message}${newlines}Co-authored-by: ${coauthor}`;\n\t}\n\n\t@debug()\n\tprivate async contributorCopyToClipboard(node: ContributorNode) {\n\t\tif (!(node instanceof ContributorNode)) return;\n\n\t\tawait env.clipboard.writeText(\n\t\t\t`${node.contributor.name}${node.contributor.email ? ` <${node.contributor.email}>` : ''}`\n\t\t);\n\t}\n\n\t@debug()\n\tprivate exploreRepoAtRevision(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return undefined;\n\n\t\treturn commands.executeCommand(Commands.ExploreRepoAtRevision, { uri: node.uri });\n\t}\n\n\t@debug()\n\tprivate fetch(node: RemoteNode | RepositoryNode) {\n\t\tif (node instanceof RemoteNode) return node.fetch();\n\t\tif (node instanceof RepositoryNode) {\n\t\t\tconst args: GitCommandsCommandArgs = { command: 'fetch', state: { repos: [node.repo] } };\n\t\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tprivate async merge(node: BranchNode | TagNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof TagNode)) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'merge',\n\t\t\tstate: { repo: repo!, reference: node instanceof BranchNode ? node.branch : node.tag }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate openInTerminal(node: RepositoryNode) {\n\t\tif (!(node instanceof RepositoryNode)) return undefined;\n\n\t\treturn commands.executeCommand(BuiltInCommands.OpenInTerminal, Uri.file(node.repo.path));\n\t}\n\n\t@debug()\n\tprivate async pruneRemote(node: RemoteNode) {\n\t\tconst remoteName = node.remote.name;\n\t\tvoid (await Container.git.pruneRemote(node.repo.path, remoteName));\n\n\t\treturn remoteName;\n\t}\n\n\t@debug()\n\tprivate pull(node: RepositoryNode | BranchNode | BranchTrackingStatusNode) {\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\tnode = node.getParent() as RepositoryNode;\n\t\t}\n\t\tif (!(node instanceof RepositoryNode)) return undefined;\n\n\t\tconst args: GitCommandsCommandArgs = { command: 'pull', state: { repos: [node.repo] } };\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate push(node: RepositoryNode | BranchNode | BranchTrackingStatusNode, force?: boolean) {\n\t\tif (node instanceof BranchNode || node instanceof BranchTrackingStatusNode) {\n\t\t\tnode = node.getParent() as RepositoryNode;\n\t\t}\n\t\tif (!(node instanceof RepositoryNode)) return undefined;\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'push',\n\t\t\tstate: { repos: [node.repo], flags: force ? ['--force'] : [] }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate async rebase(node: BranchNode | CommitNode | TagNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof CommitNode) && !(node instanceof TagNode)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tlet args: GitCommandsCommandArgs;\n\t\tif (node instanceof CommitNode) {\n\t\t\targs = {\n\t\t\t\tcommand: 'rebase',\n\t\t\t\tstate: {\n\t\t\t\t\trepo: repo!,\n\t\t\t\t\treference: GitReference.create(node.ref)\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\targs = {\n\t\t\t\tcommand: 'rebase',\n\t\t\t\tstate: {\n\t\t\t\t\trepo: repo!,\n\t\t\t\t\treference: node instanceof BranchNode ? node.branch : node.tag\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate async rebaseToRemote(node: BranchNode | BranchTrackingStatusNode) {\n\t\tif (!(node instanceof BranchNode) && !(node instanceof BranchTrackingStatusNode)) return undefined;\n\n\t\tconst upstream = node instanceof BranchNode ? node.branch.tracking : node.status.upstream;\n\t\tif (upstream === undefined) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'rebase',\n\t\t\tstate: { repo: repo!, reference: GitReference.create(upstream, { name: upstream, refType: 'branch' }) }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate async reset(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'reset',\n\t\t\tstate: { repo: repo!, reference: GitReference.create(node.ref) }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate async restore(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode)) return undefined;\n\n\t\treturn Container.git.checkout(node.repoPath, node.ref, { fileName: node.fileName });\n\t}\n\n\t@debug()\n\tprivate async revert(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tconst args: GitCommandsCommandArgs = {\n\t\t\tcommand: 'revert',\n\t\t\tstate: { repo: repo!, references: [GitReference.create(node.ref)] }\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate setAsDefault(node: RemoteNode) {\n\t\tif (node instanceof RemoteNode) return node.setAsDefault();\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tprivate setComparisonNotation(node: ViewNode, comparisonNotation: '...' | '..') {\n\t\tif (!(node instanceof CompareResultsNode) && !(node instanceof CompareBranchNode)) return undefined;\n\n\t\treturn node.setComparisonNotation(comparisonNotation);\n\t}\n\n\t@debug()\n\tprivate async stageFile(node: CommitFileNode | StatusFileNode) {\n\t\tif (!(node instanceof CommitFileNode) && !(node instanceof StatusFileNode)) return;\n\n\t\tvoid (await Container.git.stageFile(node.repoPath, node.file.fileName));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate async stageDirectory(node: FolderNode) {\n\t\tif (!(node instanceof FolderNode) || !node.relativePath) return;\n\n\t\tvoid (await Container.git.stageDirectory(node.repoPath, node.relativePath));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate star(node: BranchNode | RepositoryNode) {\n\t\tif (node instanceof BranchNode || node instanceof RepositoryNode) return node.star();\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tprivate async switch(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(node.repoPath);\n\n\t\tlet args: GitCommandsCommandArgs;\n\t\tif (node instanceof BranchNode) {\n\t\t\targs = {\n\t\t\t\tcommand: 'switch',\n\t\t\t\tstate: { repos: [repo!], reference: node.branch.current ? undefined : node.branch }\n\t\t\t};\n\t\t} else if (node instanceof TagNode) {\n\t\t\targs = { command: 'switch', state: { repos: [repo!], reference: node.tag } };\n\t\t} else {\n\t\t\targs = {\n\t\t\t\tcommand: 'switch',\n\t\t\t\tstate: { repos: [repo!], reference: GitReference.create(node.ref) }\n\t\t\t};\n\t\t}\n\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n\n\t@debug()\n\tprivate unsetAsDefault(node: RemoteNode) {\n\t\tif (node instanceof RemoteNode) return node.setAsDefault(false);\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tprivate async unstageFile(node: CommitFileNode | StatusFileNode) {\n\t\tif (!(node instanceof CommitFileNode) && !(node instanceof StatusFileNode)) return;\n\n\t\tvoid (await Container.git.unStageFile(node.repoPath, node.file.fileName));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate async unstageDirectory(node: FolderNode) {\n\t\tif (!(node instanceof FolderNode) || !node.relativePath) return;\n\n\t\tvoid (await Container.git.unStageDirectory(node.repoPath, node.relativePath));\n\t\tvoid node.triggerChange();\n\t}\n\n\t@debug()\n\tprivate unstar(node: BranchNode | RepositoryNode) {\n\t\tif (node instanceof BranchNode || node instanceof RepositoryNode) return node.unstar();\n\t\treturn undefined;\n\t}\n\n\t@debug()\n\tprivate compareWithHead(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return undefined;\n\n\t\treturn Container.compareView.compare(node.repoPath, node.ref, 'HEAD');\n\t}\n\n\t@debug()\n\tprivate compareWithRemote(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return undefined;\n\t\tif (!node.branch.tracking) return undefined;\n\n\t\treturn Container.compareView.compare(node.repoPath, node.branch.tracking, node.ref);\n\t}\n\n\t@debug()\n\tprivate compareWithWorking(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return undefined;\n\n\t\treturn Container.compareView.compare(node.repoPath, node.ref, '');\n\t}\n\n\t@debug()\n\tprivate async compareAncestryWithWorking(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return undefined;\n\n\t\tconst branch = await Container.git.getBranch(node.repoPath);\n\t\tif (branch === undefined) return undefined;\n\n\t\tconst commonAncestor = await Container.git.getMergeBase(node.repoPath, branch.ref, node.ref);\n\t\tif (commonAncestor === undefined) return undefined;\n\n\t\treturn Container.compareView.compare(\n\t\t\tnode.repoPath,\n\t\t\t{ ref: commonAncestor, label: `ancestry with ${node.ref} (${GitService.shortenSha(commonAncestor)})` },\n\t\t\t''\n\t\t);\n\t}\n\n\t@debug()\n\tprivate compareWithSelected(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tContainer.compareView.compareWithSelected(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate selectForCompare(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tContainer.compareView.selectForCompare(node.repoPath, node.ref);\n\t}\n\n\t@debug()\n\tprivate compareFileWithSelected(node: ViewRefFileNode) {\n\t\tif (this._selectedFile === undefined || !(node instanceof ViewRefFileNode) || node.ref === undefined) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (this._selectedFile.repoPath !== node.repoPath) {\n\t\t\tthis.selectFileForCompare(node);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst selected = this._selectedFile;\n\n\t\tthis._selectedFile = undefined;\n\t\tsetCommandContext(CommandContext.ViewsCanCompareFile, false);\n\n\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\trepoPath: selected.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: selected.ref,\n\t\t\t\turi: selected.uri!\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: node.ref,\n\t\t\t\turi: node.uri\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t}\n\n\tprivate _selectedFile: CompareSelectedInfo | undefined;\n\n\t@debug()\n\tprivate selectFileForCompare(node: ViewRefFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode) || node.ref === undefined) return;\n\n\t\tthis._selectedFile = {\n\t\t\tref: node.ref,\n\t\t\trepoPath: node.repoPath,\n\t\t\turi: node.uri\n\t\t};\n\t\tsetCommandContext(CommandContext.ViewsCanCompareFile, true);\n\t}\n\n\t@debug()\n\tprivate openChanges(node: ViewRefFileNode | StatusFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode) && !(node instanceof StatusFileNode)) return undefined;\n\n\t\tconst command = node.getCommand();\n\t\tif (command === undefined || command.arguments === undefined) return undefined;\n\n\t\tconst [uri, args] = command.arguments as [Uri, DiffWithPreviousCommandArgs];\n\t\targs.showOptions!.preview = false;\n\t\treturn commands.executeCommand(command.command, uri, args);\n\t}\n\n\t@debug()\n\tprivate openChangesWithWorking(node: ViewRefFileNode | StatusFileNode) {\n\t\tif (!(node instanceof ViewRefFileNode) && !(node instanceof StatusFileNode)) return undefined;\n\n\t\tconst args: DiffWithWorkingCommandArgs = {\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: false\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.DiffWithWorking, node.uri, args);\n\t}\n\n\t@debug()\n\tprivate openFile(node: ViewRefFileNode | StatusFileNode | FileHistoryNode | LineHistoryNode) {\n\t\tif (\n\t\t\t!(node instanceof ViewRefFileNode) &&\n\t\t\t!(node instanceof StatusFileNode) &&\n\t\t\t!(node instanceof FileHistoryNode) &&\n\t\t\t!(node instanceof LineHistoryNode)\n\t\t) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst args: OpenWorkingFileCommandArgs = {\n\t\t\turi: node.uri,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: false\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.OpenWorkingFile, undefined, args);\n\t}\n\n\t@debug()\n\tprivate openFileRevision(\n\t\tnode: CommitFileNode | ResultsFileNode | StashFileNode | StatusFileNode,\n\t\toptions?: OpenFileRevisionCommandArgs\n\t) {\n\t\tif (\n\t\t\t!(node instanceof CommitFileNode) &&\n\t\t\t!(node instanceof StashFileNode) &&\n\t\t\t!(node instanceof ResultsFileNode) &&\n\t\t\t!(node instanceof StatusFileNode)\n\t\t) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\toptions = { showOptions: { preserveFocus: true, preview: false }, ...options };\n\n\t\tlet uri = options.uri;\n\t\tif (uri == null) {\n\t\t\tif (node instanceof ResultsFileNode) {\n\t\t\t\turi = GitUri.toRevisionUri(node.uri);\n\t\t\t} else {\n\t\t\t\turi =\n\t\t\t\t\tnode.commit.status === 'D'\n\t\t\t\t\t\t? GitUri.toRevisionUri(\n\t\t\t\t\t\t\t\tnode.commit.previousSha!,\n\t\t\t\t\t\t\t\tnode.commit.previousUri.fsPath,\n\t\t\t\t\t\t\t\tnode.commit.repoPath\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: GitUri.toRevisionUri(node.uri);\n\t\t\t}\n\t\t}\n\n\t\treturn openEditor(uri, options.showOptions || { preserveFocus: true, preview: false });\n\t}\n\n\t@debug()\n\tprivate openFileRevisionInRemote(node: CommitFileNode) {\n\t\tif (!(node instanceof CommitFileNode) || node instanceof StashFileNode) return undefined;\n\n\t\tconst args: OpenFileInRemoteCommandArgs = {\n\t\t\trange: false\n\t\t};\n\t\treturn commands.executeCommand(\n\t\t\tCommands.OpenFileInRemote,\n\t\t\tnode.commit.toGitUri(node.commit.status === 'D'),\n\t\t\targs\n\t\t);\n\t}\n\n\t@debug()\n\tprivate async openChangedFiles(node: CommitNode | StashNode | ResultsFilesNode, options?: TextDocumentShowOptions) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions = { preserveFocus: false, preview: false, ...options };\n\n\t\tlet repoPath: string;\n\t\tlet files;\n\t\tlet ref: string;\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return;\n\n\t\t\trepoPath = node.repoPath;\n\t\t\tfiles = diff;\n\t\t\tref = node.ref1 || node.ref2;\n\t\t} else {\n\t\t\trepoPath = node.commit.repoPath;\n\t\t\tfiles = node.commit.files;\n\t\t\tref = node.commit.sha;\n\t\t}\n\n\t\tif (files.length > 20) {\n\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t\t\t{ title: 'Yes' },\n\t\t\t\t{ title: 'No', isCloseAffordance: true }\n\t\t\t);\n\t\t\tif (result === undefined || result.title === 'No') return;\n\t\t}\n\n\t\tfor (const file of files) {\n\t\t\tconst uri = GitUri.fromFile(file, repoPath, ref);\n\n\t\t\tconst args: OpenWorkingFileCommandArgs = {\n\t\t\t\turi: uri,\n\t\t\t\tshowOptions: options\n\t\t\t};\n\t\t\tawait commands.executeCommand(Commands.OpenWorkingFile, undefined, args);\n\t\t}\n\t}\n\n\t@debug()\n\tprivate async openChangedFileDiffs(\n\t\tnode: CommitNode | StashNode | ResultsFilesNode,\n\t\toptions?: TextDocumentShowOptions\n\t) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions = { preserveFocus: false, preview: false, ...options };\n\n\t\tlet repoPath: string;\n\t\tlet files;\n\t\tlet ref1: string;\n\t\tlet ref2: string;\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return;\n\n\t\t\trepoPath = node.repoPath;\n\t\t\tfiles = diff;\n\t\t\tref1 = node.ref1;\n\t\t\tref2 = node.ref2;\n\t\t} else {\n\t\t\trepoPath = node.commit.repoPath;\n\t\t\tfiles = node.commit.files;\n\t\t\tref1 = node.commit.previousSha !== undefined ? node.commit.previousSha : GitService.deletedOrMissingSha;\n\t\t\tref2 = node.commit.sha;\n\t\t}\n\n\t\tif (files.length > 20) {\n\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t\t\t{ title: 'Yes' },\n\t\t\t\t{ title: 'No', isCloseAffordance: true }\n\t\t\t);\n\t\t\tif (result === undefined || result.title === 'No') return;\n\t\t}\n\n\t\tlet diffArgs: DiffWithCommandArgs;\n\t\tfor (const file of files) {\n\t\t\tif (file.status === 'A') continue;\n\n\t\t\tconst uri1 = GitUri.fromFile(file, repoPath);\n\t\t\tconst uri2 = file.status === 'R' ? GitUri.fromFile(file, repoPath, ref2, true) : uri1;\n\n\t\t\tdiffArgs = {\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tlhs: { uri: uri1, sha: ref1 },\n\t\t\t\trhs: { uri: uri2, sha: ref2 },\n\t\t\t\tshowOptions: options\n\t\t\t};\n\t\t\tvoid (await commands.executeCommand(Commands.DiffWith, diffArgs));\n\t\t}\n\t}\n\n\t@debug()\n\tprivate async openChangedFileDiffsWithWorking(\n\t\tnode: CommitNode | StashNode | ResultsFilesNode,\n\t\toptions?: TextDocumentShowOptions\n\t) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions = { preserveFocus: false, preview: false, ...options };\n\n\t\tlet repoPath: string;\n\t\tlet files;\n\t\tlet ref: string;\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return;\n\n\t\t\trepoPath = node.repoPath;\n\t\t\tfiles = diff;\n\t\t\tref = node.ref1 || node.ref2;\n\t\t} else {\n\t\t\trepoPath = node.commit.repoPath;\n\t\t\tfiles = node.commit.files;\n\t\t\tref = node.commit.sha;\n\t\t}\n\n\t\tif (files.length > 20) {\n\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t\t\t{ title: 'Yes' },\n\t\t\t\t{ title: 'No', isCloseAffordance: true }\n\t\t\t);\n\t\t\tif (result === undefined || result.title === 'No') return;\n\t\t}\n\n\t\tfor (const file of files) {\n\t\t\tif (file.status === 'A' || file.status === 'D') continue;\n\n\t\t\tconst args: DiffWithWorkingCommandArgs = {\n\t\t\t\tshowOptions: options\n\t\t\t};\n\n\t\t\tconst uri = GitUri.fromFile(file, repoPath, ref);\n\t\t\tawait commands.executeCommand(Commands.DiffWithWorking, uri, args);\n\t\t}\n\t}\n\n\t@debug()\n\tprivate async openChangedFileRevisions(\n\t\tnode: CommitNode | StashNode | ResultsFilesNode,\n\t\toptions?: TextDocumentShowOptions\n\t) {\n\t\tif (!(node instanceof CommitNode) && !(node instanceof StashNode) && !(node instanceof ResultsFilesNode)) {\n\t\t\treturn;\n\t\t}\n\n\t\toptions = { preserveFocus: false, preview: false, ...options };\n\n\t\tlet repoPath: string;\n\t\tlet files;\n\t\tlet ref1: string;\n\t\tlet ref2: string;\n\n\t\tif (node instanceof ResultsFilesNode) {\n\t\t\tconst { diff } = await node.getFilesQueryResults();\n\t\t\tif (diff == null || diff.length === 0) return;\n\n\t\t\trepoPath = node.repoPath;\n\t\t\tfiles = diff;\n\t\t\tref1 = node.ref1;\n\t\t\tref2 = node.ref2;\n\t\t} else {\n\t\t\trepoPath = node.commit.repoPath;\n\t\t\tfiles = node.commit.files;\n\t\t\tref1 = node.commit.sha;\n\t\t\tref2 = node.commit.previousFileSha;\n\t\t}\n\n\t\tif (files.length > 20) {\n\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t`Are your sure you want to open all ${files.length} files?`,\n\t\t\t\t{ title: 'Yes' },\n\t\t\t\t{ title: 'No', isCloseAffordance: true }\n\t\t\t);\n\t\t\tif (result === undefined || result.title === 'No') return;\n\t\t}\n\n\t\tfor (const file of files) {\n\t\t\tconst uri = GitUri.toRevisionUri(file.status === 'D' ? ref2 : ref1, file, repoPath);\n\n\t\t\tawait openEditor(uri, options);\n\t\t}\n\t}\n\n\tasync terminalCreateBranch(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tlet remoteBranch = false;\n\t\tlet value = undefined;\n\t\tif (node instanceof BranchNode && node.branch.remote) {\n\t\t\tremoteBranch = true;\n\t\t\tvalue = node.branch.getName();\n\t\t}\n\n\t\tconst name = await window.showInputBox({\n\t\t\tprompt: 'Please provide a branch name',\n\t\t\tplaceHolder: 'Branch name',\n\t\t\tvalue: value,\n\t\t\tignoreFocusOut: true\n\t\t});\n\t\tif (name === undefined || name.length === 0) return;\n\n\t\trunGitCommandInTerminal('branch', `${remoteBranch ? '-t ' : ''}${name} ${node.ref}`, node.repoPath);\n\t}\n\n\tterminalDeleteBranch(node: BranchNode) {\n\t\tif (!(node instanceof BranchNode)) return;\n\n\t\tif (node.branch.remote) {\n\t\t\trunGitCommandInTerminal('push', `${node.branch.getRemoteName()} :${node.branch.getName()}`, node.repoPath);\n\t\t} else {\n\t\t\trunGitCommandInTerminal('branch', `-d ${node.ref}`, node.repoPath);\n\t\t}\n\t}\n\n\tterminalCheckoutCommit(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return;\n\n\t\trunGitCommandInTerminal('checkout', `${node.ref}`, node.repoPath);\n\t}\n\n\tasync terminalPushCommit(node: CommitNode) {\n\t\tif (!(node instanceof CommitNode)) return;\n\n\t\tconst branch = node.branch || (await Container.git.getBranch(node.repoPath));\n\t\tif (branch === undefined) return;\n\n\t\trunGitCommandInTerminal('push', `${branch.getRemoteName()} ${node.ref}:${branch.getName()}`, node.repoPath);\n\t}\n\n\tterminalRemoveRemote(node: RemoteNode) {\n\t\tif (!(node instanceof RemoteNode)) return;\n\n\t\trunGitCommandInTerminal('remote', `remove ${node.remote.name}`, node.remote.repoPath);\n\t}\n\n\tasync terminalCreateTag(node: ViewRefNode) {\n\t\tif (!(node instanceof ViewRefNode)) return;\n\n\t\tconst name = await window.showInputBox({\n\t\t\tprompt: 'Please provide a tag name',\n\t\t\tplaceHolder: 'Tag name',\n\t\t\tignoreFocusOut: true\n\t\t});\n\t\tif (name === undefined || name.length === 0) return;\n\n\t\tconst message = await window.showInputBox({\n\t\t\tprompt: 'Please provide an optional message to annotate the tag',\n\t\t\tplaceHolder: 'Tag message',\n\t\t\tignoreFocusOut: true\n\t\t});\n\t\tif (message === undefined) return;\n\n\t\tconst args = `${message.length !== 0 ? `-a -m \"${message}\" ` : ''}${name} ${node.ref}`;\n\t\trunGitCommandInTerminal('tag', args, node.repoPath);\n\t}\n\n\tterminalDeleteTag(node: TagNode) {\n\t\tif (!(node instanceof TagNode)) return;\n\n\t\trunGitCommandInTerminal('tag', `-d ${node.ref}`, node.repoPath);\n\t}\n}\n","'use strict';\nimport { Config } from '../config';\n\nexport interface IpcMessage {\n\tid: string;\n\tmethod: string;\n\tparams?: any;\n}\n\nexport type IpcNotificationParamsOf<NT> = NT extends IpcNotificationType<infer P> ? P : never;\nexport class IpcNotificationType<P = any> {\n\tconstructor(public readonly method: string) {}\n}\n\nexport type IpcCommandParamsOf<CT> = CT extends IpcCommandType<infer P> ? P : never;\nexport class IpcCommandType<P = any> {\n\tconstructor(public readonly method: string) {}\n}\n\nexport function onIpcCommand<CT extends IpcCommandType>(\n\ttype: CT,\n\tcommand: IpcMessage,\n\tfn: (params: IpcCommandParamsOf<CT>) => unknown\n) {\n\tfn(command.params);\n}\n\nexport function onIpcNotification<NT extends IpcNotificationType>(\n\ttype: NT,\n\tnotification: IpcMessage,\n\tfn: (params: IpcNotificationParamsOf<NT>) => void\n) {\n\tfn(notification.params);\n}\n\nexport interface DidChangeConfigurationNotificationParams {\n\tconfig: Config;\n}\nexport const DidChangeConfigurationNotificationType = new IpcNotificationType<DidChangeConfigurationNotificationParams>(\n\t'configuration/didChange'\n);\n\nexport const ReadyCommandType = new IpcCommandType<{}>('webview/ready');\n\nexport interface UpdateConfigurationCommandParams {\n\tchanges: {\n\t\t[key: string]: any;\n\t};\n\tremoves: string[];\n\tscope: 'user' | 'workspace';\n\turi?: string;\n}\nexport const UpdateConfigurationCommandType = new IpcCommandType<UpdateConfigurationCommandParams>(\n\t'configuration/update'\n);\n\nexport interface SettingsDidRequestJumpToNotificationParams {\n\tanchor: string;\n}\nexport const SettingsDidRequestJumpToNotificationType = new IpcNotificationType<\n\tSettingsDidRequestJumpToNotificationParams\n>('settings/jumpTo');\n\nexport interface AppStateWithConfig {\n\tconfig: Config;\n}\n\nexport interface SettingsState extends AppStateWithConfig {\n\tscope: 'user' | 'workspace';\n\tscopes: ['user' | 'workspace', string][];\n}\n\nexport interface WelcomeState extends AppStateWithConfig {}\n","'use strict';\nimport * as paths from 'path';\nimport * as fs from 'fs';\nimport {\n\tcommands,\n\tConfigurationChangeEvent,\n\tConfigurationTarget,\n\tDisposable,\n\tUri,\n\tViewColumn,\n\tWebviewPanel,\n\tWebviewPanelOnDidChangeViewStateEvent,\n\twindow,\n\tworkspace\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport {\n\tDidChangeConfigurationNotificationType,\n\tIpcMessage,\n\tIpcNotificationParamsOf,\n\tIpcNotificationType,\n\tonIpcCommand,\n\tUpdateConfigurationCommandType\n} from './protocol';\nimport { Commands } from '../commands';\n\nlet ipcSequence = 0;\n\nconst emptyCommands: Disposable[] = [\n\t{\n\t\tdispose: function() {\n\t\t\t/* noop */\n\t\t}\n\t}\n];\n\nexport abstract class WebviewBase implements Disposable {\n\tprotected _disposable: Disposable;\n\tprivate _disposablePanel: Disposable | undefined;\n\tprivate _panel: WebviewPanel | undefined;\n\n\tconstructor(showCommand: Commands, private readonly _column?: ViewColumn) {\n\t\tthis._disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\tcommands.registerCommand(showCommand, this.onShowCommand, this)\n\t\t);\n\t}\n\n\tabstract get filename(): string;\n\tabstract get id(): string;\n\tabstract get title(): string;\n\n\tregisterCommands(): Disposable[] {\n\t\treturn emptyCommands;\n\t}\n\n\trenderHead?(): string | Promise<string>;\n\trenderBody?(): string | Promise<string>;\n\trenderEndOfBody?(): string | Promise<string>;\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t\tthis._disposablePanel && this._disposablePanel.dispose();\n\t}\n\n\tprotected onShowCommand() {\n\t\tthis.show(this._column);\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tthis.notifyDidChangeConfiguration();\n\t}\n\n\tprivate onPanelDisposed() {\n\t\tthis._disposablePanel && this._disposablePanel.dispose();\n\t\tthis._panel = undefined;\n\t}\n\n\tprivate onViewStateChanged(e: WebviewPanelOnDidChangeViewStateEvent) {\n\t\tLogger.log(\n\t\t\t`Webview(${this.id}).onViewStateChanged`,\n\t\t\t`active=${e.webviewPanel.active}, visible=${e.webviewPanel.visible}`\n\t\t);\n\n\t\t// Anytime the webview becomes active, make sure it has the most up-to-date config\n\t\tif (e.webviewPanel.active) {\n\t\t\tthis.notifyDidChangeConfiguration();\n\t\t}\n\t}\n\n\tprotected onMessageReceived(e: IpcMessage) {\n\t\tswitch (e.method) {\n\t\t\tcase UpdateConfigurationCommandType.method:\n\t\t\t\tonIpcCommand(UpdateConfigurationCommandType, e, async params => {\n\t\t\t\t\tconst target =\n\t\t\t\t\t\tparams.scope === 'workspace' ? ConfigurationTarget.Workspace : ConfigurationTarget.Global;\n\n\t\t\t\t\tfor (const key in params.changes) {\n\t\t\t\t\t\tconst inspect = configuration.inspect(key as any)!;\n\n\t\t\t\t\t\tlet value = params.changes[key];\n\t\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\t\tif (params.scope === 'workspace') {\n\t\t\t\t\t\t\t\tif (value === inspect.workspaceValue) continue;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (value === inspect.globalValue && value !== inspect.defaultValue) continue;\n\n\t\t\t\t\t\t\t\tif (value === inspect.defaultValue) {\n\t\t\t\t\t\t\t\t\tvalue = undefined;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid (await configuration.update(key as any, value, target));\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const key of params.removes) {\n\t\t\t\t\t\tvoid (await configuration.update(key as any, undefined, target));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate onMessageReceivedCore(e: IpcMessage) {\n\t\tif (e == null) return;\n\n\t\tLogger.log(`Webview(${this.id}).onMessageReceived: method=${e.method}, data=${JSON.stringify(e)}`);\n\n\t\tthis.onMessageReceived(e);\n\t}\n\n\tget visible() {\n\t\treturn this._panel === undefined ? false : this._panel.visible;\n\t}\n\n\thide() {\n\t\tif (this._panel === undefined) return;\n\n\t\tthis._panel.dispose();\n\t}\n\n\tsetTitle(title: string) {\n\t\tif (this._panel === undefined) return;\n\n\t\tthis._panel.title = title;\n\t}\n\n\tasync show(column: ViewColumn = ViewColumn.Active): Promise<void> {\n\t\tconst html = await this.getHtml();\n\n\t\tif (this._panel === undefined) {\n\t\t\tthis._panel = window.createWebviewPanel(\n\t\t\t\tthis.id,\n\t\t\t\tthis.title,\n\t\t\t\t{ viewColumn: column, preserveFocus: false },\n\t\t\t\t{\n\t\t\t\t\tretainContextWhenHidden: true,\n\t\t\t\t\tenableFindWidget: true,\n\t\t\t\t\tenableCommandUris: true,\n\t\t\t\t\tenableScripts: true\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis._panel.iconPath = Uri.file(Container.context.asAbsolutePath('images/gitlens-icon.png'));\n\t\t\tthis._disposablePanel = Disposable.from(\n\t\t\t\tthis._panel,\n\t\t\t\tthis._panel.onDidDispose(this.onPanelDisposed, this),\n\t\t\t\tthis._panel.onDidChangeViewState(this.onViewStateChanged, this),\n\t\t\t\tthis._panel.webview.onDidReceiveMessage(this.onMessageReceivedCore, this),\n\t\t\t\t...this.registerCommands()\n\t\t\t);\n\n\t\t\tthis._panel.webview.html = html;\n\t\t} else {\n\t\t\t// Reset the html to get the webview to reload\n\t\t\tthis._panel.webview.html = '';\n\t\t\tthis._panel.webview.html = html;\n\t\t\tthis._panel.reveal(this._panel.viewColumn || ViewColumn.Active, false);\n\t\t}\n\t}\n\n\tprivate _html: string | undefined;\n\tprivate async getHtml(): Promise<string> {\n\t\tconst filename = Container.context.asAbsolutePath(paths.join('dist/webviews/', this.filename));\n\n\t\tlet content;\n\t\t// When we are debugging avoid any caching so that we can change the html and have it update without reloading\n\t\tif (Logger.isDebugging) {\n\t\t\tcontent = await new Promise<string>((resolve, reject) => {\n\t\t\t\tfs.readFile(filename, 'utf8', (err, data) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tif (this._html !== undefined) return this._html;\n\n\t\t\tconst doc = await workspace.openTextDocument(filename);\n\t\t\tcontent = doc.getText();\n\t\t}\n\n\t\tlet html = content.replace(\n\t\t\t/#{root}/g,\n\t\t\tUri.file(Container.context.asAbsolutePath('.'))\n\t\t\t\t.with({ scheme: 'vscode-resource' })\n\t\t\t\t.toString()\n\t\t);\n\n\t\tif (this.renderHead) {\n\t\t\thtml = html.replace(/#{head}/i, await this.renderHead());\n\t\t}\n\n\t\tif (this.renderBody) {\n\t\t\thtml = html.replace(/#{body}/i, await this.renderBody());\n\t\t}\n\n\t\tif (this.renderEndOfBody) {\n\t\t\thtml = html.replace(/#{endOfBody}/i, await this.renderEndOfBody());\n\t\t}\n\n\t\tthis._html = html;\n\t\treturn html;\n\t}\n\n\tprotected notify<NT extends IpcNotificationType>(type: NT, params: IpcNotificationParamsOf<NT>): Thenable<boolean> {\n\t\treturn this.postMessage({ id: this.nextIpcId(), method: type.method, params: params });\n\t}\n\n\tprivate nextIpcId() {\n\t\tif (ipcSequence === Number.MAX_SAFE_INTEGER) {\n\t\t\tipcSequence = 1;\n\t\t} else {\n\t\t\tipcSequence++;\n\t\t}\n\n\t\treturn `host:${ipcSequence}`;\n\t}\n\n\tprivate notifyDidChangeConfiguration() {\n\t\t// Make sure to get the raw config, not from the container which has the modes mixed in\n\t\treturn this.notify(DidChangeConfigurationNotificationType, { config: configuration.get() });\n\t}\n\n\tprivate postMessage(message: IpcMessage) {\n\t\tif (this._panel === undefined) return Promise.resolve(false);\n\n\t\treturn this._panel.webview.postMessage(message);\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget } from 'vscode';\nimport { configuration, ViewLocation } from '../configuration';\n\nexport function applyViewLayoutPreset(preset: 'contextual' | 'default' | 'scm') {\n\tlet repositories;\n\tlet histories;\n\tlet compareAndSearch;\n\tswitch (preset) {\n\t\tcase 'contextual':\n\t\t\trepositories = ViewLocation.SourceControl;\n\t\t\thistories = ViewLocation.Explorer;\n\t\t\tcompareAndSearch = ViewLocation.GitLens;\n\t\t\tbreak;\n\t\tcase 'default':\n\t\t\trepositories = ViewLocation.GitLens;\n\t\t\thistories = ViewLocation.GitLens;\n\t\t\tcompareAndSearch = ViewLocation.GitLens;\n\t\t\tbreak;\n\t\tcase 'scm':\n\t\t\trepositories = ViewLocation.SourceControl;\n\t\t\thistories = ViewLocation.SourceControl;\n\t\t\tcompareAndSearch = ViewLocation.SourceControl;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\treturn;\n\t}\n\n\tconfiguration.update('views', 'repositories', 'location', repositories, ConfigurationTarget.Global);\n\tconfiguration.update('views', 'fileHistory', 'location', histories, ConfigurationTarget.Global);\n\tconfiguration.update('views', 'lineHistory', 'location', histories, ConfigurationTarget.Global);\n\tconfiguration.update('views', 'compare', 'location', compareAndSearch, ConfigurationTarget.Global);\n\tconfiguration.update('views', 'search', 'location', compareAndSearch, ConfigurationTarget.Global);\n}\n","'use strict';\nimport { commands, Disposable, workspace } from 'vscode';\nimport { Commands } from '../commands';\nimport { configuration } from '../configuration';\nimport {\n\tIpcMessage,\n\tonIpcCommand,\n\tReadyCommandType,\n\tSettingsDidRequestJumpToNotificationType,\n\tSettingsState\n} from './protocol';\nimport { WebviewBase } from './webviewBase';\nimport { applyViewLayoutPreset } from './helpers';\n\nconst anchorRegex = /.*?#(.*)/;\n\nexport class SettingsWebview extends WebviewBase {\n\tprivate _pendingJumpToAnchor: string | undefined;\n\n\tconstructor() {\n\t\tsuper(Commands.ShowSettingsPage);\n\n\t\tthis._disposable = Disposable.from(\n\t\t\tthis._disposable,\n\t\t\t...[\n\t\t\t\tCommands.ShowSettingsPageAndJumpToCompareView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToFileHistoryView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToLineHistoryView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToRepositoriesView,\n\t\t\t\tCommands.ShowSettingsPageAndJumpToSearchCommitsView\n\t\t\t].map(c => {\n\t\t\t\t// The show and jump commands are structured to have a # separating the base command from the anchor\n\t\t\t\tlet anchor: string | undefined;\n\t\t\t\tconst match = anchorRegex.exec(c);\n\t\t\t\tif (match != null) {\n\t\t\t\t\t[, anchor] = match;\n\t\t\t\t}\n\n\t\t\t\treturn commands.registerCommand(c, () => this.onShowCommand(anchor), this);\n\t\t\t})\n\t\t);\n\t}\n\n\tprotected onShowCommand(anchor?: string) {\n\t\tif (anchor) {\n\t\t\tthis._pendingJumpToAnchor = anchor;\n\t\t}\n\t\tsuper.onShowCommand();\n\t}\n\n\tprotected onMessageReceived(e: IpcMessage) {\n\t\tswitch (e.method) {\n\t\t\tcase ReadyCommandType.method:\n\t\t\t\tonIpcCommand(ReadyCommandType, e, params => {\n\t\t\t\t\tif (this._pendingJumpToAnchor !== undefined) {\n\t\t\t\t\t\tthis.notify(SettingsDidRequestJumpToNotificationType, { anchor: this._pendingJumpToAnchor });\n\t\t\t\t\t\tthis._pendingJumpToAnchor = undefined;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tsuper.onMessageReceived(e);\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tget filename(): string {\n\t\treturn 'settings.html';\n\t}\n\n\tget id(): string {\n\t\treturn 'gitlens.settings';\n\t}\n\n\tget title(): string {\n\t\treturn 'GitLens Settings';\n\t}\n\n\trenderEndOfBody() {\n\t\tconst scopes: ['user' | 'workspace', string][] = [['user', 'User']];\n\t\tif (workspace.workspaceFolders !== undefined && workspace.workspaceFolders.length) {\n\t\t\tscopes.push(['workspace', 'Workspace']);\n\t\t}\n\n\t\tconst bootstrap: SettingsState = {\n\t\t\t// Make sure to get the raw config, not from the container which has the modes mixed in\n\t\t\tconfig: configuration.get(),\n\t\t\tscope: 'user',\n\t\t\tscopes: scopes\n\t\t};\n\t\treturn `<script type=\"text/javascript\" nonce=\"Z2l0bGVucy1ib290c3RyYXA=\">window.bootstrap = ${JSON.stringify(\n\t\t\tbootstrap\n\t\t)};</script>`;\n\t}\n\n\tregisterCommands() {\n\t\treturn [commands.registerCommand(`${this.id}.applyViewLayoutPreset`, applyViewLayoutPreset, this)];\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Commands } from '../commands';\nimport { Container } from '../container';\nimport { WelcomeState } from './protocol';\nimport { WebviewBase } from './webviewBase';\nimport { applyViewLayoutPreset } from './helpers';\n\nexport class WelcomeWebview extends WebviewBase {\n\tconstructor() {\n\t\tsuper(Commands.ShowWelcomePage);\n\t}\n\n\tget filename(): string {\n\t\treturn 'welcome.html';\n\t}\n\n\tget id(): string {\n\t\treturn 'gitlens.welcome';\n\t}\n\n\tget title(): string {\n\t\treturn 'Welcome to GitLens';\n\t}\n\n\tregisterCommands() {\n\t\treturn [commands.registerCommand(`${this.id}.applyViewLayoutPreset`, applyViewLayoutPreset, this)];\n\t}\n\n\trenderEndOfBody() {\n\t\tconst bootstrap: WelcomeState = {\n\t\t\tconfig: Container.config\n\t\t};\n\t\treturn `<script type=\"text/javascript\" nonce=\"Z2l0bGVucy1ib290c3RyYXA=\">window.bootstrap = ${JSON.stringify(\n\t\t\tbootstrap\n\t\t)};</script>`;\n\t}\n}\n","'use strict';\nimport { commands, ConfigurationChangeEvent, Disposable, ExtensionContext, Uri } from 'vscode';\nimport { FileAnnotationController } from './annotations/fileAnnotationController';\nimport { LineAnnotationController } from './annotations/lineAnnotationController';\nimport { GitCodeLensController } from './codelens/codeLensController';\nimport { Commands, ToggleFileBlameCommandArgs } from './commands';\nimport { AnnotationsToggleMode, Config, configuration, ConfigurationWillChangeEvent } from './configuration';\nimport { GitFileSystemProvider } from './git/fsProvider';\nimport { GitService } from './git/gitService';\nimport { clearAvatarCache } from './avatars';\nimport { LineHoverController } from './hovers/lineHoverController';\nimport { Keyboard } from './keyboard';\nimport { Logger } from './logger';\nimport { StatusBarController } from './statusbar/statusBarController';\nimport { GitDocumentTracker } from './trackers/gitDocumentTracker';\nimport { GitLineTracker } from './trackers/gitLineTracker';\nimport { CompareView } from './views/compareView';\nimport { FileHistoryView } from './views/fileHistoryView';\nimport { LineHistoryView } from './views/lineHistoryView';\nimport { RepositoriesView } from './views/repositoriesView';\nimport { SearchView } from './views/searchView';\nimport { ViewCommands } from './views/viewCommands';\nimport { VslsController } from './vsls/vsls';\nimport { SettingsWebview } from './webviews/settingsWebview';\nimport { WelcomeWebview } from './webviews/welcomeWebview';\n\nexport class Container {\n\tprivate static _configsAffectedByMode: string[] | undefined;\n\tprivate static _applyModeConfigurationTransformBound:\n\t\t| ((e: ConfigurationChangeEvent) => ConfigurationChangeEvent)\n\t\t| undefined;\n\n\tstatic initialize(context: ExtensionContext, config: Config) {\n\t\tthis._context = context;\n\t\tthis._config = Container.applyMode(config);\n\n\t\tcontext.subscriptions.push((this._lineTracker = new GitLineTracker()));\n\t\tcontext.subscriptions.push((this._tracker = new GitDocumentTracker()));\n\t\tcontext.subscriptions.push((this._vsls = new VslsController()));\n\n\t\tcontext.subscriptions.push((this._git = new GitService()));\n\n\t\t// Since there is a bit of a chicken & egg problem with the DocumentTracker and the GitService, initialize the tracker once the GitService is loaded\n\t\tthis._tracker.initialize();\n\n\t\tcontext.subscriptions.push((this._fileAnnotationController = new FileAnnotationController()));\n\t\tcontext.subscriptions.push((this._lineAnnotationController = new LineAnnotationController()));\n\t\tcontext.subscriptions.push((this._lineHoverController = new LineHoverController()));\n\t\tcontext.subscriptions.push((this._statusBarController = new StatusBarController()));\n\t\tcontext.subscriptions.push((this._codeLensController = new GitCodeLensController()));\n\t\tcontext.subscriptions.push((this._keyboard = new Keyboard()));\n\t\tcontext.subscriptions.push((this._settingsWebview = new SettingsWebview()));\n\t\tcontext.subscriptions.push((this._welcomeWebview = new WelcomeWebview()));\n\n\t\tif (config.views.compare.enabled) {\n\t\t\tcontext.subscriptions.push((this._compareView = new CompareView()));\n\t\t} else {\n\t\t\tlet disposable: Disposable;\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tdisposable = configuration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'views', 'compare', 'enabled')) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tcontext.subscriptions.push((this._compareView = new CompareView()));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (config.views.fileHistory.enabled) {\n\t\t\tcontext.subscriptions.push((this._fileHistoryView = new FileHistoryView()));\n\t\t} else {\n\t\t\tlet disposable: Disposable;\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tdisposable = configuration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'views', 'fileHistory', 'enabled')) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tcontext.subscriptions.push((this._fileHistoryView = new FileHistoryView()));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (config.views.lineHistory.enabled) {\n\t\t\tcontext.subscriptions.push((this._lineHistoryView = new LineHistoryView()));\n\t\t} else {\n\t\t\tlet disposable: Disposable;\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tdisposable = configuration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'views', 'lineHistory', 'enabled')) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tcontext.subscriptions.push((this._lineHistoryView = new LineHistoryView()));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (config.views.repositories.enabled) {\n\t\t\tcontext.subscriptions.push((this._repositoriesView = new RepositoriesView()));\n\t\t} else {\n\t\t\tlet disposable: Disposable;\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tdisposable = configuration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'views', 'repositories', 'enabled')) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tcontext.subscriptions.push((this._repositoriesView = new RepositoriesView()));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (config.views.search.enabled) {\n\t\t\tcontext.subscriptions.push((this._searchView = new SearchView()));\n\t\t} else {\n\t\t\tlet disposable: Disposable;\n\t\t\t// eslint-disable-next-line prefer-const\n\t\t\tdisposable = configuration.onDidChange(e => {\n\t\t\t\tif (configuration.changed(e, 'views', 'search', 'enabled')) {\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\tcontext.subscriptions.push((this._searchView = new SearchView()));\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcontext.subscriptions.push(new GitFileSystemProvider());\n\n\t\tcontext.subscriptions.push(configuration.onWillChange(this.onConfigurationChanging, this));\n\t}\n\n\tprivate static onConfigurationChanging(e: ConfigurationWillChangeEvent) {\n\t\tthis._config = undefined;\n\n\t\tif (configuration.changed(e.change, 'outputLevel')) {\n\t\t\tLogger.level = configuration.get('outputLevel');\n\t\t}\n\n\t\tif (configuration.changed(e.change, 'defaultGravatarsStyle')) {\n\t\t\tclearAvatarCache();\n\t\t}\n\n\t\tif (configuration.changed(e.change, 'mode') || configuration.changed(e.change, 'modes')) {\n\t\t\tif (this._applyModeConfigurationTransformBound === undefined) {\n\t\t\t\tthis._applyModeConfigurationTransformBound = this.applyModeConfigurationTransform.bind(this);\n\t\t\t}\n\t\t\te.transform = this._applyModeConfigurationTransformBound;\n\t\t}\n\t}\n\n\tprivate static _codeLensController: GitCodeLensController;\n\tstatic get codeLens() {\n\t\treturn this._codeLensController;\n\t}\n\n\tprivate static _compareView: CompareView | undefined;\n\tstatic get compareView() {\n\t\tif (this._compareView === undefined) {\n\t\t\tthis._context.subscriptions.push((this._compareView = new CompareView()));\n\t\t}\n\n\t\treturn this._compareView;\n\t}\n\n\tprivate static _config: Config | undefined;\n\tstatic get config() {\n\t\tif (this._config === undefined) {\n\t\t\tthis._config = Container.applyMode(configuration.get());\n\t\t}\n\t\treturn this._config;\n\t}\n\n\tprivate static _context: ExtensionContext;\n\tstatic get context() {\n\t\treturn this._context;\n\t}\n\n\tprivate static _fileAnnotationController: FileAnnotationController;\n\tstatic get fileAnnotations() {\n\t\treturn this._fileAnnotationController;\n\t}\n\n\tprivate static _fileHistoryView: FileHistoryView | undefined;\n\tstatic get fileHistoryView() {\n\t\tif (this._fileHistoryView === undefined) {\n\t\t\tthis._context.subscriptions.push((this._fileHistoryView = new FileHistoryView()));\n\t\t}\n\n\t\treturn this._fileHistoryView;\n\t}\n\n\tprivate static _git: GitService;\n\tstatic get git() {\n\t\treturn this._git;\n\t}\n\n\tprivate static _keyboard: Keyboard;\n\tstatic get keyboard() {\n\t\treturn this._keyboard;\n\t}\n\n\tprivate static _lineAnnotationController: LineAnnotationController;\n\tstatic get lineAnnotations() {\n\t\treturn this._lineAnnotationController;\n\t}\n\n\tprivate static _lineHistoryView: LineHistoryView | undefined;\n\tstatic get lineHistoryView() {\n\t\tif (this._lineHistoryView === undefined) {\n\t\t\tthis._context.subscriptions.push((this._lineHistoryView = new LineHistoryView()));\n\t\t}\n\n\t\treturn this._lineHistoryView;\n\t}\n\n\tprivate static _lineHoverController: LineHoverController;\n\tstatic get lineHovers() {\n\t\treturn this._lineHoverController;\n\t}\n\n\tprivate static _lineTracker: GitLineTracker;\n\tstatic get lineTracker() {\n\t\treturn this._lineTracker;\n\t}\n\n\tprivate static _repositoriesView: RepositoriesView | undefined;\n\tstatic get repositoriesView(): RepositoriesView {\n\t\tif (this._repositoriesView === undefined) {\n\t\t\tthis._context.subscriptions.push((this._repositoriesView = new RepositoriesView()));\n\t\t}\n\n\t\treturn this._repositoriesView;\n\t}\n\n\tprivate static _searchView: SearchView | undefined;\n\tstatic get searchView() {\n\t\tif (this._searchView === undefined) {\n\t\t\tthis._context.subscriptions.push((this._searchView = new SearchView()));\n\t\t}\n\n\t\treturn this._searchView;\n\t}\n\n\tprivate static _settingsWebview: SettingsWebview;\n\tstatic get settingsWebview() {\n\t\treturn this._settingsWebview;\n\t}\n\n\tprivate static _statusBarController: StatusBarController;\n\tstatic get statusBar() {\n\t\treturn this._statusBarController;\n\t}\n\n\tprivate static _tracker: GitDocumentTracker;\n\tstatic get tracker() {\n\t\treturn this._tracker;\n\t}\n\n\tprivate static _viewCommands: ViewCommands | undefined;\n\tstatic get viewCommands() {\n\t\tif (this._viewCommands === undefined) {\n\t\t\tthis._viewCommands = new ViewCommands();\n\t\t}\n\t\treturn this._viewCommands;\n\t}\n\n\tprivate static _vsls: VslsController;\n\tstatic get vsls() {\n\t\treturn this._vsls;\n\t}\n\n\tprivate static _welcomeWebview: WelcomeWebview;\n\tstatic get welcomeWebview() {\n\t\treturn this._welcomeWebview;\n\t}\n\n\tprivate static applyMode(config: Config) {\n\t\tif (!config.mode.active) return config;\n\n\t\tconst mode = config.modes[config.mode.active];\n\t\tif (mode == null) return config;\n\n\t\tif (mode.annotations != null) {\n\t\t\tlet command: string | undefined;\n\t\t\tswitch (mode.annotations) {\n\t\t\t\tcase 'blame':\n\t\t\t\t\tconfig.blame.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileBlame;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'heatmap':\n\t\t\t\t\tconfig.heatmap.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileHeatmap;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'recentChanges':\n\t\t\t\t\tconfig.recentChanges.toggleMode = AnnotationsToggleMode.Window;\n\t\t\t\t\tcommand = Commands.ToggleFileRecentChanges;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (command !== undefined) {\n\t\t\t\tconst commandArgs: ToggleFileBlameCommandArgs = {\n\t\t\t\t\ton: true\n\t\t\t\t};\n\t\t\t\t// Make sure to delay the execution by a bit so that the configuration changes get propegated first\n\t\t\t\tsetTimeout(() => commands.executeCommand(command!, commandArgs), 50);\n\t\t\t}\n\t\t}\n\n\t\tif (mode.codeLens != null) {\n\t\t\tconfig.codeLens.enabled = mode.codeLens;\n\t\t}\n\n\t\tif (mode.currentLine != null) {\n\t\t\tconfig.currentLine.enabled = mode.currentLine;\n\t\t}\n\n\t\tif (mode.hovers != null) {\n\t\t\tconfig.hovers.enabled = mode.hovers;\n\t\t}\n\n\t\tif (mode.statusBar != null) {\n\t\t\tconfig.statusBar.enabled = mode.statusBar;\n\t\t}\n\n\t\tif (mode.views != null) {\n\t\t\tconfig.views.compare.enabled = mode.views;\n\t\t}\n\t\tif (mode.views != null) {\n\t\t\tconfig.views.fileHistory.enabled = mode.views;\n\t\t}\n\t\tif (mode.views != null) {\n\t\t\tconfig.views.lineHistory.enabled = mode.views;\n\t\t}\n\t\tif (mode.views != null) {\n\t\t\tconfig.views.repositories.enabled = mode.views;\n\t\t}\n\t\tif (mode.views != null) {\n\t\t\tconfig.views.search.enabled = mode.views;\n\t\t}\n\n\t\treturn config;\n\t}\n\n\tprivate static applyModeConfigurationTransform(e: ConfigurationChangeEvent): ConfigurationChangeEvent {\n\t\tif (this._configsAffectedByMode === undefined) {\n\t\t\tthis._configsAffectedByMode = [\n\t\t\t\t`gitlens.${configuration.name('mode')}`,\n\t\t\t\t`gitlens.${configuration.name('modes')}`,\n\t\t\t\t`gitlens.${configuration.name('blame', 'toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('codeLens')}`,\n\t\t\t\t`gitlens.${configuration.name('currentLine')}`,\n\t\t\t\t`gitlens.${configuration.name('heatmap', 'toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('hovers')}`,\n\t\t\t\t`gitlens.${configuration.name('recentChanges', 'toggleMode')}`,\n\t\t\t\t`gitlens.${configuration.name('statusBar')}`,\n\t\t\t\t`gitlens.${configuration.name('views', 'compare')}`,\n\t\t\t\t`gitlens.${configuration.name('views', 'fileHistory')}`,\n\t\t\t\t`gitlens.${configuration.name('views', 'lineHistory')}`,\n\t\t\t\t`gitlens.${configuration.name('views', 'repositories')}`,\n\t\t\t\t`gitlens.${configuration.name('views', 'search')}`\n\t\t\t];\n\t\t}\n\n\t\tconst original = e.affectsConfiguration;\n\t\treturn {\n\t\t\t...e,\n\t\t\taffectsConfiguration: (section: string, resource?: Uri) => {\n\t\t\t\tif (this._configsAffectedByMode && this._configsAffectedByMode.some(n => section.startsWith(n))) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn original(section, resource);\n\t\t\t}\n\t\t};\n\t}\n}\n","'use strict';\nimport * as fs from 'fs';\nimport * as paths from 'path';\nimport {\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tExtension,\n\textensions,\n\tProgressLocation,\n\tRange,\n\tTextEditor,\n\tUri,\n\twindow,\n\tWindowState,\n\tworkspace,\n\tWorkspaceFolder,\n\tWorkspaceFoldersChangeEvent\n} from 'vscode';\n// eslint-disable-next-line import/no-unresolved\nimport { API as BuiltInGitApi, GitExtension } from '../@types/git';\nimport { configuration } from '../configuration';\nimport { CommandContext, DocumentSchemes, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { LogCorrelationContext, Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Arrays, debug, gate, Iterables, log, Objects, Strings, TernarySearchTree, Versions } from '../system';\nimport { CachedBlame, CachedDiff, CachedLog, GitDocumentState, TrackedDocument } from '../trackers/gitDocumentTracker';\nimport { vslsUriPrefixRegex } from '../vsls/vsls';\nimport {\n\tBranchDateFormatting,\n\tCommitDateFormatting,\n\tGit,\n\tGitAuthor,\n\tGitBlame,\n\tGitBlameCommit,\n\tGitBlameLine,\n\tGitBlameLines,\n\tGitBlameParser,\n\tGitBranch,\n\tGitBranchParser,\n\tGitCommit,\n\tGitCommitType,\n\tGitContributor,\n\tGitDiff,\n\tGitDiffHunkLine,\n\tGitDiffParser,\n\tGitDiffShortStat,\n\tGitErrors,\n\tGitFile,\n\tGitLog,\n\tGitLogCommit,\n\tGitLogDiffFilter,\n\tGitLogParser,\n\tGitReflog,\n\tGitRemote,\n\tGitRemoteParser,\n\tGitStash,\n\tGitStashParser,\n\tGitStatus,\n\tGitStatusFile,\n\tGitStatusParser,\n\tGitTag,\n\tGitTagParser,\n\tGitTree,\n\tGitTreeParser,\n\tRepository,\n\tRepositoryChange\n} from './git';\nimport { GitUri } from './gitUri';\nimport { RemoteProviderFactory, RemoteProviders } from './remotes/factory';\nimport { GitReflogParser, GitShortLogParser } from './parsers/parsers';\n\nexport * from './gitUri';\nexport * from './models/models';\nexport * from './formatters/formatters';\nexport * from './remotes/provider';\nexport { RemoteProviderFactory } from './remotes/factory';\n\nconst emptyStr = '';\nconst slash = '/';\n\nconst RepoSearchWarnings = {\n\tdoesNotExist: /no such file or directory/i\n};\n\nconst doubleQuoteRegex = /\"/g;\nconst userConfigRegex = /^user\\.(name|email) (.*)$/gm;\nconst mappedAuthorRegex = /(.+)\\s<(.+)>/;\nconst searchMessageOperationRegex = /(?=(.*?)\\s?(?:(?:=:|message:|@:|author:|#:|commit:|\\?:|file:|~:|change:)|$))/;\nconst searchMessageValuesRegex = /(\".+\"|[^\\b\\s]+)/g;\nconst searchOperationRegex = /((?:=|message|@|author|#|commit|\\?|file|~|change):)\\s?(?=(.*?)\\s?(?:(?:=:|message:|@:|author:|#:|commit:|\\?:|file:|~:|change:)|$))/g;\n\nconst emptyPromise: Promise<GitBlame | GitDiff | GitLog | undefined> = Promise.resolve(undefined);\nconst reflogCommands = ['merge', 'pull'];\n\nexport type SearchOperators =\n\t| ''\n\t| '=:'\n\t| 'message:'\n\t| '@:'\n\t| 'author:'\n\t| '#:'\n\t| 'commit:'\n\t| '?:'\n\t| 'file:'\n\t| '~:'\n\t| 'change:';\n\nexport const searchOperators = new Set<string>([\n\t'',\n\t'=:',\n\t'message:',\n\t'@:',\n\t'author:',\n\t'#:',\n\t'commit:',\n\t'?:',\n\t'file:',\n\t'~:',\n\t'change:'\n]);\n\nexport interface SearchPattern {\n\tpattern: string;\n\tmatchAll?: boolean;\n\tmatchCase?: boolean;\n\tmatchRegex?: boolean;\n}\n\nexport namespace SearchPattern {\n\texport function fromCommit(ref: string): string;\n\texport function fromCommit(commit: GitCommit): string;\n\texport function fromCommit(refOrCommit: string | GitCommit) {\n\t\treturn `#:${GitService.shortenSha(typeof refOrCommit === 'string' ? refOrCommit : refOrCommit.sha)}`;\n\t}\n\n\texport function fromCommits(refs: string[]): string;\n\texport function fromCommits(commits: GitCommit[]): string;\n\texport function fromCommits(refsOrCommits: (string | GitCommit)[]) {\n\t\treturn refsOrCommits.map(r => `#:${GitService.shortenSha(typeof r === 'string' ? r : r.sha)}`).join(' ');\n\t}\n\n\texport function toKey(search: SearchPattern) {\n\t\treturn `${search.pattern}|${search.matchAll ? 'A' : ''}${search.matchCase ? 'C' : ''}${\n\t\t\tsearch.matchRegex ? 'R' : ''\n\t\t}`;\n\t}\n}\n\nconst normalizeSearchOperatorsMap = new Map<SearchOperators, SearchOperators>([\n\t['', 'message:'],\n\t['=:', 'message:'],\n\t['message:', 'message:'],\n\t['@:', 'author:'],\n\t['author:', 'author:'],\n\t['#:', 'commit:'],\n\t['commit:', 'commit:'],\n\t['?:', 'file:'],\n\t['file:', 'file:'],\n\t['~:', 'change:'],\n\t['change:', 'change:']\n]);\n\nexport class GitService implements Disposable {\n\tprivate _onDidChangeRepositories = new EventEmitter<void>();\n\tget onDidChangeRepositories(): Event<void> {\n\t\treturn this._onDidChangeRepositories.event;\n\t}\n\n\tprivate readonly _disposable: Disposable;\n\tprivate readonly _repositoryTree: TernarySearchTree<Repository>;\n\tprivate _repositoriesLoadingPromise: Promise<void> | undefined;\n\tprivate _suspended: boolean = false;\n\n\tprivate readonly _branchesCache = new Map<string, GitBranch[]>();\n\tprivate readonly _tagsCache = new Map<string, GitTag[]>();\n\tprivate readonly _tagsWithRefsCache = new Map<string, GitTag[]>();\n\tprivate readonly _trackedCache = new Map<string, boolean | Promise<boolean>>();\n\tprivate readonly _userMapCache = new Map<string, { name?: string; email?: string } | null>();\n\n\tconstructor() {\n\t\tthis._repositoryTree = TernarySearchTree.forPaths();\n\n\t\tthis._disposable = Disposable.from(\n\t\t\twindow.onDidChangeWindowState(this.onWindowStateChanged, this),\n\t\t\tworkspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged, this),\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this)\n\t\t);\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\n\t\tthis._repositoriesLoadingPromise = this.onWorkspaceFoldersChanged();\n\t}\n\n\tdispose() {\n\t\tthis._repositoryTree.forEach(r => r.dispose());\n\t\tthis._branchesCache.clear();\n\t\tthis._tagsCache.clear();\n\t\tthis._tagsWithRefsCache.clear();\n\t\tthis._trackedCache.clear();\n\t\tthis._userMapCache.clear();\n\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\t@log()\n\tstatic async initialize(): Promise<void> {\n\t\t// Try to use the same git as the built-in vscode git extension\n\t\tlet gitPath;\n\t\tconst gitApi = await GitService.getBuiltInGitApi();\n\t\tif (gitApi !== undefined) {\n\t\t\tgitPath = gitApi.git.path;\n\t\t}\n\n\t\tawait Git.setOrFindGitPath(gitPath || configuration.getAny<string>('git.path'));\n\t}\n\n\tget readonly() {\n\t\treturn Container.vsls.readonly;\n\t}\n\n\tget useCaching() {\n\t\treturn Container.config.advanced.caching.enabled;\n\t}\n\n\tprivate onAnyRepositoryChanged(repo: Repository, reason: RepositoryChange) {\n\t\tthis._branchesCache.delete(repo.path);\n\t\tthis._tagsCache.delete(repo.path);\n\t\tthis._tagsWithRefsCache.clear();\n\t\tthis._trackedCache.clear();\n\n\t\tif (reason === RepositoryChange.Config) {\n\t\t\tthis._userMapCache.delete(repo.path);\n\t\t}\n\n\t\tif (reason === RepositoryChange.Closed) {\n\t\t\t// Send a notification that the repositories changed\n\t\t\tsetImmediate(async () => {\n\t\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\t\tthis.fireRepositoriesChanged();\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (\n\t\t\tconfiguration.changed(e, 'defaultDateFormat') ||\n\t\t\tconfiguration.changed(e, 'defaultDateSource') ||\n\t\t\tconfiguration.changed(e, 'defaultDateStyle')\n\t\t) {\n\t\t\tBranchDateFormatting.reset();\n\t\t\tCommitDateFormatting.reset();\n\t\t}\n\t}\n\n\tprivate onWindowStateChanged(e: WindowState) {\n\t\tif (e.focused) {\n\t\t\tthis._repositoryTree.forEach(r => r.resume());\n\t\t} else {\n\t\t\tthis._repositoryTree.forEach(r => r.suspend());\n\t\t}\n\n\t\tthis._suspended = !e.focused;\n\t}\n\n\tprivate async onWorkspaceFoldersChanged(e?: WorkspaceFoldersChangeEvent) {\n\t\tlet initializing = false;\n\t\tif (e === undefined) {\n\t\t\tinitializing = true;\n\t\t\te = {\n\t\t\t\tadded: workspace.workspaceFolders || [],\n\t\t\t\tremoved: []\n\t\t\t};\n\n\t\t\tLogger.log(`Starting repository search in ${e.added.length} folders`);\n\t\t}\n\n\t\tfor (const f of e.added) {\n\t\t\tconst { scheme } = f.uri;\n\t\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Vsls) continue;\n\n\t\t\tif (scheme === DocumentSchemes.Vsls) {\n\t\t\t\tif (Container.vsls.isMaybeGuest) {\n\t\t\t\t\tconst guest = await Container.vsls.guest();\n\t\t\t\t\tif (guest !== undefined) {\n\t\t\t\t\t\tconst repositories = await guest.getRepositoriesInFolder(\n\t\t\t\t\t\t\tf,\n\t\t\t\t\t\t\tthis.onAnyRepositoryChanged.bind(this)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Search for and add all repositories (nested and/or submodules)\n\t\t\t\tconst repositories = await this.repositorySearch(f);\n\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const f of e.removed) {\n\t\t\tconst { fsPath, scheme } = f.uri;\n\t\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Vsls) continue;\n\n\t\t\tconst repos = this._repositoryTree.findSuperstr(fsPath);\n\t\t\tconst reposToDelete =\n\t\t\t\trepos !== undefined\n\t\t\t\t\t? // Since the filtered tree will have keys that are relative to the fsPath, normalize to the full path\n\t\t\t\t\t  [...Iterables.map<Repository, [Repository, string]>(repos, r => [r, r.path])]\n\t\t\t\t\t: [];\n\n\t\t\t// const filteredTree = this._repositoryTree.findSuperstr(fsPath);\n\t\t\t// const reposToDelete =\n\t\t\t//     filteredTree !== undefined\n\t\t\t//         ? // Since the filtered tree will have keys that are relative to the fsPath, normalize to the full path\n\t\t\t//           [\n\t\t\t//               ...Iterables.map<[Repository, string], [Repository, string]>(\n\t\t\t//                   filteredTree.entries(),\n\t\t\t//                   ([r, k]) => [r, path.join(fsPath, k)]\n\t\t\t//               )\n\t\t\t//           ]\n\t\t\t//         : [];\n\n\t\t\tconst repo = this._repositoryTree.get(fsPath);\n\t\t\tif (repo !== undefined) {\n\t\t\t\treposToDelete.push([repo, fsPath]);\n\t\t\t}\n\n\t\t\tfor (const [r, k] of reposToDelete) {\n\t\t\t\tthis._repositoryTree.delete(k);\n\t\t\t\tr.dispose();\n\t\t\t}\n\t\t}\n\n\t\tawait this.updateContext(this._repositoryTree);\n\n\t\tif (!initializing) {\n\t\t\t// Defer the event trigger enough to let everything unwind\n\t\t\tsetImmediate(() => this.fireRepositoriesChanged());\n\t\t}\n\t}\n\n\t@log<GitService['repositorySearch']>({\n\t\targs: false,\n\t\tsingleLine: true,\n\t\tprefix: (context, folder) => `${context.prefix}(${folder.uri.fsPath})`,\n\t\texit: result =>\n\t\t\t`returned ${result.length} repositories${\n\t\t\t\tresult.length !== 0 ? ` (${result.map(r => r.path).join(', ')})` : emptyStr\n\t\t\t}`\n\t})\n\tprivate async repositorySearch(folder: WorkspaceFolder): Promise<Repository[]> {\n\t\tconst cc = Logger.getCorrelationContext();\n\t\tconst { uri } = folder;\n\t\tconst depth = configuration.get('advanced', 'repositorySearchDepth', uri);\n\n\t\tLogger.log(cc, `searching (depth=${depth})...`);\n\n\t\tconst repositories: Repository[] = [];\n\t\tconst anyRepoChangedFn = this.onAnyRepositoryChanged.bind(this);\n\n\t\tconst rootPath = await this.getRepoPathCore(uri.fsPath, true);\n\t\tif (rootPath !== undefined) {\n\t\t\tLogger.log(cc, `found root repository in '${rootPath}'`);\n\t\t\trepositories.push(new Repository(folder, rootPath, true, anyRepoChangedFn, this._suspended));\n\t\t}\n\n\t\tif (depth <= 0) return repositories;\n\n\t\t// Get any specified excludes -- this is a total hack, but works for some simple cases and something is better than nothing :)\n\t\tlet excludes = {\n\t\t\t...configuration.getAny<{ [key: string]: boolean }>('files.exclude', uri, {}),\n\t\t\t...configuration.getAny<{ [key: string]: boolean }>('search.exclude', uri, {})\n\t\t};\n\n\t\tconst excludedPaths = [\n\t\t\t...Iterables.filterMap(Objects.entries(excludes), ([key, value]) => {\n\t\t\t\tif (!value) return undefined;\n\t\t\t\tif (key.startsWith('**/')) return key.substring(3);\n\t\t\t\treturn key;\n\t\t\t})\n\t\t];\n\n\t\texcludes = excludedPaths.reduce((accumulator, current) => {\n\t\t\taccumulator[current] = true;\n\t\t\treturn accumulator;\n\t\t}, Object.create(null));\n\n\t\tlet repoPaths;\n\t\ttry {\n\t\t\trepoPaths = await this.repositorySearchCore(uri.fsPath, depth, excludes);\n\t\t} catch (ex) {\n\t\t\tif (RepoSearchWarnings.doesNotExist.test(ex.message || emptyStr)) {\n\t\t\t\tLogger.log(cc, `FAILED${ex.message ? ` Error: ${ex.message}` : emptyStr}`);\n\t\t\t} else {\n\t\t\t\tLogger.error(ex, cc, 'FAILED');\n\t\t\t}\n\n\t\t\treturn repositories;\n\t\t}\n\n\t\tfor (let p of repoPaths) {\n\t\t\tp = paths.dirname(p);\n\t\t\t// If we are the same as the root, skip it\n\t\t\tif (Strings.normalizePath(p) === rootPath) continue;\n\n\t\t\tLogger.log(cc, `searching in '${p}'...`);\n\n\t\t\tconst rp = await this.getRepoPathCore(p, true);\n\t\t\tif (rp === undefined) continue;\n\n\t\t\tLogger.log(cc, `found repository in '${rp}'`);\n\t\t\trepositories.push(new Repository(folder, rp, false, anyRepoChangedFn, this._suspended));\n\t\t}\n\n\t\treturn repositories;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (root: string) => root,\n\t\t\t1: (depth: number) => `${depth}`,\n\t\t\t2: () => false,\n\t\t\t3: () => false\n\t\t}\n\t})\n\tprivate repositorySearchCore(\n\t\troot: string,\n\t\tdepth: number,\n\t\texcludes: { [key: string]: boolean },\n\t\trepositories: string[] = []\n\t): Promise<string[]> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\treturn new Promise<string[]>((resolve, reject) => {\n\t\t\tfs.readdir(root, { withFileTypes: true }, async (err, files) => {\n\t\t\t\tif (err != null) {\n\t\t\t\t\treject(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (files.length === 0) {\n\t\t\t\t\tresolve(repositories);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdepth--;\n\n\t\t\t\tlet f;\n\t\t\t\tfor (f of files) {\n\t\t\t\t\tif (!f.isDirectory()) continue;\n\n\t\t\t\t\tif (f.name === '.git') {\n\t\t\t\t\t\trepositories.push(paths.resolve(root, f.name));\n\t\t\t\t\t} else if (depth >= 0 && excludes[f.name] !== true) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.repositorySearchCore(paths.resolve(root, f.name), depth, excludes, repositories);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\tLogger.error(ex, cc, 'FAILED');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresolve(repositories);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async updateContext(repositoryTree: TernarySearchTree<Repository>) {\n\t\tconst hasRepository = repositoryTree.any();\n\t\tawait setCommandContext(CommandContext.Enabled, hasRepository);\n\n\t\tlet hasRemotes = false;\n\t\tif (hasRepository) {\n\t\t\tfor (const repo of repositoryTree.values()) {\n\t\t\t\thasRemotes = await repo.hasRemotes();\n\t\t\t\tif (hasRemotes) break;\n\t\t\t}\n\t\t}\n\n\t\tawait setCommandContext(CommandContext.HasRemotes, hasRemotes);\n\n\t\t// If we have no repositories setup a watcher in case one is initialized\n\t\tif (!hasRepository) {\n\t\t\tconst watcher = workspace.createFileSystemWatcher('**/.git', false, true, true);\n\t\t\tconst disposable = Disposable.from(\n\t\t\t\twatcher,\n\t\t\t\twatcher.onDidCreate(async uri => {\n\t\t\t\t\tconst f = workspace.getWorkspaceFolder(uri);\n\t\t\t\t\tif (f === undefined) return;\n\n\t\t\t\t\t// Search for and add all repositories (nested and/or submodules)\n\t\t\t\t\tconst repositories = await this.repositorySearch(f);\n\t\t\t\t\tif (repositories.length === 0) return;\n\n\t\t\t\t\tdisposable.dispose();\n\n\t\t\t\t\tfor (const r of repositories) {\n\t\t\t\t\t\tthis._repositoryTree.set(r.path, r);\n\t\t\t\t\t}\n\n\t\t\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\t\t\t// Defer the event trigger enough to let everything unwind\n\t\t\t\t\tsetImmediate(() => this.fireRepositoriesChanged());\n\t\t\t\t}, this)\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate fireRepositoriesChanged() {\n\t\tthis._onDidChangeRepositories.fire();\n\t}\n\n\t@log()\n\taddRemote(repoPath: string, name: string, url: string) {\n\t\treturn Git.remote__add(repoPath, name, url);\n\t}\n\n\t@log()\n\tpruneRemote(repoPath: string, remoteName: string) {\n\t\treturn Git.remote__prune(repoPath, remoteName);\n\t}\n\n\t@log()\n\tasync applyChangesToWorkingFile(uri: GitUri, ref1?: string, ref2?: string) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tref1 = ref1 || uri.sha;\n\t\tif (ref1 === undefined || uri.repoPath === undefined) return;\n\n\t\tif (ref2 === undefined) {\n\t\t\tref2 = ref1;\n\t\t\tref1 = `${ref1}^`;\n\t\t}\n\n\t\tlet patch;\n\t\ttry {\n\t\t\tpatch = await Git.diff(uri.repoPath, uri.fsPath, ref1, ref2, {\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t\t});\n\t\t\tvoid (await Git.apply(uri.repoPath, patch));\n\t\t} catch (ex) {\n\t\t\tif (patch && /patch does not apply/i.test(ex.message)) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to apply changes cleanly. Retry and allow conflicts?',\n\t\t\t\t\t{ title: 'Yes' },\n\t\t\t\t\t{ title: 'No', isCloseAffordance: true }\n\t\t\t\t);\n\n\t\t\t\tif (result === undefined || result.title !== 'Yes') return;\n\n\t\t\t\tif (result.title === 'Yes') {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvoid (await Git.apply(uri.repoPath, patch, { allowConflicts: true }));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// eslint-disable-next-line no-ex-assign\n\t\t\t\t\t\tex = e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tvoid Messages.showGenericErrorMessage('Unable to apply changes');\n\t\t}\n\t}\n\n\t@log()\n\tasync checkout(repoPath: string, ref: string, options: { createBranch?: string } | { fileName?: string } = {}) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\treturn await Git.checkout(repoPath, ref, options);\n\t\t} catch (ex) {\n\t\t\tif (/overwritten by checkout/i.test(ex.message)) {\n\t\t\t\tvoid Messages.showGenericErrorMessage(\n\t\t\t\t\t`Unable to checkout '${ref}'. Please commit or stash your changes before switching branches`\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tvoid void Messages.showGenericErrorMessage(`Unable to checkout '${ref}'`);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tfetch(repoPath: string, options: { all?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\treturn Git.fetch(repoPath, options);\n\t}\n\n\t@gate<GitService['fetchAll']>(\n\t\t(repos, opts) => `${repos === undefined ? '' : repos.map(r => r.id).join(',')}|${JSON.stringify(opts)}`\n\t)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos === undefined ? false : repos.map(r => r.name).join(', '))\n\t\t}\n\t})\n\tasync fetchAll(repositories?: Repository[], options: { all?: boolean; prune?: boolean } = {}) {\n\t\tif (repositories === undefined) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\trepositories[0].fetch(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Fetching ${repositories.length} repositories`\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.fetch({ progress: false, ...options })))\n\t\t);\n\t}\n\n\t@gate<GitService['pullAll']>(\n\t\t(repos, opts) => `${repos === undefined ? '' : repos.map(r => r.id).join(',')}|${JSON.stringify(opts)}`\n\t)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos === undefined ? false : repos.map(r => r.name).join(', '))\n\t\t}\n\t})\n\tasync pullAll(repositories?: Repository[], options: { rebase?: boolean } = {}) {\n\t\tif (repositories === undefined) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\trepositories[0].pull(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pulling ${repositories.length} repositories`\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.pull({ progress: false, ...options })))\n\t\t);\n\t}\n\n\t@gate<GitService['pushAll']>(repos => `${repos === undefined ? '' : repos.map(r => r.id).join(',')}`)\n\t@log({\n\t\targs: {\n\t\t\t0: (repos?: Repository[]) => (repos === undefined ? false : repos.map(r => r.name).join(', '))\n\t\t}\n\t})\n\tasync pushAll(repositories?: Repository[], options: { force?: boolean } = {}) {\n\t\tif (repositories === undefined) {\n\t\t\trepositories = await this.getOrderedRepositories();\n\t\t}\n\t\tif (repositories.length === 0) return;\n\n\t\tif (repositories.length === 1) {\n\t\t\trepositories[0].push(options);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pushing ${repositories.length} repositories`\n\t\t\t},\n\t\t\t() => Promise.all(repositories!.map(r => r.push({ progress: false, ...options })))\n\t\t);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: (editor: TextEditor) =>\n\t\t\t\teditor !== undefined ? `TextEditor(${Logger.toLoggable(editor.document.uri)})` : 'undefined'\n\t\t}\n\t})\n\tasync getActiveRepository(editor?: TextEditor): Promise<Repository | undefined> {\n\t\tconst repoPath = await this.getActiveRepoPath(editor);\n\t\tif (repoPath === undefined) return undefined;\n\n\t\treturn this.getRepository(repoPath);\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t0: (editor: TextEditor) =>\n\t\t\t\teditor !== undefined ? `TextEditor(${Logger.toLoggable(editor.document.uri)})` : 'undefined'\n\t\t}\n\t})\n\tasync getActiveRepoPath(editor?: TextEditor): Promise<string | undefined> {\n\t\teditor = editor || window.activeTextEditor;\n\n\t\tlet repoPath;\n\t\tif (editor != null) {\n\t\t\tconst doc = await Container.tracker.getOrAdd(editor.document.uri);\n\t\t\tif (doc !== undefined) {\n\t\t\t\trepoPath = doc.uri.repoPath;\n\t\t\t}\n\t\t}\n\n\t\tif (repoPath != null) return repoPath;\n\n\t\treturn this.getHighlanderRepoPath();\n\t}\n\n\t@log()\n\tgetHighlanderRepoPath(): string | undefined {\n\t\tconst entry = this._repositoryTree.highlander();\n\t\tif (entry === undefined) return undefined;\n\n\t\tconst [repo] = entry;\n\t\treturn repo.path;\n\t}\n\n\t@log()\n\tasync getBlameForFile(uri: GitUri): Promise<GitBlame | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet key = 'blame';\n\t\tif (uri.sha !== undefined) {\n\t\t\tkey += `:${uri.sha}`;\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state !== undefined) {\n\t\t\t\tconst cachedBlame = doc.state.get<CachedBlame>(key);\n\t\t\t\tif (cachedBlame !== undefined) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedBlame.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state === undefined) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getBlameForFileCore(uri, doc, key, cc);\n\n\t\tif (doc.state !== undefined) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedBlame = {\n\t\t\t\titem: promise as Promise<GitBlame>\n\t\t\t};\n\t\t\tdoc.state.set<CachedBlame>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getBlameForFileCore(\n\t\turi: GitUri,\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined\n\t): Promise<GitBlame | undefined> {\n\t\tif (!(await this.isTracked(uri))) {\n\t\t\tLogger.log(cc, `Skipping blame; '${uri.fsPath}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(uri.fsPath, uri.repoPath, false);\n\n\t\ttry {\n\t\t\tconst data = await Git.blame(root, file, uri.sha, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, root, file, await this.getCurrentUser(root));\n\t\t\treturn blame;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected blame errors\n\t\t\tif (document.state !== undefined) {\n\t\t\t\tconst msg = ex && ex.toString();\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedBlame = {\n\t\t\t\t\titem: emptyPromise as Promise<GitBlame>,\n\t\t\t\t\terrorMessage: msg\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedBlame>(key, value);\n\n\t\t\t\tdocument.setBlameFailure();\n\n\t\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t1: contents => '<contents>'\n\t\t}\n\t})\n\tasync getBlameForFileContents(uri: GitUri, contents: string): Promise<GitBlame | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst key = `blame:${Strings.sha1(contents)}`;\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state !== undefined) {\n\t\t\t\tconst cachedBlame = doc.state.get<CachedBlame>(key);\n\t\t\t\tif (cachedBlame !== undefined) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: ${key}`);\n\t\t\t\t\treturn cachedBlame.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: ${key}`);\n\n\t\t\tif (doc.state === undefined) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getBlameForFileContentsCore(uri, contents, doc, key, cc);\n\n\t\tif (doc.state !== undefined) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedBlame = {\n\t\t\t\titem: promise as Promise<GitBlame>\n\t\t\t};\n\t\t\tdoc.state.set<CachedBlame>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tasync getBlameForFileContentsCore(\n\t\turi: GitUri,\n\t\tcontents: string,\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined\n\t): Promise<GitBlame | undefined> {\n\t\tif (!(await this.isTracked(uri))) {\n\t\t\tLogger.log(cc, `Skipping blame; '${uri.fsPath}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(uri.fsPath, uri.repoPath, false);\n\n\t\ttry {\n\t\t\tconst data = await Git.blame__contents(root, file, contents, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tcorrelationKey: `:${key}`,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, root, file, await this.getCurrentUser(root));\n\t\t\treturn blame;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected blame errors\n\t\t\tif (document.state !== undefined) {\n\t\t\t\tconst msg = ex && ex.toString();\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedBlame = {\n\t\t\t\t\titem: emptyPromise as Promise<GitBlame>,\n\t\t\t\t\terrorMessage: msg\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedBlame>(key, value);\n\n\t\t\t\tdocument.setBlameFailure();\n\t\t\t\treturn emptyPromise as Promise<GitBlame>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getBlameForLine(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\toptions: { skipCache?: boolean } = {}\n\t): Promise<GitBlameLine | undefined> {\n\t\tif (!options.skipCache && this.useCaching) {\n\t\t\tconst blame = await this.getBlameForFile(uri);\n\t\t\tif (blame === undefined) return undefined;\n\n\t\t\tlet blameLine = blame.lines[editorLine];\n\t\t\tif (blameLine === undefined) {\n\t\t\t\tif (blame.lines.length !== editorLine) return undefined;\n\t\t\t\tblameLine = blame.lines[editorLine - 1];\n\t\t\t}\n\n\t\t\tconst commit = blame.commits.get(blameLine.sha);\n\t\t\tif (commit === undefined) return undefined;\n\n\t\t\tconst author = blame.authors.get(commit.author)!;\n\t\t\treturn {\n\t\t\t\tauthor: { ...author, lineCount: commit.lines.length },\n\t\t\t\tcommit: commit,\n\t\t\t\tline: blameLine\n\t\t\t};\n\t\t}\n\n\t\tconst lineToBlame = editorLine + 1;\n\t\tconst fileName = uri.fsPath;\n\n\t\ttry {\n\t\t\tconst data = await Git.blame(uri.repoPath, fileName, uri.sha, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t\tstartLine: lineToBlame,\n\t\t\t\tendLine: lineToBlame\n\t\t\t});\n\t\t\tconst blame = GitBlameParser.parse(data, uri.repoPath, fileName, await this.getCurrentUser(uri.repoPath!));\n\t\t\tif (blame === undefined) return undefined;\n\n\t\t\treturn {\n\t\t\t\tauthor: Iterables.first(blame.authors.values()),\n\t\t\t\tcommit: Iterables.first(blame.commits.values()),\n\t\t\t\tline: blame.lines[editorLine]\n\t\t\t};\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log({\n\t\targs: {\n\t\t\t2: contents => '<contents>'\n\t\t}\n\t})\n\tasync getBlameForLineContents(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\tcontents: string,\n\t\toptions: { skipCache?: boolean } = {}\n\t): Promise<GitBlameLine | undefined> {\n\t\tif (!options.skipCache && this.useCaching) {\n\t\t\tconst blame = await this.getBlameForFileContents(uri, contents);\n\t\t\tif (blame === undefined) return undefined;\n\n\t\t\tlet blameLine = blame.lines[editorLine];\n\t\t\tif (blameLine === undefined) {\n\t\t\t\tif (blame.lines.length !== editorLine) return undefined;\n\t\t\t\tblameLine = blame.lines[editorLine - 1];\n\t\t\t}\n\n\t\t\tconst commit = blame.commits.get(blameLine.sha);\n\t\t\tif (commit === undefined) return undefined;\n\n\t\t\tconst author = blame.authors.get(commit.author)!;\n\t\t\treturn {\n\t\t\t\tauthor: { ...author, lineCount: commit.lines.length },\n\t\t\t\tcommit: commit,\n\t\t\t\tline: blameLine\n\t\t\t};\n\t\t}\n\n\t\tconst lineToBlame = editorLine + 1;\n\t\tconst fileName = uri.fsPath;\n\n\t\ttry {\n\t\t\tconst data = await Git.blame__contents(uri.repoPath, fileName, contents, {\n\t\t\t\targs: Container.config.advanced.blame.customArguments,\n\t\t\t\tignoreWhitespace: Container.config.blame.ignoreWhitespace,\n\t\t\t\tstartLine: lineToBlame,\n\t\t\t\tendLine: lineToBlame\n\t\t\t});\n\t\t\tconst currentUser = await this.getCurrentUser(uri.repoPath!);\n\t\t\tconst blame = GitBlameParser.parse(data, uri.repoPath, fileName, currentUser);\n\t\t\tif (blame === undefined) return undefined;\n\n\t\t\treturn {\n\t\t\t\tauthor: Iterables.first(blame.authors.values()),\n\t\t\t\tcommit: Iterables.first(blame.commits.values()),\n\t\t\t\tline: blame.lines[editorLine]\n\t\t\t};\n\t\t} catch {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getBlameForRange(uri: GitUri, range: Range): Promise<GitBlameLines | undefined> {\n\t\tconst blame = await this.getBlameForFile(uri);\n\t\tif (blame === undefined) return undefined;\n\n\t\treturn this.getBlameForRangeSync(blame, uri, range);\n\t}\n\n\t@log()\n\tasync getBlameForRangeContents(uri: GitUri, range: Range, contents: string): Promise<GitBlameLines | undefined> {\n\t\tconst blame = await this.getBlameForFileContents(uri, contents);\n\t\tif (blame === undefined) return undefined;\n\n\t\treturn this.getBlameForRangeSync(blame, uri, range);\n\t}\n\n\t@log({\n\t\targs: { 0: blame => '<blame>' }\n\t})\n\tgetBlameForRangeSync(blame: GitBlame, uri: GitUri, range: Range): GitBlameLines | undefined {\n\t\tif (blame.lines.length === 0) return { allLines: blame.lines, ...blame };\n\n\t\tif (range.start.line === 0 && range.end.line === blame.lines.length - 1) {\n\t\t\treturn { allLines: blame.lines, ...blame };\n\t\t}\n\n\t\tconst lines = blame.lines.slice(range.start.line, range.end.line + 1);\n\t\tconst shas = new Set(lines.map(l => l.sha));\n\n\t\t// ranges are 0-based\n\t\tconst startLine = range.start.line + 1;\n\t\tconst endLine = range.end.line + 1;\n\n\t\tconst authors: Map<string, GitAuthor> = new Map();\n\t\tconst commits: Map<string, GitBlameCommit> = new Map();\n\t\tfor (const c of blame.commits.values()) {\n\t\t\tif (!shas.has(c.sha)) continue;\n\n\t\t\tconst commit = c.with({\n\t\t\t\tlines: c.lines.filter(l => l.line >= startLine && l.line <= endLine)\n\t\t\t});\n\t\t\tcommits.set(c.sha, commit);\n\n\t\t\tlet author = authors.get(commit.author);\n\t\t\tif (author === undefined) {\n\t\t\t\tauthor = {\n\t\t\t\t\tname: commit.author,\n\t\t\t\t\tlineCount: 0\n\t\t\t\t};\n\t\t\t\tauthors.set(author.name, author);\n\t\t\t}\n\n\t\t\tauthor.lineCount += commit.lines.length;\n\t\t}\n\n\t\tconst sortedAuthors = new Map([...authors.entries()].sort((a, b) => b[1].lineCount - a[1].lineCount));\n\n\t\treturn {\n\t\t\trepoPath: uri.repoPath!,\n\t\t\tauthors: sortedAuthors,\n\t\t\tcommits: commits,\n\t\t\tlines: lines,\n\t\t\tallLines: blame.lines\n\t\t};\n\t}\n\n\t@log()\n\tasync getBranch(repoPath: string | undefined): Promise<GitBranch | undefined> {\n\t\tif (repoPath === undefined) return undefined;\n\n\t\tconst data = await Git.rev_parse__currentBranch(repoPath);\n\t\tif (data === undefined) return undefined;\n\n\t\tconst committerDate = await Git.log__recent_committerdate(repoPath);\n\n\t\tconst branch = data[0].split('\\n');\n\t\treturn new GitBranch(\n\t\t\trepoPath,\n\t\t\tbranch[0],\n\t\t\tfalse,\n\t\t\ttrue,\n\t\t\tcommitterDate === undefined ? undefined : new Date(Number(committerDate) * 1000),\n\t\t\tdata[1],\n\t\t\tbranch[1]\n\t\t);\n\t}\n\n\t@log()\n\tasync getBranches(\n\t\trepoPath: string | undefined,\n\t\toptions: { filter?: (b: GitBranch) => boolean; sort?: boolean } = {}\n\t): Promise<GitBranch[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tlet branches: GitBranch[] | undefined;\n\t\ttry {\n\t\t\tif (this.useCaching) {\n\t\t\t\tbranches = this._branchesCache.get(repoPath);\n\t\t\t\tif (branches !== undefined) return branches;\n\t\t\t}\n\n\t\t\tconst data = await Git.for_each_ref__branch(repoPath, { all: true });\n\t\t\t// If we don't get any data, assume the repo doesn't have any commits yet so check if we have a current branch\n\t\t\tif (data == null || data.length === 0) {\n\t\t\t\tconst current = await this.getBranch(repoPath);\n\t\t\t\tbranches = current !== undefined ? [current] : [];\n\t\t\t} else {\n\t\t\t\tbranches = GitBranchParser.parse(data, repoPath);\n\t\t\t}\n\n\t\t\tif (this.useCaching) {\n\t\t\t\tconst repo = await this.getRepository(repoPath);\n\t\t\t\tif (repo !== undefined && repo.supportsChangeEvents) {\n\t\t\t\t\tthis._branchesCache.set(repoPath, branches);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn branches;\n\t\t} finally {\n\t\t\tif (options.filter !== undefined) {\n\t\t\t\tbranches = branches!.filter(options.filter);\n\t\t\t}\n\n\t\t\tif (options.sort) {\n\t\t\t\tGitBranch.sort(branches!);\n\t\t\t}\n\n\t\t\tif (options.filter !== undefined) {\n\t\t\t\t// eslint-disable-next-line no-unsafe-finally\n\t\t\t\treturn branches!;\n\t\t\t}\n\t\t}\n\t}\n\n\t@log()\n\tasync getBranchesAndOrTags(\n\t\trepoPath: string | undefined,\n\t\t{\n\t\t\tfilterBranches,\n\t\t\tfilterTags,\n\t\t\tinclude,\n\t\t\t...options\n\t\t}: {\n\t\t\tfilterBranches?: (b: GitBranch) => boolean;\n\t\t\tfilterTags?: (t: GitTag) => boolean;\n\t\t\tinclude?: 'all' | 'branches' | 'tags';\n\t\t\tsort?: boolean;\n\t\t} = {}\n\t) {\n\t\tconst [branches, tags] = await Promise.all<GitBranch[] | undefined, GitTag[] | undefined>([\n\t\t\tinclude === 'all' || include === 'branches'\n\t\t\t\t? this.getBranches(repoPath, {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\tfilter: filterBranches\n\t\t\t\t  })\n\t\t\t\t: undefined,\n\t\t\tinclude === 'all' || include === 'tags'\n\t\t\t\t? this.getTags(repoPath, {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\tfilter: filterTags\n\t\t\t\t  })\n\t\t\t\t: undefined\n\t\t]);\n\n\t\tif (branches !== undefined && tags !== undefined) {\n\t\t\treturn [...branches.filter(b => !b.remote), ...tags, ...branches.filter(b => b.remote)];\n\t\t}\n\n\t\tif (branches !== undefined) {\n\t\t\treturn branches;\n\t\t}\n\n\t\treturn tags;\n\t}\n\n\t@log()\n\tasync getBranchesAndTagsTipsFn(repoPath: string | undefined, currentName?: string) {\n\t\tconst [branches, tags] = await Promise.all([\n\t\t\tthis.getBranches(repoPath),\n\t\t\tthis.getTags(repoPath, { includeRefs: true })\n\t\t]);\n\n\t\tconst branchesAndTagsBySha = Arrays.groupByFilterMap(\n\t\t\t(branches as { name: string; sha: string }[]).concat(tags as { name: string; sha: string }[]),\n\t\t\tbt => bt.sha,\n\t\t\tbt => (bt.name === currentName ? undefined : bt.name)\n\t\t);\n\n\t\treturn (sha: string) => {\n\t\t\tconst branchesAndTags = branchesAndTagsBySha.get(sha);\n\t\t\tif (branchesAndTags === undefined || branchesAndTags.length === 0) return undefined;\n\t\t\treturn branchesAndTags.join(', ');\n\t\t};\n\t}\n\n\t@log()\n\tasync getChangedFilesCount(repoPath: string, ref?: string): Promise<GitDiffShortStat | undefined> {\n\t\tconst data = await Git.diff__shortstat(repoPath, ref);\n\t\treturn GitDiffParser.parseShortStat(data);\n\t}\n\n\t@log()\n\tasync getCommit(repoPath: string, ref: string): Promise<GitLogCommit | undefined> {\n\t\tconst log = await this.getLog(repoPath, { maxCount: 2, ref: ref });\n\t\tif (log === undefined) return undefined;\n\n\t\treturn log.commits.get(ref) || Iterables.first(log.commits.values());\n\t}\n\n\t@log()\n\tgetCommitCount(repoPath: string, refs: string[]) {\n\t\treturn Git.rev_list(repoPath, refs, { count: true });\n\t}\n\n\t@log()\n\tasync getCommitForFile(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\toptions: { ref?: string; firstIfNotFound?: boolean; reverse?: boolean } = {}\n\t): Promise<GitLogCommit | undefined> {\n\t\tconst log = await this.getLogForFile(repoPath, fileName, {\n\t\t\tmaxCount: 2,\n\t\t\tref: options.ref,\n\t\t\treverse: options.reverse\n\t\t});\n\t\tif (log === undefined) return undefined;\n\n\t\tconst commit = options.ref && log.commits.get(options.ref);\n\t\tif (commit === undefined && !options.firstIfNotFound && options.ref) {\n\t\t\t// If the ref isn't a valid sha we will never find it, so let it fall through so we return the first\n\t\t\tif (!Git.isSha(options.ref) || Git.isUncommitted(options.ref)) return undefined;\n\t\t}\n\n\t\treturn commit || Iterables.first(log.commits.values());\n\t}\n\n\t@log()\n\tgetConfig(key: string, repoPath?: string): Promise<string | undefined> {\n\t\treturn Git.config__get(key, repoPath);\n\t}\n\n\t@log()\n\tasync getContributors(repoPath: string): Promise<GitContributor[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tconst data = await Git.shortlog(repoPath);\n\t\tconst shortlog = GitShortLogParser.parse(data, repoPath);\n\t\treturn shortlog === undefined ? [] : shortlog.contributors;\n\t}\n\n\t@log()\n\tasync getCurrentUser(repoPath: string) {\n\t\tlet user = this._userMapCache.get(repoPath);\n\t\tif (user != null) return user;\n\t\t// If we found the repo, but no user data was found just return\n\t\tif (user === null) return undefined;\n\n\t\tconst data = await Git.config__get_regex('user.(name|email)', repoPath, { local: true });\n\t\tif (!data) {\n\t\t\t// If we found no user data, mark it so we won't bother trying again\n\t\t\tthis._userMapCache.set(repoPath, null);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tuser = { name: undefined, email: undefined };\n\n\t\tlet key: string;\n\t\tlet value: string;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = userConfigRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, key, value] = match;\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tuser[key as 'name' | 'email'] = ` ${value}`.substr(1);\n\t\t} while (true);\n\n\t\tconst author = `${user.name} <${user.email}>`;\n\t\t// Check if there is a mailmap for the current user\n\t\tconst mappedAuthor = await Git.check_mailmap(repoPath, author);\n\t\tif (mappedAuthor != null && mappedAuthor.length !== 0 && author !== mappedAuthor) {\n\t\t\tmatch = mappedAuthorRegex.exec(mappedAuthor);\n\t\t\tif (match != null) {\n\t\t\t\t[, user.name, user.email] = match;\n\t\t\t}\n\t\t}\n\n\t\tthis._userMapCache.set(repoPath, user);\n\t\treturn user;\n\t}\n\n\t@log()\n\tasync getDiffForFile(\n\t\turi: GitUri,\n\t\tref1: string | undefined,\n\t\tref2?: string,\n\t\toriginalFileName?: string\n\t): Promise<GitDiff | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet key = 'diff';\n\t\tif (ref1 !== undefined) {\n\t\t\tkey += `:${ref1}`;\n\t\t}\n\t\tif (ref2 !== undefined) {\n\t\t\tkey += `:${ref2}`;\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(uri);\n\t\tif (this.useCaching) {\n\t\t\tif (doc.state !== undefined) {\n\t\t\t\tconst cachedDiff = doc.state.get<CachedDiff>(key);\n\t\t\t\tif (cachedDiff !== undefined) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedDiff.item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state === undefined) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getDiffForFileCore(\n\t\t\turi.repoPath,\n\t\t\turi.fsPath,\n\t\t\tref1,\n\t\t\tref2,\n\t\t\toriginalFileName,\n\t\t\t{ encoding: GitService.getEncoding(uri) },\n\t\t\tdoc,\n\t\t\tkey,\n\t\t\tcc\n\t\t);\n\n\t\tif (doc.state !== undefined) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedDiff = {\n\t\t\t\titem: promise as Promise<GitDiff>\n\t\t\t};\n\t\t\tdoc.state.set<CachedDiff>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getDiffForFileCore(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref1: string | undefined,\n\t\tref2: string | undefined,\n\t\toriginalFileName: string | undefined,\n\t\toptions: { encoding?: string },\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined\n\t): Promise<GitDiff | undefined> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath, false);\n\n\t\ttry {\n\t\t\tlet data;\n\t\t\tif (ref1 !== undefined && ref2 === undefined && !Git.isUncommittedStaged(ref1)) {\n\t\t\t\tdata = await Git.show__diff(root, file, ref1, originalFileName, {\n\t\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdata = await Git.diff(root, file, ref1, ref2, {\n\t\t\t\t\t...options,\n\t\t\t\t\tfilter: 'M',\n\t\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst diff = GitDiffParser.parse(data);\n\t\t\treturn diff;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected diff errors\n\t\t\tif (document.state !== undefined) {\n\t\t\t\tconst msg = ex && ex.toString();\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedDiff = {\n\t\t\t\t\titem: emptyPromise as Promise<GitDiff>,\n\t\t\t\t\terrorMessage: msg\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedDiff>(key, value);\n\n\t\t\t\treturn emptyPromise as Promise<GitDiff>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffForLine(\n\t\turi: GitUri,\n\t\teditorLine: number, // editor lines are 0-based\n\t\tref1: string | undefined,\n\t\tref2?: string,\n\t\toriginalFileName?: string\n\t): Promise<GitDiffHunkLine | undefined> {\n\t\ttry {\n\t\t\tconst diff = await this.getDiffForFile(uri, ref1, ref2, originalFileName);\n\t\t\tif (diff === undefined) return undefined;\n\n\t\t\tconst line = editorLine + 1;\n\t\t\tconst hunk = diff.hunks.find(c => c.currentPosition.start <= line && c.currentPosition.end >= line);\n\t\t\tif (hunk === undefined) return undefined;\n\n\t\t\treturn hunk.lines[line - hunk.currentPosition.start];\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffStatus(\n\t\trepoPath: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\toptions: { filter?: string; similarityThreshold?: number } = {}\n\t): Promise<GitFile[] | undefined> {\n\t\ttry {\n\t\t\tconst data = await Git.diff__name_status(repoPath, ref1, ref2, {\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold,\n\t\t\t\t...options\n\t\t\t});\n\t\t\tconst files = GitDiffParser.parseNameStatus(data, repoPath);\n\t\t\treturn files === undefined || files.length === 0 ? undefined : files;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getFileStatusForCommit(repoPath: string, fileName: string, ref: string): Promise<GitFile | undefined> {\n\t\tif (ref === GitService.deletedOrMissingSha || Git.isUncommitted(ref)) return undefined;\n\n\t\tconst data = await Git.show__name_status(repoPath, fileName, ref);\n\t\tif (!data) return undefined;\n\n\t\tconst files = GitDiffParser.parseNameStatus(data, repoPath);\n\t\tif (files === undefined || files.length === 0) return undefined;\n\n\t\treturn files[0];\n\t}\n\n\t@log()\n\tasync getLog(\n\t\trepoPath: string,\n\t\t{\n\t\t\tref,\n\t\t\t...options\n\t\t}: { authors?: string[]; maxCount?: number; merges?: boolean; ref?: string; reverse?: boolean } = {}\n\t): Promise<GitLog | undefined> {\n\t\tconst maxCount = options.maxCount == null ? Container.config.advanced.maxListItems || 0 : options.maxCount;\n\n\t\ttry {\n\t\t\tconst data = await Git.log(repoPath, ref, {\n\t\t\t\tauthors: options.authors,\n\t\t\t\tmaxCount: maxCount,\n\t\t\t\tmerges: options.merges === undefined ? true : options.merges,\n\t\t\t\treverse: options.reverse,\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t\t});\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\tGitCommitType.Log,\n\t\t\t\trepoPath,\n\t\t\t\tundefined,\n\t\t\t\tref,\n\t\t\t\tawait this.getCurrentUser(repoPath),\n\t\t\t\tmaxCount,\n\t\t\t\toptions.reverse!,\n\t\t\t\tundefined\n\t\t\t);\n\n\t\t\tif (log !== undefined) {\n\t\t\t\tconst opts = { ...options, ref: ref };\n\t\t\t\tlog.query = (maxCount: number | undefined) => this.getLog(repoPath, { ...opts, maxCount: maxCount });\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getLogForSearch(\n\t\trepoPath: string,\n\t\tsearch: SearchPattern,\n\t\toptions: { maxCount?: number } = {}\n\t): Promise<GitLog | undefined> {\n\t\tsearch = { matchAll: false, matchCase: false, matchRegex: true, ...search };\n\n\t\ttry {\n\t\t\tconst maxCount =\n\t\t\t\toptions.maxCount == null ? Container.config.advanced.maxSearchItems || 0 : options.maxCount;\n\t\t\tconst similarityThreshold = Container.config.advanced.similarityThreshold;\n\n\t\t\tconst operations = GitService.parseSearchOperations(search.pattern);\n\n\t\t\tconst searchArgs = new Set<string>();\n\t\t\tconst files: string[] = [];\n\n\t\t\tlet useShow = false;\n\n\t\t\tlet op;\n\t\t\tlet values = operations.get('commit:');\n\t\t\tif (values !== undefined) {\n\t\t\t\tuseShow = true;\n\n\t\t\t\tsearchArgs.add('-m');\n\t\t\t\tsearchArgs.add(`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t\t\tfor (const value of values) {\n\t\t\t\t\tsearchArgs.add(value.replace(doubleQuoteRegex, ''));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsearchArgs.add(`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t\t\tsearchArgs.add('--all');\n\t\t\t\tsearchArgs.add('--full-history');\n\t\t\t\tsearchArgs.add(search.matchRegex ? '--extended-regexp' : '--fixed-strings');\n\t\t\t\tif (search.matchRegex && !search.matchCase) {\n\t\t\t\t\tsearchArgs.add('--regexp-ignore-case');\n\t\t\t\t}\n\n\t\t\t\tfor ([op, values] of operations.entries()) {\n\t\t\t\t\tswitch (op) {\n\t\t\t\t\t\tcase 'message:':\n\t\t\t\t\t\t\tsearchArgs.add('-m');\n\t\t\t\t\t\t\tif (search.matchAll) {\n\t\t\t\t\t\t\t\tsearchArgs.add('--all-match');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`--grep=${value.replace(doubleQuoteRegex, '\\\\b')}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'author:':\n\t\t\t\t\t\t\tsearchArgs.add('-m');\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`--author=${value.replace(doubleQuoteRegex, '\\\\b')}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'change:':\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tsearchArgs.add(`-G=${value}`);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'file:':\n\t\t\t\t\t\t\tfor (const value of values) {\n\t\t\t\t\t\t\t\tfiles.push(value.replace(doubleQuoteRegex, ''));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst args = [...searchArgs.values(), '--'];\n\t\t\tif (files.length !== 0) {\n\t\t\t\targs.push(...files);\n\t\t\t}\n\n\t\t\tconst data = await Git.log__search(repoPath, args, { maxCount: maxCount, useShow: useShow });\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\tGitCommitType.Log,\n\t\t\t\trepoPath,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tawait this.getCurrentUser(repoPath),\n\t\t\t\tmaxCount,\n\t\t\t\tfalse,\n\t\t\t\tundefined\n\t\t\t);\n\n\t\t\tif (log !== undefined) {\n\t\t\t\tlog.query = (maxCount: number | undefined) =>\n\t\t\t\t\tthis.getLogForSearch(repoPath, search, { maxCount: maxCount });\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getLogForFile(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\toptions: { maxCount?: number; range?: Range; ref?: string; renames?: boolean; reverse?: boolean } = {}\n\t): Promise<GitLog | undefined> {\n\t\tif (repoPath !== undefined && repoPath === Strings.normalizePath(fileName)) {\n\t\t\tthrow new Error(`File name cannot match the repository path; fileName=${fileName}`);\n\t\t}\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\toptions = { reverse: false, ...options };\n\n\t\tif (options.renames === undefined) {\n\t\t\toptions.renames = Container.config.advanced.fileHistoryFollowsRenames;\n\t\t}\n\n\t\tlet key = 'log';\n\t\tif (options.ref !== undefined) {\n\t\t\tkey += `:${options.ref}`;\n\t\t}\n\n\t\toptions.maxCount = options.maxCount == null ? Container.config.advanced.maxListItems || 0 : options.maxCount;\n\t\tif (options.maxCount) {\n\t\t\tkey += `:n${options.maxCount}`;\n\t\t}\n\n\t\tif (options.renames) {\n\t\t\tkey += ':follow';\n\t\t}\n\n\t\tif (options.reverse) {\n\t\t\tkey += ':reverse';\n\t\t}\n\n\t\tconst doc = await Container.tracker.getOrAdd(GitUri.fromFile(fileName, repoPath!, options.ref));\n\t\tif (this.useCaching && options.range === undefined) {\n\t\t\tif (doc.state !== undefined) {\n\t\t\t\tconst cachedLog = doc.state.get<CachedLog>(key);\n\t\t\t\tif (cachedLog !== undefined) {\n\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\t\t\t\t\treturn cachedLog.item;\n\t\t\t\t}\n\n\t\t\t\tif (options.ref !== undefined || options.maxCount !== undefined) {\n\t\t\t\t\t// Since we are looking for partial log, see if we have the log of the whole file\n\t\t\t\t\tconst cachedLog = doc.state.get<CachedLog>(\n\t\t\t\t\t\t`log${options.renames ? ':follow' : emptyStr}${options.reverse ? ':reverse' : emptyStr}`\n\t\t\t\t\t);\n\t\t\t\t\tif (cachedLog !== undefined) {\n\t\t\t\t\t\tif (options.ref === undefined) {\n\t\t\t\t\t\t\tLogger.debug(cc, `Cache hit: ~'${key}'`);\n\t\t\t\t\t\t\treturn cachedLog.item;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.debug(cc, `Cache ?: '${key}'`);\n\t\t\t\t\t\tlet log = await cachedLog.item;\n\t\t\t\t\t\tif (log !== undefined && !log.truncated && log.commits.has(options.ref)) {\n\t\t\t\t\t\t\tLogger.debug(cc, `Cache hit: '${key}'`);\n\n\t\t\t\t\t\t\t// Create a copy of the log starting at the requested commit\n\t\t\t\t\t\t\tlet skip = true;\n\t\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\t\tconst authors = new Map<string, GitAuthor>();\n\t\t\t\t\t\t\tconst commits = new Map(\n\t\t\t\t\t\t\t\tIterables.filterMap<[string, GitLogCommit], [string, GitLogCommit]>(\n\t\t\t\t\t\t\t\t\tlog.commits.entries(),\n\t\t\t\t\t\t\t\t\t([ref, c]) => {\n\t\t\t\t\t\t\t\t\t\tif (skip) {\n\t\t\t\t\t\t\t\t\t\t\tif (ref !== options.ref) return undefined;\n\t\t\t\t\t\t\t\t\t\t\tskip = false;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\tif (options.maxCount !== undefined && i > options.maxCount) {\n\t\t\t\t\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tauthors.set(c.author, log.authors.get(c.author)!);\n\t\t\t\t\t\t\t\t\t\treturn [ref, c];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst opts = { ...options };\n\t\t\t\t\t\t\tlog = {\n\t\t\t\t\t\t\t\t...log,\n\t\t\t\t\t\t\t\tmaxCount: options.maxCount,\n\t\t\t\t\t\t\t\tcount: commits.size,\n\t\t\t\t\t\t\t\tcommits: commits,\n\t\t\t\t\t\t\t\tauthors: authors,\n\t\t\t\t\t\t\t\tquery: (maxCount: number | undefined) =>\n\t\t\t\t\t\t\t\t\tthis.getLogForFile(repoPath, fileName, { ...opts, maxCount: maxCount })\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\treturn log;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tLogger.debug(cc, `Cache miss: '${key}'`);\n\n\t\t\tif (doc.state === undefined) {\n\t\t\t\tdoc.state = new GitDocumentState(doc.key);\n\t\t\t}\n\t\t}\n\n\t\tconst promise = this.getLogForFileCore(repoPath, fileName, options, doc, key, cc);\n\n\t\tif (doc.state !== undefined && options.range === undefined) {\n\t\t\tLogger.debug(cc, `Cache add: '${key}'`);\n\n\t\t\tconst value: CachedLog = {\n\t\t\t\titem: promise as Promise<GitLog>\n\t\t\t};\n\t\t\tdoc.state.set<CachedLog>(key, value);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tprivate async getLogForFileCore(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\t{\n\t\t\tref,\n\t\t\trange,\n\t\t\t...options\n\t\t}: { maxCount?: number; range?: Range; ref?: string; renames?: boolean; reverse?: boolean },\n\t\tdocument: TrackedDocument<GitDocumentState>,\n\t\tkey: string,\n\t\tcc: LogCorrelationContext | undefined\n\t): Promise<GitLog | undefined> {\n\t\tif (!(await this.isTracked(fileName, repoPath, { ref: ref }))) {\n\t\t\tLogger.log(cc, `Skipping log; '${fileName}' is not tracked`);\n\t\t\treturn emptyPromise as Promise<GitLog>;\n\t\t}\n\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath, false);\n\n\t\ttry {\n\t\t\tif (range !== undefined && range.start.line > range.end.line) {\n\t\t\t\trange = new Range(range.end, range.start);\n\t\t\t}\n\n\t\t\tconst data = await Git.log__file(root, file, ref, {\n\t\t\t\t...options,\n\t\t\t\tstartLine: range === undefined ? undefined : range.start.line + 1,\n\t\t\t\tendLine: range === undefined ? undefined : range.end.line + 1\n\t\t\t});\n\t\t\tconst log = GitLogParser.parse(\n\t\t\t\tdata,\n\t\t\t\tGitCommitType.LogFile,\n\t\t\t\troot,\n\t\t\t\tfile,\n\t\t\t\tref,\n\t\t\t\tawait this.getCurrentUser(root),\n\t\t\t\toptions.maxCount,\n\t\t\t\toptions.reverse!,\n\t\t\t\trange\n\t\t\t);\n\n\t\t\tif (log !== undefined) {\n\t\t\t\tconst opts = { ...options, ref: ref, range: range };\n\t\t\t\tlog.query = (maxCount: number | undefined) =>\n\t\t\t\t\tthis.getLogForFile(repoPath, fileName, { ...opts, maxCount: maxCount });\n\t\t\t}\n\n\t\t\treturn log;\n\t\t} catch (ex) {\n\t\t\t// Trap and cache expected log errors\n\t\t\tif (document.state !== undefined && range === undefined && !options.reverse) {\n\t\t\t\tconst msg = ex && ex.toString();\n\t\t\t\tLogger.debug(cc, `Cache replace (with empty promise): '${key}'`);\n\n\t\t\t\tconst value: CachedLog = {\n\t\t\t\t\titem: emptyPromise as Promise<GitLog>,\n\t\t\t\t\terrorMessage: msg\n\t\t\t\t};\n\t\t\t\tdocument.state.set<CachedLog>(key, value);\n\n\t\t\t\treturn emptyPromise as Promise<GitLog>;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync hasRemotes(repoPath: string | undefined): Promise<boolean> {\n\t\tif (repoPath === undefined) return false;\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tif (repository === undefined) return false;\n\n\t\treturn repository.hasRemotes();\n\t}\n\n\t@log()\n\tasync hasTrackingBranch(repoPath: string | undefined): Promise<boolean> {\n\t\tif (repoPath === undefined) return false;\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tif (repository === undefined) return false;\n\n\t\treturn repository.hasTrackingBranch();\n\t}\n\n\t@log()\n\tasync getMergeBase(repoPath: string, ref1: string, ref2: string, options: { forkPoint?: boolean } = {}) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\tconst data = await Git.merge_base(repoPath, ref1, ref2, options);\n\t\t\tif (data === undefined) return undefined;\n\n\t\t\treturn data.split('\\n')[0];\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getNextDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref: string | undefined,\n\t\tskip: number = 0\n\t): Promise<{ current: GitUri; next: GitUri | undefined; deleted?: boolean } | undefined> {\n\t\t// If we have no ref (or staged ref) there is no next commit\n\t\tif (ref === undefined || ref.length === 0) return undefined;\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tif (Git.isUncommittedStaged(ref)) {\n\t\t\treturn {\n\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, undefined)\n\t\t\t};\n\t\t}\n\n\t\tconst next = await this.getNextUri(repoPath, uri, ref, skip);\n\t\tif (next === undefined) {\n\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\tif (status !== undefined) {\n\t\t\t\t// If the file is staged, diff with the staged version\n\t\t\t\tif (status.indexStatus !== undefined) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, GitService.uncommittedStagedSha)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, ref),\n\t\t\t\tnext: GitUri.fromFile(fileName, repoPath, undefined)\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tcurrent:\n\t\t\t\tskip === 0\n\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t: (await this.getNextUri(repoPath, uri, ref, skip - 1))!,\n\t\t\tnext: next\n\t\t};\n\t}\n\n\t@log()\n\tasync getNextUri(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref?: string,\n\t\tskip: number = 0\n\t\t// editorLine?: number\n\t): Promise<GitUri | undefined> {\n\t\t// If we have no ref (or staged ref) there is no next commit\n\t\tif (ref === undefined || ref.length === 0 || Git.isUncommittedStaged(ref)) return undefined;\n\n\t\tlet filters: GitLogDiffFilter[] | undefined;\n\t\tif (ref === GitService.deletedOrMissingSha) {\n\t\t\t// If we are trying to move next from a deleted or missing ref then get the first commit\n\t\t\tref = undefined;\n\t\t\tfilters = ['A'];\n\t\t}\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\t\tlet data = await Git.log__file(repoPath, fileName, ref, {\n\t\t\tfilters: filters,\n\t\t\tmaxCount: skip + 1,\n\t\t\t// startLine: editorLine !== undefined ? editorLine + 1 : undefined,\n\t\t\treverse: true,\n\t\t\tsimple: true\n\t\t});\n\t\tif (data == null || data.length === 0) return undefined;\n\n\t\tconst [nextRef, file, status] = GitLogParser.parseSimple(data, skip);\n\t\t// If the file was deleted, check for a possible rename\n\t\tif (status === 'D') {\n\t\t\tdata = await Git.log__file(repoPath, '.', nextRef, {\n\t\t\t\tfilters: ['R'],\n\t\t\t\tmaxCount: 1,\n\t\t\t\t// startLine: editorLine !== undefined ? editorLine + 1 : undefined\n\t\t\t\tsimple: true\n\t\t\t});\n\t\t\tif (data == null || data.length === 0) {\n\t\t\t\treturn GitUri.fromFile(file || fileName, repoPath, nextRef);\n\t\t\t}\n\n\t\t\tconst [nextRenamedRef, renamedFile] = GitLogParser.parseSimpleRenamed(data, file || fileName);\n\t\t\treturn GitUri.fromFile(\n\t\t\t\trenamedFile || file || fileName,\n\t\t\t\trepoPath,\n\t\t\t\tnextRenamedRef || nextRef || GitService.deletedOrMissingSha\n\t\t\t);\n\t\t}\n\n\t\treturn GitUri.fromFile(file || fileName, repoPath, nextRef);\n\t}\n\n\t@log()\n\tasync getPreviousDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref: string | undefined,\n\t\tskip: number = 0,\n\t\tfirstParent: boolean = false\n\t): Promise<{ current: GitUri; previous: GitUri | undefined } | undefined> {\n\t\tif (ref === GitService.deletedOrMissingSha) return undefined;\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\t// If we are at the working tree (i.e. no ref), we need to dig deeper to figure out where to go\n\t\tif (ref === undefined || ref.length === 0) {\n\t\t\t// First, check the file status to see if there is anything staged\n\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\tif (status !== undefined) {\n\t\t\t\t// If the file is staged with working changes, diff working with staged (index)\n\t\t\t\t// If the file is staged without working changes, diff staged with HEAD\n\t\t\t\tif (status.indexStatus !== undefined) {\n\t\t\t\t\t// Backs up to get to HEAD\n\t\t\t\t\tif (status.workingTreeStatus === undefined) {\n\t\t\t\t\t\tskip++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (skip === 0) {\n\t\t\t\t\t\t// Diff working with staged\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\tprevious: GitUri.fromFile(fileName, repoPath, GitService.uncommittedStagedSha)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t// Diff staged with HEAD (or prior if more skips)\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, GitService.uncommittedStagedSha),\n\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, ref, skip - 1, undefined, firstParent)\n\t\t\t\t\t};\n\t\t\t\t} else if (status.workingTreeStatus !== undefined) {\n\t\t\t\t\tif (skip === 0) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, undefined, firstParent)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (skip === 0) {\n\t\t\t\tskip++;\n\t\t\t}\n\t\t}\n\t\t// If we are at the index (staged), diff staged with HEAD\n\t\telse if (GitService.isUncommittedStaged(ref)) {\n\t\t\tconst current =\n\t\t\t\tskip === 0\n\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t: (await this.getPreviousUri(repoPath, uri, undefined, skip - 1, undefined, firstParent))!;\n\t\t\tif (current === undefined || current.sha === GitService.deletedOrMissingSha) return undefined;\n\n\t\t\treturn {\n\t\t\t\tcurrent: current,\n\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, undefined, firstParent)\n\t\t\t};\n\t\t}\n\n\t\t// If we are at a commit, diff commit with previous\n\t\tconst current =\n\t\t\tskip === 0\n\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t: (await this.getPreviousUri(repoPath, uri, ref, skip - 1, undefined, firstParent))!;\n\t\tif (current === undefined || current.sha === GitService.deletedOrMissingSha) return undefined;\n\n\t\treturn {\n\t\t\tcurrent: current,\n\t\t\tprevious: await this.getPreviousUri(repoPath, uri, ref, skip, undefined, firstParent)\n\t\t};\n\t}\n\n\t@log()\n\tasync getPreviousLineDiffUris(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\teditorLine: number,\n\t\tref: string | undefined,\n\t\tskip: number = 0\n\t): Promise<{ current: GitUri; previous: GitUri | undefined } | undefined> {\n\t\tif (ref === GitService.deletedOrMissingSha) return undefined;\n\n\t\tlet fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tlet previous;\n\n\t\t// If we are at the working tree (i.e. no ref), we need to dig deeper to figure out where to go\n\t\tif (ref === undefined || ref.length === 0) {\n\t\t\t// First, check the blame on the current line to see if there are any working/staged changes\n\t\t\tconst gitUri = new GitUri(uri, repoPath);\n\n\t\t\tconst document = await workspace.openTextDocument(uri);\n\t\t\tconst blameLine = document.isDirty\n\t\t\t\t? await this.getBlameForLineContents(gitUri, editorLine, document.getText())\n\t\t\t\t: await this.getBlameForLine(gitUri, editorLine);\n\t\t\tif (blameLine === undefined) return undefined;\n\n\t\t\t// If line is uncommitted, we need to dig deeper to figure out where to go (because blame can't be trusted)\n\t\t\tif (blameLine.commit.isUncommitted) {\n\t\t\t\t// If the document is dirty (unsaved), use the status to determine where to go\n\t\t\t\tif (document.isDirty) {\n\t\t\t\t\t// Check the file status to see if there is anything staged\n\t\t\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\t\t\tif (status !== undefined) {\n\t\t\t\t\t\t// If the file is staged, diff working with staged (index)\n\t\t\t\t\t\t// If the file is not staged, diff working with HEAD\n\t\t\t\t\t\tif (status.indexStatus !== undefined) {\n\t\t\t\t\t\t\t// Diff working with staged\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\t\t\tprevious: GitUri.fromFile(fileName, repoPath, GitService.uncommittedStagedSha)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Diff working with HEAD (or prior if more skips)\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcurrent: GitUri.fromFile(fileName, repoPath, undefined),\n\t\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, editorLine)\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// First, check if we have a diff in the working tree\n\t\t\t\tlet hunkLine = await this.getDiffForLine(gitUri, editorLine, undefined);\n\t\t\t\tif (hunkLine === undefined) {\n\t\t\t\t\t// Next, check if we have a diff in the index (staged)\n\t\t\t\t\thunkLine = await this.getDiffForLine(\n\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\teditorLine,\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tGitService.uncommittedStagedSha\n\t\t\t\t\t);\n\n\t\t\t\t\tif (hunkLine !== undefined) {\n\t\t\t\t\t\tref = GitService.uncommittedStagedSha;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tskip++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If line is committed, diff with line ref with previous\n\t\t\telse {\n\t\t\t\tref = blameLine.commit.sha;\n\t\t\t\tfileName = blameLine.commit.fileName || blameLine.commit.originalFileName || fileName;\n\t\t\t\turi = GitUri.resolveToUri(fileName, repoPath);\n\t\t\t\teditorLine = blameLine.line.originalLine - 1;\n\n\t\t\t\tif (skip === 0 && blameLine.commit.previousSha) {\n\t\t\t\t\tprevious = GitUri.fromFile(fileName, repoPath, blameLine.commit.previousSha);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (GitService.isUncommittedStaged(ref)) {\n\t\t\t\tconst current =\n\t\t\t\t\tskip === 0\n\t\t\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t\t\t: (await this.getPreviousUri(repoPath, uri, undefined, skip - 1, editorLine))!;\n\t\t\t\tif (current.sha === GitService.deletedOrMissingSha) return undefined;\n\n\t\t\t\treturn {\n\t\t\t\t\tcurrent: current,\n\t\t\t\t\tprevious: await this.getPreviousUri(repoPath, uri, undefined, skip, editorLine)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst gitUri = new GitUri(uri, { repoPath: repoPath, sha: ref });\n\t\t\tconst blameLine = await this.getBlameForLine(gitUri, editorLine);\n\t\t\tif (blameLine === undefined) return undefined;\n\n\t\t\t// Diff with line ref with previous\n\t\t\tref = blameLine.commit.sha;\n\t\t\tfileName = blameLine.commit.fileName || blameLine.commit.originalFileName || fileName;\n\t\t\turi = GitUri.resolveToUri(fileName, repoPath);\n\t\t\teditorLine = blameLine.line.originalLine - 1;\n\n\t\t\tif (skip === 0 && blameLine.commit.previousSha) {\n\t\t\t\tprevious = GitUri.fromFile(fileName, repoPath, blameLine.commit.previousSha);\n\t\t\t}\n\t\t}\n\n\t\tconst current =\n\t\t\tskip === 0\n\t\t\t\t? GitUri.fromFile(fileName, repoPath, ref)\n\t\t\t\t: (await this.getPreviousUri(repoPath, uri, ref, skip - 1, editorLine))!;\n\t\tif (current.sha === GitService.deletedOrMissingSha) return undefined;\n\n\t\treturn {\n\t\t\tcurrent: current,\n\t\t\tprevious: previous || (await this.getPreviousUri(repoPath, uri, ref, skip, editorLine))\n\t\t};\n\t}\n\n\t@log()\n\tasync getPreviousUri(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\tref?: string,\n\t\tskip: number = 0,\n\t\teditorLine?: number,\n\t\tfirstParent: boolean = false\n\t): Promise<GitUri | undefined> {\n\t\tif (ref === GitService.deletedOrMissingSha) return undefined;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (ref === GitService.uncommittedSha) {\n\t\t\tref = undefined;\n\t\t}\n\n\t\tconst fileName = GitUri.relativeTo(uri, repoPath);\n\t\t// TODO: Add caching\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = await Git.log__file(repoPath, fileName, ref, {\n\t\t\t\tmaxCount: skip + 2,\n\t\t\t\tfirstParent: firstParent,\n\t\t\t\tsimple: true,\n\t\t\t\tstartLine: editorLine !== undefined ? editorLine + 1 : undefined\n\t\t\t});\n\t\t} catch (ex) {\n\t\t\t// If the line count is invalid just fallback to the most recent commit\n\t\t\tif (\n\t\t\t\t(ref === undefined || GitService.isUncommittedStaged(ref)) &&\n\t\t\t\tGitErrors.invalidLineCount.test(ex.message)\n\t\t\t) {\n\t\t\t\tif (ref === undefined) {\n\t\t\t\t\tconst status = await this.getStatusForFile(repoPath, fileName);\n\t\t\t\t\tif (status !== undefined && status.indexStatus !== undefined) {\n\t\t\t\t\t\treturn GitUri.fromFile(fileName, repoPath, GitService.uncommittedStagedSha);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tref = await Git.log__file_recent(repoPath, fileName);\n\t\t\t\treturn GitUri.fromFile(fileName, repoPath, ref || GitService.deletedOrMissingSha);\n\t\t\t}\n\n\t\t\tLogger.error(ex, cc);\n\t\t\tthrow ex;\n\t\t}\n\t\tif (data == null || data.length === 0) return undefined;\n\n\t\tconst [previousRef, file] = GitLogParser.parseSimple(data, skip, ref);\n\t\t// If the previous ref matches the ref we asked for assume we are at the end of the history\n\t\tif (ref !== undefined && ref === previousRef) return undefined;\n\n\t\treturn GitUri.fromFile(file || fileName, repoPath, previousRef || GitService.deletedOrMissingSha);\n\t}\n\n\t@log()\n\tasync getIncomingActivity(\n\t\trepoPath: string,\n\t\t{ maxCount, ...options }: { all?: boolean; branch?: string; maxCount?: number; since?: string } = {}\n\t): Promise<GitReflog | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\tconst data = await Git.reflog(repoPath, options);\n\t\t\tif (data === undefined) return undefined;\n\n\t\t\tconst reflog = GitReflogParser.parse(\n\t\t\t\tdata,\n\t\t\t\trepoPath,\n\t\t\t\treflogCommands,\n\t\t\t\tmaxCount == null ? Container.config.advanced.maxListItems || 0 : maxCount\n\t\t\t);\n\n\t\t\treturn reflog;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getRemotes(\n\t\trepoPath: string | undefined,\n\t\toptions: { includeAll?: boolean; sort?: boolean } = {}\n\t): Promise<GitRemote[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tconst repository = await this.getRepository(repoPath);\n\t\tconst remotes = await (repository !== undefined\n\t\t\t? repository.getRemotes({ sort: options.sort })\n\t\t\t: this.getRemotesCore(repoPath, undefined, { sort: options.sort }));\n\n\t\tif (options.includeAll) return remotes;\n\n\t\treturn remotes.filter(r => r.provider !== undefined);\n\t}\n\n\tasync getRemotesCore(\n\t\trepoPath: string | undefined,\n\t\tproviders?: RemoteProviders,\n\t\toptions: { sort?: boolean } = {}\n\t): Promise<GitRemote[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tproviders = providers || RemoteProviderFactory.loadProviders(configuration.get('remotes', null));\n\n\t\ttry {\n\t\t\tconst data = await Git.remote(repoPath);\n\t\t\tconst remotes = GitRemoteParser.parse(data, repoPath, RemoteProviderFactory.factory(providers));\n\t\t\tif (remotes === undefined) return [];\n\n\t\t\tif (options.sort) {\n\t\t\t\tGitRemote.sort(remotes);\n\t\t\t}\n\n\t\t\treturn remotes;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync getRepoPath(filePath: string, options?: { ref?: string }): Promise<string | undefined>;\n\tasync getRepoPath(uri: Uri | undefined, options?: { ref?: string }): Promise<string | undefined>;\n\t@log<GitService['getRepoPath']>({\n\t\texit: path => `returned ${path}`\n\t})\n\tasync getRepoPath(\n\t\tfilePathOrUri: string | Uri | undefined,\n\t\toptions: { ref?: string } = {}\n\t): Promise<string | undefined> {\n\t\tif (filePathOrUri == null) return this.getHighlanderRepoPath();\n\t\tif (GitUri.is(filePathOrUri)) return filePathOrUri.repoPath;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t// Don't save the tracking info to the cache, because we could be looking in the wrong place (e.g. looking in the root when the file is in a submodule)\n\t\tlet repo = await this.getRepository(filePathOrUri, { ...options, skipCacheUpdate: true });\n\t\tif (repo !== undefined) return repo.path;\n\n\t\tconst rp = await this.getRepoPathCore(\n\t\t\ttypeof filePathOrUri === 'string' ? filePathOrUri : filePathOrUri.fsPath,\n\t\t\tfalse\n\t\t);\n\t\tif (rp === undefined) return undefined;\n\n\t\t// Recheck this._repositoryTree.get(rp) to make sure we haven't already tried adding this due to awaits\n\t\tif (this._repositoryTree.get(rp) !== undefined) return rp;\n\n\t\tconst isVslsScheme =\n\t\t\ttypeof filePathOrUri === 'string' ? undefined : filePathOrUri.scheme === DocumentSchemes.Vsls;\n\n\t\t// If this new repo is inside one of our known roots and we we don't already know about, add it\n\t\tconst root = this.findRepositoryForPath(this._repositoryTree, rp, isVslsScheme);\n\n\t\tlet folder;\n\t\tif (root !== undefined) {\n\t\t\t// Not sure why I added this for vsls (I can't see a reason for it anymore), but if it is added it will break submodules\n\t\t\t// rp = root.path;\n\t\t\tfolder = root.folder;\n\t\t} else {\n\t\t\tfolder = workspace.getWorkspaceFolder(GitUri.file(rp, isVslsScheme));\n\t\t\tif (folder === undefined) {\n\t\t\t\tconst parts = rp.split(slash);\n\t\t\t\tfolder = {\n\t\t\t\t\turi: GitUri.file(rp, isVslsScheme),\n\t\t\t\t\tname: parts[parts.length - 1],\n\t\t\t\t\tindex: this._repositoryTree.count()\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tLogger.log(cc, `Repository found in '${rp}'`);\n\t\trepo = new Repository(folder, rp, false, this.onAnyRepositoryChanged.bind(this), this._suspended);\n\t\tthis._repositoryTree.set(rp, repo);\n\n\t\t// Send a notification that the repositories changed\n\t\tsetImmediate(async () => {\n\t\t\tawait this.updateContext(this._repositoryTree);\n\n\t\t\tthis.fireRepositoriesChanged();\n\t\t});\n\n\t\treturn rp;\n\t}\n\n\tprivate async getRepoPathCore(filePath: string, isDirectory: boolean): Promise<string | undefined> {\n\t\ttry {\n\t\t\treturn await Git.rev_parse__show_toplevel(isDirectory ? filePath : paths.dirname(filePath));\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t@log()\n\tasync getRepoPathOrActive(uri: Uri | undefined, editor: TextEditor | undefined) {\n\t\tconst repoPath = await this.getRepoPath(uri);\n\t\tif (repoPath) return repoPath;\n\n\t\treturn this.getActiveRepoPath(editor);\n\t}\n\n\t@log()\n\tasync getRepositories(predicate?: (repo: Repository) => boolean): Promise<Iterable<Repository>> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\n\t\tconst values = repositoryTree.values();\n\t\treturn predicate !== undefined ? Iterables.filter(values, predicate) : values;\n\t}\n\n\t@log()\n\tasync getOrderedRepositories(): Promise<Repository[]> {\n\t\tconst repositories = [...(await this.getRepositories())];\n\t\tif (repositories.length === 0) return repositories;\n\n\t\treturn Repository.sort(repositories.filter(r => !r.closed));\n\t}\n\n\tprivate async getRepositoryTree(): Promise<TernarySearchTree<Repository>> {\n\t\tif (this._repositoriesLoadingPromise !== undefined) {\n\t\t\tawait this._repositoriesLoadingPromise;\n\t\t\tthis._repositoriesLoadingPromise = undefined;\n\t\t}\n\n\t\treturn this._repositoryTree;\n\t}\n\n\tasync getRepository(\n\t\trepoPath: string,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean }\n\t): Promise<Repository | undefined>;\n\tasync getRepository(\n\t\turi: Uri,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean }\n\t): Promise<Repository | undefined>;\n\tasync getRepository(\n\t\trepoPathOrUri: string | Uri,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean }\n\t): Promise<Repository | undefined>;\n\t@log<GitService['getRepository']>({\n\t\texit: repo => `returned ${repo !== undefined ? `${repo.path}` : 'undefined'}`\n\t})\n\tasync getRepository(\n\t\trepoPathOrUri: string | Uri,\n\t\toptions: { ref?: string; skipCacheUpdate?: boolean } = {}\n\t): Promise<Repository | undefined> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\n\t\tlet isVslsScheme;\n\n\t\tlet path: string;\n\t\tif (typeof repoPathOrUri === 'string') {\n\t\t\tconst repo = repositoryTree.get(repoPathOrUri);\n\t\t\tif (repo !== undefined) return repo;\n\n\t\t\tpath = repoPathOrUri;\n\t\t\tisVslsScheme = undefined;\n\t\t} else {\n\t\t\tif (GitUri.is(repoPathOrUri)) {\n\t\t\t\tif (repoPathOrUri.repoPath) {\n\t\t\t\t\tconst repo = repositoryTree.get(repoPathOrUri.repoPath);\n\t\t\t\t\tif (repo !== undefined) return repo;\n\t\t\t\t}\n\n\t\t\t\tpath = repoPathOrUri.fsPath;\n\t\t\t} else {\n\t\t\t\tpath = repoPathOrUri.fsPath;\n\t\t\t}\n\n\t\t\tisVslsScheme = repoPathOrUri.scheme === DocumentSchemes.Vsls;\n\t\t}\n\n\t\tconst repo = this.findRepositoryForPath(repositoryTree, path, isVslsScheme);\n\t\tif (repo === undefined) return undefined;\n\n\t\t// Make sure the file is tracked in this repo before returning -- it could be from a submodule\n\t\tif (!(await this.isTracked(path, repo.path, options))) return undefined;\n\t\treturn repo;\n\t}\n\n\tprivate findRepositoryForPath(\n\t\trepositoryTree: TernarySearchTree<Repository>,\n\t\tpath: string,\n\t\tisVslsScheme: boolean | undefined\n\t): Repository | undefined {\n\t\tlet repo = repositoryTree.findSubstr(path);\n\t\t// If we can't find the repo and we are a guest, check if we are a \"root\" workspace\n\t\tif (repo === undefined && isVslsScheme !== false && Container.vsls.isMaybeGuest) {\n\t\t\tif (!vslsUriPrefixRegex.test(path)) {\n\t\t\t\tpath = Strings.normalizePath(path);\n\t\t\t\tconst vslsPath = `/~0${path.startsWith(slash) ? path : `/${path}`}`;\n\t\t\t\trepo = repositoryTree.findSubstr(vslsPath);\n\t\t\t}\n\t\t}\n\t\treturn repo;\n\t}\n\n\tasync getRepositoryCount(): Promise<number> {\n\t\tconst repositoryTree = await this.getRepositoryTree();\n\t\treturn repositoryTree.count();\n\t}\n\n\t@log()\n\tasync getStashList(repoPath: string | undefined): Promise<GitStash | undefined> {\n\t\tif (repoPath === undefined) return undefined;\n\n\t\tconst data = await Git.stash__list(repoPath, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t});\n\t\tconst stash = GitStashParser.parse(data, repoPath);\n\t\treturn stash;\n\t}\n\n\t@log()\n\tasync getStatusForFile(repoPath: string, fileName: string): Promise<GitStatusFile | undefined> {\n\t\tconst porcelainVersion = Git.validateVersion(2, 11) ? 2 : 1;\n\n\t\tconst data = await Git.status__file(repoPath, fileName, porcelainVersion, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t});\n\t\tconst status = GitStatusParser.parse(data, repoPath, porcelainVersion);\n\t\tif (status === undefined || !status.files.length) return undefined;\n\n\t\treturn status.files[0];\n\t}\n\n\t@log()\n\tasync getStatusForRepo(repoPath: string | undefined): Promise<GitStatus | undefined> {\n\t\tif (repoPath === undefined) return undefined;\n\n\t\tconst porcelainVersion = Git.validateVersion(2, 11) ? 2 : 1;\n\n\t\tconst data = await Git.status(repoPath, porcelainVersion, {\n\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t});\n\t\tconst status = GitStatusParser.parse(data, repoPath, porcelainVersion);\n\t\treturn status;\n\t}\n\n\t@log()\n\tasync getTags(\n\t\trepoPath: string | undefined,\n\t\toptions: { filter?: (t: GitTag) => boolean; includeRefs?: boolean; sort?: boolean } = {}\n\t): Promise<GitTag[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tlet tags: GitTag[] | undefined;\n\t\ttry {\n\t\t\tif (options.includeRefs) {\n\t\t\t\ttags = this._tagsWithRefsCache.get(repoPath);\n\t\t\t\tif (tags !== undefined) return tags;\n\n\t\t\t\tconst data = await Git.show_ref__tags(repoPath);\n\t\t\t\ttags = GitTagParser.parseWithRef(data, repoPath) || [];\n\n\t\t\t\tconst repo = await this.getRepository(repoPath);\n\t\t\t\tif (repo !== undefined && repo.supportsChangeEvents) {\n\t\t\t\t\tthis._tagsWithRefsCache.set(repoPath, tags);\n\t\t\t\t}\n\n\t\t\t\treturn tags;\n\t\t\t}\n\n\t\t\ttags = this._tagsCache.get(repoPath);\n\t\t\tif (tags !== undefined) return tags;\n\n\t\t\tconst data = await Git.tag(repoPath);\n\t\t\ttags = GitTagParser.parse(data, repoPath) || [];\n\n\t\t\tconst repo = await this.getRepository(repoPath);\n\t\t\tif (repo !== undefined && repo.supportsChangeEvents) {\n\t\t\t\tthis._tagsCache.set(repoPath, tags);\n\t\t\t}\n\n\t\t\treturn tags;\n\t\t} finally {\n\t\t\tif (options.filter !== undefined) {\n\t\t\t\ttags = tags!.filter(options.filter);\n\t\t\t}\n\n\t\t\tif (options.sort) {\n\t\t\t\tGitTag.sort(tags!);\n\t\t\t}\n\n\t\t\tif (options.filter !== undefined) {\n\t\t\t\t// eslint-disable-next-line no-unsafe-finally\n\t\t\t\treturn tags!;\n\t\t\t}\n\t\t}\n\t}\n\n\t@log()\n\tasync getTreeFileForRevision(repoPath: string, fileName: string, ref: string): Promise<GitTree | undefined> {\n\t\tif (repoPath === undefined || fileName == null || fileName.length === 0) return undefined;\n\n\t\tconst data = await Git.ls_tree(repoPath, ref, { fileName: fileName });\n\t\tconst trees = GitTreeParser.parse(data);\n\t\treturn trees === undefined || trees.length === 0 ? undefined : trees[0];\n\t}\n\n\t@log()\n\tasync getTreeForRevision(repoPath: string, ref: string): Promise<GitTree[]> {\n\t\tif (repoPath === undefined) return [];\n\n\t\tconst data = await Git.ls_tree(repoPath, ref);\n\t\treturn GitTreeParser.parse(data) || [];\n\t}\n\n\t@log()\n\tgetVersionedFileBuffer(repoPath: string, fileName: string, ref: string) {\n\t\treturn Git.show<Buffer>(repoPath, fileName, ref, { encoding: 'buffer' });\n\t}\n\n\t@log()\n\tasync getVersionedUri(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref: string | undefined\n\t): Promise<Uri | undefined> {\n\t\tif (ref === GitService.deletedOrMissingSha) return undefined;\n\n\t\tif (ref == null || ref.length === 0 || (Git.isUncommitted(ref) && !Git.isUncommittedStaged(ref))) {\n\t\t\t// Make sure the file exists in the repo\n\t\t\tlet data = await Git.ls_files(repoPath!, fileName);\n\t\t\tif (data !== undefined) return GitUri.file(fileName);\n\n\t\t\t// Check if the file exists untracked\n\t\t\tdata = await Git.ls_files(repoPath!, fileName, { untracked: true });\n\t\t\tif (data !== undefined) return GitUri.file(fileName);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (Git.isUncommittedStaged(ref)) {\n\t\t\treturn GitUri.git(fileName, repoPath);\n\t\t}\n\n\t\treturn GitUri.toRevisionUri(ref, fileName, repoPath!);\n\t}\n\n\t@log()\n\tasync getWorkingUri(repoPath: string, uri: Uri) {\n\t\tlet fileName = GitUri.relativeTo(uri, repoPath);\n\n\t\tlet data;\n\t\tlet ref;\n\t\tdo {\n\t\t\tdata = await Git.ls_files(repoPath, fileName);\n\t\t\tif (data !== undefined) {\n\t\t\t\treturn GitUri.resolveToUri(data, repoPath);\n\t\t\t}\n\n\t\t\t// TODO: Add caching\n\t\t\t// Get the most recent commit for this file name\n\t\t\tref = await Git.log__file_recent(repoPath, fileName, {\n\t\t\t\tsimilarityThreshold: Container.config.advanced.similarityThreshold\n\t\t\t});\n\t\t\tif (ref === undefined) return undefined;\n\n\t\t\t// Now check if that commit had any renames\n\t\t\tdata = await Git.log__file(repoPath, '.', ref, {\n\t\t\t\tfilters: ['R'],\n\t\t\t\tmaxCount: 1,\n\t\t\t\tsimple: true\n\t\t\t});\n\t\t\tif (data == null || data.length === 0) {\n\t\t\t\treturn GitUri.resolveToUri(fileName, repoPath);\n\t\t\t}\n\n\t\t\tconst [renamedRef, renamedFile] = GitLogParser.parseSimpleRenamed(data, fileName);\n\t\t\tif (renamedRef === undefined || renamedFile === undefined) {\n\t\t\t\treturn GitUri.resolveToUri(fileName, repoPath);\n\t\t\t}\n\n\t\t\tfileName = renamedFile;\n\t\t} while (true);\n\t}\n\n\tisTrackable(scheme: string): boolean;\n\tisTrackable(uri: Uri): boolean;\n\tisTrackable(schemeOruri: string | Uri): boolean {\n\t\tconst scheme = typeof schemeOruri === 'string' ? schemeOruri : schemeOruri.scheme;\n\t\treturn (\n\t\t\tscheme === DocumentSchemes.File ||\n\t\t\tscheme === DocumentSchemes.Vsls ||\n\t\t\tscheme === DocumentSchemes.Git ||\n\t\t\tscheme === DocumentSchemes.GitLens\n\t\t);\n\t}\n\n\tasync isTracked(\n\t\tfileName: string,\n\t\trepoPath?: string,\n\t\toptions?: { ref?: string; skipCacheUpdate?: boolean }\n\t): Promise<boolean>;\n\tasync isTracked(uri: GitUri): Promise<boolean>;\n\t@log<GitService['isTracked']>({\n\t\texit: tracked => `returned ${tracked}`,\n\t\tsingleLine: true\n\t})\n\tasync isTracked(\n\t\tfileNameOrUri: string | GitUri,\n\t\trepoPath?: string,\n\t\toptions: { ref?: string; skipCacheUpdate?: boolean } = {}\n\t): Promise<boolean> {\n\t\tif (options.ref === GitService.deletedOrMissingSha) return false;\n\n\t\tlet ref = options.ref;\n\t\tlet cacheKey: string;\n\t\tlet fileName: string;\n\t\tif (typeof fileNameOrUri === 'string') {\n\t\t\t[fileName, repoPath] = Git.splitPath(fileNameOrUri, repoPath);\n\t\t\tcacheKey = GitUri.toKey(fileNameOrUri);\n\t\t} else {\n\t\t\tif (!this.isTrackable(fileNameOrUri)) return false;\n\n\t\t\tfileName = fileNameOrUri.fsPath;\n\t\t\trepoPath = fileNameOrUri.repoPath;\n\t\t\tref = fileNameOrUri.sha;\n\t\t\tcacheKey = GitUri.toKey(fileName);\n\t\t}\n\n\t\tif (ref !== undefined) {\n\t\t\tcacheKey += `:${ref}`;\n\t\t}\n\n\t\tlet tracked = this._trackedCache.get(cacheKey);\n\t\tif (tracked !== undefined) {\n\t\t\ttracked = await tracked;\n\n\t\t\treturn tracked;\n\t\t}\n\n\t\ttracked = this.isTrackedCore(fileName, repoPath === undefined ? emptyStr : repoPath, ref);\n\t\tif (options.skipCacheUpdate) {\n\t\t\ttracked = await tracked;\n\n\t\t\treturn tracked;\n\t\t}\n\n\t\tthis._trackedCache.set(cacheKey, tracked);\n\t\ttracked = await tracked;\n\t\tthis._trackedCache.set(cacheKey, tracked);\n\n\t\treturn tracked;\n\t}\n\n\tprivate async isTrackedCore(fileName: string, repoPath: string, ref?: string) {\n\t\tif (ref === GitService.deletedOrMissingSha) return false;\n\n\t\ttry {\n\t\t\t// Even if we have a ref, check first to see if the file exists (that way the cache will be better reused)\n\t\t\tlet tracked = Boolean(await Git.ls_files(repoPath === undefined ? emptyStr : repoPath, fileName));\n\t\t\tif (!tracked && ref !== undefined) {\n\t\t\t\ttracked = Boolean(\n\t\t\t\t\tawait Git.ls_files(repoPath === undefined ? emptyStr : repoPath, fileName, { ref: ref })\n\t\t\t\t);\n\t\t\t\t// If we still haven't found this file, make sure it wasn't deleted in that ref (i.e. check the previous)\n\t\t\t\tif (!tracked) {\n\t\t\t\t\ttracked = Boolean(\n\t\t\t\t\t\tawait Git.ls_files(repoPath === undefined ? emptyStr : repoPath, fileName, {\n\t\t\t\t\t\t\tref: `${ref}^`\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tracked;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t@log()\n\tasync getDiffTool(repoPath?: string) {\n\t\treturn (\n\t\t\t(await Git.config__get('diff.guitool', repoPath, { local: true })) ||\n\t\t\tGit.config__get('diff.tool', repoPath, { local: true })\n\t\t);\n\t}\n\n\t@log()\n\tasync openDiffTool(\n\t\trepoPath: string,\n\t\turi: Uri,\n\t\toptions: { ref1?: string; ref2?: string; staged?: boolean; tool?: string } = {}\n\t) {\n\t\tif (!options.tool) {\n\t\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t\toptions.tool = await this.getDiffTool(repoPath);\n\t\t\tif (options.tool === undefined) throw new Error('No diff tool found');\n\n\t\t\tLogger.log(cc, `Using tool=${options.tool}`);\n\t\t}\n\n\t\tconst { tool, ...opts } = options;\n\t\treturn Git.difftool(repoPath, uri.fsPath, tool, opts);\n\t}\n\n\t@log()\n\tasync openDirectoryDiff(repoPath: string, ref1: string, ref2?: string, tool?: string) {\n\t\tif (!tool) {\n\t\t\tconst cc = Logger.getCorrelationContext();\n\n\t\t\ttool = await this.getDiffTool(repoPath);\n\t\t\tif (tool === undefined) throw new Error('No diff tool found');\n\n\t\t\tLogger.log(cc, `Using tool=${tool}`);\n\t\t}\n\n\t\treturn Git.difftool__dir_diff(repoPath, tool, ref1, ref2);\n\t}\n\n\t@log()\n\tasync resolveReference(repoPath: string, ref: string, uri?: Uri) {\n\t\tif (ref == null || ref.length === 0 || ref === GitService.deletedOrMissingSha) return ref;\n\n\t\tif (uri == null) {\n\t\t\tif (Git.isSha(ref) || !Git.isShaLike(ref) || ref.endsWith('^3')) return ref;\n\n\t\t\treturn (await Git.rev_parse(repoPath, ref)) || ref;\n\t\t}\n\n\t\tconst fileName = Strings.normalizePath(paths.relative(repoPath, uri.fsPath));\n\n\t\tconst match = Git.shaParentRegex.exec(ref);\n\t\tif (match != null) {\n\t\t\tconst parentRef = await Git.log__file_recent(repoPath, fileName, { ref: ref });\n\t\t\tif (parentRef !== undefined) return parentRef;\n\t\t}\n\n\t\tconst ensuredRef = await Git.cat_file__resolve(repoPath, fileName, ref);\n\t\tif (ensuredRef === undefined) return ref;\n\n\t\treturn ensuredRef;\n\t}\n\n\t@log()\n\tvalidateBranchName(ref: string, repoPath?: string) {\n\t\treturn Git.check_ref_format(ref, repoPath);\n\t}\n\n\t@log()\n\tvalidateReference(repoPath: string, ref: string) {\n\t\treturn Git.cat_file__validate(repoPath, ref);\n\t}\n\n\tstageFile(repoPath: string, fileName: string): Promise<string>;\n\tstageFile(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tstageFile(repoPath: string, fileNameOrUri: string | Uri): Promise<string> {\n\t\treturn Git.add(\n\t\t\trepoPath,\n\t\t\ttypeof fileNameOrUri === 'string' ? fileNameOrUri : Git.splitPath(fileNameOrUri.fsPath, repoPath)[0]\n\t\t);\n\t}\n\n\tstageDirectory(repoPath: string, directory: string): Promise<string>;\n\tstageDirectory(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tstageDirectory(repoPath: string, directoryOrUri: string | Uri): Promise<string> {\n\t\treturn Git.add(\n\t\t\trepoPath,\n\t\t\ttypeof directoryOrUri === 'string' ? directoryOrUri : Git.splitPath(directoryOrUri.fsPath, repoPath)[0]\n\t\t);\n\t}\n\n\tunStageFile(repoPath: string, fileName: string): Promise<string>;\n\tunStageFile(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tunStageFile(repoPath: string, fileNameOrUri: string | Uri): Promise<string> {\n\t\treturn Git.reset(\n\t\t\trepoPath,\n\t\t\ttypeof fileNameOrUri === 'string' ? fileNameOrUri : Git.splitPath(fileNameOrUri.fsPath, repoPath)[0]\n\t\t);\n\t}\n\n\tunStageDirectory(repoPath: string, directory: string): Promise<string>;\n\tunStageDirectory(repoPath: string, uri: Uri): Promise<string>;\n\t@log()\n\tunStageDirectory(repoPath: string, directoryOrUri: string | Uri): Promise<string> {\n\t\treturn Git.reset(\n\t\t\trepoPath,\n\t\t\ttypeof directoryOrUri === 'string' ? directoryOrUri : Git.splitPath(directoryOrUri.fsPath, repoPath)[0]\n\t\t);\n\t}\n\n\t@log()\n\tstashApply(repoPath: string, stashName: string, deleteAfter: boolean = false) {\n\t\treturn Git.stash__apply(repoPath, stashName, deleteAfter);\n\t}\n\n\t@log()\n\tstashDelete(repoPath: string, stashName: string) {\n\t\treturn Git.stash__delete(repoPath, stashName);\n\t}\n\n\t@log()\n\tstashSave(\n\t\trepoPath: string,\n\t\tmessage?: string,\n\t\turis?: Uri[],\n\t\toptions: { includeUntracked?: boolean; keepIndex?: boolean } = {}\n\t) {\n\t\tif (uris === undefined) return Git.stash__push(repoPath, message, options);\n\n\t\tGitService.ensureGitVersion('2.13.2', 'Stashing individual files');\n\n\t\tconst pathspecs = uris.map(u => `./${Git.splitPath(u.fsPath, repoPath)[0]}`);\n\t\treturn Git.stash__push(repoPath, message, { ...options, pathspecs: pathspecs });\n\t}\n\n\tstatic compareGitVersion(version: string) {\n\t\treturn Versions.compare(Versions.fromString(this.getGitVersion()), Versions.fromString(version));\n\t}\n\n\tstatic ensureGitVersion(version: string, feature: string): void {\n\t\tconst gitVersion = this.getGitVersion();\n\t\tif (Versions.compare(Versions.fromString(gitVersion), Versions.fromString(version)) === -1) {\n\t\t\tthrow new Error(\n\t\t\t\t`${feature} requires a newer version of Git (>= ${version}) than is currently installed (${gitVersion}). Please install a more recent version of Git to use this GitLens feature.`\n\t\t\t);\n\t\t}\n\t}\n\n\t@log()\n\tstatic async getBuiltInGitApi(): Promise<BuiltInGitApi | undefined> {\n\t\ttry {\n\t\t\tconst extension = extensions.getExtension('vscode.git') as Extension<GitExtension>;\n\t\t\tif (extension !== undefined) {\n\t\t\t\tconst gitExtension = extension.isActive ? extension.exports : await extension.activate();\n\n\t\t\t\treturn gitExtension.getAPI(1);\n\t\t\t}\n\t\t} catch {}\n\n\t\treturn undefined;\n\t}\n\n\tstatic getEncoding(repoPath: string, fileName: string): string;\n\tstatic getEncoding(uri: Uri): string;\n\tstatic getEncoding(repoPathOrUri: string | Uri, fileName?: string): string {\n\t\tconst uri = typeof repoPathOrUri === 'string' ? GitUri.resolveToUri(fileName!, repoPathOrUri) : repoPathOrUri;\n\t\treturn Git.getEncoding(configuration.getAny<string>('files.encoding', uri));\n\t}\n\n\tstatic deletedOrMissingSha = Git.deletedOrMissingSha;\n\tstatic getGitPath = Git.getGitPath;\n\tstatic getGitVersion = Git.getGitVersion;\n\tstatic isSha = Git.isSha;\n\tstatic isShaLike = Git.isShaLike;\n\tstatic isShaParent = Git.isShaParent;\n\tstatic isUncommitted = Git.isUncommitted;\n\tstatic isUncommittedStaged = Git.isUncommittedStaged;\n\tstatic uncommittedSha = Git.uncommittedSha;\n\tstatic uncommittedStagedSha = Git.uncommittedStagedSha;\n\n\tstatic shortenSha(\n\t\tref: string | undefined,\n\t\toptions: {\n\t\t\tforce?: boolean;\n\t\t\tstrings?: { uncommitted?: string; uncommittedStaged?: string; working?: string };\n\t\t} = {}\n\t) {\n\t\tif (ref === GitService.deletedOrMissingSha) return '(deleted)';\n\n\t\treturn Git.shortenSha(ref, options);\n\t}\n\n\tstatic parseSearchOperations(search: string): Map<string, string[]> {\n\t\tconst operations = new Map<string, string[]>();\n\n\t\tlet op;\n\t\tlet value;\n\n\t\tlet match = searchMessageOperationRegex.exec(search);\n\t\tif (match != null && match[1] !== '') {\n\t\t\tthis.parseSearchMessageOperations(match[1], operations);\n\t\t}\n\n\t\tdo {\n\t\t\tmatch = searchOperationRegex.exec(search);\n\t\t\tif (match == null) break;\n\n\t\t\t[, op, value] = match;\n\n\t\t\tif (op !== undefined) {\n\t\t\t\top = normalizeSearchOperatorsMap.get(op as SearchOperators)!;\n\n\t\t\t\tif (op === 'message:') {\n\t\t\t\t\tthis.parseSearchMessageOperations(value, operations);\n\t\t\t\t} else {\n\t\t\t\t\tlet values = operations.get(op);\n\t\t\t\t\tif (values === undefined) {\n\t\t\t\t\t\tvalues = [value];\n\t\t\t\t\t\toperations.set(op, values);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.push(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while (true);\n\n\t\treturn operations;\n\t}\n\n\tprivate static parseSearchMessageOperations(message: string, operations: Map<string, string[]>) {\n\t\tlet values = operations.get('message:');\n\n\t\tif (message === emptyStr) {\n\t\t\tif (values === undefined) {\n\t\t\t\tvalues = [''];\n\t\t\t\toperations.set('message:', values);\n\t\t\t} else {\n\t\t\t\tvalues.push('');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet match;\n\t\tlet value;\n\t\tdo {\n\t\t\tmatch = searchMessageValuesRegex.exec(message);\n\t\t\tif (match == null) break;\n\n\t\t\t[, value] = match;\n\n\t\t\tif (values === undefined) {\n\t\t\t\tvalues = [value];\n\t\t\t\toperations.set('message:', values);\n\t\t\t} else {\n\t\t\t\tvalues.push(value);\n\t\t\t}\n\t\t} while (true);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tcommands,\n\tDisposable,\n\tExtensionContext,\n\tSourceControlResourceGroup,\n\tSourceControlResourceState,\n\tTextDocumentShowOptions,\n\tTextEditor,\n\tTextEditorEdit,\n\tUri,\n\tViewColumn,\n\twindow,\n\tworkspace\n} from 'vscode';\nimport { BuiltInCommands, DocumentSchemes, ImageMimetypes } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitCommit, GitContributor, GitFile, GitRemote, GitUri, Repository } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { CommandQuickPickItem, RepositoriesQuickPick } from '../quickpicks';\n// import { Telemetry } from '../telemetry';\nimport { ViewNode, ViewRefNode } from '../views/nodes';\n\nexport enum Commands {\n\tClearFileAnnotations = 'gitlens.clearFileAnnotations',\n\tCloseUnchangedFiles = 'gitlens.closeUnchangedFiles',\n\tComputingFileAnnotations = 'gitlens.computingFileAnnotations',\n\tCopyMessageToClipboard = 'gitlens.copyMessageToClipboard',\n\tCopyRemoteFileUrlToClipboard = 'gitlens.copyRemoteFileUrlToClipboard',\n\tCopyShaToClipboard = 'gitlens.copyShaToClipboard',\n\tDiffDirectory = 'gitlens.diffDirectory',\n\tDiffDirectoryWithHead = 'gitlens.diffDirectoryWithHead',\n\tDiffHeadWith = 'gitlens.diffHeadWith',\n\t// DEPRECATED\n\tDiffHeadWithBranch = 'gitlens.diffHeadWithBranch',\n\tDiffWorkingWith = 'gitlens.diffWorkingWith',\n\t// DEPRECATED\n\tDiffWorkingWithBranch = 'gitlens.diffWorkingWithBranch',\n\tExternalDiffAll = 'gitlens.externalDiffAll',\n\tDiffWith = 'gitlens.diffWith',\n\t// DEPRECATED\n\tDiffWithBranch = 'gitlens.diffWithBranch',\n\tDiffWithRef = 'gitlens.diffWithRef',\n\tDiffWithNext = 'gitlens.diffWithNext',\n\tDiffWithNextInDiffLeft = 'gitlens.diffWithNextInDiffLeft',\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tDiffWithPreviousInDiffRight = 'gitlens.diffWithPreviousInDiffRight',\n\tDiffLineWithPrevious = 'gitlens.diffLineWithPrevious',\n\tDiffWithRevision = 'gitlens.diffWithRevision',\n\tDiffWithWorking = 'gitlens.diffWithWorking',\n\tDiffLineWithWorking = 'gitlens.diffLineWithWorking',\n\tExploreRepoAtRevision = 'gitlens.exploreRepoAtRevision',\n\tExternalDiff = 'gitlens.externalDiff',\n\tFetchRepositories = 'gitlens.fetchRepositories',\n\tInviteToLiveShare = 'gitlens.inviteToLiveShare',\n\tOpenChangedFiles = 'gitlens.openChangedFiles',\n\tOpenBranchesInRemote = 'gitlens.openBranchesInRemote',\n\tOpenBranchInRemote = 'gitlens.openBranchInRemote',\n\tOpenCommitInRemote = 'gitlens.openCommitInRemote',\n\tOpenFileInRemote = 'gitlens.openFileInRemote',\n\tOpenFileRevision = 'gitlens.openFileRevision',\n\tOpenFileRevisionFrom = 'gitlens.openFileRevisionFrom',\n\t// DEPRECATED\n\tOpenFileRevisionFromBranch = 'gitlens.openFileRevisionFromBranch',\n\tOpenInRemote = 'gitlens.openInRemote',\n\tOpenRepoInRemote = 'gitlens.openRepoInRemote',\n\tOpenRevisionFile = 'gitlens.openRevisionFile',\n\tOpenWorkingFile = 'gitlens.openWorkingFile',\n\tPullRepositories = 'gitlens.pullRepositories',\n\tPushRepositories = 'gitlens.pushRepositories',\n\tGitCommands = 'gitlens.gitCommands',\n\tResetSuppressedWarnings = 'gitlens.resetSuppressedWarnings',\n\tRevealCommitInView = 'gitlens.revealCommitInView',\n\tSearchCommits = 'gitlens.showCommitSearch',\n\tSearchCommitsInView = 'gitlens.views.search.searchCommits',\n\tShowCommitInView = 'gitlens.showCommitInView',\n\tShowCommitsInView = 'gitlens.showCommitsInView',\n\tShowCompareView = 'gitlens.showCompareView',\n\tShowFileHistoryView = 'gitlens.showFileHistoryView',\n\tShowFileHistoryInView = 'gitlens.showFileHistoryInView',\n\tShowLineHistoryView = 'gitlens.showLineHistoryView',\n\tShowLastQuickPick = 'gitlens.showLastQuickPick',\n\tShowQuickBranchHistory = 'gitlens.showQuickBranchHistory',\n\tShowQuickCommitDetails = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFileDetails = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tShowQuickRepoStatus = 'gitlens.showQuickRepoStatus',\n\tShowQuickRevisionDetails = 'gitlens.showQuickRevisionDetails',\n\tShowQuickStashList = 'gitlens.showQuickStashList',\n\tShowRepositoriesView = 'gitlens.showRepositoriesView',\n\tShowSearchView = 'gitlens.showSearchView',\n\tShowHistoryPage = 'gitlens.showHistoryPage',\n\tShowSettingsPage = 'gitlens.showSettingsPage',\n\tShowSettingsPageAndJumpToCompareView = 'gitlens.showSettingsPage#compare-view',\n\tShowSettingsPageAndJumpToFileHistoryView = 'gitlens.showSettingsPage#file-history-view',\n\tShowSettingsPageAndJumpToLineHistoryView = 'gitlens.showSettingsPage#line-history-view',\n\tShowSettingsPageAndJumpToRepositoriesView = 'gitlens.showSettingsPage#repositories-view',\n\tShowSettingsPageAndJumpToSearchCommitsView = 'gitlens.showSettingsPage#search-commits-view',\n\tShowWelcomePage = 'gitlens.showWelcomePage',\n\tStashApply = 'gitlens.stashApply',\n\tStashDelete = 'gitlens.stashDelete',\n\tStashSave = 'gitlens.stashSave',\n\tStashSaveFiles = 'gitlens.stashSaveFiles',\n\tSupportGitLens = 'gitlens.supportGitLens',\n\tSwitchMode = 'gitlens.switchMode',\n\tToggleCodeLens = 'gitlens.toggleCodeLens',\n\tToggleFileBlame = 'gitlens.toggleFileBlame',\n\tToggleFileHeatmap = 'gitlens.toggleFileHeatmap',\n\tToggleFileRecentChanges = 'gitlens.toggleFileRecentChanges',\n\tToggleLineBlame = 'gitlens.toggleLineBlame',\n\tToggleReviewMode = 'gitlens.toggleReviewMode',\n\tToggleZenMode = 'gitlens.toggleZenMode',\n\tViewsOpenDirectoryDiff = 'gitlens.views.openDirectoryDiff',\n\tViewsOpenDirectoryDiffWithWorking = 'gitlens.views.openDirectoryDiffWithWorking'\n}\n\ninterface CommandConstructor {\n\tnew (): Command;\n}\n\nconst registrableCommands: CommandConstructor[] = [];\n\nexport function command(): ClassDecorator {\n\treturn (target: any) => {\n\t\tregistrableCommands.push(target);\n\t};\n}\n\nexport function registerCommands(context: ExtensionContext): void {\n\tfor (const c of registrableCommands) {\n\t\tcontext.subscriptions.push(new c());\n\t}\n}\n\nexport function getCommandUri(uri?: Uri, editor?: TextEditor): Uri | undefined {\n\tif (uri instanceof Uri) return uri;\n\tif (editor == null) return undefined;\n\n\tconst document = editor.document;\n\tif (document == null) return undefined;\n\n\treturn document.uri;\n}\n\nexport async function getRepoPathOrActiveOrPrompt(\n\turi: Uri | undefined,\n\teditor: TextEditor | undefined,\n\tplaceholder: string,\n\tgoBackCommand?: CommandQuickPickItem\n) {\n\tlet repoPath = await Container.git.getRepoPathOrActive(uri, editor);\n\tif (!repoPath) {\n\t\tconst pick = await RepositoriesQuickPick.show(placeholder, goBackCommand);\n\t\tif (pick instanceof CommandQuickPickItem) {\n\t\t\tawait pick.execute();\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (pick === undefined) {\n\t\t\tif (goBackCommand !== undefined) {\n\t\t\t\tawait goBackCommand.execute();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\trepoPath = pick.repoPath;\n\t}\n\treturn repoPath;\n}\n\nexport async function getRepoPathOrPrompt(placeholder: string, goBackCommand?: CommandQuickPickItem, uri?: Uri) {\n\tlet repoPath = await Container.git.getRepoPath(uri);\n\tif (!repoPath) {\n\t\tconst pick = await RepositoriesQuickPick.show(placeholder, goBackCommand);\n\t\tif (pick instanceof CommandQuickPickItem) {\n\t\t\tawait pick.execute();\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (pick === undefined) {\n\t\t\tif (goBackCommand !== undefined) {\n\t\t\t\tawait goBackCommand.execute();\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\trepoPath = pick.repoPath;\n\t}\n\treturn repoPath;\n}\n\nexport interface CommandContextParsingOptions {\n\teditor: boolean;\n\turi: boolean;\n}\n\nexport interface CommandBaseContext {\n\tcommand: string;\n\teditor?: TextEditor;\n\turi?: Uri;\n}\n\nexport interface CommandScmGroupsContext extends CommandBaseContext {\n\ttype: 'scm-groups';\n\tscmResourceGroups: SourceControlResourceGroup[];\n}\n\nexport interface CommandScmStatesContext extends CommandBaseContext {\n\ttype: 'scm-states';\n\tscmResourceStates: SourceControlResourceState[];\n}\n\nexport interface CommandUnknownContext extends CommandBaseContext {\n\ttype: 'unknown';\n}\n\nexport interface CommandUriContext extends CommandBaseContext {\n\ttype: 'uri';\n}\n\nexport interface CommandUrisContext extends CommandBaseContext {\n\ttype: 'uris';\n\turis: Uri[];\n}\n\n// export interface CommandViewContext extends CommandBaseContext {\n//     type: 'view';\n// }\n\nexport interface CommandViewItemContext extends CommandBaseContext {\n\ttype: 'viewItem';\n\tnode: ViewNode;\n}\n\nexport function isCommandViewContextWithBranch(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { branch: GitBranch } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitBranch.is((context.node as ViewNode & { branch: GitBranch }).branch);\n}\n\nexport function isCommandViewContextWithCommit<T extends GitCommit>(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { commit: T } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitCommit.is((context.node as ViewNode & { commit: GitCommit }).commit);\n}\n\nexport function isCommandViewContextWithContributor(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { contributor: GitContributor } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitContributor.is((context.node as ViewNode & { contributor: GitContributor }).contributor);\n}\n\nexport function isCommandViewContextWithFile(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { file: GitFile; repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { file: GitFile; repoPath: string };\n\treturn node.file !== undefined && (node.file.repoPath !== undefined || node.repoPath !== undefined);\n}\n\nexport function isCommandViewContextWithFileCommit(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { commit: GitCommit; file: GitFile; repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { commit: GitCommit; file: GitFile; repoPath: string };\n\treturn (\n\t\tnode.file !== undefined &&\n\t\tGitCommit.is(node.commit) &&\n\t\t(node.file.repoPath !== undefined || node.repoPath !== undefined)\n\t);\n}\n\nexport function isCommandViewContextWithFileRefs(\n\tcontext: CommandContext\n): context is CommandViewItemContext & {\n\tnode: ViewNode & { file: GitFile; ref1: string; ref2: string; repoPath: string };\n} {\n\tif (context.type !== 'viewItem') return false;\n\n\tconst node = context.node as ViewNode & { file: GitFile; ref1: string; ref2: string; repoPath: string };\n\treturn (\n\t\tnode.file !== undefined &&\n\t\tnode.ref1 !== undefined &&\n\t\tnode.ref2 !== undefined &&\n\t\t(node.file.repoPath !== undefined || node.repoPath !== undefined)\n\t);\n}\n\nexport function isCommandViewContextWithRef(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { ref: string } } {\n\treturn context.type === 'viewItem' && context.node instanceof ViewRefNode;\n}\n\nexport function isCommandViewContextWithRemote(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { remote: GitRemote } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn GitRemote.is((context.node as ViewNode & { remote: GitRemote }).remote);\n}\n\nexport function isCommandViewContextWithRepo(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { repo: Repository } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn (context.node as ViewNode & { repo?: Repository }).repo instanceof Repository;\n}\n\nexport function isCommandViewContextWithRepoPath(\n\tcontext: CommandContext\n): context is CommandViewItemContext & { node: ViewNode & { repoPath: string } } {\n\tif (context.type !== 'viewItem') return false;\n\n\treturn typeof (context.node as ViewNode & { repoPath?: string }).repoPath === 'string';\n}\n\nexport type CommandContext =\n\t| CommandScmGroupsContext\n\t| CommandScmStatesContext\n\t| CommandUnknownContext\n\t| CommandUriContext\n\t| CommandUrisContext\n\t// | CommandViewContext\n\t| CommandViewItemContext;\n\nfunction isScmResourceGroup(group: any): group is SourceControlResourceGroup {\n\tif (group == null) return false;\n\n\treturn (\n\t\t(group as SourceControlResourceGroup).id !== undefined &&\n\t\t(group.handle !== undefined ||\n\t\t\t(group as SourceControlResourceGroup).label !== undefined ||\n\t\t\t(group as SourceControlResourceGroup).resourceStates !== undefined)\n\t);\n}\n\nfunction isScmResourceState(state: any): state is SourceControlResourceState {\n\tif (state == null) return false;\n\n\treturn (state as SourceControlResourceState).resourceUri != null;\n}\n\nfunction isTextEditor(editor: any | undefined): editor is TextEditor {\n\tif (editor == null) return false;\n\n\treturn (\n\t\teditor.id !== undefined &&\n\t\t((editor as TextEditor).edit !== undefined || (editor as TextEditor).document !== undefined)\n\t);\n}\n\nexport abstract class Command implements Disposable {\n\tstatic getMarkdownCommandArgsCore<T>(command: Commands, args: T): string {\n\t\treturn `command:${command}?${encodeURIComponent(JSON.stringify(args))}`;\n\t}\n\n\tprotected readonly contextParsingOptions: CommandContextParsingOptions = { editor: false, uri: false };\n\n\tprivate _disposable: Disposable;\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tif (typeof command === 'string') {\n\t\t\tthis._disposable = commands.registerCommand(\n\t\t\t\tcommand,\n\t\t\t\t(...args: any[]) => this._execute(command, ...args),\n\t\t\t\tthis\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst subscriptions = command.map(cmd =>\n\t\t\tcommands.registerCommand(cmd, (...args: any[]) => this._execute(cmd, ...args), this)\n\t\t);\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprotected preExecute(context: CommandContext, ...args: any[]): Promise<any> {\n\t\treturn this.execute(...args);\n\t}\n\n\tabstract execute(...args: any[]): any;\n\n\tprotected _execute(command: string, ...args: any[]): any {\n\t\t// Telemetry.trackEvent(command);\n\n\t\tconst [context, rest] = Command.parseContext(command, { ...this.contextParsingOptions }, ...args);\n\t\treturn this.preExecute(context, ...rest);\n\t}\n\n\tprivate static parseContext(\n\t\tcommand: string,\n\t\toptions: CommandContextParsingOptions,\n\t\t...args: any[]\n\t): [CommandContext, any[]] {\n\t\tlet editor: TextEditor | undefined = undefined;\n\n\t\tlet firstArg = args[0];\n\t\tif (options.editor && (firstArg == null || isTextEditor(firstArg))) {\n\t\t\teditor = firstArg;\n\t\t\targs = args.slice(1);\n\t\t\tfirstArg = args[0];\n\t\t}\n\n\t\tif (options.uri && (firstArg == null || firstArg instanceof Uri)) {\n\t\t\tconst [uri, ...rest] = args as [Uri, any];\n\t\t\tif (uri !== undefined) {\n\t\t\t\tconst uris = rest[0];\n\t\t\t\tif (uris != null && Array.isArray(uris) && uris.length !== 0 && uris[0] instanceof Uri) {\n\t\t\t\t\treturn [{ command: command, type: 'uris', editor: editor, uri: uri, uris: uris }, rest.slice(1)];\n\t\t\t\t}\n\t\t\t\treturn [{ command: command, type: 'uri', editor: editor, uri: uri }, rest];\n\t\t\t}\n\n\t\t\targs = args.slice(1);\n\t\t}\n\n\t\tif (firstArg instanceof ViewNode) {\n\t\t\tconst [node, ...rest] = args as [ViewNode, any];\n\t\t\treturn [{ command: command, type: 'viewItem', node: node, uri: node.uri }, rest];\n\t\t}\n\n\t\tif (isScmResourceState(firstArg)) {\n\t\t\tconst states = [];\n\t\t\tlet count = 0;\n\t\t\tfor (const arg of args) {\n\t\t\t\tif (!isScmResourceState(arg)) break;\n\n\t\t\t\tcount++;\n\t\t\t\tstates.push(arg);\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t{ command: command, type: 'scm-states', scmResourceStates: states, uri: states[0].resourceUri },\n\t\t\t\targs.slice(count)\n\t\t\t];\n\t\t}\n\n\t\tif (isScmResourceGroup(firstArg)) {\n\t\t\tconst groups = [];\n\t\t\tlet count = 0;\n\t\t\tfor (const arg of args) {\n\t\t\t\tif (!isScmResourceGroup(arg)) break;\n\n\t\t\t\tcount++;\n\t\t\t\tgroups.push(arg);\n\t\t\t}\n\n\t\t\treturn [{ command: command, type: 'scm-groups', scmResourceGroups: groups }, args.slice(count)];\n\t\t}\n\n\t\treturn [{ command: command, type: 'unknown', editor: editor }, args];\n\t}\n}\n\nexport abstract class ActiveEditorCommand extends Command {\n\tprotected readonly contextParsingOptions: CommandContextParsingOptions = { editor: true, uri: true };\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tsuper(command);\n\t}\n\n\tprotected preExecute(context: CommandContext, ...args: any[]): Promise<any> {\n\t\treturn this.execute(context.editor, context.uri, ...args);\n\t}\n\n\tprotected _execute(command: string, ...args: any[]): any {\n\t\treturn super._execute(command, window.activeTextEditor, ...args);\n\t}\n\n\tabstract execute(editor?: TextEditor, ...args: any[]): any;\n}\n\nlet lastCommand: { command: string; args: any[] } | undefined = undefined;\nexport function getLastCommand() {\n\treturn lastCommand;\n}\n\nexport abstract class ActiveEditorCachedCommand extends ActiveEditorCommand {\n\tconstructor(command: Commands | Commands[]) {\n\t\tsuper(command);\n\t}\n\n\tprotected _execute(command: string, ...args: any[]): any {\n\t\tlastCommand = {\n\t\t\tcommand: command,\n\t\t\targs: args\n\t\t};\n\t\treturn super._execute(command, ...args);\n\t}\n\n\tabstract execute(editor: TextEditor, ...args: any[]): any;\n}\n\nexport abstract class EditorCommand implements Disposable {\n\tprivate _disposable: Disposable;\n\n\tconstructor(command: Commands | Commands[]) {\n\t\tif (!Array.isArray(command)) {\n\t\t\tcommand = [command];\n\t\t}\n\n\t\tconst subscriptions = [];\n\t\tfor (const cmd of command) {\n\t\t\tsubscriptions.push(\n\t\t\t\tcommands.registerTextEditorCommand(\n\t\t\t\t\tcmd,\n\t\t\t\t\t(editor: TextEditor, edit: TextEditorEdit, ...args: any[]) =>\n\t\t\t\t\t\tthis.executeCore(cmd, editor, edit, ...args),\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate executeCore(command: string, editor: TextEditor, edit: TextEditorEdit, ...args: any[]): any {\n\t\t// Telemetry.trackEvent(command);\n\t\treturn this.execute(editor, edit, ...args);\n\t}\n\n\tabstract execute(editor: TextEditor, edit: TextEditorEdit, ...args: any[]): any;\n}\n\nexport async function openEditor(\n\turi: Uri,\n\toptions: TextDocumentShowOptions & { rethrow?: boolean } = {}\n): Promise<TextEditor | undefined> {\n\tconst { rethrow, ...opts } = options;\n\ttry {\n\t\tif (GitUri.is(uri)) {\n\t\t\turi = uri.documentUri();\n\t\t}\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens && ImageMimetypes[paths.extname(uri.fsPath)]) {\n\t\t\tawait commands.executeCommand(BuiltInCommands.Open, uri);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst document = await workspace.openTextDocument(uri);\n\t\treturn window.showTextDocument(document, {\n\t\t\tpreserveFocus: false,\n\t\t\tpreview: true,\n\t\t\tviewColumn: ViewColumn.Active,\n\t\t\t...opts\n\t\t});\n\t} catch (ex) {\n\t\tconst msg = ex.toString();\n\t\tif (msg.includes('File seems to be binary and cannot be opened as text')) {\n\t\t\tawait commands.executeCommand(BuiltInCommands.Open, uri);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (rethrow) throw ex;\n\n\t\tLogger.error(ex, 'openEditor');\n\t\treturn undefined;\n\t}\n}\n\nexport function openWorkspace(uri: Uri, name: string, options: { openInNewWindow?: boolean } = {}) {\n\tif (options.openInNewWindow) {\n\t\tcommands.executeCommand(BuiltInCommands.OpenFolder, uri, true);\n\n\t\treturn true;\n\t}\n\n\treturn workspace.updateWorkspaceFolders(\n\t\tworkspace.workspaceFolders !== undefined ? workspace.workspaceFolders.length : 0,\n\t\tnull,\n\t\t{ uri: uri, name: name }\n\t);\n}\n","'use strict';\nexport * from './config';\n\nimport {\n\tConfigurationChangeEvent,\n\tConfigurationTarget,\n\tEvent,\n\tEventEmitter,\n\tExtensionContext,\n\tUri,\n\tworkspace\n} from 'vscode';\nimport { Config } from './config';\nimport { extensionId } from './constants';\nimport { Objects } from './system';\n\nconst emptyConfig: Config = new Proxy<Config>({} as Config, {\n\tget: function() {\n\t\treturn emptyConfig;\n\t}\n});\n\ntype ConfigInspection<T> = {\n\tkey: string;\n\tdefaultValue?: T;\n\tglobalValue?: T;\n\tworkspaceValue?: T;\n\tworkspaceFolderValue?: T;\n};\n\nexport interface ConfigurationWillChangeEvent {\n\tchange: ConfigurationChangeEvent;\n\ttransform?(e: ConfigurationChangeEvent): ConfigurationChangeEvent;\n}\n\nexport class Configuration {\n\tstatic configure(context: ExtensionContext) {\n\t\tcontext.subscriptions.push(\n\t\t\tworkspace.onDidChangeConfiguration(configuration.onConfigurationChanged, configuration)\n\t\t);\n\t}\n\n\tprivate _onDidChange = new EventEmitter<ConfigurationChangeEvent>();\n\tget onDidChange(): Event<ConfigurationChangeEvent> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _onDidChangeAny = new EventEmitter<ConfigurationChangeEvent>();\n\tget onDidChangeAny(): Event<ConfigurationChangeEvent> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _onWillChange = new EventEmitter<ConfigurationWillChangeEvent>();\n\tget onWillChange(): Event<ConfigurationWillChangeEvent> {\n\t\treturn this._onWillChange.event;\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (!e.affectsConfiguration(extensionId, null!)) {\n\t\t\tthis._onDidChangeAny.fire(e);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst evt: ConfigurationWillChangeEvent = {\n\t\t\tchange: e\n\t\t};\n\t\tthis._onWillChange.fire(evt);\n\n\t\tif (evt.transform !== undefined) {\n\t\t\te = evt.transform(e);\n\t\t}\n\n\t\tthis._onDidChange.fire(e);\n\t}\n\n\treadonly initializingChangeEvent: ConfigurationChangeEvent = {\n\t\taffectsConfiguration: (section: string, resource?: Uri) => true\n\t};\n\n\tget(): Config;\n\tget<S1 extends keyof Config>(s1: S1, resource?: Uri | null, defaultValue?: Config[S1]): Config[S1];\n\tget<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\tresource?: Uri | null,\n\t\tdefaultValue?: Config[S1][S2]\n\t): Config[S1][S2];\n\tget<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\tresource?: Uri | null,\n\t\tdefaultValue?: Config[S1][S2][S3]\n\t): Config[S1][S2][S3];\n\tget<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\ts4: S4,\n\t\tresource?: Uri | null,\n\t\tdefaultValue?: Config[S1][S2][S3][S4]\n\t): Config[S1][S2][S3][S4];\n\tget<T>(...args: any[]): T {\n\t\tlet section: string | undefined;\n\t\tlet resource: Uri | null | undefined;\n\t\tlet defaultValue: T | undefined;\n\t\tif (args.length > 0) {\n\t\t\tsection = args[0];\n\t\t\tif (typeof args[1] === 'string') {\n\t\t\t\tsection += `.${args[1]}`;\n\t\t\t\tif (typeof args[2] === 'string') {\n\t\t\t\t\tsection += `.${args[2]}`;\n\t\t\t\t\tif (typeof args[2] === 'string') {\n\t\t\t\t\t\tsection += `.${args[3]}`;\n\t\t\t\t\t\tresource = args[4];\n\t\t\t\t\t\tdefaultValue = args[5];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresource = args[3];\n\t\t\t\t\t\tdefaultValue = args[4];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresource = args[2];\n\t\t\t\t\tdefaultValue = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresource = args[1];\n\t\t\t\tdefaultValue = args[2];\n\t\t\t}\n\t\t}\n\n\t\treturn defaultValue === undefined\n\t\t\t? workspace\n\t\t\t\t\t.getConfiguration(section === undefined ? undefined : extensionId, resource)\n\t\t\t\t\t.get<T>(section === undefined ? extensionId : section)!\n\t\t\t: workspace\n\t\t\t\t\t.getConfiguration(section === undefined ? undefined : extensionId, resource)\n\t\t\t\t\t.get<T>(section === undefined ? extensionId : section, defaultValue)!;\n\t}\n\n\tgetAny<T>(section: string, resource?: Uri | null, defaultValue?: T) {\n\t\treturn defaultValue === undefined\n\t\t\t? workspace.getConfiguration(undefined, resource).get<T>(section)!\n\t\t\t: workspace.getConfiguration(undefined, resource).get<T>(section, defaultValue)!;\n\t}\n\n\tchanged<S1 extends keyof Config>(e: ConfigurationChangeEvent, s1: S1, resource?: Uri | null): boolean;\n\tchanged<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\te: ConfigurationChangeEvent,\n\t\ts1: S1,\n\t\ts2: S2,\n\t\tresource?: Uri | null\n\t): boolean;\n\tchanged<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\te: ConfigurationChangeEvent,\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\tresource?: Uri | null\n\t): boolean;\n\tchanged<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(e: ConfigurationChangeEvent, s1: S1, s2: S2, s3: S3, s4: S4, resource?: Uri | null): boolean;\n\tchanged(e: ConfigurationChangeEvent, ...args: any[]) {\n\t\tlet section: string = args[0];\n\t\tlet resource: Uri | null | undefined;\n\t\tif (typeof args[1] === 'string') {\n\t\t\tsection += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string') {\n\t\t\t\tsection += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string') {\n\t\t\t\t\tsection += args[3];\n\t\t\t\t\tresource = args[4];\n\t\t\t\t} else {\n\t\t\t\t\tresource = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresource = args[2];\n\t\t\t}\n\t\t} else {\n\t\t\tresource = args[1];\n\t\t}\n\n\t\t// eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n\t\treturn e.affectsConfiguration(`${extensionId}.${section}`, resource!);\n\t}\n\n\tinitializing(e: ConfigurationChangeEvent) {\n\t\treturn e === this.initializingChangeEvent;\n\t}\n\n\tinspect<S1 extends keyof Config>(s1: S1, resource?: Uri | null): ConfigInspection<Config[S1]> | undefined;\n\tinspect<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\tresource?: Uri | null\n\t): ConfigInspection<Config[S1][S2]> | undefined;\n\tinspect<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\tresource?: Uri | null\n\t): ConfigInspection<Config[S1][S2][S3]> | undefined;\n\tinspect<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(s1: S1, s2: S2, s3: S3, s4: S4, resource?: Uri | null): ConfigInspection<Config[S1][S2][S3][S4]> | undefined;\n\tinspect(...args: any[]) {\n\t\tlet section: string = args[0];\n\t\tlet resource: Uri | null | undefined;\n\t\tif (typeof args[1] === 'string') {\n\t\t\tsection += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string') {\n\t\t\t\tsection += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string') {\n\t\t\t\t\tsection += args[3];\n\t\t\t\t\tresource = args[4];\n\t\t\t\t} else {\n\t\t\t\t\tresource = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresource = args[2];\n\t\t\t}\n\t\t} else {\n\t\t\tresource = args[1];\n\t\t}\n\n\t\treturn workspace\n\t\t\t.getConfiguration(section === undefined ? undefined : extensionId, resource)\n\t\t\t.inspect(section === undefined ? extensionId : section);\n\t}\n\n\tinspectAny(section: string, resource?: Uri | null) {\n\t\treturn workspace.getConfiguration(undefined, resource).inspect(section);\n\t}\n\n\tmigrate<S1 extends keyof Config>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\toptions: { fallbackValue?: Config[S1]; migrationFn?(value: any): Config[S1] }\n\t): Promise<boolean>;\n\tmigrate<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\toptions: { fallbackValue?: Config[S1][S2]; migrationFn?(value: any): Config[S1][S2] }\n\t): Promise<boolean>;\n\tmigrate<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\tto3: S3,\n\t\toptions: { fallbackValue?: Config[S1][S2][S3]; migrationFn?(value: any): Config[S1][S2][S3] }\n\t): Promise<boolean>;\n\tmigrate<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\tto3: S3,\n\t\tto4: S4,\n\t\toptions: { fallbackValue?: Config[S1][S2][S3][S4]; migrationFn?(value: any): Config[S1][S2][S3][S4] }\n\t): Promise<boolean>;\n\tasync migrate(from: string, ...args: any[]): Promise<boolean> {\n\t\tlet to: string = args[0];\n\t\tlet options: { fallbackValue?: any; migrationFn?(value: any): any } | undefined;\n\t\tif (typeof args[1] === 'string' && args.length > 3) {\n\t\t\tto += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string' && args.length > 4) {\n\t\t\t\tto += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string' && args.length > 5) {\n\t\t\t\t\tto += `.${args[3]}`;\n\t\t\t\t\toptions = args[4];\n\t\t\t\t} else {\n\t\t\t\t\toptions = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toptions = args[2];\n\t\t\t}\n\t\t} else {\n\t\t\toptions = args[1];\n\t\t}\n\n\t\tif (options === undefined) {\n\t\t\toptions = {};\n\t\t}\n\n\t\tconst inspection = configuration.inspect(from as any);\n\t\tif (inspection === undefined) return false;\n\n\t\tlet migrated = false;\n\t\tif (inspection.globalValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto as any,\n\t\t\t\toptions.migrationFn ? options.migrationFn(inspection.globalValue) : inspection.globalValue,\n\t\t\t\tConfigurationTarget.Global\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Global);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (inspection.workspaceValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto as any,\n\t\t\t\toptions.migrationFn ? options.migrationFn(inspection.workspaceValue) : inspection.workspaceValue,\n\t\t\t\tConfigurationTarget.Workspace\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Workspace);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (inspection.workspaceFolderValue !== undefined) {\n\t\t\tawait this.update(\n\t\t\t\tto as any,\n\t\t\t\toptions.migrationFn\n\t\t\t\t\t? options.migrationFn(inspection.workspaceFolderValue)\n\t\t\t\t\t: inspection.workspaceFolderValue,\n\t\t\t\tConfigurationTarget.WorkspaceFolder\n\t\t\t);\n\t\t\tmigrated = true;\n\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t// if (from !== to) {\n\t\t\t//     try {\n\t\t\t//         await this.update(from, undefined, ConfigurationTarget.WorkspaceFolder);\n\t\t\t//     }\n\t\t\t//     catch { }\n\t\t\t// }\n\t\t}\n\n\t\tif (!migrated && options.fallbackValue !== undefined) {\n\t\t\tawait this.update(to as any, options.fallbackValue, ConfigurationTarget.Global);\n\t\t\tmigrated = true;\n\t\t}\n\n\t\treturn migrated;\n\t}\n\n\tmigrateIfMissing<S1 extends keyof Config>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\toptions: { migrationFn?(value: any): Config[S1] }\n\t): Promise<void>;\n\tmigrateIfMissing<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\toptions: { migrationFn?(value: any): Config[S1][S2] }\n\t): Promise<void>;\n\tmigrateIfMissing<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\tto3: S3,\n\t\toptions: { migrationFn?(value: any): Config[S1][S2][S3] }\n\t): Promise<void>;\n\tmigrateIfMissing<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(\n\t\tfrom: string,\n\t\tto1: S1,\n\t\tto2: S2,\n\t\tto3: S3,\n\t\tto4: S4,\n\t\toptions: { migrationFn?(value: any): Config[S1][S2][S3][S4] }\n\t): Promise<void>;\n\tasync migrateIfMissing(from: string, ...args: any[]): Promise<void> {\n\t\tlet to: string = args[0];\n\t\tlet options: { migrationFn?(value: any): any } | undefined;\n\t\tif (typeof args[1] === 'string' && args.length > 3) {\n\t\t\tto += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string' && args.length > 4) {\n\t\t\t\tto += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string' && args.length > 5) {\n\t\t\t\t\tto += `.${args[3]}`;\n\t\t\t\t\toptions = args[4];\n\t\t\t\t} else {\n\t\t\t\t\toptions = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toptions = args[2];\n\t\t\t}\n\t\t} else {\n\t\t\toptions = args[1];\n\t\t}\n\n\t\tif (options === undefined) {\n\t\t\toptions = {};\n\t\t}\n\n\t\t// async migrateIfMissing<TFrom, TTo>(from: string, to: string, options: { migrationFn?(value: TFrom): TTo } = {}) {\n\t\tconst fromInspection = configuration.inspect(from as any);\n\t\tif (fromInspection === undefined) return;\n\n\t\tconst toInspection = configuration.inspect(to as any);\n\t\tif (fromInspection.globalValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.globalValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto as any,\n\t\t\t\t\toptions.migrationFn ? options.migrationFn(fromInspection.globalValue) : fromInspection.globalValue,\n\t\t\t\t\tConfigurationTarget.Global\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Global);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\tif (fromInspection.workspaceValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.workspaceValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto as any,\n\t\t\t\t\toptions.migrationFn\n\t\t\t\t\t\t? options.migrationFn(fromInspection.workspaceValue)\n\t\t\t\t\t\t: fromInspection.workspaceValue,\n\t\t\t\t\tConfigurationTarget.Workspace\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.Workspace);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\n\t\tif (fromInspection.workspaceFolderValue !== undefined) {\n\t\t\tif (toInspection === undefined || toInspection.workspaceFolderValue === undefined) {\n\t\t\t\tawait this.update(\n\t\t\t\t\tto as any,\n\t\t\t\t\toptions.migrationFn\n\t\t\t\t\t\t? options.migrationFn(fromInspection.workspaceFolderValue)\n\t\t\t\t\t\t: fromInspection.workspaceFolderValue,\n\t\t\t\t\tConfigurationTarget.WorkspaceFolder\n\t\t\t\t);\n\t\t\t\t// Can't delete the old setting currently because it errors with `Unable to write to User Settings because <setting name> is not a registered configuration`\n\t\t\t\t// if (from !== to) {\n\t\t\t\t//     try {\n\t\t\t\t//         await this.update(from, undefined, ConfigurationTarget.WorkspaceFolder);\n\t\t\t\t//     }\n\t\t\t\t//     catch { }\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t}\n\n\tname<S1 extends keyof Config>(s1: S1): string;\n\tname<S1 extends keyof Config, S2 extends keyof Config[S1]>(s1: S1, s2: S2): string;\n\tname<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3\n\t): string;\n\tname<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(s1: S1, s2: S2, s3: S3, s4: S4): string;\n\tname(...args: string[]) {\n\t\treturn args.join('.');\n\t}\n\n\tupdate<S1 extends keyof Config>(s1: S1, value: Config[S1] | undefined, target: ConfigurationTarget): Thenable<void>;\n\tupdate<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\tvalue: Config[S1][S2] | undefined,\n\t\ttarget: ConfigurationTarget\n\t): Thenable<void>;\n\n\tupdate<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\tvalue: Config[S1][S2][S3] | undefined,\n\t\ttarget: ConfigurationTarget\n\t): Thenable<void>;\n\tupdate<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\ts4: S4,\n\t\tvalue: Config[S1][S2][S3][S4] | undefined,\n\t\ttarget: ConfigurationTarget\n\t): Thenable<void>;\n\tupdate(...args: any[]) {\n\t\tlet section: string = args[0];\n\t\tlet value;\n\t\tlet target: ConfigurationTarget;\n\t\tif (typeof args[1] === 'string' && args.length > 3) {\n\t\t\tsection += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string' && args.length > 4) {\n\t\t\t\tsection += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string' && args.length > 5) {\n\t\t\t\t\tsection += `.${args[3]}`;\n\t\t\t\t\tvalue = args[4];\n\t\t\t\t\ttarget = args[5];\n\t\t\t\t} else {\n\t\t\t\t\tvalue = args[3];\n\t\t\t\t\ttarget = args[4];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvalue = args[2];\n\t\t\t\ttarget = args[3];\n\t\t\t}\n\t\t} else {\n\t\t\tvalue = args[1];\n\t\t\ttarget = args[2];\n\t\t}\n\n\t\treturn workspace.getConfiguration(extensionId).update(section, value, target);\n\t}\n\n\tupdateAny(section: string, value: any, target: ConfigurationTarget, resource?: Uri | null) {\n\t\treturn workspace\n\t\t\t.getConfiguration(undefined, target === ConfigurationTarget.Global ? undefined : resource!)\n\t\t\t.update(section, value, target);\n\t}\n\n\tupdateEffective<S1 extends keyof Config>(s1: S1, value: Config[S1]): Thenable<void>;\n\tupdateEffective<S1 extends keyof Config, S2 extends keyof Config[S1]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\tvalue: Config[S1][S2]\n\t): Thenable<void>;\n\tupdateEffective<S1 extends keyof Config, S2 extends keyof Config[S1], S3 extends keyof Config[S1][S2]>(\n\t\ts1: S1,\n\t\ts2: S2,\n\t\ts3: S3,\n\t\tvalue: Config[S1][S2][S3]\n\t): Thenable<void>;\n\tupdateEffective<\n\t\tS1 extends keyof Config,\n\t\tS2 extends keyof Config[S1],\n\t\tS3 extends keyof Config[S1][S2],\n\t\tS4 extends keyof Config[S1][S2][S3]\n\t>(s1: S1, s2: S2, s3: S3, s4: S4, value: Config[S1][S2][S3][S4]): Thenable<void>;\n\tupdateEffective(...args: any[]) {\n\t\tlet section: string = args[0];\n\t\tlet value;\n\t\tif (typeof args[1] === 'string' && args.length > 2) {\n\t\t\tsection += `.${args[1]}`;\n\t\t\tif (typeof args[2] === 'string' && args.length > 3) {\n\t\t\t\tsection += `.${args[2]}`;\n\t\t\t\tif (typeof args[3] === 'string' && args.length > 4) {\n\t\t\t\t\tsection += `.${args[3]}`;\n\t\t\t\t\tvalue = args[4];\n\t\t\t\t} else {\n\t\t\t\t\tvalue = args[3];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvalue = args[2];\n\t\t\t}\n\t\t} else {\n\t\t\tvalue = args[1];\n\t\t}\n\n\t\tconst inspect = configuration.inspect(section as any)!;\n\t\tif (inspect.workspaceFolderValue !== undefined) {\n\t\t\tif (value === inspect.workspaceFolderValue) return Promise.resolve(undefined);\n\n\t\t\treturn configuration.update(section as any, value, ConfigurationTarget.WorkspaceFolder);\n\t\t}\n\n\t\tif (inspect.workspaceValue !== undefined) {\n\t\t\tif (value === inspect.workspaceValue) return Promise.resolve(undefined);\n\n\t\t\treturn configuration.update(section as any, value, ConfigurationTarget.Workspace);\n\t\t}\n\n\t\tif (inspect.globalValue === value || (inspect.globalValue === undefined && value === inspect.defaultValue)) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn configuration.update(\n\t\t\tsection as any,\n\t\t\tObjects.areEquivalent(value, inspect.defaultValue) ? undefined : value,\n\t\t\tConfigurationTarget.Global\n\t\t);\n\t}\n}\n\nexport const configuration = new Configuration();\n","'use strict';\nimport { ExtensionContext, OutputChannel, Uri, window } from 'vscode';\nimport { extensionOutputChannelName } from './constants';\nimport { getCorrelationContext } from './system';\n// import { Telemetry } from './telemetry';\n\nconst emptyStr = '';\n\nexport enum TraceLevel {\n\tSilent = 'silent',\n\tErrors = 'errors',\n\tVerbose = 'verbose',\n\tDebug = 'debug'\n}\n\nconst ConsolePrefix = `[${extensionOutputChannelName}]`;\n\nconst isDebuggingRegex = /\\bgitlens\\b/i;\n\nexport interface LogCorrelationContext {\n\treadonly correlationId?: number;\n\treadonly prefix: string;\n\texitDetails?: string;\n}\n\nexport class Logger {\n\tstatic output: OutputChannel | undefined;\n\tstatic customLoggableFn: ((o: object) => string | undefined) | undefined;\n\n\tstatic configure(context: ExtensionContext, level: TraceLevel, loggableFn?: (o: any) => string | undefined) {\n\t\tthis.customLoggableFn = loggableFn;\n\n\t\tthis.level = level;\n\t}\n\n\tprivate static _level: TraceLevel = TraceLevel.Silent;\n\tstatic get level() {\n\t\treturn this._level;\n\t}\n\tstatic set level(value: TraceLevel) {\n\t\tthis._level = value;\n\t\tif (value === TraceLevel.Silent) {\n\t\t\tif (this.output !== undefined) {\n\t\t\t\tthis.output.dispose();\n\t\t\t\tthis.output = undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.output = this.output || window.createOutputChannel(extensionOutputChannelName);\n\t\t}\n\t}\n\n\tstatic debug(message: string, ...params: any[]): void;\n\tstatic debug(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic debug(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Debug && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage !== undefined) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message || emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message || emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output !== undefined && this.level === TraceLevel.Debug) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message || emptyStr}${this.toLoggableParams(true, params)}`);\n\t\t}\n\t}\n\n\tstatic error(ex: Error, message?: string, ...params: any[]): void;\n\tstatic error(ex: Error, context?: LogCorrelationContext, message?: string, ...params: any[]): void;\n\tstatic error(ex: Error, contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level === TraceLevel.Silent && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (contextOrMessage === undefined || typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = `${contextOrMessage.prefix} ${params.shift() || emptyStr}`;\n\t\t}\n\n\t\tif (message === undefined) {\n\t\t\tconst stack = ex.stack;\n\t\t\tif (stack) {\n\t\t\t\tconst match = /.*\\s*?at\\s(.+?)\\s/.exec(stack);\n\t\t\t\tif (match != null) {\n\t\t\t\t\tmessage = match[1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.error(this.timestamp, ConsolePrefix, message || emptyStr, ...params, ex);\n\t\t}\n\n\t\tif (this.output !== undefined && this.level !== TraceLevel.Silent) {\n\t\t\tthis.output.appendLine(\n\t\t\t\t`${this.timestamp} ${message || emptyStr}${this.toLoggableParams(false, params)}\\n${ex}`\n\t\t\t);\n\t\t}\n\n\t\t// Telemetry.trackException(ex);\n\t}\n\n\tstatic getCorrelationContext() {\n\t\treturn getCorrelationContext();\n\t}\n\n\tstatic log(message: string, ...params: any[]): void;\n\tstatic log(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic log(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Verbose && this.level !== TraceLevel.Debug && !Logger.isDebugging) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage !== undefined) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message || emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message || emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output !== undefined && (this.level === TraceLevel.Verbose || this.level === TraceLevel.Debug)) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message || emptyStr}${this.toLoggableParams(false, params)}`);\n\t\t}\n\t}\n\n\tstatic logWithDebugParams(message: string, ...params: any[]): void;\n\tstatic logWithDebugParams(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic logWithDebugParams(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level !== TraceLevel.Verbose && this.level !== TraceLevel.Debug && !Logger.isDebugging) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage !== undefined) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message || emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.log(this.timestamp, ConsolePrefix, message || emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output !== undefined && (this.level === TraceLevel.Verbose || this.level === TraceLevel.Debug)) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message || emptyStr}${this.toLoggableParams(true, params)}`);\n\t\t}\n\t}\n\n\tstatic warn(message: string, ...params: any[]): void;\n\tstatic warn(context: LogCorrelationContext | undefined, message: string, ...params: any[]): void;\n\tstatic warn(contextOrMessage: LogCorrelationContext | string | undefined, ...params: any[]): void {\n\t\tif (this.level === TraceLevel.Silent && !Logger.isDebugging) return;\n\n\t\tlet message;\n\t\tif (typeof contextOrMessage === 'string') {\n\t\t\tmessage = contextOrMessage;\n\t\t} else {\n\t\t\tmessage = params.shift();\n\n\t\t\tif (contextOrMessage !== undefined) {\n\t\t\t\tmessage = `${contextOrMessage.prefix} ${message || emptyStr}`;\n\t\t\t}\n\t\t}\n\n\t\tif (Logger.isDebugging) {\n\t\t\tconsole.warn(this.timestamp, ConsolePrefix, message || emptyStr, ...params);\n\t\t}\n\n\t\tif (this.output !== undefined && this.level !== TraceLevel.Silent) {\n\t\t\tthis.output.appendLine(`${this.timestamp} ${message || emptyStr}${this.toLoggableParams(false, params)}`);\n\t\t}\n\t}\n\n\tstatic showOutputChannel() {\n\t\tif (this.output === undefined) return;\n\n\t\tthis.output.show();\n\t}\n\n\tstatic toLoggable(p: any, sanitize?: ((key: string, value: any) => any) | undefined) {\n\t\tif (typeof p !== 'object') return String(p);\n\t\tif (this.customLoggableFn !== undefined) {\n\t\t\tconst loggable = this.customLoggableFn(p);\n\t\t\tif (loggable != null) return loggable;\n\t\t}\n\t\tif (p instanceof Uri) return `Uri(${p.toString(true)})`;\n\n\t\ttry {\n\t\t\treturn JSON.stringify(p, sanitize);\n\t\t} catch {\n\t\t\treturn '<error>';\n\t\t}\n\t}\n\n\tstatic toLoggableName(instance: Function | object) {\n\t\tlet name;\n\t\tif (typeof instance === 'function') {\n\t\t\tif (instance.prototype == null || instance.prototype.constructor == null) {\n\t\t\t\treturn instance.name;\n\t\t\t}\n\n\t\t\tname = instance.prototype.constructor.name;\n\t\t} else {\n\t\t\tname = instance.constructor != null ? instance.constructor.name : emptyStr;\n\t\t}\n\n\t\t// Strip webpack module name (since I never name classes with an _)\n\t\tconst index = name.indexOf('_');\n\t\treturn index === -1 ? name : name.substr(index + 1);\n\t}\n\n\tprivate static get timestamp(): string {\n\t\tconst now = new Date();\n\t\treturn `[${now\n\t\t\t.toISOString()\n\t\t\t.replace(/T/, ' ')\n\t\t\t.replace(/\\..+/, emptyStr)}:${`00${now.getUTCMilliseconds()}`.slice(-3)}]`;\n\t}\n\n\tprivate static toLoggableParams(debugOnly: boolean, params: any[]) {\n\t\tif (params.length === 0 || (debugOnly && this.level !== TraceLevel.Debug && !Logger.isDebugging)) {\n\t\t\treturn emptyStr;\n\t\t}\n\n\t\tconst loggableParams = params.map(p => this.toLoggable(p)).join(', ');\n\t\treturn loggableParams.length !== 0 ? ` \\u2014 ${loggableParams}` : emptyStr;\n\t}\n\n\tprivate static _isDebugging: boolean | undefined;\n\tstatic get isDebugging() {\n\t\tif (this._isDebugging === undefined) {\n\t\t\tconst env = process.env;\n\t\t\tthis._isDebugging =\n\t\t\t\tenv && env.VSCODE_DEBUGGING_EXTENSION ? isDebuggingRegex.test(env.VSCODE_DEBUGGING_EXTENSION) : false;\n\t\t}\n\n\t\treturn this._isDebugging;\n\t}\n\n\tstatic gitOutput: OutputChannel | undefined;\n\n\tstatic logGitCommand(command: string, ex?: Error): void {\n\t\tif (this.level !== TraceLevel.Debug) return;\n\n\t\tif (this.gitOutput === undefined) {\n\t\t\tthis.gitOutput = window.createOutputChannel(`${extensionOutputChannelName} (Git)`);\n\t\t}\n\t\tthis.gitOutput.appendLine(`${this.timestamp} ${command}${ex != null ? `\\n\\n${ex.toString()}` : emptyStr}`);\n\t}\n}\n","'use strict';\nimport { CancellationToken, CancellationTokenSource, QuickPickItem, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitTag } from '../git/gitService';\nimport { Promises } from '../system';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut } from './commonQuickPicks';\nimport { BranchQuickPickItem, RefQuickPickItem, TagQuickPickItem } from './gitQuickPicks';\n\nexport type ReferencesQuickPickItem = BranchQuickPickItem | TagQuickPickItem | RefQuickPickItem;\n\nexport enum ReferencesQuickPickIncludes {\n\tBranches = 1,\n\tTags = 2,\n\tWorkingTree = 4,\n\n\tBranchesAndTags = 3\n}\n\nexport interface ReferencesQuickPickOptions {\n\tallowEnteringRefs?: boolean;\n\tautoPick?: boolean;\n\tchecked?: string;\n\tcheckmarks: boolean;\n\tfilterBranches?(branch: GitBranch): boolean;\n\tfilterTags?(tag: GitTag): boolean;\n\tgoBack?: CommandQuickPickItem;\n\tinclude?: ReferencesQuickPickIncludes;\n}\n\nexport class ReferencesQuickPick {\n\tconstructor(public readonly repoPath: string | undefined) {}\n\n\tasync show(\n\t\tplaceHolder: string,\n\t\toptions?: Exclude<ReferencesQuickPickOptions, CommandQuickPickItem> & {\n\t\t\tinclude: ReferencesQuickPickIncludes.Branches;\n\t\t}\n\t): Promise<BranchQuickPickItem | undefined>;\n\tasync show(\n\t\tplaceHolder: string,\n\t\toptions?: Exclude<ReferencesQuickPickOptions, CommandQuickPickItem> & {\n\t\t\tinclude: ReferencesQuickPickIncludes.Tags;\n\t\t}\n\t): Promise<TagQuickPickItem | undefined>;\n\tasync show(\n\t\tplaceHolder: string,\n\t\toptions?: Exclude<ReferencesQuickPickOptions, CommandQuickPickItem>\n\t): Promise<ReferencesQuickPickItem | undefined>;\n\tasync show(\n\t\tplaceHolder: string,\n\t\toptions: ReferencesQuickPickOptions = { checkmarks: true }\n\t): Promise<ReferencesQuickPickItem | CommandQuickPickItem | undefined> {\n\t\tconst cancellation = new CancellationTokenSource();\n\n\t\tlet scope;\n\t\tif (options.goBack) {\n\t\t\tscope = await Container.keyboard.beginScope({ 'alt+left': options.goBack });\n\t\t}\n\n\t\tlet autoPick;\n\t\ttry {\n\t\t\tlet items = this.getItems(options, cancellation.token);\n\t\t\tif (options.autoPick) {\n\t\t\t\titems = items.then(itms => {\n\t\t\t\t\tif (itms.length <= 1) {\n\t\t\t\t\t\tautoPick = itms[0];\n\t\t\t\t\t\tcancellation.cancel();\n\t\t\t\t\t}\n\t\t\t\t\treturn itms;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet pick;\n\t\t\tif (options.allowEnteringRefs) {\n\t\t\t\tplaceHolder += `${GlyphChars.Space.repeat(3)}(select or enter a reference)`;\n\n\t\t\t\tconst quickpick = window.createQuickPick<ReferencesQuickPickItem | CommandQuickPickItem>();\n\t\t\t\tquickpick.busy = true;\n\t\t\t\tquickpick.enabled = false;\n\t\t\t\tquickpick.placeholder = placeHolder;\n\t\t\t\tquickpick.ignoreFocusOut = getQuickPickIgnoreFocusOut();\n\t\t\t\tquickpick.show();\n\n\t\t\t\tquickpick.items = await items;\n\t\t\t\tquickpick.busy = false;\n\t\t\t\tquickpick.enabled = true;\n\n\t\t\t\tpick = await new Promise<ReferencesQuickPickItem | CommandQuickPickItem | undefined>(resolve => {\n\t\t\t\t\tcancellation.token.onCancellationRequested(() => quickpick.hide());\n\n\t\t\t\t\tquickpick.onDidHide(() => resolve(undefined));\n\t\t\t\t\tquickpick.onDidAccept(async () => {\n\t\t\t\t\t\tif (quickpick.selectedItems.length === 0) {\n\t\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\t\t\t\tconst ref = quickpick.value;\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.repoPath === undefined ||\n\t\t\t\t\t\t\t\t(await Container.git.validateReference(this.repoPath, ref))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tresolve(RefQuickPickItem.create(ref));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tquickpick.title = 'You must enter a valid reference';\n\t\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(quickpick.selectedItems[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tquickpick.hide();\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tquickpick.dispose();\n\t\t\t} else {\n\t\t\t\tpick = await window.showQuickPick(\n\t\t\t\t\titems,\n\t\t\t\t\t{\n\t\t\t\t\t\tplaceHolder: placeHolder,\n\t\t\t\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t\t\t\t},\n\t\t\t\t\tcancellation.token\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (pick === undefined && autoPick !== undefined) {\n\t\t\t\tpick = autoPick;\n\t\t\t}\n\n\t\t\tif (pick === undefined) {\n\t\t\t\tcancellation.cancel();\n\t\t\t}\n\n\t\t\treturn pick;\n\t\t} finally {\n\t\t\tif (scope !== undefined) {\n\t\t\t\tawait scope.dispose();\n\t\t\t}\n\n\t\t\tcancellation.dispose();\n\t\t}\n\t}\n\n\tprivate async getItems(\n\t\t{ checked, checkmarks, filterBranches, filterTags, goBack, include, ...options }: ReferencesQuickPickOptions,\n\t\ttoken: CancellationToken\n\t): Promise<(BranchQuickPickItem | TagQuickPickItem | CommandQuickPickItem)[]> {\n\t\tinclude = include || ReferencesQuickPickIncludes.BranchesAndTags;\n\n\t\tconst results = await Promises.cancellable(\n\t\t\tPromise.all<GitBranch[] | undefined, GitTag[] | undefined>([\n\t\t\t\tinclude & ReferencesQuickPickIncludes.Branches\n\t\t\t\t\t? Container.git.getBranches(this.repoPath, {\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\tfilter: filterBranches && filterBranches\n\t\t\t\t\t  })\n\t\t\t\t\t: undefined,\n\t\t\t\tinclude & ReferencesQuickPickIncludes.Tags\n\t\t\t\t\t? Container.git.getTags(this.repoPath, {\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\tfilter: filterTags && filterTags,\n\t\t\t\t\t\t\tincludeRefs: true\n\t\t\t\t\t  })\n\t\t\t\t\t: undefined\n\t\t\t]),\n\t\t\ttoken\n\t\t);\n\t\tif (results === undefined || token.isCancellationRequested) return [];\n\n\t\tconst [branches, tags] = results;\n\n\t\tlet items: (BranchQuickPickItem | TagQuickPickItem)[];\n\t\tif (branches !== undefined && tags !== undefined) {\n\t\t\titems = await Promise.all<BranchQuickPickItem | TagQuickPickItem>([\n\t\t\t\t...branches\n\t\t\t\t\t.filter(b => !b.remote)\n\t\t\t\t\t.map(b =>\n\t\t\t\t\t\tBranchQuickPickItem.create(b, checkmarks, {\n\t\t\t\t\t\t\tcurrent: true,\n\t\t\t\t\t\t\tchecked: b.name === checked,\n\t\t\t\t\t\t\tref: true,\n\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t})\n\t\t\t\t\t),\n\t\t\t\t...tags.map(t =>\n\t\t\t\t\tTagQuickPickItem.create(t, checkmarks, { checked: t.name === checked, ref: true, type: true })\n\t\t\t\t),\n\t\t\t\t...branches\n\t\t\t\t\t.filter(b => b.remote)\n\t\t\t\t\t.map(b =>\n\t\t\t\t\t\tBranchQuickPickItem.create(b, checkmarks, { checked: b.name === checked, type: 'remote' })\n\t\t\t\t\t)\n\t\t\t]);\n\t\t} else if (branches !== undefined) {\n\t\t\titems = await Promise.all(\n\t\t\t\tbranches.map(b =>\n\t\t\t\t\tBranchQuickPickItem.create(b, checkmarks, {\n\t\t\t\t\t\tcurrent: true,\n\t\t\t\t\t\tchecked: b.name === checked,\n\t\t\t\t\t\tref: true,\n\t\t\t\t\t\tstatus: true,\n\t\t\t\t\t\ttype: 'remote'\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\titems = tags!.map(t => TagQuickPickItem.create(t, checkmarks, { checked: t.name === checked, ref: true }));\n\t\t}\n\n\t\t// Move the checked item to the top\n\t\tif (checked) {\n\t\t\tconst index = items.findIndex(i => i.ref === checked);\n\t\t\tif (index !== -1) {\n\t\t\t\titems.splice(0, 0, ...items.splice(index, 1));\n\t\t\t}\n\t\t}\n\n\t\tif (include & ReferencesQuickPickIncludes.WorkingTree) {\n\t\t\t(items as QuickPickItem[]).splice(0, 0, RefQuickPickItem.create('', undefined));\n\t\t}\n\n\t\tif (goBack !== undefined) {\n\t\t\t(items as QuickPickItem[]).splice(0, 0, goBack);\n\t\t}\n\n\t\treturn items;\n\t}\n}\n","'use strict';\nimport { CancellationTokenSource, commands, QuickPickItem, window } from 'vscode';\nimport { Commands } from '../commands';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { GitLogCommit, GitStashCommit, GitUri, SearchPattern } from '../git/gitService';\nimport { KeyMapping, Keys } from '../keyboard';\nimport { ReferencesQuickPick, ReferencesQuickPickItem } from './referencesQuickPick';\nimport { GlyphChars } from '../constants';\n\nexport function getQuickPickIgnoreFocusOut() {\n\treturn !configuration.get('advanced', 'quickPick', 'closeOnFocusOut');\n}\n\nexport function showQuickPickProgress(message: string, mapping?: KeyMapping): CancellationTokenSource {\n\tconst cancellation = new CancellationTokenSource();\n\tvoid _showQuickPickProgress(message, cancellation, mapping);\n\treturn cancellation;\n}\n\nasync function _showQuickPickProgress(message: string, cancellation: CancellationTokenSource, mapping?: KeyMapping) {\n\tconst scope = mapping && (await Container.keyboard.beginScope(mapping));\n\n\ttry {\n\t\tawait window.showQuickPick(\n\t\t\t_getInfiniteCancellablePromise(cancellation),\n\t\t\t{\n\t\t\t\tplaceHolder: message,\n\t\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t\t},\n\t\t\tcancellation.token\n\t\t);\n\t} catch (ex) {\n\t\t// Not sure why this throws\n\t} finally {\n\t\tcancellation.cancel();\n\t\tscope && scope.dispose();\n\t}\n}\n\nfunction _getInfiniteCancellablePromise(cancellation: CancellationTokenSource) {\n\treturn new Promise<QuickPickItem[]>((resolve, reject) => {\n\t\tconst disposable = cancellation.token.onCancellationRequested(() => {\n\t\t\tdisposable.dispose();\n\t\t\tresolve([]);\n\t\t});\n\t});\n}\n\nexport interface QuickPickItem extends QuickPickItem {\n\tonDidSelect?(): void;\n\tonDidPressKey?(key: Keys): Promise<void>;\n}\n\nexport class CommandQuickPickItem implements QuickPickItem {\n\tlabel!: string;\n\tdescription!: string;\n\tdetail?: string | undefined;\n\tprotected command: Commands | undefined;\n\tprotected args: any[] | undefined;\n\n\tconstructor(item: QuickPickItem, args?: [Commands, any[]]);\n\tconstructor(item: QuickPickItem, command?: Commands, args?: any[]);\n\tconstructor(item: QuickPickItem, commandOrArgs?: Commands | [Commands, any[]], args?: any[]) {\n\t\tif (commandOrArgs === undefined) {\n\t\t\tthis.command = undefined;\n\t\t\tthis.args = args;\n\t\t} else if (typeof commandOrArgs === 'string') {\n\t\t\tthis.command = commandOrArgs;\n\t\t\tthis.args = args;\n\t\t} else {\n\t\t\tthis.command = commandOrArgs[0];\n\t\t\tthis.args = commandOrArgs.slice(1);\n\t\t}\n\t\tObject.assign(this, item);\n\t}\n\n\texecute(): Thenable<{} | undefined> {\n\t\tif (this.command === undefined) return Promise.resolve(undefined);\n\n\t\treturn commands.executeCommand(this.command, ...(this.args || []));\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tawait this.execute();\n\t}\n}\n\nexport class KeyCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(command: Commands, args?: any[]) {\n\t\tsuper({ label: '', description: '' }, command, args);\n\t}\n}\n\nexport class MessageQuickPickItem extends CommandQuickPickItem {\n\tconstructor(message: string) {\n\t\tsuper({ label: message, description: '' });\n\t}\n}\n\nexport class OpenInSearchCommitsViewQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tpublic readonly commit: GitLogCommit,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: '$(link-external) Show Commit in Search Commits View',\n\t\t\tdescription: ''\n\t\t}\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\tasync execute(): Promise<{} | undefined> {\n\t\tvoid (await Container.searchView.search(\n\t\t\tthis.commit.repoPath,\n\t\t\t{\n\t\t\t\tpattern: SearchPattern.fromCommit(this.commit)\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: { label: `for ${this.commit.isStash ? 'stash' : 'commit'} id ${this.commit.shortSha}` }\n\t\t\t}\n\t\t));\n\n\t\treturn undefined;\n\t}\n}\n\nexport class OpenInFileHistoryViewQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tpublic readonly uri: GitUri,\n\t\tpublic readonly baseRef: string | undefined,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: '$(eye) Show in File History View',\n\t\t\tdescription: 'shows the file history in the File History view'\n\t\t}\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\tasync execute(): Promise<{} | undefined> {\n\t\treturn void (await Container.fileHistoryView.showHistoryForUri(this.uri, this.baseRef));\n\t}\n}\n\nexport class RevealInRepositoriesViewQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tpublic readonly commit: GitLogCommit | GitStashCommit,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: '$(eye) Reveal Commit in Repositories View',\n\t\t\tdescription: `${commit.isStash ? '' : `${GlyphChars.Dash} this can take a while`}`\n\t\t}\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\tasync execute(): Promise<{} | undefined> {\n\t\tif (GitStashCommit.is(this.commit)) {\n\t\t\tvoid (await Container.repositoriesView.revealStash(this.commit, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: true,\n\t\t\t\texpand: true\n\t\t\t}));\n\t\t} else {\n\t\t\tvoid (await Container.repositoriesView.revealCommit(this.commit, {\n\t\t\t\tselect: true,\n\t\t\t\tfocus: true,\n\t\t\t\texpand: true\n\t\t\t}));\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nexport class ShowFileHistoryFromQuickPickItem extends CommandQuickPickItem {\n\tconstructor(\n\t\tprivate readonly repoPath: string,\n\t\tprivate readonly placeHolder: string,\n\t\tprivate readonly _goBack?: CommandQuickPickItem,\n\t\titem: QuickPickItem = {\n\t\t\tlabel: '$(history) Show File History from...',\n\t\t\tdescription: 'shows an alternate file history'\n\t\t}\n\t) {\n\t\tsuper(item, undefined, undefined);\n\t}\n\n\texecute(): Promise<CommandQuickPickItem | ReferencesQuickPickItem | undefined> {\n\t\treturn new ReferencesQuickPick(this.repoPath).show(this.placeHolder, {\n\t\t\tallowEnteringRefs: true,\n\t\t\tcheckmarks: false,\n\t\t\tgoBack: this._goBack\n\t\t});\n\t}\n}\n","'use strict';\nimport { window } from 'vscode';\nimport { Commands, OpenInRemoteCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport {\n\tgetNameFromRemoteResource,\n\tGitRemote,\n\tGitService,\n\tGitUri,\n\tRemoteResource,\n\tRemoteResourceType\n} from '../git/gitService';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut } from './commonQuickPicks';\n\nexport class OpenRemoteCommandQuickPickItem extends CommandQuickPickItem {\n\tprivate remote: GitRemote;\n\tprivate resource: RemoteResource;\n\n\tconstructor(remote: GitRemote, resource: RemoteResource, public readonly clipboard?: boolean) {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tlabel: clipboard\n\t\t\t\t\t? `$(link-external) Copy ${getNameFromRemoteResource(resource)} Url to Clipboard from ${\n\t\t\t\t\t\t\tremote.provider!.name\n\t\t\t\t\t  }`\n\t\t\t\t\t: `$(link-external) Open ${getNameFromRemoteResource(resource)} on ${remote.provider!.name}`,\n\t\t\t\tdescription: `$(repo) ${remote.provider!.path}`\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined\n\t\t);\n\n\t\tthis.remote = remote;\n\t\tthis.resource = resource;\n\t}\n\n\texecute(): Thenable<{} | undefined> {\n\t\tif (this.clipboard) return this.remote.provider!.copy(this.resource);\n\n\t\treturn this.remote.provider!.open(this.resource);\n\t}\n}\n\nexport class OpenRemotesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(remotes: GitRemote[], resource: RemoteResource, goBackCommand?: CommandQuickPickItem) {\n\t\tconst name = getNameFromRemoteResource(resource);\n\n\t\tlet description;\n\t\tswitch (resource.type) {\n\t\t\tcase RemoteResourceType.Branch:\n\t\t\t\tdescription = `$(git-branch) ${resource.branch}`;\n\t\t\t\tbreak;\n\n\t\t\tcase RemoteResourceType.Branches:\n\t\t\t\tdescription = '$(git-branch) Branches';\n\t\t\t\tbreak;\n\n\t\t\tcase RemoteResourceType.Commit:\n\t\t\t\tdescription = `$(git-commit) ${GitService.shortenSha(resource.sha)}`;\n\t\t\t\tbreak;\n\n\t\t\tcase RemoteResourceType.File:\n\t\t\t\tdescription = GitUri.getFormattedPath(resource.fileName);\n\t\t\t\tbreak;\n\n\t\t\tcase RemoteResourceType.Repo:\n\t\t\t\tdescription = '$(repo) Repository';\n\t\t\t\tbreak;\n\n\t\t\tcase RemoteResourceType.Revision:\n\t\t\t\tif (resource.commit !== undefined && resource.commit.isFile) {\n\t\t\t\t\tif (resource.commit.status === 'D') {\n\t\t\t\t\t\tresource.sha = resource.commit.previousSha;\n\t\t\t\t\t\tdescription = `${GitUri.getFormattedPath(resource.fileName)} from ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t}$(git-commit) ${resource.commit.previousShortSha} (deleted in ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t}$(git-commit) ${resource.commit.shortSha})`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresource.sha = resource.commit.sha;\n\t\t\t\t\t\tdescription = `${GitUri.getFormattedPath(resource.fileName)} from ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t}$(git-commit) ${resource.commit.shortSha}`;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst shortFileSha = resource.sha === undefined ? '' : GitService.shortenSha(resource.sha);\n\t\t\t\t\tdescription = `${GitUri.getFormattedPath(resource.fileName)}${\n\t\t\t\t\t\tshortFileSha ? ` from ${GlyphChars.Space}$(git-commit) ${shortFileSha}` : ''\n\t\t\t\t\t}`;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tdescription = '';\n\t\t\t\tbreak;\n\t\t}\n\n\t\tlet remote: GitRemote | undefined;\n\t\tif (remotes.length > 1) {\n\t\t\tremote = remotes.find(r => r.default);\n\t\t} else if (remotes.length === 1) {\n\t\t\tremote = remotes[0];\n\t\t}\n\n\t\tif (remote != null) {\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tremotes: remotes,\n\t\t\t\tresource: resource,\n\t\t\t\tgoBackCommand: goBackCommand\n\t\t\t};\n\t\t\tsuper(\n\t\t\t\t{\n\t\t\t\t\tlabel: `$(link-external) Open ${name} on ${remote.provider!.name}`,\n\t\t\t\t\tdescription: `${description} in ${GlyphChars.Space}$(repo) ${remote.provider!.path}`\n\t\t\t\t},\n\t\t\t\tCommands.OpenInRemote,\n\t\t\t\t[undefined, commandArgs]\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tremote = remotes[0];\n\t\t// Use the real provider name if there is only 1 provider\n\t\tconst provider = remotes.every(r => r.provider !== undefined && r.provider.name === remote!.provider!.name)\n\t\t\t? remote.provider!.name\n\t\t\t: 'Remote';\n\n\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\tremotes: remotes,\n\t\t\tresource: resource,\n\t\t\tgoBackCommand: goBackCommand\n\t\t};\n\t\tsuper(\n\t\t\t{\n\t\t\t\tlabel: `$(link-external) Open ${name} on ${provider}${GlyphChars.Ellipsis}`,\n\t\t\t\tdescription: `${description}`\n\t\t\t},\n\t\t\tCommands.OpenInRemote,\n\t\t\t[undefined, commandArgs]\n\t\t);\n\t}\n}\n\nexport class RemotesQuickPick {\n\tstatic async show(\n\t\tremotes: GitRemote[],\n\t\tplaceHolder: string,\n\t\tresource: RemoteResource,\n\t\tclipboard?: boolean,\n\t\tgoBackCommand?: CommandQuickPickItem\n\t): Promise<OpenRemoteCommandQuickPickItem | CommandQuickPickItem | undefined> {\n\t\tconst items = remotes.map(r => new OpenRemoteCommandQuickPickItem(r, resource, clipboard)) as (\n\t\t\t| OpenRemoteCommandQuickPickItem\n\t\t\t| CommandQuickPickItem)[];\n\n\t\tif (goBackCommand) {\n\t\t\titems.splice(0, 0, goBackCommand);\n\t\t}\n\n\t\t// const scope = await Container.keyboard.beginScope({ left: goBackCommand });\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tplaceHolder: placeHolder,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t});\n\t\tif (pick === undefined) return undefined;\n\n\t\t// await scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport { CancellationTokenSource, window } from 'vscode';\nimport { Commands, ShowQuickBranchHistoryCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, GitUri, RemoteResourceType } from '../git/gitService';\nimport { KeyNoopCommand } from '../keyboard';\nimport { Iterables } from '../system';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut, showQuickPickProgress } from './commonQuickPicks';\nimport { OpenRemotesCommandQuickPickItem } from './remotesQuickPick';\nimport { CommitQuickPickItem } from './gitQuickPicks';\n\nexport class BranchHistoryQuickPick {\n\tstatic showProgress(branch: string) {\n\t\treturn showQuickPickProgress(\n\t\t\t`${branch} history ${GlyphChars.Dash} search by commit message, filename, or commit id`,\n\t\t\t{\n\t\t\t\t'alt+left': KeyNoopCommand,\n\t\t\t\t'alt+,': KeyNoopCommand,\n\t\t\t\t'alt+.': KeyNoopCommand\n\t\t\t}\n\t\t);\n\t}\n\n\tstatic async show(\n\t\tlog: GitLog,\n\t\turi: GitUri | undefined,\n\t\tbranch: string,\n\t\tprogressCancellation: CancellationTokenSource,\n\t\tgoBackCommand?: CommandQuickPickItem,\n\t\tnextPageCommand?: CommandQuickPickItem\n\t): Promise<CommitQuickPickItem | CommandQuickPickItem | undefined> {\n\t\tconst items = Array.from(Iterables.map(log.commits.values(), c => CommitQuickPickItem.create(c))) as (\n\t\t\t| CommitQuickPickItem\n\t\t\t| CommandQuickPickItem)[];\n\n\t\tconst currentCommandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\tbranch: branch,\n\t\t\tlog: log,\n\t\t\tmaxCount: log.maxCount,\n\t\t\tgoBackCommand: goBackCommand\n\t\t};\n\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t{\n\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\tdescription: `to history of ${GlyphChars.Space}$(git-branch) ${branch}`\n\t\t\t},\n\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t[uri, currentCommandArgs]\n\t\t);\n\n\t\tconst remotes = await Container.git.getRemotes((uri && uri.repoPath) || log.repoPath, { sort: true });\n\t\tif (remotes.length) {\n\t\t\titems.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew OpenRemotesCommandQuickPickItem(\n\t\t\t\t\tremotes,\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: RemoteResourceType.Branch,\n\t\t\t\t\t\tbranch: branch\n\t\t\t\t\t},\n\t\t\t\t\tcurrentCommand\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tlet previousPageCommand: CommandQuickPickItem | undefined = undefined;\n\n\t\tif (log.truncated || log.sha) {\n\t\t\tif (log.truncated) {\n\t\t\t\tconst commandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\t\tbranch: branch,\n\t\t\t\t\tmaxCount: 0,\n\t\t\t\t\tgoBackCommand: goBackCommand\n\t\t\t\t};\n\t\t\t\titems.splice(\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(sync) Show All Commits',\n\t\t\t\t\t\t\tdescription: 'this may take a while'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t\t[GitUri.fromRepoPath(log.repoPath), commandArgs]\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (nextPageCommand) {\n\t\t\t\titems.splice(0, 0, nextPageCommand);\n\t\t\t}\n\n\t\t\tif (log.truncated) {\n\t\t\t\tconst commandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\t\tbranch: branch,\n\t\t\t\t\tmaxCount: log.maxCount,\n\t\t\t\t\tnextPageCommand: nextPageCommand\n\t\t\t\t};\n\t\t\t\tconst npc = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(arrow-right) Show Next Commits',\n\t\t\t\t\t\tdescription: `shows ${log.maxCount} newer commits`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t);\n\n\t\t\t\tconst last = Iterables.last(log.commits.values());\n\t\t\t\tif (last != null) {\n\t\t\t\t\tconst commandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\t\t\tbranch: branch,\n\t\t\t\t\t\tmaxCount: log.maxCount,\n\t\t\t\t\t\tgoBackCommand: goBackCommand,\n\t\t\t\t\t\tnextPageCommand: npc\n\t\t\t\t\t};\n\t\t\t\t\tpreviousPageCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(arrow-left) Show Previous Commits',\n\t\t\t\t\t\t\tdescription: `shows ${log.maxCount} older commits`\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t\t[new GitUri(uri ? uri : last.uri, last), commandArgs]\n\t\t\t\t\t);\n\n\t\t\t\t\titems.splice(0, 0, previousPageCommand);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (goBackCommand) {\n\t\t\titems.splice(0, 0, goBackCommand);\n\t\t}\n\n\t\tif (progressCancellation.token.isCancellationRequested) return undefined;\n\n\t\tconst scope = await Container.keyboard.beginScope({\n\t\t\t'alt+left': goBackCommand,\n\t\t\t'alt+,': previousPageCommand,\n\t\t\t'alt+.': nextPageCommand\n\t\t});\n\n\t\tprogressCancellation.cancel();\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tmatchOnDescription: true,\n\t\t\tmatchOnDetail: true,\n\t\t\tplaceHolder: `${branch} history ${GlyphChars.Dash} search by commit message, filename, or commit id`,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t\t// onDidSelectItem: (item: QuickPickItem) => {\n\t\t\t//     scope.setKeyCommand('right', item);\n\t\t\t// }\n\t\t});\n\n\t\tawait scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport { commands, QuickPickItem, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport {\n\tCommands,\n\tCopyMessageToClipboardCommandArgs,\n\tCopyRemoteFileUrlToClipboardCommandArgs,\n\tCopyShaToClipboardCommandArgs,\n\tDiffWithPreviousCommandArgs,\n\topenEditor,\n\tOpenWorkingFileCommandArgs,\n\tShowQuickCommitDetailsCommandArgs,\n\tShowQuickCommitFileDetailsCommandArgs,\n\tShowQuickFileHistoryCommandArgs\n} from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, GitLogCommit, GitService, GitUri, RemoteResourceType } from '../git/gitService';\nimport { KeyCommand, KeyNoopCommand, Keys } from '../keyboard';\nimport { Strings } from '../system';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut, KeyCommandQuickPickItem } from './commonQuickPicks';\nimport { OpenRemotesCommandQuickPickItem } from './remotesQuickPick';\n\nexport class ApplyCommitFileChangesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(git-pull-request) Apply Changes',\n\t\t\t\tdescription: `${commit.getFormattedPath()} from ${GlyphChars.Space}$(git-commit) ${commit.shortSha}`\n\t\t\t},\n\t\t\tundefined,\n\t\t\tundefined\n\t\t);\n\t}\n\n\tasync execute(): Promise<{} | undefined> {\n\t\tconst uri = this.commit.toGitUri();\n\n\t\t// Open the working file to ensure undo will work\n\t\tconst args: OpenWorkingFileCommandArgs = {\n\t\t\turi: uri,\n\t\t\tshowOptions: { preserveFocus: true, preview: false }\n\t\t};\n\t\tvoid (await commands.executeCommand(Commands.OpenWorkingFile, undefined, args));\n\n\t\tvoid (await Container.git.applyChangesToWorkingFile(uri));\n\n\t\treturn undefined;\n\t}\n}\n\nexport class OpenCommitFileCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly _commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(file-symlink-file) Open File',\n\t\t\t\tdescription: `${_commit.getFormattedPath()}`\n\t\t\t}\n\t\t);\n\t}\n\n\texecute(options?: TextDocumentShowOptions): Thenable<TextEditor | undefined> {\n\t\tconst uri = this._commit.toGitUri();\n\t\tconst args: OpenWorkingFileCommandArgs = {\n\t\t\turi: uri,\n\t\t\tshowOptions: options\n\t\t};\n\t\treturn commands.executeCommand(Commands.OpenWorkingFile, undefined, args);\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tawait this.execute({\n\t\t\tpreserveFocus: true,\n\t\t\tpreview: false\n\t\t});\n\t}\n}\n\nexport class OpenCommitFileRevisionCommandQuickPickItem extends CommandQuickPickItem {\n\tprivate readonly _uri: Uri;\n\n\tconstructor(commit: GitLogCommit, item?: QuickPickItem) {\n\t\tlet description: string;\n\t\tlet uri: Uri;\n\t\tif (commit.status === 'D') {\n\t\t\turi = GitUri.toRevisionUri(commit.previousFileSha, commit.previousUri.fsPath, commit.repoPath);\n\t\t\tdescription = `${commit.getFormattedPath()} from ${GlyphChars.Space}$(git-commit) ${\n\t\t\t\tcommit.previousShortSha\n\t\t\t} (deleted in ${GlyphChars.Space}$(git-commit) ${commit.shortSha})`;\n\t\t} else {\n\t\t\turi = GitUri.toRevisionUri(commit.sha, commit.uri.fsPath, commit.repoPath);\n\t\t\tdescription = `${commit.getFormattedPath()} from ${GlyphChars.Space}$(git-commit) ${commit.shortSha}`;\n\t\t}\n\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(file-symlink-file) Open Revision',\n\t\t\t\tdescription: description\n\t\t\t}\n\t\t);\n\n\t\tthis._uri = uri;\n\t}\n\n\texecute(options?: TextDocumentShowOptions): Thenable<TextEditor | undefined> {\n\t\treturn openEditor(this._uri, options);\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tawait this.execute({\n\t\t\tpreserveFocus: true,\n\t\t\tpreview: false\n\t\t});\n\t}\n}\n\nexport class CommitFileQuickPick {\n\tstatic async show(\n\t\tcommit: GitLogCommit,\n\t\turi: Uri,\n\t\tgoBackCommand?: CommandQuickPickItem,\n\t\tcurrentCommand?: CommandQuickPickItem,\n\t\tfileLog?: GitLog\n\t): Promise<CommandQuickPickItem | undefined> {\n\t\tconst items: CommandQuickPickItem[] = [];\n\n\t\tconst stash = commit.isStash;\n\n\t\tconst isUncommitted = commit.isUncommitted;\n\t\tif (isUncommitted) {\n\t\t\t// Since we can't trust the previous sha on an uncommitted commit, find the last commit for this file\n\t\t\tconst c = await Container.git.getCommitForFile(undefined, commit.uri.fsPath);\n\t\t\tif (c === undefined) return undefined;\n\n\t\t\tcommit = c;\n\t\t}\n\n\t\tconst workingUri = await commit.getWorkingUri();\n\n\t\tif (stash) {\n\t\t\titems.push(new ApplyCommitFileChangesCommandQuickPickItem(commit));\n\t\t}\n\n\t\tif (commit.previousFileSha) {\n\t\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\t\tcommit: commit\n\t\t\t};\n\n\t\t\tconst previousSha = await Container.git.resolveReference(\n\t\t\t\tcommit.repoPath,\n\t\t\t\tcommit.previousFileSha,\n\t\t\t\tcommit.previousUri\n\t\t\t);\n\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(git-compare) Open Changes',\n\t\t\t\t\t\tdescription: `$(git-commit) ${GitService.shortenSha(previousSha)} ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t} $(git-compare) ${GlyphChars.Space} $(git-commit) ${commit.shortSha}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.DiffWithPrevious,\n\t\t\t\t\t[commit.uri, commandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (workingUri) {\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(git-compare) Open Changes with Working File',\n\t\t\t\t\t\tdescription: `$(git-commit) ${commit.shortSha} ${GlyphChars.Space} $(git-compare) ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t} ${GitUri.getFormattedPath(workingUri, { relativeTo: commit.repoPath })}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.DiffWithWorking,\n\t\t\t\t\t[GitUri.fromCommit(commit)]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (workingUri && commit.status !== 'D') {\n\t\t\titems.push(new OpenCommitFileCommandQuickPickItem(commit));\n\t\t}\n\t\titems.push(new OpenCommitFileRevisionCommandQuickPickItem(commit));\n\n\t\tconst remotes = await Container.git.getRemotes(commit.repoPath, { sort: true });\n\t\tif (remotes.length) {\n\t\t\tif (workingUri && commit.status !== 'D') {\n\t\t\t\tconst branch = await Container.git.getBranch(commit.repoPath);\n\t\t\t\tif (branch !== undefined) {\n\t\t\t\t\titems.push(\n\t\t\t\t\t\tnew OpenRemotesCommandQuickPickItem(\n\t\t\t\t\t\t\tremotes,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: RemoteResourceType.File,\n\t\t\t\t\t\t\t\tfileName: GitUri.relativeTo(workingUri, commit.repoPath),\n\t\t\t\t\t\t\t\tbranch: branch.name\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcurrentCommand\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!stash) {\n\t\t\t\titems.push(\n\t\t\t\t\tnew OpenRemotesCommandQuickPickItem(\n\t\t\t\t\t\tremotes,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\t\t\t\tfileName: commit.fileName,\n\t\t\t\t\t\t\tcommit: commit\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcurrentCommand\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (!stash) {\n\t\t\titems.push(new ApplyCommitFileChangesCommandQuickPickItem(commit));\n\n\t\t\tconst copyShaCommandArgs: CopyShaToClipboardCommandArgs = {\n\t\t\t\tsha: commit.sha\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(clippy) Copy Commit ID to Clipboard',\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.CopyShaToClipboard,\n\t\t\t\t\t[uri, copyShaCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst copyMessageCommandArgs: CopyMessageToClipboardCommandArgs = {\n\t\t\t\tmessage: commit.message,\n\t\t\t\tsha: commit.sha\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `$(clippy) Copy ${commit.isStash ? 'Stash' : 'Commit'} Message to Clipboard`,\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.CopyMessageToClipboard,\n\t\t\t\t\t[uri, copyMessageCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif (remotes.length) {\n\t\t\t\tconst copyRemoteUrlCommandArgs: CopyRemoteFileUrlToClipboardCommandArgs = {\n\t\t\t\t\tsha: commit.sha\n\t\t\t\t};\n\t\t\t\titems.push(\n\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(clippy) Copy Remote Url to Clipboard'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.CopyRemoteFileUrlToClipboard,\n\t\t\t\t\t\t[uri, copyRemoteUrlCommandArgs]\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (workingUri) {\n\t\t\tconst commandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\tlog: fileLog,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(history) Show File History',\n\t\t\t\t\t\tdescription: `of ${commit.getFormattedPath()}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t[workingUri, commandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (!stash) {\n\t\t\tconst fileHistoryCommandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `$(history) Show ${\n\t\t\t\t\t\t\tGitUri.relativeTo(workingUri || commit.uri, commit.repoPath) ? 'Previous ' : ''\n\t\t\t\t\t\t}File History`,\n\t\t\t\t\t\tdescription: `of ${commit.getFormattedPath()} from ${GlyphChars.Space}$(git-commit) ${\n\t\t\t\t\t\t\tcommit.shortSha\n\t\t\t\t\t\t}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t[commit.toGitUri(), fileHistoryCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst commitDetailsCommandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\tcommit: commit,\n\t\t\t\tsha: commit.sha,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(git-commit) Show Commit Details',\n\t\t\t\t\t\tdescription: `$(git-commit) ${commit.shortSha}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickCommitDetails,\n\t\t\t\t\t[commit.toGitUri(), commitDetailsCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (goBackCommand) {\n\t\t\titems.splice(0, 0, goBackCommand);\n\t\t}\n\n\t\tlet previousCommand: KeyCommand | (() => Promise<KeyCommand>) | undefined = undefined;\n\t\tlet nextCommand: KeyCommand | (() => Promise<KeyCommand>) | undefined = undefined;\n\t\tif (!stash) {\n\t\t\tpreviousCommand = async () => {\n\t\t\t\tconst previousUri = await Container.git.getPreviousUri(commit.repoPath, uri, commit.sha);\n\t\t\t\tif (previousUri === undefined || previousUri.sha === undefined) return KeyNoopCommand;\n\n\t\t\t\tconst previousCommandArgs: ShowQuickCommitFileDetailsCommandArgs = {\n\t\t\t\t\t// If we have the full file history, reuse it\n\t\t\t\t\tfileLog:\n\t\t\t\t\t\tfileLog !== undefined && !fileLog.truncated && fileLog.sha === undefined ? fileLog : undefined,\n\t\t\t\t\tsha: previousUri.sha,\n\t\t\t\t\tgoBackCommand: goBackCommand\n\t\t\t\t};\n\t\t\t\treturn new KeyCommandQuickPickItem(Commands.ShowQuickCommitFileDetails, [\n\t\t\t\t\tpreviousUri,\n\t\t\t\t\tpreviousCommandArgs\n\t\t\t\t]);\n\t\t\t};\n\n\t\t\tnextCommand = async () => {\n\t\t\t\tconst nextUri = await Container.git.getNextUri(commit.repoPath, uri, commit.sha);\n\t\t\t\tif (nextUri === undefined || nextUri.sha === undefined) return KeyNoopCommand;\n\n\t\t\t\tconst nextCommandArgs: ShowQuickCommitFileDetailsCommandArgs = {\n\t\t\t\t\t// If we have the full file history, reuse it\n\t\t\t\t\tfileLog:\n\t\t\t\t\t\tfileLog !== undefined && !fileLog.truncated && fileLog.sha === undefined ? fileLog : undefined,\n\t\t\t\t\tsha: nextUri.sha,\n\t\t\t\t\tgoBackCommand: goBackCommand\n\t\t\t\t};\n\t\t\t\treturn new KeyCommandQuickPickItem(Commands.ShowQuickCommitFileDetails, [nextUri, nextCommandArgs]);\n\t\t\t};\n\t\t}\n\n\t\tconst scope = await Container.keyboard.beginScope({\n\t\t\t'alt+left': goBackCommand,\n\t\t\t'alt+,': previousCommand,\n\t\t\t'alt+.': nextCommand\n\t\t});\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tmatchOnDescription: true,\n\t\t\tplaceHolder: `${commit.getFormattedPath()} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${\n\t\t\t\tisUncommitted ? `Uncommitted ${GlyphChars.ArrowRightHollow} ` : ''\n\t\t\t}${commit.shortSha} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${commit.author}, ${\n\t\t\t\tcommit.formattedDate\n\t\t\t} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${commit.getShortMessage()}`,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut(),\n\t\t\tonDidSelectItem: (item: QuickPickItem) => {\n\t\t\t\tvoid scope.setKeyCommand('alt+right', item as KeyCommand);\n\t\t\t}\n\t\t});\n\n\t\tawait scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport {\n\tCommands,\n\tCopyMessageToClipboardCommandArgs,\n\tCopyRemoteFileUrlToClipboardCommandArgs,\n\tCopyShaToClipboardCommandArgs,\n\tDiffDirectoryCommandArgs,\n\tDiffWithPreviousCommandArgs,\n\topenEditor,\n\tOpenWorkingFileCommandArgs,\n\tShowQuickCommitDetailsCommandArgs,\n\tStashApplyCommandArgs,\n\tStashDeleteCommandArgs\n} from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitFile,\n\tGitLog,\n\tGitLogCommit,\n\tGitService,\n\tGitStashCommit,\n\tGitUri,\n\tRemoteResourceType\n} from '../git/gitService';\nimport { KeyNoopCommand, Keys } from '../keyboard';\nimport { Arrays, Iterables, Strings } from '../system';\nimport {\n\tCommandQuickPickItem,\n\tgetQuickPickIgnoreFocusOut,\n\tKeyCommandQuickPickItem,\n\tOpenInSearchCommitsViewQuickPickItem,\n\tQuickPickItem,\n\tRevealInRepositoriesViewQuickPickItem\n} from './commonQuickPicks';\nimport { OpenRemotesCommandQuickPickItem } from './remotesQuickPick';\n\nexport class CommitWithFileStatusQuickPickItem extends CommandQuickPickItem {\n\tconstructor(public readonly commit: GitLogCommit, private readonly _file: GitFile) {\n\t\tsuper({\n\t\t\tlabel: `${Strings.pad(GitFile.getStatusOcticon(_file.status), 4, 2)} ${paths.basename(_file.fileName)}`,\n\t\t\tdescription: GitFile.getFormattedDirectory(_file, true)\n\t\t});\n\n\t\tthis.commit = commit.toFileCommit(_file);\n\t}\n\n\tget sha(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\texecute(options?: TextDocumentShowOptions): Thenable<TextEditor | undefined> {\n\t\treturn openEditor(GitUri.toRevisionUri(this.commit.sha, this._file, this.commit.repoPath), options);\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tif (this.commit.previousSha === undefined) {\n\t\t\tawait super.onDidPressKey(key);\n\t\t}\n\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: false\n\t\t\t}\n\t\t};\n\t\tawait commands.executeCommand(Commands.DiffWithPrevious, this.commit.toGitUri(), commandArgs);\n\t}\n}\n\nexport class OpenCommitFilesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly _commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(file-symlink-file) Open Files',\n\t\t\t\tdescription: ''\n\t\t\t\t// detail: `Opens all of the changed file in the working tree`\n\t\t\t}\n\t\t);\n\t}\n\n\tasync execute(\n\t\toptions: TextDocumentShowOptions = { preserveFocus: false, preview: false }\n\t): Promise<{} | undefined> {\n\t\tconst uris = Arrays.filterMap(this._commit.files, f =>\n\t\t\tGitUri.fromFile(f, this._commit.repoPath, this._commit.sha)\n\t\t);\n\t\tfor (const uri of uris) {\n\t\t\tconst args: OpenWorkingFileCommandArgs = {\n\t\t\t\turi: uri,\n\t\t\t\tshowOptions: options\n\t\t\t};\n\t\t\tawait commands.executeCommand(Commands.OpenWorkingFile, undefined, args);\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tawait this.execute({\n\t\t\tpreserveFocus: true,\n\t\t\tpreview: false\n\t\t});\n\t}\n}\n\nexport class OpenCommitFileRevisionsCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(private readonly _commit: GitLogCommit, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(file-symlink-file) Open Revisions',\n\t\t\t\tdescription: `from ${GlyphChars.Space}$(git-commit) ${_commit.shortSha}`\n\t\t\t\t// detail: `Opens all of the changed files in $(git-commit) ${commit.shortSha}`\n\t\t\t}\n\t\t);\n\t}\n\n\tasync execute(\n\t\toptions: TextDocumentShowOptions = { preserveFocus: false, preview: false }\n\t): Promise<{} | undefined> {\n\t\tconst uris = Arrays.filterMap(this._commit.files, f =>\n\t\t\tGitUri.toRevisionUri(\n\t\t\t\tf.status === 'D' ? this._commit.previousFileSha : this._commit.sha,\n\t\t\t\tf,\n\t\t\t\tthis._commit.repoPath\n\t\t\t)\n\t\t);\n\n\t\tfor (const uri of uris) {\n\t\t\tawait openEditor(uri, options);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tawait this.execute({\n\t\t\tpreserveFocus: true,\n\t\t\tpreview: false\n\t\t});\n\t}\n}\n\nexport interface CommitQuickPickOptions {\n\tcurrentCommand?: CommandQuickPickItem;\n\tgoBackCommand?: CommandQuickPickItem;\n\trepoLog?: GitLog;\n\tshowChanges?: boolean;\n}\n\nexport class CommitQuickPick {\n\tconstructor(public readonly repoPath: string | undefined) {}\n\n\tasync show(\n\t\tcommit: GitLogCommit,\n\t\turi: Uri,\n\t\toptions: CommitQuickPickOptions = {}\n\t): Promise<CommitWithFileStatusQuickPickItem | CommandQuickPickItem | undefined> {\n\t\toptions = { showChanges: true, ...options };\n\n\t\tlet previousCommand: (() => Promise<KeyCommandQuickPickItem | typeof KeyNoopCommand>) | undefined = undefined;\n\t\tlet nextCommand: (() => Promise<KeyCommandQuickPickItem | typeof KeyNoopCommand>) | undefined = undefined;\n\t\tif (!commit.isStash) {\n\t\t\tpreviousCommand = async () => {\n\t\t\t\tconst previousRef =\n\t\t\t\t\tcommit.previousSha === undefined || GitService.isShaParent(commit.previousSha)\n\t\t\t\t\t\t? await Container.git.resolveReference(commit.repoPath, commit.previousSha || commit.sha)\n\t\t\t\t\t\t: commit.previousSha;\n\t\t\t\tif (previousRef === undefined) return KeyNoopCommand;\n\n\t\t\t\tconst previousCommandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\t\trepoLog: options.repoLog,\n\t\t\t\t\tsha: previousRef,\n\t\t\t\t\tgoBackCommand: options.goBackCommand\n\t\t\t\t};\n\t\t\t\treturn new KeyCommandQuickPickItem(Commands.ShowQuickCommitDetails, [\n\t\t\t\t\tUri.file(commit.repoPath),\n\t\t\t\t\tpreviousCommandArgs\n\t\t\t\t]);\n\t\t\t};\n\n\t\t\tnextCommand = async () => {\n\t\t\t\tlet log = options.repoLog;\n\t\t\t\tlet c = log && log.commits.get(commit.sha);\n\n\t\t\t\t// If we can't find the commit or the next commit isn't available (since it isn't trustworthy)\n\t\t\t\tif (c === undefined || c.nextSha === undefined) {\n\t\t\t\t\tlog = undefined;\n\t\t\t\t\tc = undefined;\n\n\t\t\t\t\t// Try to find the next commit\n\t\t\t\t\tconst nextLog = await Container.git.getLog(commit.repoPath, {\n\t\t\t\t\t\tmaxCount: 1,\n\t\t\t\t\t\treverse: true,\n\t\t\t\t\t\tref: commit.sha\n\t\t\t\t\t});\n\n\t\t\t\t\tconst next = nextLog && Iterables.first(nextLog.commits.values());\n\t\t\t\t\tif (next !== undefined && next.sha !== commit.sha) {\n\t\t\t\t\t\tc = commit;\n\t\t\t\t\t\tc.nextSha = next.sha;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (c === undefined || c.nextSha === undefined) return KeyNoopCommand;\n\n\t\t\t\tconst nextCommandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\t\trepoLog: log,\n\t\t\t\t\tsha: c.nextSha,\n\t\t\t\t\tgoBackCommand: options.goBackCommand\n\t\t\t\t};\n\t\t\t\treturn new KeyCommandQuickPickItem(Commands.ShowQuickCommitDetails, [\n\t\t\t\t\tUri.file(commit.repoPath),\n\t\t\t\t\tnextCommandArgs\n\t\t\t\t]);\n\t\t\t};\n\t\t}\n\n\t\tconst scope = await Container.keyboard.beginScope({\n\t\t\t'alt+left': options.goBackCommand,\n\t\t\t'alt+,': previousCommand,\n\t\t\t'alt+.': nextCommand\n\t\t});\n\n\t\tconst pick = await window.showQuickPick(CommitQuickPick.getItems(commit, uri, options), {\n\t\t\tmatchOnDescription: true,\n\t\t\tmatchOnDetail: true,\n\t\t\tplaceHolder: `${commit.shortSha} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${\n\t\t\t\tcommit.author ? `${commit.author}, ` : ''\n\t\t\t}${commit.formattedDate} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${commit.getShortMessage()}`,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut(),\n\t\t\tonDidSelectItem: (item: QuickPickItem) => {\n\t\t\t\tvoid scope.setKeyCommand('alt+right', item);\n\t\t\t\tif (typeof item.onDidSelect === 'function') {\n\t\t\t\t\titem.onDidSelect();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tawait scope.dispose();\n\n\t\treturn pick;\n\t}\n\n\tstatic async getItems(commit: GitLogCommit, uri: Uri, options: CommitQuickPickOptions = {}) {\n\t\tconst items: CommandQuickPickItem[] = [];\n\n\t\tlet remotes;\n\t\tif (GitStashCommit.is(commit)) {\n\t\t\tconst stashApplyCommmandArgs: StashApplyCommandArgs = {\n\t\t\t\tdeleteAfter: false,\n\t\t\t\tstashItem: commit,\n\t\t\t\tgoBackCommand: options.currentCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(git-pull-request) Apply Stash',\n\t\t\t\t\t\tdescription: `${\n\t\t\t\t\t\t\tcommit.number === undefined ? '' : `${commit.number}: `\n\t\t\t\t\t\t}${commit.getShortMessage()}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.StashApply,\n\t\t\t\t\t[stashApplyCommmandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tconst stashDeleteCommmandArgs: StashDeleteCommandArgs = {\n\t\t\t\tstashItem: commit,\n\t\t\t\tgoBackCommand: options.currentCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(x) Delete Stash',\n\t\t\t\t\t\tdescription: `${\n\t\t\t\t\t\t\tcommit.number === undefined ? '' : `${commit.number}: `\n\t\t\t\t\t\t}${commit.getShortMessage()}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.StashDelete,\n\t\t\t\t\t[stashDeleteCommmandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\titems.push(new RevealInRepositoriesViewQuickPickItem(commit));\n\t\t} else {\n\t\t\titems.push(new OpenInSearchCommitsViewQuickPickItem(commit));\n\t\t\titems.push(new RevealInRepositoriesViewQuickPickItem(commit));\n\t\t\titems.push(new OpenCommitFilesCommandQuickPickItem(commit));\n\t\t\titems.push(new OpenCommitFileRevisionsCommandQuickPickItem(commit));\n\n\t\t\tremotes = await Container.git.getRemotes(commit.repoPath, { sort: true });\n\t\t\tif (remotes.length) {\n\t\t\t\titems.push(\n\t\t\t\t\tnew OpenRemotesCommandQuickPickItem(\n\t\t\t\t\t\tremotes,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\t\t\t\tsha: commit.sha\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions.currentCommand\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst previousSha = await Container.git.resolveReference(commit.repoPath, commit.previousFileSha);\n\n\t\tlet diffDirectoryCommmandArgs: DiffDirectoryCommandArgs = {\n\t\t\tref1: previousSha,\n\t\t\tref2: commit.sha\n\t\t};\n\t\titems.push(\n\t\t\tnew CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: '$(git-compare) Open Directory Compare with Previous Revision',\n\t\t\t\t\tdescription: `$(git-commit) ${GitService.shortenSha(previousSha)} ${\n\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t} $(git-compare) ${GlyphChars.Space} $(git-commit) ${commit.shortSha}`\n\t\t\t\t},\n\t\t\t\tCommands.DiffDirectory,\n\t\t\t\t[commit.uri, diffDirectoryCommmandArgs]\n\t\t\t)\n\t\t);\n\n\t\tdiffDirectoryCommmandArgs = {\n\t\t\tref1: commit.sha\n\t\t};\n\t\titems.push(\n\t\t\tnew CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: '$(git-compare) Open Directory Compare with Working Tree',\n\t\t\t\t\tdescription: `$(git-commit) ${commit.shortSha} ${GlyphChars.Space} $(git-compare) ${GlyphChars.Space} Working Tree`\n\t\t\t\t},\n\t\t\t\tCommands.DiffDirectory,\n\t\t\t\t[uri, diffDirectoryCommmandArgs]\n\t\t\t)\n\t\t);\n\n\t\tif (!GitStashCommit.is(commit)) {\n\t\t\tconst copyShaCommandArgs: CopyShaToClipboardCommandArgs = {\n\t\t\t\tsha: commit.sha\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(clippy) Copy Commit ID to Clipboard',\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.CopyShaToClipboard,\n\t\t\t\t\t[uri, copyShaCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst copyMessageCommandArgs: CopyMessageToClipboardCommandArgs = {\n\t\t\tmessage: commit.message,\n\t\t\tsha: commit.sha\n\t\t};\n\t\titems.push(\n\t\t\tnew CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `$(clippy) Copy ${commit.isStash ? 'Stash' : 'Commit'} Message to Clipboard`,\n\t\t\t\t\tdescription: ''\n\t\t\t\t},\n\t\t\t\tCommands.CopyMessageToClipboard,\n\t\t\t\t[uri, copyMessageCommandArgs]\n\t\t\t)\n\t\t);\n\n\t\tif (!GitStashCommit.is(commit)) {\n\t\t\tif (remotes !== undefined && remotes.length) {\n\t\t\t\tconst copyRemoteUrlCommandArgs: CopyRemoteFileUrlToClipboardCommandArgs = {\n\t\t\t\t\tsha: commit.sha\n\t\t\t\t};\n\t\t\t\titems.push(\n\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(clippy) Copy Remote Url to Clipboard'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.CopyRemoteFileUrlToClipboard,\n\t\t\t\t\t\t[uri, copyRemoteUrlCommandArgs]\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (options.showChanges) {\n\t\t\tconst commitDetailsCommandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\tcommit: commit,\n\t\t\t\trepoLog: options.repoLog,\n\t\t\t\tsha: commit.sha,\n\t\t\t\tgoBackCommand: options.goBackCommand\n\t\t\t};\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Changed Files',\n\t\t\t\t\t\tdescription: commit.getFormattedDiffStatus()\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickCommitDetails,\n\t\t\t\t\t[uri, commitDetailsCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\n\t\t\titems.push(...commit.files.map(fs => new CommitWithFileStatusQuickPickItem(commit, fs)));\n\t\t}\n\n\t\tif (options.goBackCommand) {\n\t\t\titems.splice(0, 0, options.goBackCommand);\n\t\t}\n\n\t\treturn items;\n\t}\n}\n","'use strict';\nimport { CancellationTokenSource, window } from 'vscode';\nimport { Commands, ShowQuickCurrentBranchHistoryCommandArgs, ShowQuickFileHistoryCommandArgs } from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, GitUri, RemoteResource, RemoteResourceType } from '../git/gitService';\nimport { KeyNoopCommand } from '../keyboard';\nimport { Iterables } from '../system';\nimport {\n\tCommandQuickPickItem,\n\tgetQuickPickIgnoreFocusOut,\n\tShowFileHistoryFromQuickPickItem,\n\tshowQuickPickProgress\n} from './commonQuickPicks';\nimport { OpenRemotesCommandQuickPickItem } from './remotesQuickPick';\nimport { CommitQuickPickItem } from './gitQuickPicks';\n\nexport class FileHistoryQuickPick {\n\tstatic showProgress(placeHolder: string) {\n\t\treturn showQuickPickProgress(placeHolder, {\n\t\t\t'alt+left': KeyNoopCommand,\n\t\t\t'alt+,': KeyNoopCommand,\n\t\t\t'alt+.': KeyNoopCommand\n\t\t});\n\t}\n\n\tstatic async show(\n\t\tlog: GitLog,\n\t\turi: GitUri,\n\t\tplaceHolder: string,\n\t\toptions: {\n\t\t\tcurrentCommand?: CommandQuickPickItem;\n\t\t\tgoBackCommand?: CommandQuickPickItem;\n\t\t\tnextPageCommand?: CommandQuickPickItem;\n\t\t\tpreviousPageCommand?: CommandQuickPickItem;\n\t\t\tpickerOnly?: boolean;\n\t\t\tprogressCancellation?: CancellationTokenSource;\n\t\t\tshowAllCommand?: CommandQuickPickItem;\n\t\t\tshowInViewCommand?: CommandQuickPickItem;\n\t\t} = {}\n\t): Promise<CommitQuickPickItem | CommandQuickPickItem | undefined> {\n\t\toptions = { pickerOnly: false, ...options };\n\n\t\tconst items = Array.from(Iterables.map(log.commits.values(), c => CommitQuickPickItem.create(c))) as (\n\t\t\t| CommitQuickPickItem\n\t\t\t| CommandQuickPickItem)[];\n\n\t\tlet index = 0;\n\n\t\tindex++;\n\t\titems.splice(0, 0, new ShowFileHistoryFromQuickPickItem(log.repoPath, placeHolder, options.currentCommand));\n\n\t\tif (options.showInViewCommand !== undefined) {\n\t\t\tindex++;\n\t\t\titems.splice(0, 0, options.showInViewCommand);\n\t\t}\n\n\t\tif (log.truncated || log.sha) {\n\t\t\tif (options.showAllCommand !== undefined) {\n\t\t\t\tindex++;\n\t\t\t\titems.splice(0, 0, options.showAllCommand);\n\t\t\t} else if (!options.pickerOnly) {\n\t\t\t\tconst workingUri = await Container.git.getWorkingUri(log.repoPath, uri);\n\t\t\t\tif (workingUri) {\n\t\t\t\t\tconst goBackCommandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\t\t\tlog: log,\n\t\t\t\t\t\tmaxCount: log.maxCount,\n\t\t\t\t\t\trange: log.range,\n\t\t\t\t\t\tgoBackCommand: options.goBackCommand\n\t\t\t\t\t};\n\n\t\t\t\t\tconst commandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\t\t\tgoBackCommand: new CommandQuickPickItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\t\t\tdescription: `to history of ${uri.getFormattedPath()}${\n\t\t\t\t\t\t\t\t\turi.sha ? ` from ${GlyphChars.Space}$(git-commit) ${uri.shortSha}` : ''\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t\t\t[uri, goBackCommandArgs]\n\t\t\t\t\t\t)\n\t\t\t\t\t};\n\n\t\t\t\t\tindex++;\n\t\t\t\t\titems.splice(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: '$(history) Show File History',\n\t\t\t\t\t\t\t\tdescription: `of ${GitUri.getFormattedPath(workingUri, { relativeTo: log.repoPath })}`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t\t\t[workingUri, commandArgs]\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.nextPageCommand !== undefined) {\n\t\t\t\tindex++;\n\t\t\t\titems.splice(0, 0, options.nextPageCommand);\n\t\t\t}\n\n\t\t\tif (options.previousPageCommand !== undefined) {\n\t\t\t\tindex++;\n\t\t\t\titems.splice(0, 0, options.previousPageCommand);\n\t\t\t}\n\t\t}\n\n\t\tif (!options.pickerOnly) {\n\t\t\tconst branch = await Container.git.getBranch(uri.repoPath);\n\n\t\t\tif (branch !== undefined) {\n\t\t\t\tconst commandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\t\tlog: log,\n\t\t\t\t\tmaxCount: log.maxCount,\n\t\t\t\t\trange: log.range\n\t\t\t\t};\n\n\t\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\tdescription: `to history of ${uri.getFormattedPath()}${\n\t\t\t\t\t\t\turi.sha ? ` from ${GlyphChars.Space}$(git-commit) ${uri.shortSha}` : ''\n\t\t\t\t\t\t}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t);\n\n\t\t\t\t// Only show the full repo option if we are the root\n\t\t\t\tif (options.goBackCommand === undefined) {\n\t\t\t\t\tconst commandArgs: ShowQuickCurrentBranchHistoryCommandArgs = {\n\t\t\t\t\t\tgoBackCommand: currentCommand\n\t\t\t\t\t};\n\t\t\t\t\titems.splice(\n\t\t\t\t\t\tindex++,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: `${GlyphChars.SpaceThin}$(git-branch) Show Branch History`,\n\t\t\t\t\t\t\t\tdescription: `shows history of ${GlyphChars.Space}$(git-branch) ${branch.name}`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tCommands.ShowQuickCurrentBranchHistory,\n\t\t\t\t\t\t\t[undefined, commandArgs]\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst remotes = await Container.git.getRemotes(uri.repoPath, { sort: true });\n\t\t\t\tif (remotes.length) {\n\t\t\t\t\tconst resource: RemoteResource =\n\t\t\t\t\t\turi.sha !== undefined\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\t\t\t\t\t\tbranch: branch.name,\n\t\t\t\t\t\t\t\t\tfileName: uri.relativePath,\n\t\t\t\t\t\t\t\t\tsha: uri.sha\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\ttype: RemoteResourceType.File,\n\t\t\t\t\t\t\t\t\tbranch: branch.name,\n\t\t\t\t\t\t\t\t\tfileName: uri.relativePath\n\t\t\t\t\t\t\t  };\n\t\t\t\t\titems.splice(index++, 0, new OpenRemotesCommandQuickPickItem(remotes, resource, currentCommand));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.goBackCommand) {\n\t\t\t\titems.splice(0, 0, options.goBackCommand);\n\t\t\t}\n\t\t}\n\n\t\tif (options.progressCancellation !== undefined && options.progressCancellation.token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst scope = await Container.keyboard.beginScope({\n\t\t\t'alt+left': options.goBackCommand,\n\t\t\t'alt+,': options.previousPageCommand,\n\t\t\t'alt+.': options.nextPageCommand\n\t\t});\n\n\t\toptions.progressCancellation && options.progressCancellation.cancel();\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tmatchOnDescription: true,\n\t\t\tmatchOnDetail: true,\n\t\t\tplaceHolder: placeHolder,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t\t// onDidSelectItem: (item: QuickPickItem) => {\n\t\t\t//     scope.setKeyCommand('right', item);\n\t\t\t// }\n\t\t});\n\n\t\tawait scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport { QuickPickItem, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\n\nexport interface ModesQuickPickItem extends QuickPickItem {\n\tkey: string | undefined;\n}\n\nexport class ModesQuickPick {\n\tstatic async show(): Promise<ModesQuickPickItem | undefined> {\n\t\tconst modes = Object.keys(Container.config.modes);\n\t\tif (modes.length === 0) return undefined;\n\n\t\tconst mode = Container.config.mode.active;\n\n\t\tconst items = modes.map(key => {\n\t\t\tconst modeCfg = Container.config.modes[key];\n\t\t\tconst item: ModesQuickPickItem = {\n\t\t\t\tlabel: `${mode === key ? '$(check)\\u00a0\\u00a0' : '\\u00a0\\u00a0\\u00a0\\u00a0\\u00a0'}${\n\t\t\t\t\tmodeCfg.name\n\t\t\t\t} mode`,\n\t\t\t\tdescription: modeCfg.description ? `\\u00a0${GlyphChars.Dash}\\u00a0 ${modeCfg.description}` : '',\n\t\t\t\tkey: key\n\t\t\t};\n\t\t\treturn item;\n\t\t});\n\n\t\tif (mode) {\n\t\t\titems.splice(0, 0, {\n\t\t\t\tlabel: `Exit ${Container.config.modes[mode].name} mode`,\n\t\t\t\tkey: undefined\n\t\t\t});\n\t\t}\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tplaceHolder: 'select a GitLens mode to enter'\n\t\t});\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport { window } from 'vscode';\nimport { Container } from '../container';\nimport { Iterables } from '../system';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut } from './commonQuickPicks';\nimport { RepositoryQuickPickItem } from './gitQuickPicks';\n\nexport class RepositoriesQuickPick {\n\tstatic async show(\n\t\tplaceHolder: string,\n\t\tgoBackCommand?: CommandQuickPickItem\n\t): Promise<RepositoryQuickPickItem | CommandQuickPickItem | undefined> {\n\t\tconst items: (RepositoryQuickPickItem | CommandQuickPickItem)[] = await Promise.all([\n\t\t\t...Iterables.map(await Container.git.getOrderedRepositories(), r =>\n\t\t\t\tRepositoryQuickPickItem.create(r, undefined, { branch: true, status: true })\n\t\t\t)\n\t\t]);\n\n\t\tif (goBackCommand !== undefined) {\n\t\t\titems.splice(0, 0, goBackCommand);\n\t\t}\n\n\t\t// const scope = await Container.keyboard.beginScope({ left: goBackCommand });\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tplaceHolder: placeHolder,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut()\n\t\t});\n\n\t\t// await scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, TextDocumentShowOptions, TextEditor, window } from 'vscode';\nimport {\n\tCommands,\n\tDiffWithPreviousCommandArgs,\n\tOpenChangedFilesCommandArgs,\n\topenEditor,\n\tShowQuickBranchHistoryCommandArgs,\n\tShowQuickRepoStatusCommandArgs,\n\tShowQuickStashListCommandArgs\n} from '../commands';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport {\n\tGitCommitType,\n\tGitFileStatus,\n\tGitLogCommit,\n\tGitService,\n\tGitStatus,\n\tGitStatusFile,\n\tGitUri\n} from '../git/gitService';\nimport { Keys } from '../keyboard';\nimport { Iterables, Strings } from '../system';\nimport { CommandQuickPickItem, getQuickPickIgnoreFocusOut, QuickPickItem } from './commonQuickPicks';\n\nexport class OpenStatusFileCommandQuickPickItem extends CommandQuickPickItem {\n\treadonly status: GitStatusFile;\n\tprivate readonly commit: GitLogCommit;\n\n\tconstructor(private readonly _status: GitStatusFile, realIndexStatus?: GitFileStatus, item?: QuickPickItem) {\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: `${_status.staged ? '$(check)' : GlyphChars.Space.repeat(3)}${Strings.pad(\n\t\t\t\t\t_status.getOcticon(),\n\t\t\t\t\t2,\n\t\t\t\t\t2\n\t\t\t\t)} ${paths.basename(_status.fileName)}`,\n\t\t\t\tdescription: _status.getFormattedDirectory(true)\n\t\t\t}\n\t\t);\n\n\t\tthis.status = _status;\n\t\tif (_status.indexStatus !== undefined) {\n\t\t\tthis.commit = new GitLogCommit(\n\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t_status.repoPath,\n\t\t\t\tGitService.uncommittedStagedSha,\n\t\t\t\t'You',\n\t\t\t\tundefined,\n\t\t\t\tnew Date(),\n\t\t\t\tnew Date(),\n\t\t\t\t'',\n\t\t\t\t_status.fileName,\n\t\t\t\t[_status],\n\t\t\t\t_status.status,\n\t\t\t\t_status.originalFileName,\n\t\t\t\t'HEAD',\n\t\t\t\t_status.fileName\n\t\t\t);\n\t\t} else {\n\t\t\tthis.commit = new GitLogCommit(\n\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t_status.repoPath,\n\t\t\t\tGitService.uncommittedSha,\n\t\t\t\t'You',\n\t\t\t\tundefined,\n\t\t\t\tnew Date(),\n\t\t\t\tnew Date(),\n\t\t\t\t'',\n\t\t\t\t_status.fileName,\n\t\t\t\t[_status],\n\t\t\t\t_status.status,\n\t\t\t\t_status.originalFileName,\n\t\t\t\trealIndexStatus !== undefined ? GitService.uncommittedStagedSha : 'HEAD',\n\t\t\t\t_status.fileName\n\t\t\t);\n\t\t}\n\t}\n\n\texecute(options?: TextDocumentShowOptions): Thenable<TextEditor | undefined> {\n\t\treturn openEditor(this._status.uri, options);\n\t}\n\n\tasync onDidPressKey(key: Keys): Promise<void> {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: false\n\t\t\t}\n\t\t};\n\t\tawait commands.executeCommand(\n\t\t\tCommands.DiffWithPrevious,\n\t\t\tGitUri.fromFile(this.status, this.status.repoPath),\n\t\t\tcommandArgs\n\t\t);\n\t}\n}\n\nexport class OpenStatusFilesCommandQuickPickItem extends CommandQuickPickItem {\n\tconstructor(files: GitStatusFile[], item?: QuickPickItem) {\n\t\tconst uris = files.map(f => f.uri);\n\t\tconst commandArgs: OpenChangedFilesCommandArgs = {\n\t\t\turis: uris\n\t\t};\n\n\t\tsuper(\n\t\t\titem || {\n\t\t\t\tlabel: '$(file-symlink-file) Open Changed Files',\n\t\t\t\tdescription: ''\n\t\t\t\t// detail: `Opens all of the changed files in the repository`\n\t\t\t},\n\t\t\tCommands.OpenChangedFiles,\n\t\t\t[undefined, commandArgs]\n\t\t);\n\t}\n}\n\ninterface ComputedStatus {\n\tstaged: number;\n\tstagedAddsAndChanges: GitStatusFile[];\n\tstagedStatus: string;\n\n\tunstaged: number;\n\tunstagedAddsAndChanges: GitStatusFile[];\n\tunstagedStatus: string;\n}\n\nexport class RepoStatusQuickPick {\n\tprivate static computeStatus(files: GitStatusFile[]): ComputedStatus {\n\t\tlet stagedAdds = 0;\n\t\tlet unstagedAdds = 0;\n\t\tlet stagedChanges = 0;\n\t\tlet unstagedChanges = 0;\n\t\tlet stagedDeletes = 0;\n\t\tlet unstagedDeletes = 0;\n\n\t\tconst stagedAddsAndChanges: GitStatusFile[] = [];\n\t\tconst unstagedAddsAndChanges: GitStatusFile[] = [];\n\n\t\tfor (const f of files) {\n\t\t\tswitch (f.indexStatus) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tstagedAdds++;\n\t\t\t\t\tstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'D':\n\t\t\t\t\tstagedDeletes++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase undefined:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tstagedChanges++;\n\t\t\t\t\tstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tswitch (f.workingTreeStatus) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tunstagedAdds++;\n\t\t\t\t\tunstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'D':\n\t\t\t\t\tunstagedDeletes++;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase undefined:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tunstagedChanges++;\n\t\t\t\t\tunstagedAddsAndChanges.push(f);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst staged = stagedAdds + stagedChanges + stagedDeletes;\n\t\tconst unstaged = unstagedAdds + unstagedChanges + unstagedDeletes;\n\n\t\treturn {\n\t\t\tstaged: staged,\n\t\t\tstagedStatus: staged > 0 ? `+${stagedAdds} ~${stagedChanges} -${stagedDeletes}` : '',\n\t\t\tstagedAddsAndChanges: stagedAddsAndChanges,\n\t\t\tunstaged: unstaged,\n\t\t\tunstagedStatus: unstaged > 0 ? `+${unstagedAdds} ~${unstagedChanges} -${unstagedDeletes}` : '',\n\t\t\tunstagedAddsAndChanges: unstagedAddsAndChanges\n\t\t};\n\t}\n\n\tstatic async show(\n\t\tstatus: GitStatus,\n\t\tgoBackCommand?: CommandQuickPickItem\n\t): Promise<\n\t\tOpenStatusFileCommandQuickPickItem | OpenStatusFilesCommandQuickPickItem | CommandQuickPickItem | undefined\n\t> {\n\t\tconst items = [\n\t\t\t...Iterables.flatMap(status.files, s => {\n\t\t\t\tif (s.workingTreeStatus !== undefined && s.indexStatus !== undefined) {\n\t\t\t\t\treturn [\n\t\t\t\t\t\tnew OpenStatusFileCommandQuickPickItem(s.with({ indexStatus: null }), s.indexStatus),\n\t\t\t\t\t\tnew OpenStatusFileCommandQuickPickItem(s.with({ workTreeStatus: null }))\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\treturn [new OpenStatusFileCommandQuickPickItem(s)];\n\t\t\t})\n\t\t] as (OpenStatusFileCommandQuickPickItem | OpenStatusFilesCommandQuickPickItem | CommandQuickPickItem)[];\n\n\t\t// Sort the status by staged and then filename\n\t\titems.sort(\n\t\t\t(a, b) =>\n\t\t\t\t((a as OpenStatusFileCommandQuickPickItem).status.staged ? -1 : 1) -\n\t\t\t\t\t((b as OpenStatusFileCommandQuickPickItem).status.staged ? -1 : 1) ||\n\t\t\t\t(a as OpenStatusFileCommandQuickPickItem).status.fileName.localeCompare(\n\t\t\t\t\t(b as OpenStatusFileCommandQuickPickItem).status.fileName,\n\t\t\t\t\tundefined,\n\t\t\t\t\t{ numeric: true, sensitivity: 'base' }\n\t\t\t\t)\n\t\t);\n\n\t\tconst repoStatusCommandArgs: ShowQuickRepoStatusCommandArgs = {\n\t\t\tgoBackCommand: goBackCommand\n\t\t};\n\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t{\n\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\tdescription: `to status of ${GlyphChars.Space}$(git-branch) ${status.branch}`\n\t\t\t},\n\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t[undefined, repoStatusCommandArgs]\n\t\t);\n\n\t\tconst computed = this.computeStatus(status.files);\n\t\tif (computed.staged > 0) {\n\t\t\tlet index = 0;\n\t\t\tconst unstagedIndex = computed.unstaged > 0 ? status.files.findIndex(f => !f.staged) : -1;\n\t\t\tif (unstagedIndex > -1) {\n\t\t\t\titems.splice(\n\t\t\t\t\tunstagedIndex,\n\t\t\t\t\t0,\n\t\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Unstaged Files',\n\t\t\t\t\t\t\tdescription: computed.unstagedStatus\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t\t\t\t[undefined, repoStatusCommandArgs]\n\t\t\t\t\t)\n\t\t\t\t);\n\n\t\t\t\titems.splice(\n\t\t\t\t\tunstagedIndex,\n\t\t\t\t\t0,\n\t\t\t\t\tnew OpenStatusFilesCommandQuickPickItem(computed.stagedAddsAndChanges, {\n\t\t\t\t\t\tlabel: `${GlyphChars.Space.repeat(4)} $(file-symlink-file) Open Staged Files`,\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\titems.push(\n\t\t\t\t\tnew OpenStatusFilesCommandQuickPickItem(computed.unstagedAddsAndChanges, {\n\t\t\t\t\t\tlabel: `${GlyphChars.Space.repeat(4)} $(file-symlink-file) Open Unstaged Files`,\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\titems.splice(\n\t\t\t\tindex++,\n\t\t\t\t0,\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Staged Files',\n\t\t\t\t\t\tdescription: computed.stagedStatus\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t\t\t[undefined, repoStatusCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t} else if (status.files.some(f => !f.staged)) {\n\t\t\titems.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Unstaged Files',\n\t\t\t\t\t\tdescription: computed.unstagedStatus\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t\t\t[undefined, repoStatusCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (status.files.length) {\n\t\t\titems.push(\n\t\t\t\tnew OpenStatusFilesCommandQuickPickItem(\n\t\t\t\t\tcomputed.stagedAddsAndChanges.concat(computed.unstagedAddsAndChanges)\n\t\t\t\t)\n\t\t\t);\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(x) Close Unchanged Files',\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.CloseUnchangedFiles\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\titems.push(\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'No changes in the working tree',\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t\t\t[undefined, repoStatusCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tconst stashListCommandArgs: ShowQuickStashListCommandArgs = {\n\t\t\tgoBackCommand: currentCommand\n\t\t};\n\t\titems.splice(\n\t\t\t0,\n\t\t\t0,\n\t\t\tnew CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: '$(inbox) Show Stashes',\n\t\t\t\t\tdescription: 'shows stashed changes in the repository'\n\t\t\t\t},\n\t\t\t\tCommands.ShowQuickStashList,\n\t\t\t\t[GitUri.fromRepoPath(status.repoPath), stashListCommandArgs]\n\t\t\t)\n\t\t);\n\n\t\tif (status.upstream && status.state.ahead) {\n\t\t\tconst branchHistoryCommandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\tbranch: status.ref,\n\t\t\t\tmaxCount: 0,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\titems.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `$(cloud-upload)${GlyphChars.Space} ${status.state.ahead} Commit${\n\t\t\t\t\t\t\tstatus.state.ahead > 1 ? 's' : ''\n\t\t\t\t\t\t} ahead of ${GlyphChars.Space}$(git-branch) ${status.upstream}`,\n\t\t\t\t\t\tdescription: `shows commits in ${GlyphChars.Space}$(git-branch) ${status.branch} but not ${GlyphChars.Space}$(git-branch) ${status.upstream}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t[\n\t\t\t\t\t\tGitUri.fromRepoPath(status.repoPath, `${status.upstream}..${status.ref}`),\n\t\t\t\t\t\tbranchHistoryCommandArgs\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (status.upstream && status.state.behind) {\n\t\t\tconst branchHistoryCommandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\tbranch: status.ref,\n\t\t\t\tmaxCount: 0,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\titems.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `$(cloud-download)${GlyphChars.Space} ${status.state.behind} Commit${\n\t\t\t\t\t\t\tstatus.state.behind > 1 ? 's' : ''\n\t\t\t\t\t\t} behind ${GlyphChars.Space}$(git-branch) ${status.upstream}`,\n\t\t\t\t\t\tdescription: `shows commits in ${GlyphChars.Space}$(git-branch) ${status.upstream} but not ${\n\t\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t\t}$(git-branch) ${status.branch}${\n\t\t\t\t\t\t\tstatus.sha\n\t\t\t\t\t\t\t\t? ` (since ${GlyphChars.Space}$(git-commit) ${GitService.shortenSha(status.sha)})`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t[\n\t\t\t\t\t\tGitUri.fromRepoPath(status.repoPath, `${status.ref}..${status.upstream}`),\n\t\t\t\t\t\tbranchHistoryCommandArgs\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (status.upstream && !status.state.ahead && !status.state.behind) {\n\t\t\titems.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tnew CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `$(git-branch) ${status.branch} is up-to-date with ${GlyphChars.Space}$(git-branch) ${status.upstream}`,\n\t\t\t\t\t\tdescription: ''\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickRepoStatus,\n\t\t\t\t\t[undefined, repoStatusCommandArgs]\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tif (goBackCommand) {\n\t\t\titems.splice(0, 0, goBackCommand);\n\t\t}\n\n\t\tconst scope = await Container.keyboard.beginScope({ 'alt+left': goBackCommand });\n\n\t\tconst pick = await window.showQuickPick(items, {\n\t\t\tmatchOnDescription: true,\n\t\t\tplaceHolder: `status of ${status.branch}${\n\t\t\t\tstatus.upstream ? ` ${Strings.pad(GlyphChars.ArrowsRightLeft, 1, 1)} ${status.upstream}` : ''\n\t\t\t}`,\n\t\t\tignoreFocusOut: getQuickPickIgnoreFocusOut(),\n\t\t\tonDidSelectItem: (item: QuickPickItem) => {\n\t\t\t\tvoid scope.setKeyCommand('alt+right', item);\n\t\t\t}\n\t\t});\n\n\t\tawait scope.dispose();\n\n\t\treturn pick;\n\t}\n}\n","'use strict';\n\nexport * from './quickpicks/commonQuickPicks';\nexport * from './quickpicks/gitQuickPicks';\n\nexport * from './quickpicks/branchHistoryQuickPick';\nexport * from './quickpicks/commitFileQuickPick';\nexport * from './quickpicks/commitQuickPick';\nexport * from './quickpicks/commitsQuickPick';\nexport * from './quickpicks/fileHistoryQuickPick';\nexport * from './quickpicks/modesQuickPick';\nexport * from './quickpicks/referencesQuickPick';\nexport * from './quickpicks/remotesQuickPick';\nexport * from './quickpicks/repositoriesQuickPick';\nexport * from './quickpicks/repoStatusQuickPick';\n","'use strict';\n/* eslint-disable @typescript-eslint/camelcase */\nimport * as paths from 'path';\nimport * as iconv from 'iconv-lite';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Objects, Strings } from '../system';\nimport { findGitPath, GitLocation } from './locator';\nimport { run, RunOptions } from './shell';\nimport { GitBranchParser, GitLogParser, GitReflogParser, GitStashParser } from './parsers/parsers';\nimport { GitFileStatus } from './models/file';\n\nexport type GitLocation = GitLocation;\nexport * from './models/models';\nexport * from './parsers/parsers';\nexport * from './remotes/provider';\n\nexport type GitLogDiffFilter = Exclude<GitFileStatus, '!' | '?'>;\n\nconst emptyArray = (Object.freeze([]) as any) as any[];\nconst emptyObj = Object.freeze({});\nconst emptyStr = '';\nconst slash = '/';\n\n// This is a root sha of all git repo's if using sha1\nconst rootSha = '4b825dc642cb6eb9a060e54bf8d69288fbee4904';\n\nexport const GitErrors = {\n\tbadRevision: /bad revision '(.*?)'/i,\n\tnotAValidObjectName: /Not a valid object name/i,\n\tinvalidLineCount: /file .+? has only \\d+ lines/i\n};\n\nconst GitWarnings = {\n\tnotARepository: /Not a git repository/i,\n\toutsideRepository: /is outside repository/i,\n\tnoPath: /no such path/i,\n\tnoCommits: /does not have any commits/i,\n\tnotFound: /Path '.*?' does not exist in/i,\n\tfoundButNotInRevision: /Path '.*?' exists on disk, but not in/i,\n\theadNotABranch: /HEAD does not point to a branch/i,\n\tnoUpstream: /no upstream configured for branch '(.*?)'/i,\n\tunknownRevision: /ambiguous argument '.*?': unknown revision or path not in the working tree|not stored as a remote-tracking branch/i,\n\tmustRunInWorkTree: /this operation must be run in a work tree/i,\n\tpatchWithConflicts: /Applied patch to '.*?' with conflicts/i,\n\tnoRemoteRepositorySpecified: /No remote repository specified\\./i,\n\tremoteConnectionError: /Could not read from remote repository/i,\n\tnotAGitCommand: /'.+' is not a git command/i\n};\n\nexport enum GitErrorHandling {\n\tIgnore = 'ignore',\n\tThrow = 'throw'\n}\n\nexport interface GitCommandOptions extends RunOptions {\n\tconfigs?: string[];\n\treadonly correlationKey?: string;\n\terrors?: GitErrorHandling;\n\t// Specifies that this command should always be executed locally if possible\n\tlocal?: boolean;\n}\n\n// A map of running git commands -- avoids running duplicate overlaping commands\nconst pendingCommands: Map<string, Promise<string | Buffer>> = new Map();\n\nexport async function git<TOut extends string | Buffer>(options: GitCommandOptions, ...args: any[]): Promise<TOut> {\n\tif (Container.vsls.isMaybeGuest) {\n\t\tif (options.local !== true) {\n\t\t\tconst guest = await Container.vsls.guest();\n\t\t\tif (guest !== undefined) {\n\t\t\t\treturn guest.git<TOut>(options, ...args);\n\t\t\t}\n\t\t} else {\n\t\t\t// Since we will have a live share path here, just blank it out\n\t\t\toptions.cwd = emptyStr;\n\t\t}\n\t}\n\n\tconst start = process.hrtime();\n\n\tconst { configs, correlationKey, errors: errorHandling, ...opts } = options;\n\n\tconst encoding = options.encoding || 'utf8';\n\tconst runOpts: RunOptions = {\n\t\t...opts,\n\t\tencoding: encoding === 'utf8' ? 'utf8' : encoding === 'buffer' ? 'buffer' : 'binary',\n\t\t// Adds GCM environment variables to avoid any possible credential issues -- from https://github.com/Microsoft/vscode/issues/26573#issuecomment-338686581\n\t\t// Shouldn't *really* be needed but better safe than sorry\n\t\tenv: {\n\t\t\t...process.env,\n\t\t\t...(options.env || emptyObj),\n\t\t\tGCM_INTERACTIVE: 'NEVER',\n\t\t\tGCM_PRESERVE_CREDS: 'TRUE',\n\t\t\tLC_ALL: 'C'\n\t\t}\n\t};\n\n\tconst gitCommand = `[${runOpts.cwd}] git ${args.join(' ')}`;\n\n\tconst command = `${correlationKey !== undefined ? `${correlationKey}:` : emptyStr}${gitCommand}`;\n\n\tlet waiting;\n\tlet promise = pendingCommands.get(command);\n\tif (promise === undefined) {\n\t\twaiting = false;\n\n\t\t// Fixes https://github.com/eamodio/vscode-gitlens/issues/73 & https://github.com/eamodio/vscode-gitlens/issues/161\n\t\t// See https://stackoverflow.com/questions/4144417/how-to-handle-asian-characters-in-file-names-in-git-on-os-x\n\t\targs.splice(\n\t\t\t0,\n\t\t\t0,\n\t\t\t'-c',\n\t\t\t'core.quotepath=false',\n\t\t\t'-c',\n\t\t\t'color.ui=false',\n\t\t\t...(configs !== undefined ? configs : emptyArray)\n\t\t);\n\n\t\tpromise = run<TOut>(gitInfo.path, args, encoding, runOpts);\n\n\t\tpendingCommands.set(command, promise);\n\t} else {\n\t\twaiting = true;\n\t}\n\n\tlet exception: Error | undefined;\n\ttry {\n\t\treturn (await promise) as TOut;\n\t} catch (ex) {\n\t\texception = ex;\n\n\t\tswitch (errorHandling) {\n\t\t\tcase GitErrorHandling.Ignore:\n\t\t\t\texception = undefined;\n\t\t\t\treturn emptyStr as TOut;\n\n\t\t\tcase GitErrorHandling.Throw:\n\t\t\t\tthrow ex;\n\n\t\t\tdefault: {\n\t\t\t\tconst result = defaultExceptionHandler(ex, options.cwd, start);\n\t\t\t\texception = undefined;\n\t\t\t\treturn result as TOut;\n\t\t\t}\n\t\t}\n\t} finally {\n\t\tpendingCommands.delete(command);\n\n\t\tconst duration = `${Strings.getDurationMilliseconds(start)} ms ${waiting ? '(await) ' : emptyStr}`;\n\t\tif (exception !== undefined) {\n\t\t\tLogger.warn(\n\t\t\t\t`[${runOpts.cwd}] Git ${(exception.message || exception.toString() || emptyStr)\n\t\t\t\t\t.trim()\n\t\t\t\t\t.replace(/fatal: /g, '')\n\t\t\t\t\t.replace(/\\r?\\n|\\r/g, ` ${GlyphChars.Dot} `)} ${GlyphChars.Dot} ${duration}`\n\t\t\t);\n\t\t} else {\n\t\t\tLogger.log(`${gitCommand} ${GlyphChars.Dot} ${duration}`);\n\t\t}\n\t\tLogger.logGitCommand(\n\t\t\t`${gitCommand} ${GlyphChars.Dot} ${exception !== undefined ? 'FAILED ' : emptyStr}${duration}`,\n\t\t\texception\n\t\t);\n\t}\n}\n\nfunction defaultExceptionHandler(ex: Error, cwd: string | undefined, start?: [number, number]): string {\n\tconst msg = ex.message || ex.toString();\n\tif (msg != null && msg.length !== 0) {\n\t\tfor (const warning of Objects.values(GitWarnings)) {\n\t\t\tif (warning.test(msg)) {\n\t\t\t\tconst duration = start !== undefined ? `${Strings.getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\tLogger.warn(\n\t\t\t\t\t`[${cwd}] Git ${msg\n\t\t\t\t\t\t.trim()\n\t\t\t\t\t\t.replace(/fatal: /g, '')\n\t\t\t\t\t\t.replace(/\\r?\\n|\\r/g, ` ${GlyphChars.Dot} `)} ${GlyphChars.Dot} ${duration}`\n\t\t\t\t);\n\t\t\t\treturn emptyStr;\n\t\t\t}\n\t\t}\n\n\t\tconst match = GitErrors.badRevision.exec(msg);\n\t\tif (match != null && match) {\n\t\t\tconst [, ref] = match;\n\n\t\t\t// Since looking up a ref with ^3 (e.g. looking for untracked files in a stash) can error on some versions of git just ignore it\n\t\t\tif (ref != null && ref.endsWith('^3')) return emptyStr;\n\t\t}\n\t}\n\n\tthrow ex;\n}\n\nlet gitInfo: GitLocation;\n\nexport class Git {\n\tstatic deletedOrMissingSha = '0000000000000000000000000000000000000000-';\n\tstatic shaLikeRegex = /(^[0-9a-f]{40}([\\^@~:]\\S*)?$)|(^[0]{40}(:|-)$)/;\n\tstatic shaRegex = /(^[0-9a-f]{40}$)|(^[0]{40}(:|-)$)/;\n\tstatic shaParentRegex = /(^[0-9a-f]{40})\\^[0-3]?$/;\n\tstatic shaShortenRegex = /^(.*?)([\\^@~:].*)?$/;\n\tstatic uncommittedRegex = /^[0]{40}(?:[\\^@~:]\\S*)?:?$/;\n\tstatic uncommittedSha = '0000000000000000000000000000000000000000';\n\tstatic uncommittedStagedRegex = /^[0]{40}([\\^@~]\\S*)?:$/;\n\tstatic uncommittedStagedSha = '0000000000000000000000000000000000000000:';\n\n\tstatic getEncoding(encoding: string | undefined) {\n\t\treturn encoding !== undefined && iconv.encodingExists(encoding) ? encoding : 'utf8';\n\t}\n\n\tstatic getGitPath(): string {\n\t\treturn gitInfo.path;\n\t}\n\n\tstatic getGitVersion(): string {\n\t\treturn gitInfo.version;\n\t}\n\n\tstatic async setOrFindGitPath(gitPath?: string): Promise<void> {\n\t\tconst start = process.hrtime();\n\n\t\tgitInfo = await findGitPath(gitPath);\n\n\t\tLogger.log(\n\t\t\t`Git found: ${gitInfo.version} @ ${gitInfo.path === 'git' ? 'PATH' : gitInfo.path} ${\n\t\t\t\tGlyphChars.Dot\n\t\t\t} ${Strings.getDurationMilliseconds(start)} ms`\n\t\t);\n\t}\n\n\tstatic isSha(ref: string) {\n\t\treturn Git.isMatch(Git.shaRegex, ref);\n\t}\n\n\tstatic isShaLike(ref: string) {\n\t\treturn Git.isMatch(Git.shaLikeRegex, ref);\n\t}\n\n\tstatic isShaParent(ref: string) {\n\t\treturn Git.isMatch(Git.shaParentRegex, ref);\n\t}\n\n\tstatic isUncommitted(ref: string | undefined) {\n\t\treturn Git.isMatch(Git.uncommittedRegex, ref);\n\t}\n\n\tstatic isUncommittedStaged(ref: string | undefined): boolean {\n\t\treturn Git.isMatch(Git.uncommittedStagedRegex, ref);\n\t}\n\n\tstatic shortenSha(\n\t\tref: string | undefined,\n\t\t{\n\t\t\tforce,\n\t\t\tstrings = {}\n\t\t}: {\n\t\t\tforce?: boolean;\n\t\t\tstrings?: { uncommitted?: string; uncommittedStaged?: string; working?: string };\n\t\t} = {}\n\t) {\n\t\tif (ref == null || ref.length === 0) return strings.working || emptyStr;\n\t\tif (Git.isUncommitted(ref)) {\n\t\t\treturn Git.isUncommittedStaged(ref)\n\t\t\t\t? strings.uncommittedStaged || 'Index'\n\t\t\t\t: strings.uncommitted || 'Working Tree';\n\t\t}\n\n\t\tif (!force && !Git.isShaLike(ref)) return ref;\n\n\t\t// Don't allow shas to be shortened to less than 5 characters\n\t\tconst len = Math.max(5, Container.config.advanced.abbreviatedShaLength);\n\n\t\t// If we have a suffix, append it\n\t\tconst match = Git.shaShortenRegex.exec(ref);\n\t\tif (match != null) {\n\t\t\tconst [, rev, suffix] = match;\n\n\t\t\tif (suffix != null) {\n\t\t\t\treturn `${rev.substr(0, len)}${suffix}`;\n\t\t\t}\n\t\t}\n\n\t\treturn ref.substr(0, len);\n\t}\n\n\tstatic splitPath(fileName: string, repoPath: string | undefined, extract: boolean = true): [string, string] {\n\t\tif (repoPath) {\n\t\t\tfileName = Strings.normalizePath(fileName);\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\n\t\t\tconst normalizedRepoPath = (repoPath.endsWith(slash) ? repoPath : `${repoPath}/`).toLowerCase();\n\t\t\tif (fileName.toLowerCase().startsWith(normalizedRepoPath)) {\n\t\t\t\tfileName = fileName.substring(normalizedRepoPath.length);\n\t\t\t}\n\t\t} else {\n\t\t\trepoPath = Strings.normalizePath(extract ? paths.dirname(fileName) : repoPath!);\n\t\t\tfileName = Strings.normalizePath(extract ? paths.basename(fileName) : fileName);\n\t\t}\n\n\t\treturn [fileName, repoPath];\n\t}\n\n\tstatic validateVersion(major: number, minor: number): boolean {\n\t\tconst [gitMajor, gitMinor] = gitInfo.version.split('.');\n\t\treturn parseInt(gitMajor, 10) >= major && parseInt(gitMinor, 10) >= minor;\n\t}\n\n\tprivate static isMatch(regex: RegExp, ref: string | undefined) {\n\t\treturn ref == null || ref.length === 0 ? false : regex.test(ref);\n\t}\n\n\t// Git commands\n\n\tstatic add(repoPath: string | undefined, pathspec: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'add', '-A', '--', pathspec);\n\t}\n\n\tstatic apply(repoPath: string | undefined, patch: string, options: { allowConflicts?: boolean } = {}) {\n\t\tconst params = ['apply', '--whitespace=warn'];\n\t\tif (options.allowConflicts) {\n\t\t\tparams.push('-3');\n\t\t}\n\t\treturn git<string>({ cwd: repoPath, stdin: patch }, ...params);\n\t}\n\n\tstatic async blame(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref?: string,\n\t\toptions: { args?: string[] | null; ignoreWhitespace?: boolean; startLine?: number; endLine?: number } = {}\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['blame', '--root', '--incremental'];\n\n\t\tif (options.ignoreWhitespace) {\n\t\t\tparams.push('-w');\n\t\t}\n\t\tif (options.startLine != null && options.endLine != null) {\n\t\t\tparams.push(`-L ${options.startLine},${options.endLine}`);\n\t\t}\n\t\tif (options.args != null) {\n\t\t\tparams.push(...options.args);\n\t\t}\n\n\t\tlet stdin;\n\t\tif (ref) {\n\t\t\tif (Git.isUncommittedStaged(ref)) {\n\t\t\t\t// Pipe the blame contents to stdin\n\t\t\t\tparams.push('--contents', '-');\n\n\t\t\t\t// Get the file contents for the staged version using `:`\n\t\t\t\tstdin = await Git.show<string>(repoPath, fileName, ':');\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>({ cwd: root, stdin: stdin }, ...params, '--', file);\n\t}\n\n\tstatic blame__contents(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tcontents: string,\n\t\toptions: {\n\t\t\targs?: string[] | null;\n\t\t\tcorrelationKey?: string;\n\t\t\tignoreWhitespace?: boolean;\n\t\t\tstartLine?: number;\n\t\t\tendLine?: number;\n\t\t} = {}\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['blame', '--root', '--incremental'];\n\n\t\tif (options.ignoreWhitespace) {\n\t\t\tparams.push('-w');\n\t\t}\n\t\tif (options.startLine != null && options.endLine != null) {\n\t\t\tparams.push(`-L ${options.startLine},${options.endLine}`);\n\t\t}\n\t\tif (options.args != null) {\n\t\t\tparams.push(...options.args);\n\t\t}\n\n\t\t// Pipe the blame contents to stdin\n\t\tparams.push('--contents', '-');\n\n\t\treturn git<string>(\n\t\t\t{ cwd: root, stdin: contents, correlationKey: options.correlationKey },\n\t\t\t...params,\n\t\t\t'--',\n\t\t\tfile\n\t\t);\n\t}\n\n\tstatic branch__contains(repoPath: string, ref: string, options: { remote: boolean } = { remote: false }) {\n\t\tconst params = ['branch', '--contains'];\n\t\tif (options.remote) {\n\t\t\tparams.push('-r');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath, configs: ['-c', 'color.branch=false'] }, ...params, ref);\n\t}\n\n\tstatic async cat_file__resolve(repoPath: string, fileName: string, ref: string) {\n\t\tif (Git.isUncommitted(ref)) return ref;\n\n\t\ttry {\n\t\t\tvoid (await git<string>(\n\t\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Throw },\n\t\t\t\t'cat-file',\n\t\t\t\t'-e',\n\t\t\t\t`${ref}:./${fileName}`\n\t\t\t));\n\t\t\treturn ref;\n\t\t} catch (ex) {\n\t\t\tconst msg = ex && ex.toString();\n\t\t\tif (GitErrors.notAValidObjectName.test(msg)) {\n\t\t\t\treturn Git.deletedOrMissingSha;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic async cat_file__validate(repoPath: string, ref: string) {\n\t\tif (Git.isUncommitted(ref)) return true;\n\n\t\ttry {\n\t\t\tvoid (await git<string>({ cwd: repoPath, errors: GitErrorHandling.Throw }, 'cat-file', '-t', ref));\n\t\t\treturn true;\n\t\t} catch (ex) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstatic check_mailmap(repoPath: string, author: string) {\n\t\treturn git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore, local: true }, 'check-mailmap', author);\n\t}\n\n\tstatic async check_ref_format(ref: string, repoPath?: string, options: { branch?: boolean } = { branch: true }) {\n\t\tconst params = ['check-ref-format'];\n\t\tif (options.branch) {\n\t\t\tparams.push('--branch');\n\t\t} else {\n\t\t\tparams.push('--normalize');\n\t\t}\n\n\t\ttry {\n\t\t\tconst data = await git<string>(\n\t\t\t\t{ cwd: repoPath || emptyStr, errors: GitErrorHandling.Throw, local: true },\n\t\t\t\t...params,\n\t\t\t\tref\n\t\t\t);\n\t\t\treturn data.trim();\n\t\t} catch {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstatic checkout(\n\t\trepoPath: string,\n\t\tref: string,\n\t\t{ createBranch, fileName }: { createBranch?: string; fileName?: string } = {}\n\t) {\n\t\tconst params = ['checkout'];\n\t\tif (createBranch) {\n\t\t\tparams.push('-b', createBranch, '--track', ref, '--');\n\t\t} else {\n\t\t\tparams.push(ref, '--');\n\n\t\t\tif (fileName) {\n\t\t\t\t[fileName, repoPath] = Git.splitPath(fileName, repoPath);\n\n\t\t\t\tparams.push(fileName);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic async config__get(key: string, repoPath?: string, options: { local?: boolean } = {}) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath || emptyStr, errors: GitErrorHandling.Ignore, local: options.local },\n\t\t\t'config',\n\t\t\t'--get',\n\t\t\tkey\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async config__get_regex(pattern: string, repoPath?: string, options: { local?: boolean } = {}) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath || emptyStr, errors: GitErrorHandling.Ignore, local: options.local },\n\t\t\t'config',\n\t\t\t'--get-regex',\n\t\t\tpattern\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async diff(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\toptions: { encoding?: string; filter?: string; similarityThreshold?: number } = {}\n\t): Promise<string> {\n\t\tconst params = [\n\t\t\t'diff',\n\t\t\t`-M${options.similarityThreshold == null ? '' : `${options.similarityThreshold}%`}`,\n\t\t\t'--no-ext-diff',\n\t\t\t'-U0',\n\t\t\t'--minimal'\n\t\t];\n\t\tif (options.filter) {\n\t\t\tparams.push(`--diff-filter=${options.filter}`);\n\t\t}\n\n\t\tif (ref1) {\n\t\t\t// <sha>^3 signals an untracked file in a stash and if we are trying to find its parent, use the root sha\n\t\t\tif (ref1.endsWith('^3^')) {\n\t\t\t\tref1 = rootSha;\n\t\t\t}\n\t\t\tparams.push(Git.isUncommittedStaged(ref1) ? '--staged' : ref1);\n\t\t}\n\t\tif (ref2) {\n\t\t\tparams.push(Git.isUncommittedStaged(ref2) ? '--staged' : ref2);\n\t\t}\n\n\t\tconst encoding: BufferEncoding = options.encoding === 'utf8' ? 'utf8' : 'binary';\n\n\t\ttry {\n\t\t\treturn await git<string>(\n\t\t\t\t{ cwd: repoPath, configs: ['-c', 'color.diff=false'], encoding: encoding },\n\t\t\t\t...params,\n\t\t\t\t'--',\n\t\t\t\tfileName\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tconst match = GitErrors.badRevision.exec(ex.message);\n\t\t\tif (match !== null) {\n\t\t\t\tconst [, ref] = match;\n\n\t\t\t\t// If the bad ref is trying to find a parent ref, assume we hit to the last commit, so try again using the root sha\n\t\t\t\tif (ref === ref1 && ref != null && ref.endsWith('^')) {\n\t\t\t\t\treturn Git.diff(repoPath, fileName, rootSha, ref2, options);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthrow ex;\n\t\t}\n\t}\n\n\tstatic diff__name_status(\n\t\trepoPath: string,\n\t\tref1?: string,\n\t\tref2?: string,\n\t\t{ filter, similarityThreshold }: { filter?: string; similarityThreshold?: number } = {}\n\t) {\n\t\tconst params = [\n\t\t\t'diff',\n\t\t\t'--name-status',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'--no-ext-diff'\n\t\t];\n\t\tif (filter) {\n\t\t\tparams.push(`--diff-filter=${filter}`);\n\t\t}\n\t\tif (ref1) {\n\t\t\tparams.push(ref1);\n\t\t}\n\t\tif (ref2) {\n\t\t\tparams.push(ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath, configs: ['-c', 'color.diff=false'] }, ...params);\n\t}\n\n\tstatic diff__shortstat(repoPath: string, ref?: string) {\n\t\tconst params = ['diff', '--shortstat', '--no-ext-diff'];\n\t\tif (ref) {\n\t\t\tparams.push(ref);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath, configs: ['-c', 'color.diff=false'] }, ...params);\n\t}\n\n\tstatic difftool(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\ttool: string,\n\t\toptions: { ref1?: string; ref2?: string; staged?: boolean } = {}\n\t) {\n\t\tconst params = ['difftool', '--no-prompt', `--tool=${tool}`];\n\t\tif (options.staged) {\n\t\t\tparams.push('--staged');\n\t\t}\n\t\tif (options.ref1) {\n\t\t\tparams.push(options.ref1);\n\t\t}\n\t\tif (options.ref2) {\n\t\t\tparams.push(options.ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, '--', fileName);\n\t}\n\n\tstatic difftool__dir_diff(repoPath: string, tool: string, ref1: string, ref2?: string) {\n\t\tconst params = ['difftool', '--dir-diff', `--tool=${tool}`, ref1];\n\t\tif (ref2) {\n\t\t\tparams.push(ref2);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic fetch(repoPath: string, options: { all?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\tconst params = ['fetch'];\n\t\tif (options.prune) {\n\t\t\tparams.push('--prune');\n\t\t}\n\n\t\tif (options.remote) {\n\t\t\tparams.push(options.remote);\n\t\t} else if (options.all) {\n\t\t\tparams.push('--all');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic for_each_ref__branch(repoPath: string, options: { all: boolean } = { all: false }) {\n\t\tconst params = ['for-each-ref', `--format=${GitBranchParser.defaultFormat}`, 'refs/heads'];\n\t\tif (options.all) {\n\t\t\tparams.push('refs/remotes');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic log(\n\t\trepoPath: string,\n\t\tref: string | undefined,\n\t\t{\n\t\t\tauthors,\n\t\t\tmaxCount,\n\t\t\tmerges,\n\t\t\treverse,\n\t\t\tsimilarityThreshold\n\t\t}: { authors?: string[]; maxCount?: number; merges?: boolean; reverse?: boolean; similarityThreshold?: number }\n\t) {\n\t\tconst params = [\n\t\t\t'log',\n\t\t\t'--name-status',\n\t\t\t`--format=${GitLogParser.defaultFormat}`,\n\t\t\t'--full-history',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`\n\t\t];\n\t\tif (maxCount && !reverse) {\n\t\t\tparams.push(`-n${maxCount}`);\n\t\t}\n\n\t\tif (merges) {\n\t\t\tparams.push('-m');\n\t\t}\n\n\t\tif (authors) {\n\t\t\tparams.push('--use-mailmap', ...authors.map(a => `--author=${a}`));\n\t\t}\n\n\t\tif (ref && !Git.isUncommittedStaged(ref)) {\n\t\t\t// If we are reversing, we must add a range (with HEAD) because we are using --ancestry-path for better reverse walking\n\t\t\tif (reverse) {\n\t\t\t\tparams.push('--reverse', '--ancestry-path', `${ref}..HEAD`);\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'diff.renameLimit=0', '-c', 'log.showSignature=false'] },\n\t\t\t...params,\n\t\t\t'--'\n\t\t);\n\t}\n\n\tstatic log__file(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref: string | undefined,\n\t\t{\n\t\t\tfilters,\n\t\t\tmaxCount,\n\t\t\tfirstParent = false,\n\t\t\trenames = true,\n\t\t\treverse = false,\n\t\t\tsimple = false,\n\t\t\tstartLine,\n\t\t\tendLine\n\t\t}: {\n\t\t\tfilters?: GitLogDiffFilter[];\n\t\t\tmaxCount?: number;\n\t\t\tfirstParent?: boolean;\n\t\t\trenames?: boolean;\n\t\t\treverse?: boolean;\n\t\t\tsimple?: boolean;\n\t\t\tstartLine?: number;\n\t\t\tendLine?: number;\n\t\t} = {}\n\t) {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['log', `--format=${simple ? GitLogParser.simpleFormat : GitLogParser.defaultFormat}`];\n\n\t\tif (maxCount && !reverse) {\n\t\t\tparams.push(`-n${maxCount}`);\n\t\t}\n\t\tparams.push(renames ? '--follow' : '-m');\n\n\t\tif (filters != null && filters.length !== 0) {\n\t\t\tparams.push(`--diff-filter=${filters.join(emptyStr)}`);\n\t\t}\n\n\t\tif (firstParent) {\n\t\t\tparams.push('--first-parent');\n\t\t}\n\n\t\tif (startLine == null) {\n\t\t\tif (simple) {\n\t\t\t\tparams.push('--name-status');\n\t\t\t} else {\n\t\t\t\tparams.push('--numstat', '--summary');\n\t\t\t}\n\t\t} else {\n\t\t\t// Don't include --name-status or -s because Git won't honor it\n\t\t\tparams.push(`-L ${startLine},${endLine == null ? startLine : endLine}:${file}`);\n\t\t}\n\n\t\tif (ref && !Git.isUncommittedStaged(ref)) {\n\t\t\t// If we are reversing, we must add a range (with HEAD) because we are using --ancestry-path for better reverse walking\n\t\t\tif (reverse) {\n\t\t\t\tparams.push('--reverse', '--ancestry-path', `${ref}..HEAD`);\n\t\t\t} else {\n\t\t\t\tparams.push(ref);\n\t\t\t}\n\t\t}\n\n\t\tif (startLine == null || renames) {\n\t\t\t// Don't specify a file spec when using a line number (so say the git docs), unless it is a follow\n\t\t\tparams.push('--', file);\n\t\t}\n\n\t\treturn git<string>({ cwd: root, configs: ['-c', 'log.showSignature=false'] }, ...params);\n\t}\n\n\tstatic async log__file_recent(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\t{ ref, similarityThreshold }: { ref?: string; similarityThreshold?: number } = {}\n\t) {\n\t\tconst params = [\n\t\t\t'log',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'-n1',\n\t\t\t'--format=%H'\n\t\t];\n\n\t\tif (ref) {\n\t\t\tparams.push(ref);\n\t\t}\n\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, ...params, '--', fileName);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async log__recent(repoPath: string) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t'log',\n\t\t\t'-n1',\n\t\t\t'--format=%H',\n\t\t\t'--'\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async log__recent_committerdate(repoPath: string) {\n\t\tconst data = await git<string>(\n\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Ignore },\n\t\t\t'log',\n\t\t\t'-n1',\n\t\t\t'--format=%ct',\n\t\t\t'--'\n\t\t);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic log__search(\n\t\trepoPath: string,\n\t\tsearch: string[] = emptyArray,\n\t\t{ maxCount, useShow }: { maxCount?: number; useShow?: boolean } = {}\n\t) {\n\t\tconst params = [\n\t\t\tuseShow ? 'show' : 'log',\n\t\t\t'--name-status',\n\t\t\t`--format=${GitLogParser.defaultFormat}`,\n\t\t\t'--use-mailmap'\n\t\t];\n\t\tif (maxCount && !useShow) {\n\t\t\tparams.push(`-n${maxCount}`);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, ...search);\n\t}\n\n\t// static log__shortstat(repoPath: string, options: { ref?: string }) {\n\t//     const params = ['log', '--shortstat', '--oneline'];\n\t//     if (options.ref && !Git.isUncommittedStaged(options.ref)) {\n\t//         params.push(options.ref);\n\t//     }\n\t//     return git<string>({ cwd: repoPath }, ...params, '--');\n\t// }\n\n\tstatic async ls_files(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\t{ ref, untracked }: { ref?: string; untracked?: boolean } = {}\n\t): Promise<string | undefined> {\n\t\tconst params = ['ls-files'];\n\t\tif (ref && !Git.isUncommitted(ref)) {\n\t\t\tparams.push(`--with-tree=${ref}`);\n\t\t}\n\n\t\tif (!ref && untracked) {\n\t\t\tparams.push('-o');\n\t\t}\n\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, ...params, '--', fileName);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async ls_tree(repoPath: string, ref: string, { fileName }: { fileName?: string } = {}) {\n\t\tconst params = ['ls-tree'];\n\t\tif (fileName) {\n\t\t\tparams.push('-l', ref, '--', fileName);\n\t\t} else {\n\t\t\tparams.push('-lrt', ref, '--');\n\t\t}\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, ...params);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic merge_base(repoPath: string, ref1: string, ref2: string, { forkPoint }: { forkPoint?: boolean } = {}) {\n\t\tconst params = ['merge-base'];\n\t\tif (forkPoint) {\n\t\t\tparams.push('--fork-point');\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, ref1, ref2);\n\t}\n\n\tstatic reflog(\n\t\trepoPath: string,\n\t\t{ all, branch, since }: { all?: boolean; branch?: string; since?: string } = {}\n\t): Promise<string> {\n\t\tconst params = ['log', '-g', `--format=${GitReflogParser.defaultFormat}`, '--date=unix'];\n\t\tif (all) {\n\t\t\tparams.push('--all');\n\t\t}\n\t\tif (branch) {\n\t\t\tparams.push(branch);\n\t\t}\n\t\tif (since) {\n\t\t\tparams.push(`--since=${since}`);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params, '--');\n\t}\n\n\tstatic remote(repoPath: string): Promise<string> {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', '-v');\n\t}\n\n\tstatic remote__add(repoPath: string, name: string, url: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'add', name, url);\n\t}\n\n\tstatic remote__prune(repoPath: string, remoteName: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'prune', remoteName);\n\t}\n\n\tstatic remote__get_url(repoPath: string, remote: string): Promise<string> {\n\t\treturn git<string>({ cwd: repoPath }, 'remote', 'get-url', remote);\n\t}\n\n\tstatic reset(repoPath: string | undefined, fileName: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'reset', '-q', '--', fileName);\n\t}\n\n\tstatic async rev_list(\n\t\trepoPath: string,\n\t\trefs: string[],\n\t\toptions: { count?: boolean } = {}\n\t): Promise<number | undefined> {\n\t\tconst params = [];\n\t\tif (options.count) {\n\t\t\tparams.push('--count');\n\t\t}\n\t\tparams.push(...refs);\n\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, 'rev-list', ...params);\n\t\treturn data.length === 0 ? undefined : Number(data.trim()) || undefined;\n\t}\n\n\tstatic async rev_parse(repoPath: string, ref: string): Promise<string | undefined> {\n\t\tconst data = await git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, 'rev-parse', ref);\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic async rev_parse__currentBranch(repoPath: string): Promise<[string, string | undefined] | undefined> {\n\t\ttry {\n\t\t\tconst data = await git<string>(\n\t\t\t\t{ cwd: repoPath, errors: GitErrorHandling.Throw },\n\t\t\t\t'rev-parse',\n\t\t\t\t'--abbrev-ref',\n\t\t\t\t'--symbolic-full-name',\n\t\t\t\t'@',\n\t\t\t\t'@{u}',\n\t\t\t\t'--'\n\t\t\t);\n\t\t\treturn [data, undefined];\n\t\t} catch (ex) {\n\t\t\tconst msg = ex && ex.toString();\n\t\t\tif (GitErrors.badRevision.test(msg) || GitWarnings.noUpstream.test(msg)) {\n\t\t\t\treturn [ex.stdout, undefined];\n\t\t\t}\n\n\t\t\tif (GitWarnings.headNotABranch.test(msg)) {\n\t\t\t\tconst sha = await this.log__recent(repoPath);\n\t\t\t\tif (sha === undefined) return undefined;\n\n\t\t\t\treturn [`(HEAD detached at ${this.shortenSha(sha)})`, sha];\n\t\t\t}\n\n\t\t\tdefaultExceptionHandler(ex, repoPath);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic async rev_parse__show_toplevel(cwd: string): Promise<string | undefined> {\n\t\tconst data = await git<string>({ cwd: cwd, errors: GitErrorHandling.Ignore }, 'rev-parse', '--show-toplevel');\n\t\treturn data.length === 0 ? undefined : data.trim();\n\t}\n\n\tstatic shortlog(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'shortlog', '-sne', '--all', '--no-merges');\n\t}\n\n\tstatic async show<TOut extends string | Buffer>(\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tref: string,\n\t\toptions: {\n\t\t\tencoding?: 'binary' | 'ascii' | 'utf8' | 'utf16le' | 'ucs2' | 'base64' | 'latin1' | 'hex' | 'buffer';\n\t\t} = {}\n\t): Promise<TOut | undefined> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tif (Git.isUncommittedStaged(ref)) {\n\t\t\tref = ':';\n\t\t}\n\t\tif (Git.isUncommitted(ref)) throw new Error(`ref=${ref} is uncommitted`);\n\n\t\tconst opts: GitCommandOptions = {\n\t\t\tconfigs: ['-c', 'log.showSignature=false'],\n\t\t\tcwd: root,\n\t\t\tencoding: options.encoding || 'utf8',\n\t\t\terrors: GitErrorHandling.Throw\n\t\t};\n\t\tconst args = ref.endsWith(':') ? `${ref}./${file}` : `${ref}:./${file}`;\n\n\t\ttry {\n\t\t\tconst data = await git<TOut>(opts, 'show', args, '--');\n\t\t\treturn data;\n\t\t} catch (ex) {\n\t\t\tconst msg = ex && ex.toString();\n\t\t\tif (ref === ':' && GitErrors.badRevision.test(msg)) {\n\t\t\t\treturn Git.show<TOut>(repoPath, fileName, 'HEAD:', options);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tGitErrors.badRevision.test(msg) ||\n\t\t\t\tGitWarnings.notFound.test(msg) ||\n\t\t\t\tGitWarnings.foundButNotInRevision.test(msg)\n\t\t\t) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn defaultExceptionHandler(ex, opts.cwd) as TOut;\n\t\t}\n\t}\n\n\tstatic show__diff(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tref: string,\n\t\toriginalFileName?: string,\n\t\t{ similarityThreshold }: { similarityThreshold?: number } = {}\n\t) {\n\t\tconst params = [\n\t\t\t'show',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t'--format=',\n\t\t\t'--minimal',\n\t\t\t'-U0',\n\t\t\tref,\n\t\t\t'--',\n\t\t\tfileName\n\t\t];\n\t\tif (originalFileName != null && originalFileName.length !== 0) {\n\t\t\tparams.push(originalFileName);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic show__name_status(repoPath: string, fileName: string, ref: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'show', '--name-status', '--format=', ref, '--', fileName);\n\t}\n\n\tstatic show_ref__tags(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath, errors: GitErrorHandling.Ignore }, 'show-ref', '--tags');\n\t}\n\n\tstatic stash__apply(repoPath: string, stashName: string, deleteAfter: boolean) {\n\t\tif (!stashName) return undefined;\n\t\treturn git<string>({ cwd: repoPath }, 'stash', deleteAfter ? 'pop' : 'apply', stashName);\n\t}\n\n\tstatic stash__delete(repoPath: string, stashName: string) {\n\t\tif (!stashName) return undefined;\n\t\treturn git<string>({ cwd: repoPath }, 'stash', 'drop', stashName);\n\t}\n\n\tstatic stash__list(\n\t\trepoPath: string,\n\t\t{\n\t\t\tformat = GitStashParser.defaultFormat,\n\t\t\tsimilarityThreshold\n\t\t}: { format?: string; similarityThreshold?: number } = {}\n\t) {\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath },\n\t\t\t'stash',\n\t\t\t'list',\n\t\t\t'--name-status',\n\t\t\t`-M${similarityThreshold == null ? '' : `${similarityThreshold}%`}`,\n\t\t\t`--format=${format}`\n\t\t);\n\t}\n\n\tstatic stash__push(\n\t\trepoPath: string,\n\t\tmessage?: string,\n\t\t{\n\t\t\tincludeUntracked,\n\t\t\tkeepIndex,\n\t\t\tpathspecs\n\t\t}: { includeUntracked?: boolean; keepIndex?: boolean; pathspecs?: string[] } = {}\n\t) {\n\t\tconst params = ['stash', 'push'];\n\n\t\tif (includeUntracked || (pathspecs !== undefined && pathspecs.length !== 0)) {\n\t\t\tparams.push('-u');\n\t\t}\n\n\t\tif (keepIndex) {\n\t\t\tparams.push('-k');\n\t\t}\n\n\t\tif (message) {\n\t\t\tparams.push('-m', message);\n\t\t}\n\n\t\tparams.push('--');\n\t\tif (pathspecs !== undefined && pathspecs.length !== 0) {\n\t\t\tparams.push(...pathspecs);\n\t\t}\n\n\t\treturn git<string>({ cwd: repoPath }, ...params);\n\t}\n\n\tstatic status(\n\t\trepoPath: string,\n\t\tporcelainVersion: number = 1,\n\t\t{ similarityThreshold }: { similarityThreshold?: number } = {}\n\t): Promise<string> {\n\t\tconst params = [\n\t\t\t'status',\n\t\t\tporcelainVersion >= 2 ? `--porcelain=v${porcelainVersion}` : '--porcelain',\n\t\t\t'--branch',\n\t\t\t'-u'\n\t\t];\n\t\tif (Git.validateVersion(2, 18)) {\n\t\t\tparams.push(`--find-renames=${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: repoPath, configs: ['-c', 'color.status=false'], env: { GIT_OPTIONAL_LOCKS: '0' } },\n\t\t\t...params,\n\t\t\t'--'\n\t\t);\n\t}\n\n\tstatic status__file(\n\t\trepoPath: string,\n\t\tfileName: string,\n\t\tporcelainVersion: number = 1,\n\t\t{ similarityThreshold }: { similarityThreshold?: number } = {}\n\t): Promise<string> {\n\t\tconst [file, root] = Git.splitPath(fileName, repoPath);\n\n\t\tconst params = ['status', porcelainVersion >= 2 ? `--porcelain=v${porcelainVersion}` : '--porcelain'];\n\t\tif (Git.validateVersion(2, 18)) {\n\t\t\tparams.push(`--find-renames=${similarityThreshold == null ? '' : `${similarityThreshold}%`}`);\n\t\t}\n\n\t\treturn git<string>(\n\t\t\t{ cwd: root, configs: ['-c', 'color.status=false'], env: { GIT_OPTIONAL_LOCKS: '0' } },\n\t\t\t...params,\n\t\t\t'--',\n\t\t\tfile\n\t\t);\n\t}\n\n\tstatic tag(repoPath: string) {\n\t\treturn git<string>({ cwd: repoPath }, 'tag', '-l', '-n1');\n\t}\n}\n","'use strict';\nimport { Command, Disposable, Event, TreeItem, TreeItemCollapsibleState, TreeViewVisibilityChangeEvent } from 'vscode';\nimport { GitUri } from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { debug, Functions, gate, logName } from '../../system';\nimport { TreeViewNodeStateChangeEvent, View } from '../viewBase';\n\nexport enum ResourceType {\n\tActiveFileHistory = 'gitlens:history:active:file',\n\tActiveLineHistory = 'gitlens:history:active:line',\n\tBranch = 'gitlens:branch',\n\tBranches = 'gitlens:branches',\n\tBranchStatusAheadOfUpstream = 'gitlens:status-branch:upstream:ahead',\n\tBranchStatusBehindUpstream = 'gitlens:status-branch:upstream:behind',\n\tCommit = 'gitlens:commit',\n\tCommits = 'gitlens:commits',\n\tCompare = 'gitlens:compare',\n\tCompareBranch = 'gitlens:compare:branch',\n\tComparePicker = 'gitlens:compare:picker',\n\tComparePickerWithRef = 'gitlens:compare:picker:ref',\n\tCompareResults = 'gitlens:compare:results',\n\tContributor = 'gitlens:contributor',\n\tContributors = 'gitlens:contributors',\n\tFile = 'gitlens:file',\n\tFileHistory = 'gitlens:history:file',\n\tFolder = 'gitlens:folder',\n\tLineHistory = 'gitlens:history:line',\n\tMessage = 'gitlens:message',\n\tPager = 'gitlens:pager',\n\tReflog = 'gitlens:reflog',\n\tReflogRecord = 'gitlens:reflog-record',\n\tRemote = 'gitlens:remote',\n\tRemotes = 'gitlens:remotes',\n\tRepositories = 'gitlens:repositories',\n\tRepository = 'gitlens:repository',\n\tResultsCommits = 'gitlens:results:commits',\n\tResultsFile = 'gitlens:file:results',\n\tResultsFiles = 'gitlens:results:files',\n\tSearch = 'gitlens:search',\n\tSearchResults = 'gitlens:search:results',\n\tStash = 'gitlens:stash',\n\tStashFile = 'gitlens:file:stash',\n\tStashes = 'gitlens:stashes',\n\tStatusFileCommits = 'gitlens:status:file:commits',\n\tStatusFiles = 'gitlens:status:files',\n\tStatusAheadOfUpstream = 'gitlens:status:upstream:ahead',\n\tStatusBehindUpstream = 'gitlens:status:upstream:behind',\n\tTag = 'gitlens:tag',\n\tTags = 'gitlens:tags'\n}\n\nexport const unknownGitUri = new GitUri();\n\nexport interface ViewNode {\n\treadonly id?: string;\n}\n\n@logName<ViewNode>((c, name) => `${name}${c.id != null ? `(${c.id})` : ''}`)\nexport abstract class ViewNode<TView extends View = View> {\n\tconstructor(uri: GitUri, public readonly view: TView, protected readonly parent?: ViewNode) {\n\t\tthis._uri = uri;\n\t}\n\n\ttoClipboard?(): string;\n\n\ttoString() {\n\t\treturn `${Logger.toLoggableName(this)}${this.id != null ? `(${this.id})` : ''}`;\n\t}\n\n\tprotected _uri: GitUri;\n\tget uri() {\n\t\treturn this._uri;\n\t}\n\n\tabstract getChildren(): ViewNode[] | Promise<ViewNode[]>;\n\n\tgetParent(): ViewNode | undefined {\n\t\treturn this.parent;\n\t}\n\n\tabstract getTreeItem(): TreeItem | Promise<TreeItem>;\n\n\tgetCommand(): Command | undefined {\n\t\treturn undefined;\n\t}\n\n\trefresh?(reset?: boolean): void | boolean | Promise<void> | Promise<boolean>;\n\n\t@gate()\n\t@debug()\n\ttriggerChange(reset: boolean = false): Promise<void> {\n\t\treturn this.view.refreshNode(this, reset);\n\t}\n}\n\nexport abstract class ViewRefNode<TView extends View = View> extends ViewNode<TView> {\n\tabstract get ref(): string;\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\ttoString() {\n\t\treturn `${super.toString()}:${this.ref}`;\n\t}\n}\n\nexport abstract class ViewRefFileNode<TView extends View = View> extends ViewRefNode<TView> {\n\tabstract get fileName(): string;\n\n\ttoString() {\n\t\treturn `${super.toString()}:${this.fileName}`;\n\t}\n}\n\nexport function nodeSupportsConditionalDismissal(node: ViewNode): node is ViewNode & { canDismiss(): boolean } {\n\treturn typeof (node as ViewNode & { canDismiss(): boolean }).canDismiss === 'function';\n}\n\nexport interface PageableViewNode {\n\treadonly id?: string;\n\treadonly supportsPaging: boolean;\n\treadonly rememberLastMaxCount?: boolean;\n\tmaxCount: number | undefined;\n}\n\nexport namespace PageableViewNode {\n\texport function is(node: ViewNode): node is ViewNode & PageableViewNode {\n\t\treturn Functions.is<ViewNode & PageableViewNode>(node, 'supportsPaging', true);\n\t}\n}\n\nexport abstract class SubscribeableViewNode<TView extends View = View> extends ViewNode<TView> {\n\tprotected _disposable: Disposable;\n\tprotected _subscription: Promise<Disposable | undefined> | undefined;\n\n\tconstructor(uri: GitUri, view: TView, parent?: ViewNode) {\n\t\tsuper(uri, view, parent);\n\n\t\tconst disposables = [\n\t\t\tthis.view.onDidChangeVisibility(this.onVisibilityChanged, this),\n\t\t\tthis.view.onDidChangeNodeState(this.onNodeStateChanged, this)\n\t\t];\n\n\t\tif (viewSupportsAutoRefresh(this.view)) {\n\t\t\tdisposables.push(this.view.onDidChangeAutoRefresh(this.onAutoRefreshChanged, this));\n\t\t}\n\n\t\tthis._disposable = Disposable.from(...disposables);\n\t}\n\n\t@debug()\n\tdispose() {\n\t\tvoid this.unsubscribe();\n\n\t\tif (this._disposable !== undefined) {\n\t\t\tthis._disposable.dispose();\n\t\t}\n\t}\n\n\tprivate _canSubscribe: boolean = true;\n\tprotected get canSubscribe(): boolean {\n\t\treturn this._canSubscribe;\n\t}\n\tprotected set canSubscribe(value: boolean) {\n\t\tif (this._canSubscribe === value) return;\n\n\t\tthis._canSubscribe = value;\n\n\t\tvoid this.ensureSubscription();\n\t\tif (value) {\n\t\t\tvoid this.triggerChange();\n\t\t}\n\t}\n\n\tprotected abstract subscribe(): Disposable | undefined | Promise<Disposable | undefined>;\n\n\t@debug()\n\tprotected async unsubscribe(): Promise<void> {\n\t\tif (this._subscription !== undefined) {\n\t\t\tconst subscriptionPromise = this._subscription;\n\t\t\tthis._subscription = undefined;\n\n\t\t\tconst subscription = await subscriptionPromise;\n\t\t\tif (subscription !== undefined) {\n\t\t\t\tsubscription.dispose();\n\t\t\t}\n\t\t}\n\t}\n\n\t@debug()\n\tprotected onAutoRefreshChanged() {\n\t\tthis.onVisibilityChanged({ visible: this.view.visible });\n\t}\n\n\tprotected onParentStateChanged?(state: TreeItemCollapsibleState): void;\n\tprotected onStateChanged?(state: TreeItemCollapsibleState): void;\n\n\tprotected _state: TreeItemCollapsibleState | undefined;\n\tprotected onNodeStateChanged(e: TreeViewNodeStateChangeEvent<ViewNode>) {\n\t\tif (e.element === this) {\n\t\t\tthis._state = e.state;\n\t\t\tif (this.onStateChanged !== undefined) {\n\t\t\t\tthis.onStateChanged(e.state);\n\t\t\t}\n\t\t} else if (e.element === this.parent) {\n\t\t\tif (this.onParentStateChanged !== undefined) {\n\t\t\t\tthis.onParentStateChanged(e.state);\n\t\t\t}\n\t\t}\n\t}\n\n\t@debug()\n\tprotected onVisibilityChanged(e: TreeViewVisibilityChangeEvent) {\n\t\tvoid this.ensureSubscription();\n\n\t\tif (e.visible) {\n\t\t\tvoid this.triggerChange();\n\t\t}\n\t}\n\n\t@debug()\n\tasync ensureSubscription() {\n\t\t// We only need to subscribe if we are visible and if auto-refresh enabled (when supported)\n\t\tif (\n\t\t\t!this.canSubscribe ||\n\t\t\t!this.view.visible ||\n\t\t\t(viewSupportsAutoRefresh(this.view) && !this.view.autoRefresh)\n\t\t) {\n\t\t\tawait this.unsubscribe();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If we already have a subscription, just kick out\n\t\tif (this._subscription !== undefined) return;\n\n\t\tthis._subscription = Promise.resolve(this.subscribe());\n\t\tawait this._subscription;\n\t}\n}\n\ninterface AutoRefreshableView {\n\tautoRefresh: boolean;\n\tonDidChangeAutoRefresh: Event<void>;\n}\nexport function viewSupportsAutoRefresh(view: View): view is View & AutoRefreshableView {\n\treturn Functions.is<View & AutoRefreshableView>(view, 'onDidChangeAutoRefresh');\n}\n\nexport function viewSupportsNodeDismissal(view: View): view is View & { dismissNode(node: ViewNode): void } {\n\treturn typeof (view as View & { dismissNode(node: ViewNode): void }).dismissNode === 'function';\n}\n","import { Command, ThemeIcon, TreeItem, TreeItemCollapsibleState, Uri } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { View } from '../viewBase';\nimport { PageableViewNode, ResourceType, unknownGitUri, ViewNode } from './viewNode';\n\nexport class MessageNode extends ViewNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tprivate readonly _message: string,\n\t\tprivate readonly _description?: string,\n\t\tprivate readonly _tooltip?: string,\n\t\tprivate readonly _iconPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this._message, TreeItemCollapsibleState.None);\n\t\titem.contextValue = ResourceType.Message;\n\t\titem.description = this._description;\n\t\titem.tooltip = this._tooltip;\n\t\titem.iconPath = this._iconPath;\n\t\treturn item;\n\t}\n}\n\nexport class CommandMessageNode extends MessageNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tprivate readonly _command: Command,\n\t\tmessage: string,\n\t\tdescription?: string,\n\t\ttooltip?: string,\n\t\ticonPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon\n\t) {\n\t\tsuper(view, parent, message, description, tooltip, iconPath);\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = super.getTreeItem();\n\t\tif (item instanceof TreeItem) {\n\t\t\titem.command = this._command;\n\t\t\treturn item;\n\t\t}\n\n\t\treturn item.then(i => {\n\t\t\ti.command = this._command;\n\t\t\treturn i;\n\t\t});\n\t}\n}\n\nexport class UpdateableMessageNode extends ViewNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly id: string,\n\t\tprivate _message: string,\n\t\tprivate _tooltip?: string,\n\t\tprivate _iconPath?:\n\t\t\t| string\n\t\t\t| Uri\n\t\t\t| {\n\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\tdark: string | Uri;\n\t\t\t  }\n\t\t\t| ThemeIcon\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this._message, TreeItemCollapsibleState.None);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Message;\n\t\titem.tooltip = this._tooltip;\n\t\titem.iconPath = this._iconPath;\n\t\treturn item;\n\t}\n\n\tupdate(\n\t\tchanges: {\n\t\t\tmessage?: string;\n\t\t\ttooltip?: string | null;\n\t\t\ticonPath?:\n\t\t\t\t| string\n\t\t\t\t| null\n\t\t\t\t| Uri\n\t\t\t\t| {\n\t\t\t\t\t\tlight: string | Uri;\n\t\t\t\t\t\tdark: string | Uri;\n\t\t\t\t  }\n\t\t\t\t| ThemeIcon;\n\t\t},\n\t\tview: View\n\t) {\n\t\tif (changes.message !== undefined) {\n\t\t\tthis._message = changes.message;\n\t\t}\n\n\t\tif (changes.tooltip !== undefined) {\n\t\t\tthis._tooltip = changes.tooltip === null ? undefined : changes.tooltip;\n\t\t}\n\n\t\tif (changes.iconPath !== undefined) {\n\t\t\tthis._iconPath = changes.iconPath === null ? undefined : changes.iconPath;\n\t\t}\n\n\t\tview.triggerNodeChange(this);\n\t}\n}\n\nexport abstract class PagerNode extends ViewNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode & PageableViewNode,\n\t\tprotected readonly message: string,\n\t\tmaxCount: number | undefined,\n\t\tprivate readonly _previousNode?: ViewNode,\n\t\tprivate readonly _pageSize: number = Container.config.views.pageItemLimit\n\t) {\n\t\tsuper(unknownGitUri, view, parent);\n\n\t\tparent.maxCount = maxCount;\n\t}\n\n\tshowMore() {\n\t\treturn this.view.showMoreNodeChildren(\n\t\t\tthis.parent! as ViewNode & PageableViewNode,\n\t\t\tthis._pageSize,\n\t\t\tthis._previousNode\n\t\t);\n\t}\n\n\tshowAll() {\n\t\treturn this.view.showMoreNodeChildren(this.parent! as ViewNode & PageableViewNode, 0, this._previousNode);\n\t}\n\n\tgetChildren(): ViewNode[] | Promise<ViewNode[]> {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem | Promise<TreeItem> {\n\t\tconst item = new TreeItem(this.message, TreeItemCollapsibleState.None);\n\t\titem.contextValue = ResourceType.Pager;\n\t\titem.command = this.getCommand();\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-ellipsis.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-ellipsis.svg')\n\t\t};\n\t\treturn item;\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\treturn {\n\t\t\ttitle: 'Show More',\n\t\t\tcommand: 'gitlens.views.showMoreChildren',\n\t\t\targuments: [this]\n\t\t};\n\t}\n}\n\nexport class ShowMoreNode extends PagerNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode & PageableViewNode,\n\t\titemType: string,\n\t\tmaxCount: number | undefined,\n\t\tpreviousNode: ViewNode,\n\t\tpageSize?: number\n\t) {\n\t\tsuper(\n\t\t\tview,\n\t\t\tparent,\n\t\t\tpageSize === 0\n\t\t\t\t? `Show All ${itemType} ${GlyphChars.Space}${GlyphChars.Dash}${GlyphChars.Space} this may take a while`\n\t\t\t\t: `Show More ${itemType}`,\n\t\t\tmaxCount,\n\t\t\tpreviousNode,\n\t\t\tpageSize\n\t\t);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, Selection, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitFile, GitLogCommit, GitUri, StatusFileFormatter } from '../../git/gitService';\nimport { View } from '../viewBase';\nimport { ResourceType, ViewNode, ViewRefFileNode } from './viewNode';\n\nexport class CommitFileNode extends ViewRefFileNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly file: GitFile,\n\t\tpublic commit: GitLogCommit,\n\t\tprivate readonly _options: { displayAsCommit?: boolean; inFileHistory?: boolean; selection?: Selection } = {}\n\t) {\n\t\tsuper(GitUri.fromFile(file, commit.repoPath, commit.sha), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this._options.displayAsCommit ? this.commit.sha : this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget priority(): number {\n\t\treturn 0;\n\t}\n\n\tget ref(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tif (!this.commit.isFile) {\n\t\t\t// See if we can get the commit directly from the multi-file commit\n\t\t\tconst commit = this.commit.toFileCommit(this.file);\n\t\t\tif (commit === undefined) {\n\t\t\t\tconst log = await Container.git.getLogForFile(this.repoPath, this.file.fileName, {\n\t\t\t\t\tmaxCount: 2,\n\t\t\t\t\tref: this.commit.sha\n\t\t\t\t});\n\t\t\t\tif (log !== undefined) {\n\t\t\t\t\tthis.commit = log.commits.get(this.commit.sha) || this.commit;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.commit = commit;\n\t\t\t}\n\t\t}\n\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.contextValue = this.resourceType;\n\t\titem.description = this.description;\n\t\titem.tooltip = this.tooltip;\n\n\t\tif (this._options.displayAsCommit && this.view.config.avatars) {\n\t\t\titem.iconPath = this.commit.getGravatarUri(Container.config.defaultGravatarsStyle);\n\t\t} else {\n\t\t\tconst icon = GitFile.getStatusIcon(this.file.status);\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', icon)),\n\t\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', icon))\n\t\t\t};\n\t\t}\n\n\t\titem.command = this.getCommand();\n\n\t\t// Only cache the label/description/tooltip for a single refresh\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t\tthis._tooltip = undefined;\n\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description === undefined) {\n\t\t\tthis._description = this._options.displayAsCommit\n\t\t\t\t? CommitFormatter.fromTemplate(this.getCommitDescriptionTemplate(), this.commit, {\n\t\t\t\t\t\ttruncateMessageAtNewLine: true,\n\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t\t\t  })\n\t\t\t\t: StatusFileFormatter.fromTemplate(this.getCommitFileDescriptionTemplate(), this.file, {\n\t\t\t\t\t\trelativePath: this.relativePath\n\t\t\t\t  });\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName === undefined) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label === undefined) {\n\t\t\tthis._label = this._options.displayAsCommit\n\t\t\t\t? CommitFormatter.fromTemplate(this.getCommitTemplate(), this.commit, {\n\t\t\t\t\t\ttruncateMessageAtNewLine: true,\n\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t\t\t  })\n\t\t\t\t: StatusFileFormatter.fromTemplate(this.getCommitFileTemplate(), this.file, {\n\t\t\t\t\t\trelativePath: this.relativePath\n\t\t\t\t  });\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._tooltip = undefined;\n\t}\n\n\tprotected get resourceType(): string {\n\t\tif (!this.commit.isUncommitted) {\n\t\t\treturn `${ResourceType.File}+committed${this._options.inFileHistory ? '+history' : ''}`;\n\t\t}\n\n\t\treturn this.commit.isUncommittedStaged ? `${ResourceType.File}+staged` : `${ResourceType.File}+unstaged`;\n\t}\n\n\tprivate _tooltip: string | undefined;\n\tget tooltip() {\n\t\tif (this._tooltip === undefined) {\n\t\t\tif (this._options.displayAsCommit) {\n\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\tconst status = StatusFileFormatter.fromTemplate('${status}${ (originalPath)}', this.file);\n\t\t\t\tthis._tooltip = CommitFormatter.fromTemplate(\n\t\t\t\t\tthis.commit.isUncommitted\n\t\t\t\t\t\t? `\\${author} ${GlyphChars.Dash} \\${id}\\n${status}\\n\\${ago} (\\${date})`\n\t\t\t\t\t\t: `\\${author} ${\n\t\t\t\t\t\t\t\tGlyphChars.Dash\n\t\t\t\t\t\t  } \\${id}\\n${status}\\n\\${ago} (\\${date})\\n\\n\\${message}${this.commit.getFormattedDiffStatus({\n\t\t\t\t\t\t\t\texpand: true,\n\t\t\t\t\t\t\t\tprefix: '\\n\\n',\n\t\t\t\t\t\t\t\tseparator: '\\n'\n\t\t\t\t\t\t  })}`,\n\t\t\t\t\tthis.commit,\n\t\t\t\t\t{\n\t\t\t\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis._tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\t\t'${file}\\n${directory}/\\n\\n${status}${ (originalPath)}',\n\t\t\t\t\tthis.file\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn this._tooltip;\n\t}\n\n\tprotected getCommitTemplate() {\n\t\treturn this.view.config.commitFormat;\n\t}\n\n\tprotected getCommitDescriptionTemplate() {\n\t\treturn this.view.config.commitDescriptionFormat;\n\t}\n\n\tprotected getCommitFileTemplate() {\n\t\treturn this.view.config.commitFileFormat;\n\t}\n\n\tprotected getCommitFileDescriptionTemplate() {\n\t\treturn this.view.config.commitFileDescriptionFormat;\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\tlet line;\n\t\tif (this.commit.line !== undefined) {\n\t\t\tline = this.commit.line.to.line - 1;\n\t\t} else {\n\t\t\tline = this._options.selection !== undefined ? this._options.selection.active.line : 0;\n\t\t}\n\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\tline: line,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Compare File with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [GitUri.fromFile(this.file, this.commit.repoPath), commandArgs]\n\t\t};\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout, ViewsFilesConfig } from '../../configuration';\nimport { GitUri } from '../../git/gitService';\nimport { Arrays } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { ResourceType, ViewNode } from './viewNode';\n\nexport interface FileNode extends ViewNode {\n\tfolderName: string;\n\tlabel?: string;\n\tpriority: number;\n\trelativePath?: string;\n\troot?: Arrays.HierarchicalItem<FileNode>;\n}\n\nexport class FolderNode extends ViewNode<ViewWithFiles> {\n\treadonly priority: number = 1;\n\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly folderName: string,\n\t\tpublic readonly root: Arrays.HierarchicalItem<FileNode>,\n\t\tprivate readonly containsWorkingFiles?: boolean,\n\t\tpublic readonly relativePath?: string\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.folderName;\n\t}\n\n\tgetChildren(): (FolderNode | FileNode)[] {\n\t\tif (this.root.descendants === undefined || this.root.children === undefined) return [];\n\n\t\tlet children: (FolderNode | FileNode)[];\n\n\t\tconst nesting = FolderNode.getFileNesting(\n\t\t\tthis.view.config.files,\n\t\t\tthis.root.descendants,\n\t\t\tthis.relativePath === undefined\n\t\t);\n\t\tif (nesting !== ViewFilesLayout.List) {\n\t\t\tchildren = [];\n\t\t\tfor (const folder of this.root.children.values()) {\n\t\t\t\tif (folder.value === undefined) {\n\t\t\t\t\tchildren.push(\n\t\t\t\t\t\tnew FolderNode(\n\t\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\tthis.repoPath,\n\t\t\t\t\t\t\tfolder.name,\n\t\t\t\t\t\t\tfolder,\n\t\t\t\t\t\t\tthis.containsWorkingFiles,\n\t\t\t\t\t\t\tfolder.relativePath\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfolder.value.relativePath = this.root.relativePath;\n\t\t\t\tchildren.push(folder.value);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.root.descendants.forEach(n => (n.relativePath = this.root.relativePath));\n\t\t\tchildren = this.root.descendants;\n\t\t}\n\n\t\tchildren.sort((a, b) => {\n\t\t\treturn (\n\t\t\t\t(a instanceof FolderNode ? -1 : 1) - (b instanceof FolderNode ? -1 : 1) ||\n\t\t\t\ta.priority - b.priority ||\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t);\n\t\t});\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.Folder;\n\t\tif (this.containsWorkingFiles) {\n\t\t\titem.contextValue += '+working';\n\t\t}\n\t\titem.iconPath = ThemeIcon.Folder;\n\t\titem.tooltip = this.label;\n\t\treturn item;\n\t}\n\n\tget label(): string {\n\t\treturn this.folderName;\n\t}\n\n\tstatic getFileNesting<T extends FileNode>(\n\t\tconfig: ViewsFilesConfig,\n\t\tchildren: T[],\n\t\tisRoot: boolean\n\t): ViewFilesLayout {\n\t\tconst nesting = config.layout || ViewFilesLayout.Auto;\n\t\tif (nesting === ViewFilesLayout.Auto) {\n\t\t\tif (isRoot || config.compact) {\n\t\t\t\tconst nestingThreshold = config.threshold || 5;\n\t\t\t\tif (children.length <= nestingThreshold) return ViewFilesLayout.List;\n\t\t\t}\n\t\t\treturn ViewFilesLayout.Tree;\n\t\t}\n\t\treturn nesting;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { ViewFilesLayout } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitBranch, GitLogCommit } from '../../git/gitService';\nimport { Arrays, Iterables, Strings } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { FileNode, FolderNode } from './folderNode';\nimport { ResourceType, ViewNode, ViewRefNode } from './viewNode';\n\nexport class CommitNode extends ViewRefNode<ViewWithFiles> {\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\tpublic readonly commit: GitLogCommit,\n\t\tpublic readonly branch?: GitBranch,\n\t\tprivate readonly getBranchAndTagTips?: (sha: string) => string | undefined,\n\t\tprivate readonly _options: { expand?: boolean } = {}\n\t) {\n\t\tsuper(commit.toGitUri(), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\tget ref(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tconst commit = this.commit;\n\t\tlet children: FileNode[] = [\n\t\t\t...Iterables.map(commit.files, s => new CommitFileNode(this.view, this, s, commit.toFileCommit(s)))\n\t\t];\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort((a, b) =>\n\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t);\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst label = CommitFormatter.fromTemplate(this.view.config.commitFormat, this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\tgetBranchAndTagTips: this.getBranchAndTagTips,\n\t\t\ttruncateMessageAtNewLine: true\n\t\t});\n\n\t\tconst item = new TreeItem(\n\t\t\tlabel,\n\t\t\tthis._options.expand ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.contextValue = ResourceType.Commit;\n\t\tif (this.branch !== undefined && this.branch.current) {\n\t\t\titem.contextValue += '+current';\n\t\t}\n\t\titem.description = CommitFormatter.fromTemplate(this.view.config.commitDescriptionFormat, this.commit, {\n\t\t\ttruncateMessageAtNewLine: true,\n\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t});\n\n\t\tif (this.view.config.avatars) {\n\t\t\titem.iconPath = this.commit.getGravatarUri(Container.config.defaultGravatarsStyle);\n\t\t} else {\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-commit.svg'),\n\t\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-commit.svg')\n\t\t\t};\n\t\t}\n\n\t\titem.tooltip = CommitFormatter.fromTemplate(\n\t\t\tthis.commit.isUncommitted\n\t\t\t\t? `\\${author} ${GlyphChars.Dash} \\${id}\\n\\${ago} (\\${date})`\n\t\t\t\t: `\\${author} \\${(email) }${GlyphChars.Dash} \\${id}\\${ (tips)}\\n\\${ago} (\\${date})\\n\\n\\${message}`,\n\t\t\tthis.commit,\n\t\t\t{\n\t\t\t\tdateFormat: Container.config.defaultDateFormat,\n\t\t\t\tgetBranchAndTagTips: this.getBranchAndTagTips\n\t\t\t}\n\t\t);\n\n\t\tif (!this.commit.isUncommitted) {\n\t\t\titem.tooltip += this.commit.getFormattedDiffStatus({\n\t\t\t\texpand: true,\n\t\t\t\tprefix: '\\n\\n',\n\t\t\t\tseparator: '\\n'\n\t\t\t});\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Compare File with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [this.uri, commandArgs]\n\t\t};\n\t}\n}\n","'use strict';\nimport { GitLogCommit } from '../../git/gitService';\nimport { MessageNode } from './common';\nimport { ViewNode } from './viewNode';\n\nconst markers: [number, string][] = [\n\t[0, 'Less than a week ago'],\n\t[7, 'Over a week ago'],\n\t[30, 'Over a month ago'],\n\t[90, 'Over 3 months ago']\n];\n\n// eslint-disable-next-line consistent-return\nexport function* insertDateMarkers<T extends ViewNode & { commit: GitLogCommit }>(\n\titerable: Iterable<T>,\n\tparent: ViewNode,\n\tskip?: number,\n\t{ show }: { show: boolean } = { show: true }\n): Iterable<ViewNode> {\n\tif (!parent.view.config.showRelativeDateMarkers || !show) {\n\t\treturn yield* iterable;\n\t}\n\n\tlet index = skip || 0;\n\tlet time = undefined;\n\tconst now = Date.now();\n\n\tlet first = true;\n\n\tfor (const node of iterable) {\n\t\tif (index < markers.length) {\n\t\t\tlet [daysAgo, marker] = markers[index];\n\t\t\tif (time === undefined) {\n\t\t\t\tconst date = new Date(now);\n\t\t\t\ttime = date.setDate(date.getDate() - daysAgo);\n\t\t\t}\n\n\t\t\tconst date = new Date(node.commit.committerDate.setUTCHours(0, 0, 0, 0)).getTime();\n\t\t\tif (date <= time) {\n\t\t\t\twhile (index < markers.length - 1) {\n\t\t\t\t\t[daysAgo] = markers[index + 1];\n\t\t\t\t\tconst nextDate = new Date(now);\n\t\t\t\t\tconst nextTime = nextDate.setDate(nextDate.getDate() - daysAgo);\n\n\t\t\t\t\tif (date > nextTime) break;\n\n\t\t\t\t\tindex++;\n\t\t\t\t\ttime = undefined;\n\t\t\t\t\t[, marker] = markers[index];\n\t\t\t\t}\n\n\t\t\t\t// Don't show the last marker as the first entry -- since it could be wildly far off\n\t\t\t\tif (!first || index < markers.length - 1) {\n\t\t\t\t\tyield new MessageNode(parent.view, parent, marker);\n\t\t\t\t}\n\n\t\t\t\tindex++;\n\t\t\t\ttime = undefined;\n\t\t\t}\n\t\t}\n\n\t\tfirst = false;\n\t\tyield node;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitBranch, GitTrackingState, GitUri } from '../../git/gitService';\nimport { Iterables, Strings } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { CommitNode } from './commitNode';\nimport { ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, ViewNode } from './viewNode';\nimport { BranchNode } from './branchNode';\n\nexport interface BranchTrackingStatus {\n\tref: string;\n\trepoPath: string;\n\tstate: GitTrackingState;\n\tupstream?: string;\n}\n\nexport class BranchTrackingStatusNode extends ViewNode<ViewWithFiles> implements PageableViewNode {\n\tstatic key = ':status:upstream';\n\tstatic getId(repoPath: string, name: string, root: boolean, upstream: string, direction: string): string {\n\t\treturn `${BranchNode.getId(repoPath, name, root)}${this.key}(${upstream}|${direction})`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\tpublic readonly status: BranchTrackingStatus,\n\t\tpublic readonly direction: 'ahead' | 'behind',\n\t\t// Specifies that the node is shown as a root under the repository node\n\t\tprivate readonly _root: boolean = false\n\t) {\n\t\tsuper(GitUri.fromRepoPath(status.repoPath), view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn BranchTrackingStatusNode.getId(\n\t\t\tthis.status.repoPath,\n\t\t\tthis.status.ref,\n\t\t\tthis._root,\n\t\t\tthis.status.upstream!,\n\t\t\tthis.direction\n\t\t);\n\t}\n\n\tget repoPath(): string {\n\t\treturn this.uri.repoPath!;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst ahead = this.direction === 'ahead';\n\t\tconst range = ahead\n\t\t\t? `${this.status.upstream}..${this.status.ref}`\n\t\t\t: `${this.status.ref}..${this.status.upstream}`;\n\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit,\n\t\t\tref: range\n\t\t});\n\t\tif (log === undefined) return [];\n\n\t\tlet children;\n\t\tif (ahead) {\n\t\t\t// Since the last commit when we are looking 'ahead' can have no previous (because of the range given) -- look it up\n\t\t\tconst commits = [...log.commits.values()];\n\t\t\tconst commit = commits[commits.length - 1];\n\t\t\tif (commit.previousSha === undefined) {\n\t\t\t\tconst previousLog = await Container.git.getLog(this.uri.repoPath!, { maxCount: 2, ref: commit.sha });\n\t\t\t\tif (previousLog !== undefined) {\n\t\t\t\t\tcommits[commits.length - 1] = Iterables.first(previousLog.commits.values());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchildren = [\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(commits, c => new CommitNode(this.view, this, c, this.branch)),\n\t\t\t\t\tthis,\n\t\t\t\t\t1\n\t\t\t\t)\n\t\t\t];\n\t\t} else {\n\t\t\tchildren = [\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(log.commits.values(), c => new CommitNode(this.view, this, c, this.branch)),\n\t\t\t\t\tthis,\n\t\t\t\t\t1\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\n\t\tif (log.truncated) {\n\t\t\tchildren.push(new ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst ahead = this.direction === 'ahead';\n\t\tconst label = ahead\n\t\t\t? `${Strings.pluralize('commit', this.status.state.ahead)} ahead`\n\t\t\t: `${Strings.pluralize('commit', this.status.state.behind)} behind`;\n\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\tif (this._root) {\n\t\t\titem.contextValue = ahead ? ResourceType.StatusAheadOfUpstream : ResourceType.StatusBehindUpstream;\n\t\t} else {\n\t\t\titem.contextValue = ahead\n\t\t\t\t? ResourceType.BranchStatusAheadOfUpstream\n\t\t\t\t: ResourceType.BranchStatusBehindUpstream;\n\t\t}\n\t\titem.tooltip = `${label}${ahead ? ' of ' : ''}${this.status.upstream}`;\n\n\t\tconst iconSuffix = ahead ? 'upload' : 'download';\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-${iconSuffix}.svg`),\n\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-${iconSuffix}.svg`)\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitLog, GitUri } from '../../git/gitService';\nimport { debug, gate, Iterables, Promises } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { CommitNode } from './commitNode';\nimport { ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, ViewNode } from './viewNode';\n\nexport interface CommitsQueryResults {\n\tlabel: string;\n\tlog: GitLog | undefined;\n}\n\nexport class ResultsCommitsNode extends ViewNode<ViewWithFiles> implements PageableViewNode {\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tprivate _label: string,\n\t\tprivate readonly _commitsQuery: (maxCount: number | undefined) => Promise<CommitsQueryResults>,\n\t\tprivate readonly _options: { expand?: boolean; includeDescription?: boolean } = {}\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\n\t\tthis._options = { expand: true, includeDescription: true, ..._options };\n\t}\n\n\tget id(): string {\n\t\treturn `${this.parent!.id}:results:commits`;\n\t}\n\n\tget type(): ResourceType {\n\t\treturn ResourceType.ResultsCommits;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst { log } = await this.getCommitsQueryResults();\n\t\tif (log === undefined) return [];\n\n\t\tconst options = { expand: this._options.expand && log.count === 1 };\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath);\n\t\tconst children = [\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, getBranchAndTagTips, options)\n\t\t\t\t),\n\t\t\t\tthis,\n\t\t\t\tundefined,\n\t\t\t\t{ show: log.count > 1 }\n\t\t\t)\n\t\t];\n\n\t\tif (log.truncated) {\n\t\t\tchildren.push(\n\t\t\t\tnew ShowMoreNode(this.view, this, 'Results', log.maxCount, children[children.length - 1], this.maxCount)\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet label;\n\t\tlet log;\n\t\tlet state;\n\n\t\ttry {\n\t\t\t({ label, log } = await Promises.timeout(this.getCommitsQueryResults(), 100));\n\t\t\tif (log != null) {\n\t\t\t\tthis.maxCount = log.maxCount;\n\t\t\t}\n\n\t\t\tstate =\n\t\t\t\tlog == null || log.count === 0\n\t\t\t\t\t? TreeItemCollapsibleState.None\n\t\t\t\t\t: this._options.expand || log.count === 1\n\t\t\t\t\t? TreeItemCollapsibleState.Expanded\n\t\t\t\t\t: TreeItemCollapsibleState.Collapsed;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.TimeoutError) {\n\t\t\t\tex.promise.then(({ log }: CommitsQueryResults) => {\n\t\t\t\t\tif (log != null) {\n\t\t\t\t\t\tthis.maxCount = log.maxCount;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.triggerChange(false);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Need to use Collapsed before we have results or the item won't show up in the view until the children are awaited\n\t\t\t// https://github.com/microsoft/vscode/issues/54806 & https://github.com/microsoft/vscode/issues/62214\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t}\n\n\t\tlet description;\n\t\tif (this._options.includeDescription && (await Container.git.getRepositoryCount()) > 1) {\n\t\t\tconst repo = await Container.git.getRepository(this.repoPath);\n\t\t\tdescription = (repo && repo.formattedName) || this.repoPath;\n\t\t}\n\n\t\tconst item = new TreeItem(label || this._label, state);\n\t\titem.contextValue = this.type;\n\t\titem.description = description;\n\t\titem.id = this.id;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh(reset: boolean = false) {\n\t\tif (!reset) return;\n\n\t\tthis._commitsQueryResults = this._commitsQuery(this.maxCount);\n\t}\n\n\tprivate _commitsQueryResults: Promise<CommitsQueryResults> | undefined;\n\n\tprotected getCommitsQueryResults() {\n\t\tif (this._commitsQueryResults === undefined) {\n\t\t\tthis._commitsQueryResults = this._commitsQuery(this.maxCount);\n\t\t}\n\n\t\treturn this._commitsQueryResults;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithCommandArgs } from '../../commands';\nimport { Container } from '../../container';\nimport { GitFile, GitUri, StatusFileFormatter } from '../../git/gitService';\nimport { View } from '../viewBase';\nimport { ResourceType, ViewNode, ViewRefFileNode } from './viewNode';\n\nexport class ResultsFileNode extends ViewRefFileNode {\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\trepoPath: string,\n\t\tpublic readonly file: GitFile,\n\t\tpublic readonly ref1: string,\n\t\tpublic readonly ref2: string\n\t) {\n\t\tsuper(GitUri.fromFile(file, repoPath, ref1 || ref2), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tget ref() {\n\t\treturn this.ref1 || this.ref2;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.contextValue = ResourceType.ResultsFile;\n\t\titem.description = this.description;\n\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t'${file}\\n${directory}/\\n\\n${status}${ (originalPath)}',\n\t\t\tthis.file\n\t\t);\n\n\t\tconst statusIcon = GitFile.getStatusIcon(this.file.status);\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', statusIcon)),\n\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', statusIcon))\n\t\t};\n\n\t\titem.command = this.getCommand();\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description === undefined) {\n\t\t\tthis._description = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.commitFileDescriptionFormat,\n\t\t\t\tthis.file,\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName === undefined) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label === undefined) {\n\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\tthis._label = StatusFileFormatter.fromTemplate('${file}', this.file, {\n\t\t\t\trelativePath: this.relativePath\n\t\t\t});\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t}\n\n\tget priority(): number {\n\t\treturn 0;\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithCommandArgs = {\n\t\t\tlhs: {\n\t\t\t\tsha: this.ref1,\n\t\t\t\turi: this.uri\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: this.ref2,\n\t\t\t\turi:\n\t\t\t\t\tthis.file.status === 'R'\n\t\t\t\t\t\t? GitUri.fromFile(this.file, this.uri.repoPath!, this.ref2, true)\n\t\t\t\t\t\t: this.uri\n\t\t\t},\n\t\t\trepoPath: this.uri.repoPath!,\n\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Open Changes',\n\t\t\tcommand: Commands.DiffWith,\n\t\t\targuments: [this.uri, commandArgs]\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { GitFile, GitUri } from '../../git/gitService';\nimport { Arrays, debug, gate, Iterables, Promises, Strings } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { FileNode, FolderNode } from './folderNode';\nimport { ResultsFileNode } from './resultsFileNode';\nimport { ResourceType, ViewNode } from './viewNode';\n\nexport interface FilesQueryResults {\n\tlabel: string;\n\tdiff: GitFile[] | undefined;\n}\n\nexport class ResultsFilesNode extends ViewNode<ViewWithFiles> {\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly ref1: string,\n\t\tpublic readonly ref2: string,\n\t\tprivate readonly _filesQuery: () => Promise<FilesQueryResults>\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn `${this.parent!.id}:results:files`;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst { diff } = await this.getFilesQueryResults();\n\t\tif (diff === undefined) return [];\n\n\t\tlet children: FileNode[] = [\n\t\t\t...Iterables.map(diff, s => new ResultsFileNode(this.view, this, this.repoPath, s, this.ref1, this.ref2))\n\t\t];\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, this.repoPath, '', hierarchy);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.priority - b.priority ||\n\t\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet label;\n\t\tlet diff;\n\t\tlet state;\n\n\t\ttry {\n\t\t\t({ label, diff } = await Promises.timeout(this.getFilesQueryResults(), 100));\n\t\t\tstate =\n\t\t\t\tdiff == null || diff.length === 0 ? TreeItemCollapsibleState.None : TreeItemCollapsibleState.Expanded;\n\t\t} catch (ex) {\n\t\t\tif (ex instanceof Promises.TimeoutError) {\n\t\t\t\tex.promise.then(() => this.triggerChange(false));\n\t\t\t}\n\n\t\t\t// Need to use Collapsed before we have results or the item won't show up in the view until the children are awaited\n\t\t\t// https://github.com/microsoft/vscode/issues/54806 & https://github.com/microsoft/vscode/issues/62214\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t}\n\n\t\tconst item = new TreeItem(label || 'files changed', state);\n\t\titem.contextValue = ResourceType.ResultsFiles;\n\t\titem.id = this.id;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh(reset: boolean = false) {\n\t\tif (!reset) return;\n\n\t\tthis._filesQueryResults = this._filesQuery();\n\t}\n\n\tprivate _filesQueryResults: Promise<FilesQueryResults> | undefined;\n\n\tgetFilesQueryResults() {\n\t\tif (this._filesQueryResults === undefined) {\n\t\t\tthis._filesQueryResults = this._filesQuery();\n\t\t}\n\n\t\treturn this._filesQueryResults;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { BranchComparison, BranchComparisons, GlyphChars, WorkspaceState } from '../../constants';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoriesView } from '../repositoriesView';\nimport { GitBranch, GitService, GitUri } from '../../git/gitService';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../../quickpicks';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { Container } from '../../container';\nimport { log, Strings } from '../../system';\nimport { FilesQueryResults, ResultsFilesNode } from './resultsFilesNode';\nimport { ViewShowBranchComparison } from '../../config';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class CompareBranchNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':compare-branch';\n\tstatic getId(repoPath: string, name: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _compareWith: BranchComparison | undefined;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly branch: GitBranch) {\n\t\tsuper(uri, view, parent);\n\n\t\tconst comparisons = Container.context.workspaceState.get<BranchComparisons>(WorkspaceState.BranchComparisons);\n\t\tconst compareWith = comparisons && comparisons[branch.id];\n\t\tif (compareWith !== undefined && typeof compareWith === 'string') {\n\t\t\tthis._compareWith = {\n\t\t\t\tref: compareWith,\n\t\t\t\tnotation: Container.config.advanced.useSymmetricDifferenceNotation ? '...' : '..',\n\t\t\t\ttype: this.view.config.showBranchComparison || ViewShowBranchComparison.Working\n\t\t\t};\n\t\t} else {\n\t\t\tthis._compareWith = compareWith;\n\t\t}\n\t}\n\n\tget id(): string {\n\t\treturn CompareBranchNode.getId(this.branch.repoPath, this.branch.name);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._compareWith === undefined) return [];\n\n\t\tif (this._children === undefined) {\n\t\t\tlet ref1 = this._compareWith.ref || 'HEAD';\n\t\t\tif (this.comparisonNotation === '..') {\n\t\t\t\tref1 = (await Container.git.getMergeBase(this.branch.repoPath, ref1, this.branch.ref)) || ref1;\n\t\t\t}\n\n\t\t\tthis._children = [\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'commits',\n\t\t\t\t\tthis.getCommitsQuery.bind(this),\n\t\t\t\t\t{\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t\tincludeDescription: false\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tnew ResultsFilesNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\tref1,\n\t\t\t\t\tthis.compareWithWorkingTree ? '' : this.branch.ref,\n\t\t\t\t\tthis.getFilesQuery.bind(this)\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tlet state: TreeItemCollapsibleState;\n\t\tlet label;\n\t\tlet description;\n\t\tif (this._compareWith === undefined) {\n\t\t\tlabel = `Compare ${this.branch.name}${\n\t\t\t\tthis.compareWithWorkingTree ? ' (working)' : ''\n\t\t\t} with <branch, tag, or ref>`;\n\t\t\tstate = TreeItemCollapsibleState.None;\n\t\t} else {\n\t\t\tlabel = `${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''}`;\n\t\t\tdescription = `${GlyphChars.ArrowLeftRightLong}${GlyphChars.Space} ${GitService.shortenSha(\n\t\t\t\tthis._compareWith.ref,\n\t\t\t\t{\n\t\t\t\t\tstrings: {\n\t\t\t\t\t\tworking: 'Working Tree'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t)}`;\n\t\t\tstate = TreeItemCollapsibleState.Collapsed;\n\t\t}\n\n\t\tconst item = new TreeItem(label, state);\n\t\titem.command = {\n\t\t\ttitle: `Compare ${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''} with${\n\t\t\t\tGlyphChars.Ellipsis\n\t\t\t}`,\n\t\t\tcommand: 'gitlens.views.executeNodeCallback',\n\t\t\targuments: [() => this.compareWith()]\n\t\t};\n\t\titem.contextValue = `${ResourceType.CompareBranch}${this._compareWith === undefined ? '' : '+comparing'}+${\n\t\t\tthis.comparisonNotation === '..' ? 'twodot' : 'threedot'\n\t\t}+${this.comparisonType}`;\n\t\titem.description = description;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(\n\t\t\t\t`images/dark/icon-compare-${this.compareWithWorkingTree ? 'ref-working' : 'refs'}.svg`\n\t\t\t),\n\t\t\tlight: Container.context.asAbsolutePath(\n\t\t\t\t`images/light/icon-compare-${this.compareWithWorkingTree ? 'ref-working' : 'refs'}.svg`\n\t\t\t)\n\t\t};\n\t\titem.id = this.id;\n\t\titem.tooltip = `Click to compare ${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''} with${\n\t\t\tGlyphChars.Ellipsis\n\t\t}`;\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tasync setComparisonNotation(comparisonNotation: '...' | '..') {\n\t\tif (this._compareWith !== undefined) {\n\t\t\tawait this.updateCompareWith({ ...this._compareWith, notation: comparisonNotation });\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\t@log()\n\tasync setComparisonType(comparisonType: Exclude<ViewShowBranchComparison, false>) {\n\t\tif (this._compareWith !== undefined) {\n\t\t\tawait this.updateCompareWith({ ...this._compareWith, type: comparisonType });\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\tprivate get comparisonNotation() {\n\t\treturn (\n\t\t\t(this._compareWith && this._compareWith.notation) ||\n\t\t\t(Container.config.advanced.useSymmetricDifferenceNotation ? '...' : '..')\n\t\t);\n\t}\n\n\tprivate get diffComparisonNotation() {\n\t\t// In git diff the range syntax doesn't mean the same thing as with git log -- since git diff is about comparing endpoints not ranges\n\t\t// see https://git-scm.com/docs/git-diff#Documentation/git-diff.txt-emgitdiffemltoptionsgtltcommitgtltcommitgt--ltpathgt82308203\n\t\t// So inverting the range syntax should be about equivalent for the behavior we want\n\t\treturn this.comparisonNotation === '...' ? '..' : '...';\n\t}\n\n\tprivate get comparisonType() {\n\t\treturn (\n\t\t\t(this._compareWith && this._compareWith.type) ||\n\t\t\tthis.view.config.showBranchComparison ||\n\t\t\tViewShowBranchComparison.Working\n\t\t);\n\t}\n\n\tprivate get compareWithWorkingTree() {\n\t\treturn this.comparisonType === ViewShowBranchComparison.Working;\n\t}\n\n\tprivate async compareWith() {\n\t\tconst pick = await new ReferencesQuickPick(this.branch.repoPath).show(\n\t\t\t`Compare ${this.branch.name}${this.compareWithWorkingTree ? ' (working)' : ''} with${GlyphChars.Ellipsis}`,\n\t\t\t{ allowEnteringRefs: true, checked: this.branch.ref, checkmarks: true }\n\t\t);\n\t\tif (pick === undefined || pick instanceof CommandQuickPickItem) return;\n\n\t\tthis.updateCompareWith({\n\t\t\tref: pick.ref,\n\t\t\tnotation: this.comparisonNotation,\n\t\t\ttype: this.comparisonType\n\t\t});\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\tprivate async getCommitsQuery(maxCount: number | undefined): Promise<CommitsQueryResults> {\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: maxCount,\n\t\t\tref: `${(this._compareWith && this._compareWith.ref) || 'HEAD'}${this.comparisonNotation}${\n\t\t\t\tthis.compareWithWorkingTree ? '' : this.branch.ref\n\t\t\t}`\n\t\t});\n\n\t\tconst count = log !== undefined ? log.count : 0;\n\t\tconst truncated = log !== undefined ? log.truncated : false;\n\n\t\treturn {\n\t\t\tlabel: Strings.pluralize('commit', count, { number: truncated ? `${count}+` : undefined, zero: 'No' }),\n\t\t\tlog: log\n\t\t};\n\t}\n\n\tprivate async getFilesQuery(): Promise<FilesQueryResults> {\n\t\tconst diff = await Container.git.getDiffStatus(\n\t\t\tthis.uri.repoPath!,\n\t\t\t`${(this._compareWith && this._compareWith.ref) || 'HEAD'}${this.diffComparisonNotation}${\n\t\t\t\tthis.compareWithWorkingTree ? '' : this.branch.ref\n\t\t\t}`\n\t\t);\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', diff !== undefined ? diff.length : 0, { zero: 'No' })} changed`,\n\t\t\tdiff: diff\n\t\t};\n\t}\n\n\tprivate async updateCompareWith(compareWith: BranchComparison | undefined) {\n\t\tthis._compareWith = compareWith;\n\n\t\tlet comparisons = Container.context.workspaceState.get<BranchComparisons>(WorkspaceState.BranchComparisons);\n\t\tif (comparisons === undefined) {\n\t\t\tcomparisons = Object.create(null);\n\t\t}\n\n\t\tif (compareWith) {\n\t\t\tcomparisons![this.branch.id] = { ...compareWith };\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\tconst { [this.branch.id]: _, ...rest } = comparisons!;\n\t\t\tcomparisons = rest;\n\t\t}\n\t\tawait Container.context.workspaceState.update(WorkspaceState.BranchComparisons, comparisons);\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GitContributor, GitUri } from '../../git/gitService';\nimport { Iterables, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { PageableViewNode, ResourceType, ViewNode } from './viewNode';\nimport { Container } from '../../container';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { CommitNode } from './commitNode';\nimport { GlyphChars } from '../../constants';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class ContributorNode extends ViewNode<RepositoriesView> implements PageableViewNode {\n\tstatic key = ':contributor';\n\tstatic getId(repoPath: string, name: string, email: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name}|${email})`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly contributor: GitContributor) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.contributor.name;\n\t}\n\n\tget id(): string {\n\t\treturn ContributorNode.getId(this.contributor.repoPath, this.contributor.name, this.contributor.email);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit,\n\t\t\tauthors: [`^${this.contributor.name} <${this.contributor.email}>$`]\n\t\t});\n\t\tif (log === undefined) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath);\n\t\tconst children = [\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, getBranchAndTagTips)\n\t\t\t\t),\n\t\t\t\tthis\n\t\t\t)\n\t\t];\n\n\t\tif (log.truncated) {\n\t\t\tchildren.push(new ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst presence = await Container.vsls.getContactPresence(this.contributor.email);\n\n\t\tconst item = new TreeItem(this.contributor.name, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Contributor;\n\t\titem.description = `${\n\t\t\tpresence != null && presence.status !== 'offline'\n\t\t\t\t? `${presence.statusText} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t\t\t: ''\n\t\t}${this.contributor.email}`;\n\t\titem.tooltip = `${this.contributor.name}${presence != null ? ` (${presence.statusText})` : ''}\\n${\n\t\t\tthis.contributor.email\n\t\t}\\n${Strings.pluralize('commit', this.contributor.count)}`;\n\n\t\tif (this.view.config.avatars) {\n\t\t\titem.iconPath = this.contributor.getGravatarUri(Container.config.defaultGravatarsStyle);\n\t\t}\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { ContributorNode } from './contributorNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { Container } from '../../container';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class ContributorsNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':contributors';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn ContributorsNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst contributors = await this.repo.getContributors();\n\t\tif (contributors.length === 0) return [new MessageNode(this.view, this, 'No contributors could be found.')];\n\n\t\tcontributors.sort((a, b) => b.count - a.count);\n\n\t\tconst children = contributors.map(c => new ContributorNode(this.uri, this.view, this, c));\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Contributors', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Contributors;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-people.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-people.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitReflogRecord, GitUri } from '../../git/gitService';\nimport { Iterables } from '../../system';\nimport { ViewWithFiles } from '../viewBase';\nimport { CommitNode } from './commitNode';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { PageableViewNode, ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class ReflogRecordNode extends ViewNode<ViewWithFiles> implements PageableViewNode {\n\tstatic key = ':reflog-record';\n\tstatic getId(\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tselector: string,\n\t\tcommand: string,\n\t\tcommandArgs: string | undefined,\n\t\tdate: Date\n\t): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${sha}|${selector}|${command}|${commandArgs ||\n\t\t\t''}|${date.getTime()})`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tconstructor(view: ViewWithFiles, parent: ViewNode, public readonly record: GitReflogRecord) {\n\t\tsuper(GitUri.fromRepoPath(record.repoPath), view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn ReflogRecordNode.getId(\n\t\t\tthis.uri.repoPath!,\n\t\t\tthis.record.sha,\n\t\t\tthis.record.selector,\n\t\t\tthis.record.command,\n\t\t\tthis.record.commandArgs,\n\t\t\tthis.record.date\n\t\t);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst range = `${this.record.previousSha}..${this.record.sha}`;\n\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit,\n\t\t\tref: range\n\t\t});\n\t\tif (log === undefined) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst children: (CommitNode | ShowMoreNode)[] = [\n\t\t\t...Iterables.map(log.commits.values(), c => new CommitNode(this.view, this, c))\n\t\t];\n\n\t\tif (log.truncated) {\n\t\t\tchildren.push(new ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\t`${this.record.command}${this.record.commandArgs ? ` ${this.record.commandArgs}` : ''}`,\n\t\t\tTreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.id = this.id;\n\t\titem.description = `${\n\t\t\tthis.record.HEAD.length === 0\n\t\t\t\t? ''\n\t\t\t\t: `${this.record.HEAD} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t}${this.record.formattedDate}`;\n\t\titem.contextValue = ResourceType.ReflogRecord;\n\t\titem.tooltip = `${this.record.HEAD.length === 0 ? '' : `${this.record.HEAD}\\n`}${this.record.command}${\n\t\t\tthis.record.commandArgs ? ` ${this.record.commandArgs}` : ''\n\t\t}${\n\t\t\tthis.record.details ? ` (${this.record.details})` : ''\n\t\t}\\n${this.record.formatDateFromNow()} (${this.record.formatDate()})\\n${this.record.previousShortSha} ${\n\t\t\tGlyphChars.Space\n\t\t}${GlyphChars.ArrowRight}${GlyphChars.Space} ${this.record.shortSha}`;\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { PageableViewNode, ResourceType, ViewNode } from './viewNode';\nimport { RepositoriesView } from '../repositoriesView';\nimport { ReflogRecordNode } from './reflogRecordNode';\nimport { debug, gate } from '../../system';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class ReflogNode extends ViewNode<RepositoriesView> implements PageableViewNode {\n\tstatic key = ':reflog';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn ReflogNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst children = [];\n\n\t\t\tconst reflog = await Container.git.getIncomingActivity(this.repo.path, {\n\t\t\t\tall: true,\n\t\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit\n\t\t\t});\n\t\t\tif (reflog === undefined || reflog.records.length === 0) {\n\t\t\t\treturn [new MessageNode(this.view, this, 'No activity could be found.')];\n\t\t\t}\n\n\t\t\tchildren.push(...reflog.records.map(r => new ReflogRecordNode(this.view, this, r)));\n\n\t\t\tif (reflog.truncated) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew ShowMoreNode(this.view, this, 'Activity', reflog.maxCount, children[children.length - 1])\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Incoming Activity', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Reflog;\n\t\titem.description = 'experimental';\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-activity.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-activity.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport { ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GitUri } from '../../git/gitService';\nimport { Arrays } from '../../system';\nimport { View } from '../viewBase';\nimport { BranchNode } from './branchNode';\nimport { TagNode } from './tagNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class BranchOrTagFolderNode extends ViewNode {\n\tstatic getId(repoPath: string, key: string | undefined, type: string, relativePath: string | undefined): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}:${\n\t\t\tkey === undefined ? type : `${key}:${type}`\n\t\t}-folder(${relativePath})`;\n\t}\n\n\tconstructor(\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly type: 'branch' | 'remote-branch' | 'tag',\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly folderName: string,\n\t\tpublic readonly relativePath: string | undefined,\n\t\tpublic readonly root: Arrays.HierarchicalItem<BranchNode | TagNode>,\n\t\tprivate readonly _key?: string,\n\t\tprivate readonly _expanded: boolean = false\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.folderName;\n\t}\n\n\tget id(): string {\n\t\treturn BranchOrTagFolderNode.getId(this.repoPath, this._key, this.type, this.relativePath);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this.root.descendants === undefined || this.root.children === undefined) return [];\n\n\t\tconst children: (BranchOrTagFolderNode | BranchNode | TagNode)[] = [];\n\n\t\tfor (const folder of this.root.children.values()) {\n\t\t\tif (folder.value === undefined) {\n\t\t\t\t// If the folder contains the current branch, expand it by default\n\t\t\t\tconst expanded =\n\t\t\t\t\tfolder.descendants !== undefined &&\n\t\t\t\t\tfolder.descendants.some(n => n instanceof BranchNode && n.current);\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew BranchOrTagFolderNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis.parent!,\n\t\t\t\t\t\tthis.type,\n\t\t\t\t\t\tthis.repoPath,\n\t\t\t\t\t\tfolder.name,\n\t\t\t\t\t\tfolder.relativePath,\n\t\t\t\t\t\tfolder,\n\t\t\t\t\t\tthis._key,\n\t\t\t\t\t\texpanded\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Make sure to set ourselves as the parent\n\t\t\t(folder.value as any).parent = this;\n\t\t\tchildren.push(folder.value);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\tthis.label,\n\t\t\tthis._expanded ? TreeItemCollapsibleState.Expanded : TreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Folder;\n\t\titem.iconPath = ThemeIcon.Folder;\n\t\titem.tooltip = this.label;\n\t\treturn item;\n\t}\n\n\tget label(): string {\n\t\treturn this.folderName;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitRemote, GitRemoteType, GitUri, Repository } from '../../git/gitService';\nimport { Arrays, log } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchNode } from './branchNode';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class RemoteNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':remote';\n\tstatic getId(repoPath: string, name: string, id: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name}|${id})`;\n\t}\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly remote: GitRemote,\n\t\tpublic readonly repo: Repository\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.remote.name;\n\t}\n\n\tget id(): string {\n\t\treturn RemoteNode.getId(this.remote.repoPath, this.remote.name, this.remote.id);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst branches = await this.repo.getBranches({\n\t\t\t// only show remote branchs for this remote\n\t\t\tfilter: b => b.remote && b.name.startsWith(this.remote.name),\n\t\t\tsort: true\n\t\t});\n\t\tif (branches === undefined) return [];\n\n\t\tconst branchNodes = branches.map(b => new BranchNode(this.uri, this.view, this, b));\n\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return branchNodes;\n\n\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\tbranchNodes,\n\t\t\tn => n.treeHierarchy,\n\t\t\t(...paths: string[]) => paths.join('/'),\n\t\t\tthis.view.config.files.compact\n\t\t);\n\n\t\tconst root = new BranchOrTagFolderNode(\n\t\t\tthis.view,\n\t\t\tthis,\n\t\t\t'remote-branch',\n\t\t\tthis.repo.path,\n\t\t\t'',\n\t\t\tundefined,\n\t\t\thierarchy,\n\t\t\t`remote(${this.remote.name}`\n\t\t);\n\t\tconst children = root.getChildren() as (BranchOrTagFolderNode | BranchNode)[];\n\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tlet arrows;\n\t\tlet left;\n\t\tlet right;\n\t\tfor (const { type } of this.remote.types) {\n\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\tleft = true;\n\n\t\t\t\tif (right) break;\n\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\tright = true;\n\n\t\t\t\tif (left) break;\n\t\t\t}\n\t\t}\n\n\t\tif (left && right) {\n\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t} else if (right) {\n\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t} else if (left) {\n\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t} else {\n\t\t\tarrows = GlyphChars.Dash;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\t`${this.remote.default ? `${GlyphChars.Check} ${GlyphChars.Space}` : ''}${this.remote.name}`,\n\t\t\tTreeItemCollapsibleState.Collapsed\n\t\t);\n\n\t\titem.description =\n\t\t\tthis.remote.provider !== undefined\n\t\t\t\t? `${arrows}${GlyphChars.Space} ${this.remote.provider.name} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} ${this.remote.provider.displayPath}`\n\t\t\t\t: `${arrows}${GlyphChars.Space} ${\n\t\t\t\t\t\tthis.remote.domain\n\t\t\t\t\t\t\t? `${this.remote.domain} ${GlyphChars.Space}${GlyphChars.Dot}${GlyphChars.Space} `\n\t\t\t\t\t\t\t: ''\n\t\t\t\t  }${this.remote.path}`;\n\t\titem.contextValue = ResourceType.Remote;\n\t\tif (this.remote.default) {\n\t\t\titem.contextValue += '+default';\n\t\t}\n\n\t\tif (this.remote.provider !== undefined) {\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-${this.remote.provider.icon}.svg`),\n\t\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-${this.remote.provider.icon}.svg`)\n\t\t\t};\n\t\t} else {\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-remote.svg'),\n\t\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-remote.svg')\n\t\t\t};\n\t\t}\n\n\t\titem.id = this.id;\n\t\titem.tooltip = `${this.remote.name} (${\n\t\t\tthis.remote.provider !== undefined ? this.remote.provider.name : this.remote.domain\n\t\t})\\n${this.remote.provider !== undefined ? this.remote.provider.displayPath : this.remote.path}\\n`;\n\n\t\tfor (const type of this.remote.types) {\n\t\t\titem.tooltip += `\\n${type.url} (${type.type})`;\n\t\t}\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tfetch(options: { progress?: boolean } = {}) {\n\t\treturn this.repo.fetch({ ...options, remote: this.remote.name });\n\t}\n\n\t@log()\n\tasync setAsDefault(state: boolean = true) {\n\t\tvoid (await this.remote.setAsDefault(state));\n\t\tvoid this.parent!.triggerChange();\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { RemoteNode } from './remoteNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class RemotesNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':remotes';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn RemotesNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst remotes = await this.repo.getRemotes({ sort: true });\n\t\tif (remotes === undefined || remotes.length === 0) {\n\t\t\treturn [new MessageNode(this.view, this, 'No remotes could be found')];\n\t\t}\n\n\t\treturn remotes.map(r => new RemoteNode(this.uri, this.view, this, r, this.repo));\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Remotes', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Remotes;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-remote.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-remote.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { GitFile, GitLogCommit } from '../../git/gitService';\nimport { View } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { ResourceType, ViewNode } from './viewNode';\n\nexport class StashFileNode extends CommitFileNode {\n\tconstructor(view: View, parent: ViewNode, file: GitFile, commit: GitLogCommit) {\n\t\tsuper(view, parent, file, commit);\n\t}\n\n\tprotected get resourceType(): ResourceType {\n\t\treturn ResourceType.StashFile;\n\t}\n\n\tprotected getCommitTemplate() {\n\t\treturn this.view.config.stashFormat;\n\t}\n\n\tprotected getCommitDescriptionTemplate() {\n\t\treturn this.view.config.stashDescriptionFormat;\n\t}\n\n\tprotected getCommitFileTemplate() {\n\t\treturn this.view.config.stashFileFormat;\n\t}\n\n\tprotected getCommitFileDescriptionTemplate() {\n\t\treturn this.view.config.stashFileDescriptionFormat;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { CommitFormatter, GitStashCommit } from '../../git/gitService';\nimport { Iterables } from '../../system';\nimport { View } from '../viewBase';\nimport { StashFileNode } from './stashFileNode';\nimport { ResourceType, ViewNode, ViewRefNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class StashNode extends ViewRefNode {\n\tstatic key = ':stash';\n\tstatic getId(repoPath: string, ref: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${ref})`;\n\t}\n\n\tconstructor(view: View, parent: ViewNode, public readonly commit: GitStashCommit) {\n\t\tsuper(commit.toGitUri(), view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.commit.stashName;\n\t}\n\n\tget id(): string {\n\t\treturn StashNode.getId(this.commit.repoPath, this.commit.sha);\n\t}\n\n\tget ref(): string {\n\t\treturn this.commit.sha;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst files = this.commit.files;\n\n\t\t// Check for any untracked files -- since git doesn't return them via `git stash list` :(\n\t\t// See https://stackoverflow.com/questions/12681529/\n\t\tconst log = await Container.git.getLog(this.commit.repoPath, {\n\t\t\tmaxCount: 1,\n\t\t\tref: `${this.commit.stashName}^3`\n\t\t});\n\t\tif (log !== undefined) {\n\t\t\tconst commit = Iterables.first(log.commits.values());\n\t\t\tif (commit !== undefined && commit.files.length !== 0) {\n\t\t\t\t// Since these files are untracked -- make them look that way\n\t\t\t\tcommit.files.forEach(s => (s.status = '?'));\n\t\t\t\tfiles.splice(files.length, 0, ...commit.files);\n\t\t\t}\n\t\t}\n\n\t\tconst children = files.map(s => new StashFileNode(this.view, this, s, this.commit.toFileCommit(s)));\n\t\tchildren.sort((a, b) => a.label.localeCompare(b.label, undefined, { numeric: true, sensitivity: 'base' }));\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\tCommitFormatter.fromTemplate(this.view.config.stashFormat, this.commit, {\n\t\t\t\ttruncateMessageAtNewLine: true,\n\t\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t\t}),\n\t\t\tTreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.id = this.id;\n\t\titem.description = CommitFormatter.fromTemplate(this.view.config.stashDescriptionFormat, this.commit, {\n\t\t\ttruncateMessageAtNewLine: true,\n\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t});\n\t\titem.contextValue = ResourceType.Stash;\n\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\titem.tooltip = CommitFormatter.fromTemplate('${ago} (${date})\\n\\n${message}', this.commit, {\n\t\t\tdateFormat: Container.config.defaultDateFormat\n\t\t});\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { Iterables } from '../../system';\nimport { View } from '../viewBase';\nimport { MessageNode } from './common';\nimport { StashNode } from './stashNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class StashesNode extends ViewNode {\n\tstatic key = ':stashes';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tconstructor(uri: GitUri, view: View, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn StashesNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst stash = await this.repo.getStashList();\n\t\tif (stash === undefined) return [new MessageNode(this.view, this, 'No stashes could be found.')];\n\n\t\treturn [...Iterables.map(stash.commits.values(), c => new StashNode(this.view, this, c))];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Stashes', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Stashes;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-stash.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-stash.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Command, ThemeIcon, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Commands, DiffWithPreviousCommandArgs } from '../../commands';\nimport { Container } from '../../container';\nimport { GitFile, GitLogCommit, GitUri, StatusFileFormatter } from '../../git/gitService';\nimport { Strings } from '../../system';\nimport { View } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { ResourceType, ViewNode } from './viewNode';\n\nexport class StatusFileNode extends ViewNode {\n\tpublic readonly commits: GitLogCommit[];\n\tpublic readonly file: GitFile;\n\tpublic readonly repoPath: string;\n\n\tprivate readonly _hasStagedChanges: boolean;\n\tprivate readonly _hasUnstagedChanges: boolean;\n\n\tconstructor(view: View, parent: ViewNode, repoPath: string, file: GitFile, commits: GitLogCommit[]) {\n\t\tlet hasStagedChanges = false;\n\t\tlet hasUnstagedChanges = false;\n\t\tlet ref = undefined;\n\t\tfor (const c of commits) {\n\t\t\tif (c.isUncommitted) {\n\t\t\t\tif (c.isUncommittedStaged) {\n\t\t\t\t\thasStagedChanges = true;\n\t\t\t\t\tif (!hasUnstagedChanges) {\n\t\t\t\t\t\tref = c.sha;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tref = undefined;\n\t\t\t\t\thasUnstagedChanges = true;\n\t\t\t\t}\n\t\t\t} else if (hasUnstagedChanges) {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tref = c.sha;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tsuper(GitUri.fromFile(file, repoPath, ref), view, parent);\n\n\t\tthis.repoPath = repoPath;\n\t\tthis.file = file;\n\t\tthis.commits = commits;\n\n\t\tthis._hasStagedChanges = hasStagedChanges;\n\t\tthis._hasUnstagedChanges = hasUnstagedChanges;\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.fileName;\n\t}\n\n\tget fileName(): string {\n\t\treturn this.file.fileName;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn this.commits.map(c => new CommitFileNode(this.view, this, this.file, c, { displayAsCommit: true }));\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.None);\n\t\titem.description = this.description;\n\n\t\tif ((this._hasStagedChanges || this._hasUnstagedChanges) && this.commits.length === 1) {\n\t\t\titem.contextValue = ResourceType.File;\n\t\t\tif (this._hasStagedChanges) {\n\t\t\t\titem.contextValue += '+staged';\n\t\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\t\t'${file}\\n${directory}/\\n\\n${status}${ (originalPath)} in Index (staged)',\n\t\t\t\t\tthis.file\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\titem.contextValue += '+unstaged';\n\t\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\t\t'${file}\\n${directory}/\\n\\n${status}${ (originalPath)} in Working Tree',\n\t\t\t\t\tthis.file\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Use the file icon and decorations\n\t\t\titem.resourceUri = GitUri.resolveToUri(this.file.fileName, this.repoPath);\n\t\t\titem.iconPath = ThemeIcon.File;\n\n\t\t\titem.command = this.getCommand();\n\t\t} else {\n\t\t\titem.collapsibleState = TreeItemCollapsibleState.Collapsed;\n\t\t\tif (this._hasStagedChanges || this._hasUnstagedChanges) {\n\t\t\t\titem.contextValue = ResourceType.File;\n\t\t\t\tif (this._hasStagedChanges && this._hasUnstagedChanges) {\n\t\t\t\t\titem.contextValue += '+staged+unstaged';\n\t\t\t\t} else if (this._hasStagedChanges) {\n\t\t\t\t\titem.contextValue += '+staged';\n\t\t\t\t} else {\n\t\t\t\t\titem.contextValue += '+unstaged';\n\t\t\t\t}\n\n\t\t\t\t// Use the file icon and decorations\n\t\t\t\titem.resourceUri = GitUri.resolveToUri(this.file.fileName, this.repoPath);\n\t\t\t\titem.iconPath = ThemeIcon.File;\n\t\t\t} else {\n\t\t\t\titem.contextValue = ResourceType.StatusFileCommits;\n\n\t\t\t\tconst icon = GitFile.getStatusIcon(this.file.status);\n\t\t\t\titem.iconPath = {\n\t\t\t\t\tdark: Container.context.asAbsolutePath(paths.join('images', 'dark', icon)),\n\t\t\t\t\tlight: Container.context.asAbsolutePath(paths.join('images', 'light', icon))\n\t\t\t\t};\n\t\t\t}\n\n\t\t\titem.tooltip = StatusFileFormatter.fromTemplate(\n\t\t\t\t`\\${file}\\n\\${directory}/\\n\\n\\${status}\\${ (originalPath)} in ${this.getChangedIn()}`,\n\t\t\t\tthis.file\n\t\t\t);\n\t\t}\n\n\t\t// Only cache the label/description for a single refresh\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\n\t\treturn item;\n\t}\n\n\tprivate _description: string | undefined;\n\tget description() {\n\t\tif (this._description === undefined) {\n\t\t\tthis._description = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.statusFileDescriptionFormat,\n\t\t\t\t{\n\t\t\t\t\t...this.file,\n\t\t\t\t\tcommit: this.commit\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn this._description;\n\t}\n\n\tprivate _folderName: string | undefined;\n\tget folderName() {\n\t\tif (this._folderName === undefined) {\n\t\t\tthis._folderName = paths.dirname(this.uri.relativePath);\n\t\t}\n\t\treturn this._folderName;\n\t}\n\n\tprivate _label: string | undefined;\n\tget label() {\n\t\tif (this._label === undefined) {\n\t\t\tthis._label = StatusFileFormatter.fromTemplate(\n\t\t\t\tthis.view.config.statusFileFormat,\n\t\t\t\t{\n\t\t\t\t\t...this.file,\n\t\t\t\t\tcommit: this.commit\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trelativePath: this.relativePath\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn this._label;\n\t}\n\n\tget commit() {\n\t\treturn this.commits[0];\n\t}\n\n\tget priority(): number {\n\t\tif (this._hasStagedChanges && !this._hasUnstagedChanges) return -3;\n\t\tif (this._hasStagedChanges) return -2;\n\t\tif (this._hasUnstagedChanges) return -1;\n\t\treturn 0;\n\t}\n\n\tprivate _relativePath: string | undefined;\n\tget relativePath(): string | undefined {\n\t\treturn this._relativePath;\n\t}\n\tset relativePath(value: string | undefined) {\n\t\tthis._relativePath = value;\n\t\tthis._label = undefined;\n\t\tthis._description = undefined;\n\t}\n\n\tprivate getChangedIn(): string {\n\t\tconst changedIn = [];\n\n\t\tlet commits = 0;\n\n\t\tif (this._hasUnstagedChanges) {\n\t\t\tcommits++;\n\t\t\tchangedIn.push('Working Tree');\n\t\t}\n\n\t\tif (this._hasStagedChanges) {\n\t\t\tcommits++;\n\t\t\tchangedIn.push('Index (staged)');\n\t\t}\n\n\t\tif (this.commits.length > commits) {\n\t\t\tcommits = this.commits.length - commits;\n\t\t}\n\n\t\tif (commits > 0) {\n\t\t\tchangedIn.push(Strings.pluralize('commit', commits));\n\t\t}\n\n\t\tif (changedIn.length > 2) {\n\t\t\tchangedIn[changedIn.length - 1] = `and ${changedIn[changedIn.length - 1]}`;\n\t\t}\n\t\treturn changedIn.join(changedIn.length > 2 ? ', ' : ' and ');\n\t}\n\n\tgetCommand(): Command | undefined {\n\t\tconst commandArgs: DiffWithPreviousCommandArgs = {\n\t\t\tcommit: this.commit,\n\t\t\tline: 0,\n\t\t\tshowOptions: {\n\t\t\t\tpreserveFocus: true,\n\t\t\t\tpreview: true\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\ttitle: 'Compare File with Previous Revision',\n\t\t\tcommand: Commands.DiffWithPrevious,\n\t\t\targuments: [GitUri.fromFile(this.file, this.repoPath), commandArgs]\n\t\t};\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewFilesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitStatusFile } from '../../git/git';\nimport {\n\tGitCommitType,\n\tGitFileWithCommit,\n\tGitLog,\n\tGitLogCommit,\n\tGitService,\n\tGitStatus,\n\tGitUri\n} from '../../git/gitService';\nimport { Arrays, Iterables, Objects, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { FileNode, FolderNode } from './folderNode';\nimport { StatusFileNode } from './statusFileNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class StatusFilesNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':status-files';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\treadonly repoPath: string;\n\n\tconstructor(\n\t\tview: RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly status: GitStatus,\n\t\tpublic readonly range: string | undefined\n\t) {\n\t\tsuper(GitUri.fromRepoPath(status.repoPath), view, parent);\n\t\tthis.repoPath = status.repoPath;\n\t}\n\n\tget id(): string {\n\t\treturn StatusFilesNode.getId(this.status.repoPath);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tlet files: GitFileWithCommit[] = [];\n\n\t\tconst repoPath = this.repoPath;\n\n\t\tlet log: GitLog | undefined;\n\t\tif (this.range !== undefined) {\n\t\t\tlog = await Container.git.getLog(repoPath, { maxCount: 0, ref: this.range });\n\t\t\tif (log !== undefined) {\n\t\t\t\tfiles = [\n\t\t\t\t\t...Iterables.flatMap(log.commits.values(), c =>\n\t\t\t\t\t\tc.files.map(s => {\n\t\t\t\t\t\t\tconst file: GitFileWithCommit = { ...s, commit: c };\n\t\t\t\t\t\t\treturn file;\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t];\n\t\t\t}\n\t\t}\n\n\t\tif (this.status.files.length !== 0 && this.includeWorkingTree) {\n\t\t\tfiles.splice(\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t...Iterables.flatMap(this.status.files, s => {\n\t\t\t\t\tif (s.workingTreeStatus !== undefined && s.indexStatus !== undefined) {\n\t\t\t\t\t\t// Decrements the date to guarantee this entry will be sorted after the previous entry (most recent first)\n\t\t\t\t\t\tconst older = new Date();\n\t\t\t\t\t\tolder.setMilliseconds(older.getMilliseconds() - 1);\n\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tthis.toStatusFile(s, GitService.uncommittedSha, GitService.uncommittedStagedSha),\n\t\t\t\t\t\t\tthis.toStatusFile(s, GitService.uncommittedStagedSha, 'HEAD', older)\n\t\t\t\t\t\t];\n\t\t\t\t\t} else if (s.indexStatus !== undefined) {\n\t\t\t\t\t\treturn [this.toStatusFile(s, GitService.uncommittedStagedSha, 'HEAD')];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [this.toStatusFile(s, GitService.uncommittedSha, 'HEAD')];\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\n\t\tfiles.sort((a, b) => b.commit.date.getTime() - a.commit.date.getTime());\n\n\t\tconst groups = Arrays.groupBy(files, s => s.fileName);\n\n\t\tlet children: FileNode[] = [\n\t\t\t...Iterables.map(\n\t\t\t\tObjects.values(groups),\n\t\t\t\tfiles =>\n\t\t\t\t\tnew StatusFileNode(this.view, this, repoPath, files[files.length - 1], files.map(s => s.commit))\n\t\t\t)\n\t\t];\n\n\t\tif (this.view.config.files.layout !== ViewFilesLayout.List) {\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tchildren,\n\t\t\t\tn => n.uri.relativePath.split('/'),\n\t\t\t\t(...parts: string[]) => Strings.normalizePath(paths.join(...parts)),\n\t\t\t\tthis.view.config.files.compact\n\t\t\t);\n\n\t\t\tconst root = new FolderNode(this.view, this, repoPath, '', hierarchy, true);\n\t\t\tchildren = root.getChildren() as FileNode[];\n\t\t} else {\n\t\t\tchildren.sort(\n\t\t\t\t(a, b) =>\n\t\t\t\t\ta.priority - b.priority ||\n\t\t\t\t\ta.label!.localeCompare(b.label!, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t);\n\t\t}\n\n\t\treturn children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet files = this.status.files !== undefined && this.includeWorkingTree ? this.status.files.length : 0;\n\n\t\tif (this.status.upstream !== undefined && this.status.state.ahead > 0) {\n\t\t\tif (files > 0) {\n\t\t\t\tconst aheadFiles = await Container.git.getDiffStatus(this.repoPath, `${this.status.upstream}...`);\n\n\t\t\t\tif (aheadFiles !== undefined) {\n\t\t\t\t\tconst uniques = new Set();\n\t\t\t\t\tfor (const f of this.status.files) {\n\t\t\t\t\t\tuniques.add(f.fileName);\n\t\t\t\t\t}\n\t\t\t\t\tfor (const f of aheadFiles) {\n\t\t\t\t\t\tuniques.add(f.fileName);\n\t\t\t\t\t}\n\n\t\t\t\t\tfiles = uniques.size;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst stats = await Container.git.getChangedFilesCount(this.repoPath, `${this.status.upstream}...`);\n\t\t\t\tif (stats !== undefined) {\n\t\t\t\t\tfiles += stats.files;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst label = `${Strings.pluralize('file', files)} changed`;\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.StatusFiles;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-diff.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-diff.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n\n\tprivate get includeWorkingTree(): boolean {\n\t\treturn this.view.config.includeWorkingTree;\n\t}\n\n\tprivate toStatusFile(file: GitStatusFile, ref: string, previousRef: string, date?: Date): GitFileWithCommit {\n\t\treturn {\n\t\t\tstatus: file.status,\n\t\t\trepoPath: file.repoPath,\n\t\t\tindexStatus: file.indexStatus,\n\t\t\tworkingTreeStatus: file.workingTreeStatus,\n\t\t\tfileName: file.fileName,\n\t\t\toriginalFileName: file.originalFileName,\n\t\t\tcommit: new GitLogCommit(\n\t\t\t\tGitCommitType.LogFile,\n\t\t\t\tfile.repoPath,\n\t\t\t\tref,\n\t\t\t\t'You',\n\t\t\t\tundefined,\n\t\t\t\tdate || new Date(),\n\t\t\t\tdate || new Date(),\n\t\t\t\t'',\n\t\t\t\tfile.fileName,\n\t\t\t\t[file],\n\t\t\t\tfile.status,\n\t\t\t\tfile.originalFileName,\n\t\t\t\tpreviousRef,\n\t\t\t\tfile.fileName\n\t\t\t)\n\t\t};\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitTag, GitUri } from '../../git/gitService';\nimport { Iterables } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { CommitNode } from './commitNode';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, ViewNode, ViewRefNode } from './viewNode';\nimport { emojify } from '../../emojis';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class TagNode extends ViewRefNode<RepositoriesView> implements PageableViewNode {\n\tstatic key = ':tag';\n\tstatic getId(repoPath: string, name: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly tag: GitTag) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.tag.name;\n\t}\n\n\tget id(): string {\n\t\treturn TagNode.getId(this.tag.repoPath, this.tag.name);\n\t}\n\n\tget label(): string {\n\t\treturn this.view.config.branches.layout === ViewBranchesLayout.Tree ? this.tag.getBasename() : this.tag.name;\n\t}\n\n\tget ref(): string {\n\t\treturn this.tag.name;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit,\n\t\t\tref: this.tag.name\n\t\t});\n\t\tif (log === undefined) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(this.uri.repoPath, this.tag.name);\n\t\tconst children = [\n\t\t\t...insertDateMarkers(\n\t\t\t\tIterables.map(\n\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\tc => new CommitNode(this.view, this, c, undefined, getBranchAndTagTips)\n\t\t\t\t),\n\t\t\t\tthis\n\t\t\t)\n\t\t];\n\n\t\tif (log.truncated) {\n\t\t\tchildren.push(new ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1]));\n\t\t}\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(this.label, TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Tag;\n\t\titem.tooltip = `${this.tag.name}${\n\t\t\tthis.tag.annotation === undefined ? '' : `\\n${emojify(this.tag.annotation)}`\n\t\t}`;\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { Arrays } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { MessageNode } from './common';\nimport { TagNode } from './tagNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class TagsNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':tags';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn TagsNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst tags = await this.repo.getTags({ sort: true });\n\t\tif (tags.length === 0) return [new MessageNode(this.view, this, 'No tags could be found.')];\n\n\t\tconst tagNodes = tags.map(t => new TagNode(this.uri, this.view, this, t));\n\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return tagNodes;\n\n\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\ttagNodes,\n\t\t\tn => n.tag.name.split('/'),\n\t\t\t(...paths: string[]) => paths.join('/'),\n\t\t\tthis.view.config.files.compact\n\t\t);\n\n\t\tconst root = new BranchOrTagFolderNode(\n\t\t\tthis.view,\n\t\t\tthis,\n\t\t\t'tag',\n\t\t\tthis.repo.path,\n\t\t\t'',\n\t\t\tundefined,\n\t\t\thierarchy,\n\t\t\t'tags'\n\t\t);\n\t\tconst children = root.getChildren() as (BranchOrTagFolderNode | TagNode)[];\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Tags', TreeItemCollapsibleState.Collapsed);\n\t\titem.id = this.id;\n\t\titem.contextValue = ResourceType.Tags;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-tag.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-tag.svg')\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { Disposable, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport {\n\tGitBranch,\n\tGitStatus,\n\tGitUri,\n\tRepository,\n\tRepositoryChange,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent\n} from '../../git/gitService';\nimport { Dates, debug, gate, log, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { CompareBranchNode } from './compareBranchNode';\nimport { BranchesNode } from './branchesNode';\nimport { BranchNode } from './branchNode';\nimport { BranchTrackingStatusNode } from './branchTrackingStatusNode';\nimport { MessageNode } from './common';\nimport { ContributorsNode } from './contributorsNode';\nimport { ReflogNode } from './reflogNode';\nimport { RemotesNode } from './remotesNode';\nimport { StashesNode } from './stashesNode';\nimport { StatusFilesNode } from './statusFilesNode';\nimport { TagsNode } from './tagsNode';\nimport { ResourceType, SubscribeableViewNode, ViewNode } from './viewNode';\n\nconst hasTimeRegex = /[hHm]/;\n\nexport class RepositoryNode extends SubscribeableViewNode<RepositoriesView> {\n\tstatic key = ':repository';\n\tstatic getId(repoPath: string): string {\n\t\treturn `gitlens${this.key}(${repoPath})`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _lastFetched: number = 0;\n\tprivate _status: Promise<GitStatus | undefined>;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\n\t\tthis._status = this.repo.getStatus();\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.repo.path;\n\t}\n\n\tget id(): string {\n\t\treturn RepositoryNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst children = [];\n\n\t\t\tconst status = await this._status;\n\t\t\tif (status !== undefined) {\n\t\t\t\tconst branch = new GitBranch(\n\t\t\t\t\tstatus.repoPath,\n\t\t\t\t\tstatus.branch,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue,\n\t\t\t\t\tundefined,\n\t\t\t\t\tstatus.sha,\n\t\t\t\t\tstatus.upstream,\n\t\t\t\t\tstatus.state.ahead,\n\t\t\t\t\tstatus.state.behind,\n\t\t\t\t\tstatus.detached\n\t\t\t\t);\n\t\t\t\tchildren.push(new BranchNode(this.uri, this.view, this, branch, true));\n\n\t\t\t\tif (status.state.behind) {\n\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, branch, status, 'behind', true));\n\t\t\t\t}\n\n\t\t\t\tif (status.state.ahead) {\n\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, branch, status, 'ahead', true));\n\t\t\t\t}\n\n\t\t\t\tif (status.state.ahead || (status.files.length !== 0 && this.includeWorkingTree)) {\n\t\t\t\t\tconst range = status.upstream ? `${status.upstream}..${branch.ref}` : undefined;\n\t\t\t\t\tchildren.push(new StatusFilesNode(this.view, this, status, range));\n\t\t\t\t}\n\n\t\t\t\tif (this.view.config.showBranchComparison !== false) {\n\t\t\t\t\tchildren.push(new CompareBranchNode(this.uri, this.view, this, branch));\n\t\t\t\t}\n\n\t\t\t\tif (!this.view.config.repositories.compact) {\n\t\t\t\t\tchildren.push(new MessageNode(this.view, this, '', GlyphChars.Dash.repeat(2), ''));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchildren.push(\n\t\t\t\tnew BranchesNode(this.uri, this.view, this, this.repo),\n\t\t\t\tnew ContributorsNode(this.uri, this.view, this, this.repo)\n\t\t\t);\n\n\t\t\tif (Container.config.insiders) {\n\t\t\t\tchildren.push(new ReflogNode(this.uri, this.view, this, this.repo));\n\t\t\t}\n\n\t\t\tchildren.push(\n\t\t\t\tnew RemotesNode(this.uri, this.view, this, this.repo),\n\t\t\t\tnew StashesNode(this.uri, this.view, this, this.repo),\n\t\t\t\tnew TagsNode(this.uri, this.view, this, this.repo)\n\t\t\t);\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst label = this.repo.formattedName || this.uri.repoPath || '';\n\n\t\tthis._lastFetched = await this.repo.getLastFetched();\n\n\t\tconst lastFetchedTooltip = this.formatLastFetched({\n\t\t\tprefix: `${Strings.pad(GlyphChars.Dash, 2, 2)}Last fetched on `,\n\t\t\tformat: Container.config.defaultDateFormat || 'dddd MMMM Do, YYYY',\n\t\t\tincludeTime: true\n\t\t});\n\n\t\tlet description;\n\t\tlet tooltip = this.repo.formattedName\n\t\t\t? `${this.repo.formattedName}${lastFetchedTooltip}\\n${this.uri.repoPath}`\n\t\t\t: `${this.uri.repoPath}${lastFetchedTooltip}`;\n\t\tlet iconSuffix = '';\n\t\tlet workingStatus = '';\n\n\t\tlet contextValue: string = ResourceType.Repository;\n\t\tif (this.repo.starred) {\n\t\t\tcontextValue += '+starred';\n\t\t}\n\n\t\tconst status = await this._status;\n\t\tif (status !== undefined) {\n\t\t\ttooltip += `\\n\\nCurrent branch is ${status.branch}`;\n\n\t\t\tif (status.files.length !== 0 && this.includeWorkingTree) {\n\t\t\t\tworkingStatus = status.getFormattedDiffStatus({\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tprefix: Strings.pad(GlyphChars.Dot, 2, 2)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst upstreamStatus = status.getUpstreamStatus({\n\t\t\t\tprefix: `${GlyphChars.Space} `\n\t\t\t});\n\n\t\t\tdescription = `${status.branch}${upstreamStatus}${workingStatus}`;\n\n\t\t\ticonSuffix = workingStatus ? '-blue' : '';\n\t\t\tif (status.upstream !== undefined) {\n\t\t\t\ttooltip += ` and is tracking ${status.upstream}\\n${status.getUpstreamStatus({\n\t\t\t\t\tempty: 'No commits ahead or behind',\n\t\t\t\t\texpand: true,\n\t\t\t\t\tseparator: '\\n',\n\t\t\t\t\tsuffix: '\\n'\n\t\t\t\t})}`;\n\n\t\t\t\tif (status.state.behind) {\n\t\t\t\t\tcontextValue += '+behind';\n\t\t\t\t\ticonSuffix = '-red';\n\t\t\t\t}\n\t\t\t\tif (status.state.ahead) {\n\t\t\t\t\ticonSuffix = status.state.behind ? '-yellow' : '-green';\n\t\t\t\t\tcontextValue += '+ahead';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (workingStatus) {\n\t\t\t\ttooltip += `\\n\\nWorking tree has uncommitted changes${status.getFormattedDiffStatus({\n\t\t\t\t\texpand: true,\n\t\t\t\t\tprefix: '\\n',\n\t\t\t\t\tseparator: '\\n'\n\t\t\t\t})}`;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.repo.supportsChangeEvents) {\n\t\t\tdescription = `<!>${description ? ` ${GlyphChars.Space}${description}` : ''}`;\n\t\t\ttooltip += '\\n\\n<!> Unable to automatically detect repository changes';\n\t\t}\n\n\t\tconst item = new TreeItem(label, TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = contextValue;\n\t\titem.description = `${description || ''}${this.formatLastFetched({\n\t\t\tprefix: `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched `\n\t\t})}`;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-repo${iconSuffix}.svg`),\n\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-repo${iconSuffix}.svg`)\n\t\t};\n\t\titem.id = this.id;\n\t\titem.tooltip = tooltip;\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tfetch(options: { all?: boolean; progress?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\treturn this.repo.fetch(options);\n\t}\n\n\t@log()\n\tpull(options: { progress?: boolean; rebase?: boolean } = {}) {\n\t\treturn this.repo.pull(options);\n\t}\n\n\t@log()\n\tpush(options: { force?: boolean; progress?: boolean } = {}) {\n\t\treturn this.repo.push(options);\n\t}\n\n\t@gate()\n\t@debug()\n\tasync refresh() {\n\t\tthis._status = this.repo.getStatus();\n\n\t\tthis._children = undefined;\n\t\tawait this.ensureSubscription();\n\t}\n\n\t@log()\n\tasync star() {\n\t\tawait this.repo.star();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@log()\n\tasync unstar() {\n\t\tawait this.repo.unstar();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\tconst disposables = [this.repo.onDidChange(this.onRepoChanged, this)];\n\n\t\t// if (Container.config.defaultDateStyle === DateStyle.Relative) {\n\t\t//     disposables.push(Functions.interval(() => void this.updateLastFetched(), 60000));\n\t\t// }\n\n\t\tif (this.includeWorkingTree) {\n\t\t\tdisposables.push(this.repo.onDidChangeFileSystem(this.onFileSystemChanged, this), {\n\t\t\t\tdispose: () => this.repo.stopWatchingFileSystem()\n\t\t\t});\n\n\t\t\tthis.repo.startWatchingFileSystem();\n\t\t}\n\n\t\treturn Disposable.from(...disposables);\n\t}\n\n\tprivate get includeWorkingTree(): boolean {\n\t\treturn this.view.config.includeWorkingTree;\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: RepositoryFileSystemChangeEvent) =>\n\t\t\t\t`{ repository: ${e.repository ? e.repository.name : ''}, uris(${e.uris.length}): [${e.uris\n\t\t\t\t\t.slice(0, 1)\n\t\t\t\t\t.map(u => u.fsPath)\n\t\t\t\t\t.join(', ')}${e.uris.length > 1 ? ', ...' : ''}] }`\n\t\t}\n\t})\n\tprivate onFileSystemChanged(e: RepositoryFileSystemChangeEvent) {\n\t\tvoid this.triggerChange();\n\t}\n\n\t@debug({\n\t\targs: {\n\t\t\t0: (e: RepositoryChangeEvent) =>\n\t\t\t\t`{ repository: ${e.repository ? e.repository.name : ''}, changes: ${e.changes.join()} }`\n\t\t}\n\t})\n\tprivate onRepoChanged(e: RepositoryChangeEvent) {\n\t\tif (e.changed(RepositoryChange.Closed)) {\n\t\t\tthis.dispose();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis._children === undefined ||\n\t\t\te.changed(RepositoryChange.Repository) ||\n\t\t\te.changed(RepositoryChange.Config)\n\t\t) {\n\t\t\tvoid this.triggerChange();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Stashes)) {\n\t\t\tconst node = this._children.find(c => c instanceof StashesNode);\n\t\t\tif (node !== undefined) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Remotes)) {\n\t\t\tconst node = this._children.find(c => c instanceof RemotesNode);\n\t\t\tif (node !== undefined) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\n\t\tif (e.changed(RepositoryChange.Tags)) {\n\t\t\tconst node = this._children.find(c => c instanceof TagsNode);\n\t\t\tif (node !== undefined) {\n\t\t\t\tvoid this.view.triggerNodeChange(node);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate formatLastFetched(options: { prefix?: string; format?: string; includeTime?: boolean } = {}) {\n\t\tif (this._lastFetched === 0) return '';\n\n\t\t// if (options.format === undefined && Container.config.defaultDateStyle === DateStyle.Relative) {\n\t\t//     // If less than a day has passed show a relative date\n\t\t//     if (Date.now() - this._lastFetched < Dates.MillisecondsPerDay) {\n\t\t//         return `${options.prefix || ''}${Dates.toFormatter(new Date(this._lastFetched)).fromNow()}`;\n\t\t//     }\n\t\t// }\n\n\t\tlet format = options.format || Container.config.defaultDateShortFormat || 'MMM D, YYYY';\n\t\tif (\n\t\t\t(options.includeTime ||\n\t\t\t\t// If less than a day has passed show the time too\n\t\t\t\t(options.includeTime === undefined && Date.now() - this._lastFetched < Dates.MillisecondsPerDay)) &&\n\t\t\t// If the time is already included don't do anything\n\t\t\t!hasTimeRegex.test(format)\n\t\t) {\n\t\t\tformat = `h:mma, ${format}`;\n\t\t}\n\n\t\treturn `${options.prefix || ''}${Dates.getFormatter(new Date(this._lastFetched)).format(format)}`;\n\t}\n\n\t// @debug()\n\t// private async updateLastFetched() {\n\t//     const prevLastFetched = this._lastFetched;\n\t//     this._lastFetched = await this.repo.getLastFetched();\n\n\t//     // If the fetched date hasn't changed and it was over a day ago, kick out\n\t//     if (this._lastFetched === prevLastFetched && Date.now() - this._lastFetched >= Dates.MillisecondsPerDay) return;\n\n\t//     this.view.triggerNodeChange(this);\n\t// }\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { BranchDateFormatting, GitBranch, GitRemoteType, GitUri } from '../../git/gitService';\nimport { debug, gate, Iterables, log, Strings } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchTrackingStatusNode } from './branchTrackingStatusNode';\nimport { CommitNode } from './commitNode';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, ViewNode, ViewRefNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class BranchNode extends ViewRefNode<RepositoriesView> implements PageableViewNode {\n\tstatic key = ':branch';\n\tstatic getId(repoPath: string, name: string, root: boolean): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${name})${root ? ':root' : ''}`;\n\t}\n\n\treadonly supportsPaging = true;\n\treadonly rememberLastMaxCount = true;\n\tmaxCount: number | undefined = this.view.getNodeLastMaxCount(this);\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: RepositoriesView,\n\t\tparent: ViewNode,\n\t\tpublic readonly branch: GitBranch,\n\t\t// Specifies that the node is shown as a root under the repository node\n\t\tpublic readonly root: boolean = false\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.branch.name;\n\t}\n\n\tget id(): string {\n\t\treturn BranchNode.getId(this.branch.repoPath, this.branch.name, this.root);\n\t}\n\n\tget current(): boolean {\n\t\treturn this.branch.current;\n\t}\n\n\tget label(): string {\n\t\tconst branchName = this.branch.getName();\n\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return branchName;\n\n\t\treturn (this.root && this.current) || this.branch.detached || this.branch.starred\n\t\t\t? branchName\n\t\t\t: this.branch.getBasename();\n\t}\n\n\tget ref(): string {\n\t\treturn this.branch.ref;\n\t}\n\n\tget treeHierarchy(): string[] {\n\t\treturn this.branch.current || this.branch.detached || this.branch.starred\n\t\t\t? [this.branch.name]\n\t\t\t: this.branch.getName().split('/');\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst children = [];\n\t\t\tif (!this.root && this.branch.tracking) {\n\t\t\t\tconst status = {\n\t\t\t\t\tref: this.branch.ref,\n\t\t\t\t\trepoPath: this.branch.repoPath,\n\t\t\t\t\tstate: this.branch.state,\n\t\t\t\t\tupstream: this.branch.tracking\n\t\t\t\t};\n\n\t\t\t\tif (this.branch.state.behind) {\n\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, this.branch, status, 'behind'));\n\t\t\t\t}\n\n\t\t\t\tif (this.branch.state.ahead) {\n\t\t\t\t\tchildren.push(new BranchTrackingStatusNode(this.view, this, this.branch, status, 'ahead'));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : this.view.config.defaultItemLimit,\n\t\t\t\tref: this.ref\n\t\t\t});\n\t\t\tif (log === undefined) return [new MessageNode(this.view, this, 'No commits could be found.')];\n\n\t\t\tconst getBranchAndTagTips = await Container.git.getBranchesAndTagsTipsFn(\n\t\t\t\tthis.uri.repoPath,\n\t\t\t\tthis.branch.name\n\t\t\t);\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(\n\t\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\t\tc => new CommitNode(this.view, this, c, this.branch, getBranchAndTagTips)\n\t\t\t\t\t),\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif (log.truncated) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1])\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis._children = children;\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst name = this.label;\n\t\tlet tooltip = `${this.branch.getName()}${this.current ? ' (current)' : ''}`;\n\t\tlet iconSuffix = '';\n\n\t\tlet contextValue: string = ResourceType.Branch;\n\t\tif (this.current) {\n\t\t\tcontextValue += '+current';\n\t\t}\n\t\tif (this.branch.remote) {\n\t\t\tcontextValue += '+remote';\n\t\t}\n\t\tif (this.branch.starred) {\n\t\t\tcontextValue += '+starred';\n\t\t}\n\t\tif (this.branch.tracking) {\n\t\t\tcontextValue += '+tracking';\n\t\t}\n\n\t\tlet description;\n\t\tif (!this.branch.remote && this.branch.tracking !== undefined) {\n\t\t\tif (this.view.config.showTrackingBranch) {\n\t\t\t\tlet arrows = GlyphChars.Dash;\n\n\t\t\t\tconst remote = await this.branch.getRemote();\n\t\t\t\tif (remote !== undefined) {\n\t\t\t\t\tlet left;\n\t\t\t\t\tlet right;\n\t\t\t\t\tfor (const { type } of remote.types) {\n\t\t\t\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\t\t\t\tleft = true;\n\n\t\t\t\t\t\t\tif (right) break;\n\t\t\t\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\t\t\t\tright = true;\n\n\t\t\t\t\t\t\tif (left) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (left && right) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t\t\t\t} else if (right) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t\t\t\t} else if (left) {\n\t\t\t\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdescription = `${this.branch.getTrackingStatus({ suffix: `${GlyphChars.Space} ` })}${arrows}${\n\t\t\t\t\tGlyphChars.Space\n\t\t\t\t} ${this.branch.tracking}`;\n\t\t\t}\n\t\t\ttooltip += ` is tracking ${this.branch.tracking}\\n${this.branch.getTrackingStatus({\n\t\t\t\tempty: 'up-to-date',\n\t\t\t\texpand: true,\n\t\t\t\tseparator: '\\n'\n\t\t\t})}`;\n\n\t\t\tif (this.branch.state.ahead || this.branch.state.behind) {\n\t\t\t\tif (this.branch.state.behind) {\n\t\t\t\t\tcontextValue += '+behind';\n\t\t\t\t\ticonSuffix = '-red';\n\t\t\t\t}\n\t\t\t\tif (this.branch.state.ahead) {\n\t\t\t\t\tcontextValue += '+ahead';\n\t\t\t\t\ticonSuffix = this.branch.state.behind ? '-yellow' : '-green';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.branch.date !== undefined) {\n\t\t\tdescription = `${description ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}` : ''}${\n\t\t\t\tthis.branch.formattedDate\n\t\t\t}`;\n\n\t\t\ttooltip += `\\nLast commit ${this.branch.formatDateFromNow()} (${this.branch.formatDate(\n\t\t\t\tBranchDateFormatting.dateFormat\n\t\t\t)})`;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\t// Hide the current branch checkmark when the node is displayed as a root under the repository node\n\t\t\t`${!this.root && this.current ? `${GlyphChars.Check} ${GlyphChars.Space}` : ''}${name}`,\n\t\t\tTreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.contextValue = contextValue;\n\t\titem.description = description;\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath(`images/dark/icon-branch${iconSuffix}.svg`),\n\t\t\tlight: Container.context.asAbsolutePath(`images/light/icon-branch${iconSuffix}.svg`)\n\t\t};\n\t\titem.id = this.id;\n\t\titem.tooltip = tooltip;\n\n\t\treturn item;\n\t}\n\n\t@log()\n\tasync star() {\n\t\tawait this.branch.star();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@log()\n\tasync unstar() {\n\t\tawait this.branch.unstar();\n\t\tvoid this.parent!.triggerChange();\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { ViewBranchesLayout } from '../../configuration';\nimport { Container } from '../../container';\nimport { GitUri, Repository } from '../../git/gitService';\nimport { Arrays, debug, gate } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { BranchNode } from './branchNode';\nimport { BranchOrTagFolderNode } from './branchOrTagFolderNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nexport class BranchesNode extends ViewNode<RepositoriesView> {\n\tstatic key = ':branches';\n\tstatic getId(repoPath: string): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\n\tconstructor(uri: GitUri, view: RepositoriesView, parent: ViewNode, public readonly repo: Repository) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\tget id(): string {\n\t\treturn BranchesNode.getId(this.repo.path);\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst branches = await this.repo.getBranches({\n\t\t\t\t// only show local branches\n\t\t\t\tfilter: b => !b.remote,\n\t\t\t\tsort: true\n\t\t\t});\n\t\t\tif (branches === undefined) return [];\n\n\t\t\tconst branchNodes = branches.map(b => new BranchNode(this.uri, this.view, this, b));\n\t\t\tif (this.view.config.branches.layout === ViewBranchesLayout.List) return branchNodes;\n\n\t\t\tconst hierarchy = Arrays.makeHierarchical(\n\t\t\t\tbranchNodes,\n\t\t\t\tn => n.treeHierarchy,\n\t\t\t\t(...paths: string[]) => paths.join('/'),\n\t\t\t\tthis.view.config.files.compact\n\t\t\t);\n\n\t\t\tconst root = new BranchOrTagFolderNode(\n\t\t\t\tthis.view,\n\t\t\t\tthis,\n\t\t\t\t'branch',\n\t\t\t\tthis.repo.path,\n\t\t\t\t'',\n\t\t\t\tundefined,\n\t\t\t\thierarchy,\n\t\t\t\t'branches'\n\t\t\t);\n\t\t\tthis._children = root.getChildren();\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst item = new TreeItem('Branches', TreeItemCollapsibleState.Collapsed);\n\t\titem.contextValue = ResourceType.Branches;\n\t\tif (await this.repo.hasRemotes()) {\n\t\t\titem.contextValue += '+remotes';\n\t\t}\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-branch.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-branch.svg')\n\t\t};\n\t\titem.id = this.id;\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh() {\n\t\tthis._children = undefined;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { CompareView } from '../compareView';\nimport { CompareNode } from './compareNode';\nimport { ResourceType, unknownGitUri, ViewNode } from './viewNode';\n\nexport class ComparePickerNode extends ViewNode<CompareView> {\n\tconstructor(view: CompareView, protected readonly parent: CompareNode) {\n\t\tsuper(unknownGitUri, view, parent);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\treturn [];\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst selectedRef = this.parent.selectedRef;\n\t\tconst repoPath = selectedRef !== undefined ? selectedRef.repoPath : undefined;\n\n\t\tlet description;\n\t\tif (repoPath !== undefined) {\n\t\t\tif ((await Container.git.getRepositoryCount()) > 1) {\n\t\t\t\tconst repo = await Container.git.getRepository(repoPath);\n\t\t\t\tdescription = (repo && repo.formattedName) || repoPath;\n\t\t\t}\n\t\t}\n\n\t\tlet item;\n\t\tif (selectedRef === undefined) {\n\t\t\titem = new TreeItem(\n\t\t\t\t'Compare <branch, tag, or ref> with <branch, tag, or ref>',\n\t\t\t\tTreeItemCollapsibleState.None\n\t\t\t);\n\t\t\titem.contextValue = ResourceType.ComparePicker;\n\t\t\titem.description = description;\n\t\t\titem.tooltip = `Click to select or enter a reference for compare${GlyphChars.Ellipsis}`;\n\t\t\titem.command = {\n\t\t\t\ttitle: `Compare${GlyphChars.Ellipsis}`,\n\t\t\t\tcommand: this.view.getQualifiedCommand('selectForCompare')\n\t\t\t};\n\t\t} else {\n\t\t\titem = new TreeItem(\n\t\t\t\t`Compare ${selectedRef.label} with <branch, tag, or ref>`,\n\t\t\t\tTreeItemCollapsibleState.None\n\t\t\t);\n\t\t\titem.contextValue = ResourceType.ComparePickerWithRef;\n\t\t\titem.description = description;\n\t\t\titem.tooltip = `Click to compare ${selectedRef.label} with${GlyphChars.Ellipsis}`;\n\t\t\titem.command = {\n\t\t\t\ttitle: `Compare ${selectedRef.label} with${GlyphChars.Ellipsis}`,\n\t\t\t\tcommand: this.view.getQualifiedCommand('compareWithSelected')\n\t\t\t};\n\t\t}\n\n\t\treturn item;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { getRepoPathOrPrompt } from '../../commands';\nimport { CommandContext, GlyphChars, NamedRef, setCommandContext } from '../../constants';\nimport { GitService } from '../../git/gitService';\nimport { ReferencesQuickPick, ReferencesQuickPickIncludes } from '../../quickpicks';\nimport { debug, gate, Iterables, log, Promises } from '../../system';\nimport { CompareView } from '../compareView';\nimport { MessageNode } from './common';\nimport { ComparePickerNode } from './comparePickerNode';\nimport { ResourceType, unknownGitUri, ViewNode } from './viewNode';\n\ninterface RepoRef {\n\tlabel: string;\n\trepoPath: string;\n\tref: string | NamedRef;\n}\n\nexport class CompareNode extends ViewNode<CompareView> {\n\tprivate _children: (ViewNode | MessageNode)[] = [];\n\tprivate _comparePickerNode: ComparePickerNode | undefined;\n\n\tconstructor(view: CompareView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tprivate _selectedRef: RepoRef | undefined;\n\tget selectedRef(): RepoRef | undefined {\n\t\treturn this._selectedRef;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this._children.length === 0) {\n\t\t\t// Not really sure why I can't reuse this node -- but if I do the Tree errors out with an id already exists error\n\t\t\tthis._comparePickerNode = new ComparePickerNode(this.view, this);\n\t\t\tthis._children = [this._comparePickerNode];\n\n\t\t\tconst pinned = this.view.getPinnedComparisons();\n\t\t\tif (pinned.length !== 0) {\n\t\t\t\tthis._children.push(...pinned);\n\t\t\t}\n\t\t} else if (this._comparePickerNode === undefined || !this._children.includes(this._comparePickerNode)) {\n\t\t\t// Not really sure why I can't reuse this node -- but if I do the Tree errors out with an id already exists error\n\t\t\tthis._comparePickerNode = new ComparePickerNode(this.view, this);\n\t\t\tthis._children.splice(0, 0, this._comparePickerNode);\n\n\t\t\tif (this._selectedRef !== undefined) {\n\t\t\t\tconst node = this._comparePickerNode;\n\t\t\t\tsetImmediate(() => this.view.reveal(node, { focus: false, select: true }));\n\t\t\t}\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Compare', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.Compare;\n\t\treturn item;\n\t}\n\n\taddOrReplace(results: ViewNode, replace: boolean) {\n\t\tif (this._children.includes(results)) return;\n\n\t\tif (this._children.length !== 0 && replace) {\n\t\t\tthis._children.length = 0;\n\t\t\tthis._children.push(results);\n\n\t\t\t// Re-add the pinned comparisons\n\t\t\tconst pinned = this.view.getPinnedComparisons();\n\t\t\tif (pinned.length !== 0) {\n\t\t\t\tthis._children.push(...pinned);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._comparePickerNode !== undefined) {\n\t\t\t\tconst index = this._children.indexOf(this._comparePickerNode);\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\tthis._children.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._children.splice(0, 0, results);\n\t\t}\n\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@log()\n\tclear() {\n\t\tthis._selectedRef = undefined;\n\t\tsetCommandContext(CommandContext.ViewsCanCompare, false);\n\n\t\tthis._children.length = 0;\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@log({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tdismiss(node: ViewNode) {\n\t\tthis._selectedRef = undefined;\n\t\tsetCommandContext(CommandContext.ViewsCanCompare, false);\n\n\t\tif (this._children.length !== 0) {\n\t\t\tconst index = this._children.indexOf(node);\n\t\t\tif (index === -1) return;\n\n\t\t\tthis._children.splice(index, 1);\n\t\t}\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@gate()\n\t@debug()\n\tasync refresh() {\n\t\tif (this._children.length === 0) return;\n\n\t\tconst promises: Promise<any>[] = [\n\t\t\t...Iterables.filterMap(this._children, c => {\n\t\t\t\tconst result = c.refresh === undefined ? false : c.refresh();\n\t\t\t\treturn Promises.is<boolean | void>(result) ? result : undefined;\n\t\t\t})\n\t\t];\n\t\tawait Promise.all(promises);\n\t}\n\n\tasync compareWithSelected(repoPath?: string, ref?: string | NamedRef) {\n\t\tif (this._selectedRef === undefined) return;\n\n\t\tif (repoPath === undefined) {\n\t\t\trepoPath = this._selectedRef.repoPath;\n\t\t} else if (repoPath !== this._selectedRef.repoPath) {\n\t\t\t// If we don't have a matching repoPath, then start over\n\t\t\tvoid this.selectForCompare(repoPath, ref);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (ref === undefined) {\n\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(\n\t\t\t\t`Compare ${this.getRefName(this._selectedRef.ref)} with${GlyphChars.Ellipsis}`,\n\t\t\t\t{\n\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\tchecked:\n\t\t\t\t\t\ttypeof this._selectedRef.ref === 'string' ? this._selectedRef.ref : this._selectedRef.ref.ref,\n\t\t\t\t\tcheckmarks: true,\n\t\t\t\t\tinclude: ReferencesQuickPickIncludes.BranchesAndTags | ReferencesQuickPickIncludes.WorkingTree\n\t\t\t\t}\n\t\t\t);\n\t\t\tif (pick === undefined) {\n\t\t\t\tawait this.view.show();\n\t\t\t\tawait this.view.reveal(this._comparePickerNode!, { focus: true, select: true });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref = pick.ref;\n\t\t}\n\n\t\tconst ref1 = this._selectedRef;\n\n\t\tthis._selectedRef = undefined;\n\t\tsetCommandContext(CommandContext.ViewsCanCompare, false);\n\n\t\tvoid (await this.view.compare(repoPath, ref1.ref, ref));\n\t}\n\n\tasync selectForCompare(repoPath?: string, ref?: string | NamedRef) {\n\t\tif (repoPath === undefined) {\n\t\t\trepoPath = await getRepoPathOrPrompt(`Compare in which repository${GlyphChars.Ellipsis}`);\n\t\t}\n\t\tif (repoPath === undefined) {\n\t\t\tawait this.view.show();\n\t\t\tawait this.view.reveal(this._comparePickerNode!, { focus: true, select: true });\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet autoCompare = false;\n\t\tif (ref === undefined) {\n\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(`Compare${GlyphChars.Ellipsis}`, {\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tcheckmarks: false,\n\t\t\t\tinclude: ReferencesQuickPickIncludes.BranchesAndTags | ReferencesQuickPickIncludes.WorkingTree\n\t\t\t});\n\t\t\tif (pick === undefined) {\n\t\t\t\tawait this.view.show();\n\t\t\t\tawait this.view.reveal(this._comparePickerNode!, { focus: true, select: true });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tref = pick.ref;\n\n\t\t\tautoCompare = true;\n\t\t}\n\n\t\tthis._selectedRef = { label: this.getRefName(ref), repoPath: repoPath, ref: ref };\n\t\tsetCommandContext(CommandContext.ViewsCanCompare, true);\n\n\t\tvoid (await this.triggerChange());\n\t\tawait this.view.reveal(this._comparePickerNode!, { focus: true, select: true });\n\n\t\tif (autoCompare) {\n\t\t\tvoid (await this.compareWithSelected());\n\t\t}\n\t}\n\n\tprivate getRefName(ref: string | NamedRef) {\n\t\treturn typeof ref === 'string' ? GitService.shortenSha(ref)! : ref.label || GitService.shortenSha(ref.ref)!;\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { NamedRef } from '../../constants';\nimport { Container } from '../../container';\nimport { GitService, GitUri } from '../../git/gitService';\nimport { debug, gate, log, Strings } from '../../system';\nimport { CompareView } from '../compareView';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { FilesQueryResults, ResultsFilesNode } from './resultsFilesNode';\nimport { ResourceType, SubscribeableViewNode, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\n\nlet instanceId = 0;\n\nexport class CompareResultsNode extends SubscribeableViewNode<CompareView> {\n\tstatic key = ':compare-results';\n\tstatic getId(repoPath: string, ref1: string, ref2: string, instanceId: number): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${ref1}|${ref2}):${instanceId}`;\n\t}\n\n\tprivate _children: ViewNode[] | undefined;\n\tprivate _instanceId: number;\n\n\tconstructor(\n\t\tview: CompareView,\n\t\tpublic readonly repoPath: string,\n\t\tprivate _ref: NamedRef,\n\t\tprivate _compareWith: NamedRef,\n\t\tprivate _pinned: boolean = false,\n\t\tprivate _comparisonNotation?: '...' | '..'\n\t) {\n\t\tsuper(GitUri.fromRepoPath(repoPath), view);\n\t\tthis._instanceId = instanceId++;\n\t}\n\n\tget id(): string {\n\t\treturn CompareResultsNode.getId(this.repoPath, this._ref.ref, this._compareWith.ref, this._instanceId);\n\t}\n\n\tget pinned(): boolean {\n\t\treturn this._pinned;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst [ref1, ref2] = await this.getDiffRefs();\n\n\t\t\tthis._children = [\n\t\t\t\tnew ResultsCommitsNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t'commits',\n\t\t\t\t\tthis.getCommitsQuery.bind(this),\n\t\t\t\t\t{\n\t\t\t\t\t\texpand: false,\n\t\t\t\t\t\tincludeDescription: true\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tnew ResultsFilesNode(this.view, this, this.uri.repoPath!, ref1, ref2, this.getFilesQuery.bind(this))\n\t\t\t];\n\t\t}\n\t\treturn this._children;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tlet description;\n\t\tif ((await Container.git.getRepositoryCount()) > 1) {\n\t\t\tconst repo = await Container.git.getRepository(this.uri.repoPath!);\n\t\t\tdescription = (repo && repo.formattedName) || this.uri.repoPath;\n\t\t}\n\n\t\tconst item = new TreeItem(\n\t\t\t`Comparing ${this._ref.label ||\n\t\t\t\tGitService.shortenSha(this._ref.ref, { strings: { working: 'Working Tree' } })} to ${this._compareWith\n\t\t\t\t.label || GitService.shortenSha(this._compareWith.ref, { strings: { working: 'Working Tree' } })}`,\n\t\t\tthis._state || TreeItemCollapsibleState.Collapsed\n\t\t);\n\t\titem.contextValue = `${ResourceType.CompareResults}+${\n\t\t\tthis.comparisonNotation === '..' ? 'twodot' : 'threedot'\n\t\t}`;\n\t\tif (this._pinned) {\n\t\t\titem.contextValue += '+pinned';\n\t\t}\n\n\t\titem.description = description;\n\t\tif (this._pinned) {\n\t\t\titem.iconPath = {\n\t\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-pin-small.svg'),\n\t\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-pin-small.svg')\n\t\t\t};\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tcanDismiss(): boolean {\n\t\treturn !this._pinned;\n\t}\n\n\t@gate()\n\t@debug()\n\tasync getDiffRefs(): Promise<[string, string]> {\n\t\tif (this.comparisonNotation === '..') {\n\t\t\treturn [\n\t\t\t\t(await Container.git.getMergeBase(this.repoPath, this._compareWith.ref, this._ref.ref)) ||\n\t\t\t\t\tthis._compareWith.ref,\n\t\t\t\tthis._ref.ref\n\t\t\t];\n\t\t}\n\n\t\treturn [this._compareWith.ref, this._ref.ref];\n\t}\n\n\t@log()\n\tasync pin() {\n\t\tif (this._pinned) return;\n\n\t\tawait this.view.updatePinnedComparison(this.getPinnableId(), {\n\t\t\tpath: this.repoPath,\n\t\t\tref1: this._ref,\n\t\t\tref2: this._compareWith,\n\t\t\tnotation: this._comparisonNotation\n\t\t});\n\n\t\tthis._pinned = true;\n\t\tvoid this.triggerChange();\n\t}\n\n\t@gate()\n\t@debug()\n\trefresh(reset: boolean = false) {\n\t\tif (!reset) return;\n\n\t\tthis._children = undefined;\n\t}\n\n\t@log()\n\tasync setComparisonNotation(comparisonNotation: '...' | '..') {\n\t\tthis._comparisonNotation = comparisonNotation;\n\n\t\tif (this._pinned) {\n\t\t\tawait this.view.updatePinnedComparison(this.getPinnableId(), {\n\t\t\t\tpath: this.repoPath,\n\t\t\t\tref1: this._ref,\n\t\t\t\tref2: this._compareWith,\n\t\t\t\tnotation: this._comparisonNotation\n\t\t\t});\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\t@log()\n\tasync swap() {\n\t\t// Save the current id so we can update it later\n\t\tconst currentId = this.getPinnableId();\n\n\t\tconst ref1 = this._ref;\n\t\tthis._ref = this._compareWith;\n\t\tthis._compareWith = ref1;\n\n\t\t// If we were pinned, remove the existing pin and save a new one\n\t\tif (this._pinned) {\n\t\t\tawait this.view.updatePinnedComparison(currentId);\n\t\t\tawait this.view.updatePinnedComparison(this.getPinnableId(), {\n\t\t\t\tpath: this.repoPath,\n\t\t\t\tref1: this._ref,\n\t\t\t\tref2: this._compareWith,\n\t\t\t\tnotation: this._comparisonNotation\n\t\t\t});\n\t\t}\n\n\t\tthis._children = undefined;\n\t\tthis.view.triggerNodeChange(this);\n\t}\n\n\t@log()\n\tasync unpin() {\n\t\tif (!this._pinned) return;\n\n\t\tawait this.view.updatePinnedComparison(this.getPinnableId());\n\n\t\tthis._pinned = false;\n\t\tvoid this.triggerChange();\n\t}\n\n\tprotected subscribe() {\n\t\treturn undefined;\n\t}\n\n\tprivate get comparisonNotation() {\n\t\treturn this._comparisonNotation || (Container.config.advanced.useSymmetricDifferenceNotation ? '...' : '..');\n\t}\n\n\tprivate get diffComparisonNotation() {\n\t\t// In git diff the range syntax doesn't mean the same thing as with git log -- since git diff is about comparing endpoints not ranges\n\t\t// see https://git-scm.com/docs/git-diff#Documentation/git-diff.txt-emgitdiffemltoptionsgtltcommitgtltcommitgt--ltpathgt82308203\n\t\t// So inverting the range syntax should be about equivalent for the behavior we want\n\t\treturn this.comparisonNotation === '...' ? '..' : '...';\n\t}\n\n\tprivate async getCommitsQuery(maxCount: number | undefined): Promise<CommitsQueryResults> {\n\t\tconst log = await Container.git.getLog(this.uri.repoPath!, {\n\t\t\tmaxCount: maxCount,\n\t\t\tref: `${this._compareWith.ref || 'HEAD'}${this.comparisonNotation}${this._ref.ref || 'HEAD'}`\n\t\t});\n\n\t\tconst count = log !== undefined ? log.count : 0;\n\t\tconst truncated = log !== undefined ? log.truncated : false;\n\n\t\treturn {\n\t\t\tlabel: Strings.pluralize('commit', count, { number: truncated ? `${count}+` : undefined, zero: 'No' }),\n\t\t\tlog: log\n\t\t};\n\t}\n\n\tprivate async getFilesQuery(): Promise<FilesQueryResults> {\n\t\tlet comparison;\n\t\tif (this._compareWith.ref === '') {\n\t\t\tcomparison = this._ref.ref;\n\t\t} else if (this._ref.ref === '') {\n\t\t\tcomparison = this._compareWith.ref;\n\t\t} else {\n\t\t\tcomparison = `${this._compareWith.ref}${this.diffComparisonNotation}${this._ref.ref}`;\n\t\t}\n\n\t\tconst diff = await Container.git.getDiffStatus(this.uri.repoPath!, comparison);\n\n\t\treturn {\n\t\t\tlabel: `${Strings.pluralize('file', diff !== undefined ? diff.length : 0, { zero: 'No' })} changed`,\n\t\t\tdiff: diff\n\t\t};\n\t}\n\n\tprivate getPinnableId() {\n\t\treturn Strings.sha1(`${this.repoPath}|${this._ref.ref}|${this._compareWith.ref}`);\n\t}\n}\n","'use strict';\nimport { Disposable, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport {\n\tGitCommitType,\n\tGitLogCommit,\n\tGitService,\n\tGitUri,\n\tRepositoryChange,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent\n} from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { debug, Iterables } from '../../system';\nimport { View } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, SubscribeableViewNode, ViewNode } from './viewNode';\n\nexport class FileHistoryNode extends SubscribeableViewNode implements PageableViewNode {\n\treadonly supportsPaging = true;\n\tmaxCount: number | undefined;\n\n\tconstructor(uri: GitUri, view: View, parent: ViewNode) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.uri.fileName;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst children: ViewNode[] = [];\n\n\t\tif (this.uri.sha === undefined) {\n\t\t\tconst status = await Container.git.getStatusForFile(this.uri.repoPath!, this.uri.fsPath);\n\t\t\tif (status !== undefined && (status.indexStatus !== undefined || status.workingTreeStatus !== undefined)) {\n\t\t\t\tlet sha;\n\t\t\t\tlet previousSha;\n\t\t\t\tif (status.workingTreeStatus !== undefined) {\n\t\t\t\t\tsha = GitService.uncommittedSha;\n\t\t\t\t\tif (status.indexStatus !== undefined) {\n\t\t\t\t\t\tpreviousSha = GitService.uncommittedStagedSha;\n\t\t\t\t\t} else if (status.workingTreeStatus !== '?') {\n\t\t\t\t\t\tpreviousSha = 'HEAD';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsha = GitService.uncommittedStagedSha;\n\t\t\t\t\tpreviousSha = 'HEAD';\n\t\t\t\t}\n\n\t\t\t\tconst user = await Container.git.getCurrentUser(this.uri.repoPath!);\n\t\t\t\tconst commit = new GitLogCommit(\n\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\tsha,\n\t\t\t\t\t'You',\n\t\t\t\t\tuser !== undefined ? user.email : undefined,\n\t\t\t\t\tnew Date(),\n\t\t\t\t\tnew Date(),\n\t\t\t\t\t'',\n\t\t\t\t\tstatus.fileName,\n\t\t\t\t\t[status],\n\t\t\t\t\tstatus.status,\n\t\t\t\t\tstatus.originalFileName,\n\t\t\t\t\tpreviousSha,\n\t\t\t\t\tstatus.originalFileName || status.fileName\n\t\t\t\t);\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew CommitFileNode(this.view, this, status, commit, { displayAsCommit: true, inFileHistory: true })\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst log = await Container.git.getLogForFile(this.uri.repoPath, this.uri.fsPath, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : undefined,\n\t\t\tref: this.uri.sha\n\t\t});\n\t\tif (log !== undefined) {\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.map(\n\t\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\t\tc =>\n\t\t\t\t\t\t\tnew CommitFileNode(this.view, this, c.files[0], c, {\n\t\t\t\t\t\t\t\tdisplayAsCommit: true,\n\t\t\t\t\t\t\t\tinFileHistory: true\n\t\t\t\t\t\t\t})\n\t\t\t\t\t),\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif (log.truncated) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1])\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (children.length === 0) return [new MessageNode(this.view, this, 'No file history could be found.')];\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem(\n\t\t\t`${this.uri.fileName}${\n\t\t\t\tthis.uri.sha\n\t\t\t\t\t? ` ${\n\t\t\t\t\t\t\tthis.uri.sha === GitService.deletedOrMissingSha\n\t\t\t\t\t\t\t\t? this.uri.shortSha\n\t\t\t\t\t\t\t\t: `(${this.uri.shortSha})`\n\t\t\t\t\t  }`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\tTreeItemCollapsibleState.Expanded\n\t\t);\n\t\titem.contextValue = ResourceType.FileHistory;\n\t\titem.description = this.uri.directory;\n\t\titem.tooltip = `History of ${this.uri.fileName}\\n${this.uri.directory}/${\n\t\t\tthis.uri.sha === undefined ? '' : `\\n\\n${this.uri.sha}`\n\t\t}`;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-history.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-history.svg')\n\t\t};\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@debug()\n\tprotected async subscribe() {\n\t\tconst repo = await Container.git.getRepository(this.uri);\n\t\tif (repo === undefined) return undefined;\n\n\t\tconst subscription = Disposable.from(\n\t\t\trepo.onDidChange(this.onRepoChanged, this),\n\t\t\trepo.onDidChangeFileSystem(this.onRepoFileSystemChanged, this),\n\t\t\t{ dispose: () => repo.stopWatchingFileSystem() }\n\t\t);\n\n\t\trepo.startWatchingFileSystem();\n\n\t\treturn subscription;\n\t}\n\n\tprivate onRepoChanged(e: RepositoryChangeEvent) {\n\t\tif (!e.changed(RepositoryChange.Repository)) return;\n\n\t\tLogger.log(`FileHistoryNode.onRepoChanged(${e.changes.join()}); triggering node refresh`);\n\n\t\tvoid this.triggerChange();\n\t}\n\n\tprivate onRepoFileSystemChanged(e: RepositoryFileSystemChangeEvent) {\n\t\tif (!e.uris.some(uri => uri.toString(true) === this.uri.toString(true))) return;\n\n\t\tLogger.debug(\n\t\t\t`FileHistoryNode${this.id}.onRepoFileSystemChanged(${this.uri.toString(true)}); triggering node refresh`\n\t\t);\n\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { Disposable, TextEditor, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { UriComparer } from '../../comparers';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitCommitish, GitUri } from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../../quickpicks';\nimport { debug, Functions, gate, log } from '../../system';\nimport { FileHistoryView } from '../fileHistoryView';\nimport { MessageNode } from './common';\nimport { FileHistoryNode } from './fileHistoryNode';\nimport { ResourceType, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class FileHistoryTrackerNode extends SubscribeableViewNode<FileHistoryView> {\n\tprivate _baseRef: string | undefined;\n\tprivate _fileUri: GitUri | undefined;\n\tprivate _child: FileHistoryNode | undefined;\n\n\tconstructor(view: FileHistoryView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tdispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChild();\n\t}\n\n\t@debug()\n\tprivate resetChild() {\n\t\tif (this._child === undefined) return;\n\n\t\tthis._child.dispose();\n\t\tthis._child = undefined;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this._child === undefined) {\n\t\t\tif (this._fileUri === undefined && this.uri === unknownGitUri) {\n\t\t\t\treturn [\n\t\t\t\t\tnew MessageNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t'There are no editors open that can provide file history information.'\n\t\t\t\t\t)\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tconst uri = this._fileUri || this.uri;\n\t\t\tconst commitish: GitCommitish = { ...uri, repoPath: uri.repoPath!, sha: this._baseRef || uri.sha };\n\t\t\tconst fileUri = new GitUri(uri, commitish);\n\t\t\tthis._child = new FileHistoryNode(fileUri, this.view, this);\n\t\t}\n\n\t\treturn [this._child];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('File History', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.ActiveFileHistory;\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@log()\n\tasync changeBase() {\n\t\tconst pick = await new ReferencesQuickPick(this.uri.repoPath).show(\n\t\t\t`Change the file history base to${GlyphChars.Ellipsis}`,\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tchecked: this._baseRef,\n\t\t\t\tcheckmarks: true\n\t\t\t}\n\t\t);\n\t\tif (pick === undefined || pick instanceof CommandQuickPickItem) return;\n\n\t\tthis._baseRef = pick.current ? undefined : pick.ref;\n\t\tif (this._child === undefined) return;\n\n\t\tthis._uri = unknownGitUri;\n\t\tawait this.triggerChange();\n\t}\n\n\t@gate()\n\t@debug({\n\t\texit: r => `returned ${r}`\n\t})\n\tasync refresh(reset: boolean = false) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (reset) {\n\t\t\tthis._uri = unknownGitUri;\n\t\t\tthis.resetChild();\n\t\t}\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor == null || !Container.git.isTrackable(editor.document.uri)) {\n\t\t\tif (\n\t\t\t\tthis.uri === unknownGitUri ||\n\t\t\t\t(Container.git.isTrackable(this.uri) &&\n\t\t\t\t\twindow.visibleTextEditors.some(e => e.document && e.document.uri.path === this.uri.path))\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._uri = unknownGitUri;\n\t\t\tthis.resetChild();\n\n\t\t\tif (cc !== undefined) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (editor.document.uri.path === this.uri.path) {\n\t\t\tif (cc !== undefined) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tlet gitUri = await GitUri.fromUri(editor.document.uri);\n\n\t\tlet uri;\n\t\tif (gitUri.sha !== undefined) {\n\t\t\t// If we have a sha, normalize the history to the working file (so we get a full history all the time)\n\t\t\tconst workingUri = await Container.git.getWorkingUri(gitUri.repoPath!, gitUri);\n\t\t\tif (workingUri !== undefined) {\n\t\t\t\turi = workingUri;\n\t\t\t}\n\t\t}\n\n\t\tif (this.uri !== unknownGitUri && UriComparer.equals(uri || gitUri, this.uri)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (uri !== undefined) {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\tthis._uri = gitUri;\n\t\tthis.resetChild();\n\n\t\tif (cc !== undefined) {\n\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@log()\n\tsetEditorFollowing(enabled: boolean) {\n\t\tif (enabled && this._fileUri !== undefined) {\n\t\t\tthis._fileUri = undefined;\n\t\t\tthis._baseRef = undefined;\n\n\t\t\tthis._uri = unknownGitUri;\n\t\t\t// Don't need to call triggerChange here, since canSubscribe will do it\n\t\t}\n\n\t\tthis.canSubscribe = enabled;\n\t}\n\n\t@log()\n\tasync showHistoryForUri(uri: GitUri, baseRef?: string) {\n\t\tthis._fileUri = uri;\n\t\tthis._baseRef = baseRef;\n\n\t\tthis._uri = unknownGitUri;\n\t\tawait this.triggerChange();\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\treturn Disposable.from(\n\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveEditorChanged, 500), this)\n\t\t);\n\t}\n\n\t@debug({ args: false })\n\tprivate onActiveEditorChanged(editor: TextEditor | undefined) {\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { Disposable, Selection, TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { Container } from '../../container';\nimport { GitCommitType, GitFile, GitLogCommit } from '../../git/git';\nimport {\n\tGitService,\n\tGitUri,\n\tRepositoryChange,\n\tRepositoryChangeEvent,\n\tRepositoryFileSystemChangeEvent\n} from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { debug, Iterables } from '../../system';\nimport { View } from '../viewBase';\nimport { CommitFileNode } from './commitFileNode';\nimport { MessageNode, ShowMoreNode } from './common';\nimport { insertDateMarkers } from './helpers';\nimport { PageableViewNode, ResourceType, SubscribeableViewNode, ViewNode } from './viewNode';\n\nexport class LineHistoryNode extends SubscribeableViewNode implements PageableViewNode {\n\treadonly supportsPaging = true;\n\tmaxCount: number | undefined;\n\n\tconstructor(\n\t\turi: GitUri,\n\t\tview: View,\n\t\tparent: ViewNode,\n\t\tpublic readonly selection: Selection,\n\t\tprivate readonly _editorContents: string | undefined\n\t) {\n\t\tsuper(uri, view, parent);\n\t}\n\n\ttoClipboard(): string {\n\t\treturn this.uri.fileName;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tconst children: ViewNode[] = [];\n\n\t\tlet selection = this.selection;\n\n\t\tif (this.uri.sha === undefined) {\n\t\t\t// Check for any uncommitted changes in the range\n\t\t\tconst blame = this._editorContents\n\t\t\t\t? await Container.git.getBlameForRangeContents(this.uri, selection, this._editorContents)\n\t\t\t\t: await Container.git.getBlameForRange(this.uri, selection);\n\t\t\tif (blame !== undefined) {\n\t\t\t\tfor (const commit of blame.commits.values()) {\n\t\t\t\t\tif (!commit.isUncommitted) continue;\n\n\t\t\t\t\tconst file: GitFile = {\n\t\t\t\t\t\tfileName: commit.fileName,\n\t\t\t\t\t\tindexStatus: '?',\n\t\t\t\t\t\toriginalFileName: commit.originalFileName,\n\t\t\t\t\t\trepoPath: this.uri.repoPath!,\n\t\t\t\t\t\tstatus: 'M',\n\t\t\t\t\t\tworkingTreeStatus: '?'\n\t\t\t\t\t};\n\n\t\t\t\t\tconst uncommitted = new GitLogCommit(\n\t\t\t\t\t\tGitCommitType.LogFile,\n\t\t\t\t\t\tthis.uri.repoPath!,\n\t\t\t\t\t\tcommit.sha,\n\t\t\t\t\t\t'You',\n\t\t\t\t\t\tcommit.email,\n\t\t\t\t\t\tcommit.authorDate,\n\t\t\t\t\t\tcommit.committerDate,\n\t\t\t\t\t\tcommit.message,\n\t\t\t\t\t\tcommit.fileName,\n\t\t\t\t\t\t[file],\n\t\t\t\t\t\t'M',\n\t\t\t\t\t\tcommit.originalFileName,\n\t\t\t\t\t\tcommit.previousSha,\n\t\t\t\t\t\tcommit.originalFileName || commit.fileName\n\t\t\t\t\t);\n\n\t\t\t\t\tconst firstLine = blame.lines[0];\n\t\t\t\t\tconst lastLine = blame.lines[blame.lines.length - 1];\n\n\t\t\t\t\t// Since there could be a change in the line numbers, update the selection\n\t\t\t\t\tconst firstActive = selection.active.line === firstLine.line - 1;\n\t\t\t\t\tselection = new Selection(\n\t\t\t\t\t\t(firstActive ? lastLine : firstLine).originalLine - 1,\n\t\t\t\t\t\tselection.anchor.character,\n\t\t\t\t\t\t(firstActive ? firstLine : lastLine).originalLine - 1,\n\t\t\t\t\t\tselection.active.character\n\t\t\t\t\t);\n\n\t\t\t\t\tchildren.splice(\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tnew CommitFileNode(this.view, this, file, uncommitted, {\n\t\t\t\t\t\t\tdisplayAsCommit: true,\n\t\t\t\t\t\t\tinFileHistory: true,\n\t\t\t\t\t\t\tselection: selection\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst log = await Container.git.getLogForFile(this.uri.repoPath, this.uri.fsPath, {\n\t\t\tmaxCount: this.maxCount !== undefined ? this.maxCount : undefined,\n\t\t\tref: this.uri.sha,\n\t\t\trange: selection\n\t\t});\n\t\tif (log !== undefined) {\n\t\t\tchildren.push(\n\t\t\t\t...insertDateMarkers(\n\t\t\t\t\tIterables.filterMap(\n\t\t\t\t\t\tlog.commits.values(),\n\t\t\t\t\t\tc =>\n\t\t\t\t\t\t\tnew CommitFileNode(this.view, this, c.files[0], c, {\n\t\t\t\t\t\t\t\tdisplayAsCommit: true,\n\t\t\t\t\t\t\t\tinFileHistory: true,\n\t\t\t\t\t\t\t\tselection: selection\n\t\t\t\t\t\t\t})\n\t\t\t\t\t),\n\t\t\t\t\tthis\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tif (log.truncated) {\n\t\t\t\tchildren.push(\n\t\t\t\t\tnew ShowMoreNode(this.view, this, 'Commits', log.maxCount, children[children.length - 1])\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (children.length === 0) return [new MessageNode(this.view, this, 'No line history could be found.')];\n\t\treturn children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst lines = this.selection.isSingleLine\n\t\t\t? ` #${this.selection.start.line + 1}`\n\t\t\t: ` #${this.selection.start.line + 1}-${this.selection.end.line + 1}`;\n\t\tconst item = new TreeItem(\n\t\t\t`${this.uri.fileName}${lines}${\n\t\t\t\tthis.uri.sha\n\t\t\t\t\t? ` ${\n\t\t\t\t\t\t\tthis.uri.sha === GitService.deletedOrMissingSha\n\t\t\t\t\t\t\t\t? this.uri.shortSha\n\t\t\t\t\t\t\t\t: `(${this.uri.shortSha})`\n\t\t\t\t\t  }`\n\t\t\t\t\t: ''\n\t\t\t}`,\n\t\t\tTreeItemCollapsibleState.Expanded\n\t\t);\n\t\titem.contextValue = ResourceType.LineHistory;\n\t\titem.description = this.uri.directory;\n\t\titem.tooltip = `History of ${this.uri.fileName}${lines}\\n${this.uri.directory}/${\n\t\t\tthis.uri.sha === undefined ? '' : `\\n\\n${this.uri.sha}`\n\t\t}`;\n\n\t\titem.iconPath = {\n\t\t\tdark: Container.context.asAbsolutePath('images/dark/icon-history.svg'),\n\t\t\tlight: Container.context.asAbsolutePath('images/light/icon-history.svg')\n\t\t};\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@debug()\n\tprotected async subscribe() {\n\t\tconst repo = await Container.git.getRepository(this.uri);\n\t\tif (repo === undefined) return undefined;\n\n\t\tconst subscription = Disposable.from(\n\t\t\trepo.onDidChange(this.onRepoChanged, this),\n\t\t\trepo.onDidChangeFileSystem(this.onRepoFileSystemChanged, this),\n\t\t\t{ dispose: () => repo.stopWatchingFileSystem() }\n\t\t);\n\n\t\trepo.startWatchingFileSystem();\n\n\t\treturn subscription;\n\t}\n\n\tprivate onRepoChanged(e: RepositoryChangeEvent) {\n\t\tif (!e.changed(RepositoryChange.Repository)) return;\n\n\t\tLogger.log(`LineHistoryNode.onRepoChanged(${e.changes.join()}); triggering node refresh`);\n\n\t\tvoid this.triggerChange();\n\t}\n\n\tprivate onRepoFileSystemChanged(e: RepositoryFileSystemChangeEvent) {\n\t\tif (!e.uris.some(uri => uri.toString(true) === this.uri.toString(true))) return;\n\n\t\tLogger.debug(`LineHistoryNode.onRepoFileSystemChanged(${this.uri.toString(true)}); triggering node refresh`);\n\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { Disposable, Selection, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { UriComparer } from '../../comparers';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitCommitish, GitUri } from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../../quickpicks';\nimport { debug, Functions, gate, log } from '../../system';\nimport { LinesChangeEvent } from '../../trackers/gitLineTracker';\nimport { LineHistoryView } from '../lineHistoryView';\nimport { MessageNode } from './common';\nimport { LineHistoryNode } from './lineHistoryNode';\nimport { ResourceType, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class LineHistoryTrackerNode extends SubscribeableViewNode<LineHistoryView> {\n\tprivate _base: string | undefined;\n\tprivate _child: LineHistoryNode | undefined;\n\tprivate _editorContents: string | undefined;\n\tprivate _selection: Selection | undefined;\n\n\tconstructor(view: LineHistoryView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tdispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChild();\n\t}\n\n\t@debug()\n\tprivate resetChild() {\n\t\tif (this._child === undefined) return;\n\n\t\tthis._child.dispose();\n\t\tthis._child = undefined;\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this._child === undefined) {\n\t\t\tif (this.uri === unknownGitUri) {\n\t\t\t\treturn [\n\t\t\t\t\tnew MessageNode(\n\t\t\t\t\t\tthis.view,\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t'There are no editors open that can provide line history information.'\n\t\t\t\t\t)\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tconst commitish: GitCommitish = {\n\t\t\t\t...this.uri,\n\t\t\t\trepoPath: this.uri.repoPath!,\n\t\t\t\tsha: this.uri.sha || this._base\n\t\t\t};\n\t\t\tconst fileUri = new GitUri(this.uri, commitish);\n\t\t\tthis._child = new LineHistoryNode(fileUri, this.view, this, this._selection!, this._editorContents);\n\t\t}\n\n\t\treturn [this._child];\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Line History', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.ActiveLineHistory;\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@log()\n\tasync changeBase() {\n\t\tconst pick = await new ReferencesQuickPick(this.uri.repoPath).show(\n\t\t\t`Change the line history base to${GlyphChars.Ellipsis}`,\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tchecked: this._base,\n\t\t\t\tcheckmarks: true\n\t\t\t}\n\t\t);\n\t\tif (pick === undefined || pick instanceof CommandQuickPickItem) return;\n\n\t\tthis._base = pick.current ? undefined : pick.ref;\n\t\tif (this._child === undefined) return;\n\n\t\tthis._uri = unknownGitUri;\n\t\tawait this.triggerChange();\n\t}\n\n\t@gate()\n\t@debug({\n\t\texit: r => `returned ${r}`\n\t})\n\tasync refresh(reset: boolean = false) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (reset) {\n\t\t\tthis._uri = unknownGitUri;\n\t\t\tthis._editorContents = undefined;\n\t\t\tthis._selection = undefined;\n\t\t\tthis.resetChild();\n\t\t}\n\n\t\tconst editor = window.activeTextEditor;\n\t\tif (editor == null || !Container.git.isTrackable(editor.document.uri)) {\n\t\t\tif (\n\t\t\t\tthis.uri === unknownGitUri ||\n\t\t\t\t(Container.git.isTrackable(this.uri) &&\n\t\t\t\t\twindow.visibleTextEditors.some(e => e.document && e.document.uri.path === this.uri.path))\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._uri = unknownGitUri;\n\t\t\tthis._editorContents = undefined;\n\t\t\tthis._selection = undefined;\n\t\t\tthis.resetChild();\n\n\t\t\tif (cc !== undefined) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\teditor.document.uri.path === this.uri.path &&\n\t\t\t(this._selection !== undefined && editor.selection.isEqual(this._selection))\n\t\t) {\n\t\t\tif (cc !== undefined) {\n\t\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tconst gitUri = await GitUri.fromUri(editor.document.uri);\n\n\t\tif (\n\t\t\tthis.uri !== unknownGitUri &&\n\t\t\tUriComparer.equals(gitUri, this.uri) &&\n\t\t\t(this._selection !== undefined && editor.selection.isEqual(this._selection))\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\tthis._uri = gitUri;\n\t\tthis._editorContents = editor.document.isDirty ? editor.document.getText() : undefined;\n\t\tthis._selection = editor.selection;\n\t\tthis.resetChild();\n\n\t\tif (cc !== undefined) {\n\t\t\tcc.exitDetails = `, uri=${Logger.toLoggable(this._uri)}`;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@log()\n\tsetEditorFollowing(enabled: boolean) {\n\t\tthis.canSubscribe = enabled;\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\tif (Container.lineTracker.isSubscribed(this)) return undefined;\n\n\t\tconst onActiveLinesChanged = Functions.debounce(this.onActiveLinesChanged.bind(this), 250);\n\n\t\treturn Container.lineTracker.start(\n\t\t\tthis,\n\t\t\tDisposable.from(\n\t\t\t\tContainer.lineTracker.onDidChangeActiveLines((e: LinesChangeEvent) => {\n\t\t\t\t\tif (e.pending) return;\n\n\t\t\t\t\tonActiveLinesChanged(e);\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t}\n\n\t@debug({ args: false })\n\tprivate onActiveLinesChanged(e: LinesChangeEvent) {\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { Disposable, TextEditor, TreeItem, TreeItemCollapsibleState, window } from 'vscode';\nimport { Container } from '../../container';\nimport { GitUri } from '../../git/gitService';\nimport { Logger } from '../../logger';\nimport { debug, Functions, gate } from '../../system';\nimport { RepositoriesView } from '../repositoriesView';\nimport { MessageNode } from './common';\nimport { RepositoryNode } from './repositoryNode';\nimport { ResourceType, SubscribeableViewNode, unknownGitUri, ViewNode } from './viewNode';\n\nexport class RepositoriesNode extends SubscribeableViewNode<RepositoriesView> {\n\tprivate _children: (RepositoryNode | MessageNode)[] | undefined;\n\n\tconstructor(view: RepositoriesView) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tdispose() {\n\t\tsuper.dispose();\n\n\t\tthis.resetChildren();\n\t}\n\n\t@debug()\n\tprivate resetChildren() {\n\t\tif (this._children === undefined) return;\n\n\t\tfor (const child of this._children) {\n\t\t\tif (child instanceof RepositoryNode) {\n\t\t\t\tchild.dispose();\n\t\t\t}\n\t\t}\n\t\tthis._children = undefined;\n\t}\n\n\tasync getChildren(): Promise<ViewNode[]> {\n\t\tif (this._children === undefined) {\n\t\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\t\tif (repositories.length === 0) return [new MessageNode(this.view, this, 'No repositories could be found.')];\n\n\t\t\tthis._children = repositories.map(r => new RepositoryNode(GitUri.fromRepoPath(r.path), this.view, this, r));\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Repositories', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.Repositories;\n\n\t\tvoid this.ensureSubscription();\n\n\t\treturn item;\n\t}\n\n\t@gate()\n\t@debug()\n\tasync refresh(reset: boolean = false) {\n\t\tif (this._children === undefined) return;\n\n\t\tif (reset) {\n\t\t\tthis.resetChildren();\n\t\t\tawait this.unsubscribe();\n\t\t\tvoid this.ensureSubscription();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst repositories = await Container.git.getOrderedRepositories();\n\t\tif (repositories.length === 0 && (this._children === undefined || this._children.length === 0)) return;\n\n\t\tif (repositories.length === 0) {\n\t\t\tthis._children = [new MessageNode(this.view, this, 'No repositories could be found.')];\n\t\t\treturn;\n\t\t}\n\n\t\tconst children = [];\n\t\tfor (const repo of repositories) {\n\t\t\tconst normalizedPath = repo.normalizedPath;\n\t\t\tconst child = (this._children as RepositoryNode[]).find(c => c.repo.normalizedPath === normalizedPath);\n\t\t\tif (child !== undefined) {\n\t\t\t\tchildren.push(child);\n\t\t\t\tvoid child.refresh();\n\t\t\t} else {\n\t\t\t\tchildren.push(new RepositoryNode(GitUri.fromRepoPath(repo.path), this.view, this, repo));\n\t\t\t}\n\t\t}\n\n\t\tfor (const child of this._children as RepositoryNode[]) {\n\t\t\tif (children.includes(child)) continue;\n\n\t\t\tchild.dispose();\n\t\t}\n\n\t\tthis._children = children;\n\n\t\tvoid this.ensureSubscription();\n\t}\n\n\t@debug()\n\tprotected subscribe() {\n\t\tconst subscriptions = [Container.git.onDidChangeRepositories(this.onRepositoriesChanged, this)];\n\n\t\tif (this.view.config.autoReveal) {\n\t\t\tsubscriptions.push(\n\t\t\t\twindow.onDidChangeActiveTextEditor(Functions.debounce(this.onActiveEditorChanged, 500), this)\n\t\t\t);\n\t\t}\n\n\t\treturn Disposable.from(...subscriptions);\n\t}\n\n\t@debug({ args: false })\n\tprivate onActiveEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor == null || this._children === undefined || this._children.length === 1) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tconst uri = editor.document.uri;\n\t\t\tconst node = this._children.find(n => n instanceof RepositoryNode && n.repo.containsUri(uri)) as\n\t\t\t\t| RepositoryNode\n\t\t\t\t| undefined;\n\t\t\tif (node === undefined) return;\n\n\t\t\t// Check to see if this repo has a descendent that is already selected\n\t\t\tlet parent = this.view.selection.length === 0 ? undefined : this.view.selection[0];\n\t\t\twhile (parent !== undefined) {\n\t\t\t\tif (parent === node) return;\n\n\t\t\t\tparent = parent.getParent();\n\t\t\t}\n\n\t\t\tvoid this.view.reveal(node, { expand: true });\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\t@debug()\n\tprivate onRepositoriesChanged() {\n\t\tvoid this.triggerChange();\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { SearchCommitsCommandArgs } from '../../commands';\nimport { GlyphChars } from '../../constants';\nimport { debug, gate, Iterables, log, Promises } from '../../system';\nimport { View } from '../viewBase';\nimport { CommandMessageNode, MessageNode } from './common';\nimport { ResourceType, unknownGitUri, ViewNode } from './viewNode';\nimport { SearchOperators } from '../../git/gitService';\n\nexport class SearchNode extends ViewNode {\n\tprivate _children: (ViewNode | MessageNode)[] = [];\n\n\tconstructor(view: View) {\n\t\tsuper(unknownGitUri, view);\n\t}\n\n\tgetChildren(): ViewNode[] {\n\t\tif (this._children.length === 0) {\n\t\t\tconst command = {\n\t\t\t\ttitle: ' ',\n\t\t\t\tcommand: 'gitlens.showCommitSearch'\n\t\t\t};\n\n\t\t\tconst getCommandArgs = (search: SearchOperators): SearchCommitsCommandArgs => {\n\t\t\t\treturn {\n\t\t\t\t\tsearch: { pattern: search },\n\t\t\t\t\tprefillOnly: true\n\t\t\t\t};\n\t\t\t};\n\n\t\t\treturn [\n\t\t\t\tnew CommandMessageNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\t...command,\n\t\t\t\t\t\targuments: [this, getCommandArgs('message:')]\n\t\t\t\t\t},\n\t\t\t\t\t'Search by Message',\n\t\t\t\t\t`pattern or message: pattern or =: pattern ${GlyphChars.Dash} use quotes to search for phrases`,\n\t\t\t\t\t`Click to search for commits with matching messages ${GlyphChars.Dash} use quotes to search for phrases`\n\t\t\t\t),\n\t\t\t\tnew CommandMessageNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\t...command,\n\t\t\t\t\t\targuments: [this, getCommandArgs('author:')]\n\t\t\t\t\t},\n\t\t\t\t\t`${GlyphChars.Space.repeat(4)} or, Author`,\n\t\t\t\t\t'author: pattern or @: pattern',\n\t\t\t\t\t'Click to search for commits with matching authors'\n\t\t\t\t),\n\t\t\t\tnew CommandMessageNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\t...command,\n\t\t\t\t\t\targuments: [this, getCommandArgs('commit:')]\n\t\t\t\t\t},\n\t\t\t\t\t`${GlyphChars.Space.repeat(4)} or, Commit ID`,\n\t\t\t\t\t'commit: sha or #: sha',\n\t\t\t\t\t'Click to search for commits with matching commit ids'\n\t\t\t\t),\n\t\t\t\tnew CommandMessageNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\t...command,\n\t\t\t\t\t\targuments: [this, getCommandArgs('file:')]\n\t\t\t\t\t},\n\t\t\t\t\t`${GlyphChars.Space.repeat(4)} or, Files`,\n\t\t\t\t\t'file: glob or ?: glob',\n\t\t\t\t\t'Click to search for commits with matching files'\n\t\t\t\t),\n\t\t\t\tnew CommandMessageNode(\n\t\t\t\t\tthis.view,\n\t\t\t\t\tthis,\n\t\t\t\t\t{\n\t\t\t\t\t\t...command,\n\t\t\t\t\t\targuments: [this, getCommandArgs('change:')]\n\t\t\t\t\t},\n\t\t\t\t\t`${GlyphChars.Space.repeat(4)} or, Changes`,\n\t\t\t\t\t'change: pattern or ~: pattern',\n\t\t\t\t\t'Click to search for commits with matching changes'\n\t\t\t\t)\n\t\t\t];\n\t\t}\n\n\t\treturn this._children;\n\t}\n\n\tgetTreeItem(): TreeItem {\n\t\tconst item = new TreeItem('Search', TreeItemCollapsibleState.Expanded);\n\t\titem.contextValue = ResourceType.Search;\n\t\treturn item;\n\t}\n\n\taddOrReplace(results: ViewNode, replace: boolean) {\n\t\tif (this._children.includes(results)) return;\n\n\t\tif (this._children.length !== 0 && replace) {\n\t\t\tthis._children.length = 0;\n\t\t\tthis._children.push(results);\n\t\t} else {\n\t\t\tthis._children.splice(0, 0, results);\n\t\t}\n\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@log()\n\tclear() {\n\t\tif (this._children.length === 0) return;\n\n\t\tthis._children.length = 0;\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@log({\n\t\targs: { 0: (n: ViewNode) => n.toString() }\n\t})\n\tdismiss(node: ViewNode) {\n\t\tif (this._children.length === 0) return;\n\n\t\tconst index = this._children.findIndex(n => n === node);\n\t\tif (index === -1) return;\n\n\t\tthis._children.splice(index, 1);\n\t\tthis.view.triggerNodeChange();\n\t}\n\n\t@gate()\n\t@debug()\n\tasync refresh() {\n\t\tif (this._children.length === 0) return;\n\n\t\tconst promises: Promise<any>[] = [\n\t\t\t...Iterables.filterMap(this._children, c => {\n\t\t\t\tconst result = c.refresh === undefined ? false : c.refresh();\n\t\t\t\treturn Promises.is<boolean | void>(result) ? result : undefined;\n\t\t\t})\n\t\t];\n\t\tawait Promise.all(promises);\n\t}\n}\n","'use strict';\nimport { TreeItem, TreeItemCollapsibleState } from 'vscode';\nimport { SearchCommitsCommandArgs } from '../../commands';\nimport { Commands } from '../../commands/common';\nimport { ViewWithFiles } from '../viewBase';\nimport { CommitsQueryResults, ResultsCommitsNode } from './resultsCommitsNode';\nimport { ResourceType, ViewNode } from './viewNode';\nimport { RepositoryNode } from './repositoryNode';\nimport { SearchPattern } from '../../git/gitService';\n\nlet instanceId = 0;\n\nexport class SearchResultsCommitsNode extends ResultsCommitsNode {\n\tstatic key = ':search-results';\n\tstatic getId(repoPath: string, search: SearchPattern | undefined, instanceId: number): string {\n\t\treturn `${RepositoryNode.getId(repoPath)}${this.key}(${\n\t\t\tsearch === undefined ? '?' : SearchPattern.toKey(search)\n\t\t}):${instanceId}`;\n\t}\n\n\tprivate _instanceId: number;\n\n\tconstructor(\n\t\tview: ViewWithFiles,\n\t\tparent: ViewNode,\n\t\trepoPath: string,\n\t\tpublic readonly search: SearchPattern,\n\t\tlabel: string,\n\t\tcommitsQuery: (maxCount: number | undefined) => Promise<CommitsQueryResults>\n\t) {\n\t\tsuper(view, parent, repoPath, label, commitsQuery, {\n\t\t\texpand: true,\n\t\t\tincludeDescription: true\n\t\t});\n\n\t\tthis._instanceId = instanceId++;\n\t}\n\n\tget id(): string {\n\t\treturn SearchResultsCommitsNode.getId(this.repoPath, this.search, this._instanceId);\n\t}\n\n\tget type(): ResourceType {\n\t\treturn ResourceType.SearchResults;\n\t}\n\n\tasync getTreeItem(): Promise<TreeItem> {\n\t\tconst item = await super.getTreeItem();\n\n\t\tif (item.collapsibleState === TreeItemCollapsibleState.None) {\n\t\t\tconst args: SearchCommitsCommandArgs = {\n\t\t\t\tsearch: this.search,\n\t\t\t\tprefillOnly: true,\n\t\t\t\tshowInView: true\n\t\t\t};\n\t\t\titem.command = {\n\t\t\t\ttitle: 'Search Commits',\n\t\t\t\tcommand: Commands.SearchCommitsInView,\n\t\t\t\targuments: [args]\n\t\t\t};\n\t\t}\n\n\t\treturn item;\n\t}\n}\n","'use strict';\n\nexport * from './nodes/common';\n\nexport * from './nodes/viewNode';\nexport * from './nodes/branchesNode';\nexport * from './nodes/branchNode';\nexport * from './nodes/branchOrTagFolderNode';\nexport * from './nodes/branchTrackingStatusNode';\nexport * from './nodes/commitFileNode';\nexport * from './nodes/commitNode';\nexport * from './nodes/compareBranchNode';\nexport * from './nodes/compareNode';\nexport * from './nodes/compareResultsNode';\nexport * from './nodes/contributorNode';\nexport * from './nodes/contributorsNode';\nexport * from './nodes/fileHistoryNode';\nexport * from './nodes/fileHistoryTrackerNode';\nexport * from './nodes/folderNode';\nexport * from './nodes/lineHistoryNode';\nexport * from './nodes/lineHistoryTrackerNode';\nexport * from './nodes/reflogNode';\nexport * from './nodes/reflogRecordNode';\nexport * from './nodes/remoteNode';\nexport * from './nodes/remotesNode';\nexport * from './nodes/repositoriesNode';\nexport * from './nodes/repositoryNode';\nexport * from './nodes/resultsCommitsNode';\nexport * from './nodes/resultsFileNode';\nexport * from './nodes/resultsFilesNode';\nexport * from './nodes/searchNode';\nexport * from './nodes/searchResultsCommitsNode';\nexport * from './nodes/stashesNode';\nexport * from './nodes/stashFileNode';\nexport * from './nodes/stashNode';\nexport * from './nodes/statusFileNode';\nexport * from './nodes/statusFilesNode';\nexport * from './nodes/tagsNode';\nexport * from './nodes/tagNode';\n","'use strict';\nimport { commands, TextEditor, TextEditorEdit, Uri, window } from 'vscode';\nimport { UriComparer } from '../comparers';\nimport { FileAnnotationType } from '../configuration';\nimport { isTextEditor } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, EditorCommand } from './common';\n\n@command()\nexport class ClearFileAnnotationsCommand extends EditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.ClearFileAnnotations, Commands.ComputingFileAnnotations]);\n\t}\n\n\texecute(editor: TextEditor, edit: TextEditorEdit, uri?: Uri): Promise<any> {\n\t\t// Handle the case where we are focused on a non-editor editor (output, debug console)\n\t\tif (editor != null && !isTextEditor(editor)) {\n\t\t\tif (uri != null && !UriComparer.equals(uri, editor.document.uri)) {\n\t\t\t\tconst e = window.visibleTextEditors.find(e => UriComparer.equals(uri, e.document.uri));\n\t\t\t\tif (e !== undefined) {\n\t\t\t\t\teditor = e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\treturn Container.fileAnnotations.clear(editor);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ClearFileAnnotationsCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to clear file annotations');\n\t\t}\n\t}\n}\n\nexport interface ToggleFileBlameCommandArgs {\n\ton?: boolean;\n\tsha?: string;\n\ttype?: FileAnnotationType;\n}\n\n@command()\nexport class ToggleFileBlameCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleFileBlame);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileBlameCommandArgs): Thenable<any> {\n\t\targs = { ...args };\n\n\t\t// Handle the case where we are focused on a non-editor editor (output, debug console)\n\t\tif (editor != null && !isTextEditor(editor)) {\n\t\t\tif (uri != null && !UriComparer.equals(uri, editor.document.uri)) {\n\t\t\t\tconst e = window.visibleTextEditors.find(e => UriComparer.equals(uri, e.document.uri));\n\t\t\t\tif (e !== undefined) {\n\t\t\t\t\teditor = e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.type === undefined) {\n\t\t\t\targs = { ...args, type: FileAnnotationType.Blame };\n\t\t\t}\n\n\t\t\treturn Container.fileAnnotations.toggle(\n\t\t\t\teditor,\n\t\t\t\targs.type!,\n\t\t\t\targs.sha !== undefined ? args.sha : editor && editor.selection.active.line,\n\t\t\t\targs.on\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ToggleFileBlameCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t`Unable to toggle file ${args.type} annotations. See output channel for more details`\n\t\t\t);\n\t\t}\n\t}\n}\n\n@command()\nexport class ToggleFileHeatmapCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleFileHeatmap);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileBlameCommandArgs): Thenable<any> {\n\t\tconst copyArgs: ToggleFileBlameCommandArgs = {\n\t\t\t...args,\n\t\t\ttype: FileAnnotationType.Heatmap\n\t\t};\n\t\treturn commands.executeCommand(Commands.ToggleFileBlame, uri, copyArgs);\n\t}\n}\n\n@command()\nexport class ToggleFileRecentChangesCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleFileRecentChanges);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri, args?: ToggleFileBlameCommandArgs): Thenable<any> {\n\t\tconst copyArgs: ToggleFileBlameCommandArgs = {\n\t\t\t...args,\n\t\t\ttype: FileAnnotationType.RecentChanges\n\t\t};\n\t\treturn commands.executeCommand(Commands.ToggleFileBlame, uri, copyArgs);\n\t}\n}\n\n@command()\nexport class ToggleLineBlameCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ToggleLineBlame);\n\t}\n\n\texecute(editor: TextEditor, uri?: Uri): Thenable<any> {\n\t\ttry {\n\t\t\treturn Container.lineAnnotations.toggle(editor);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ToggleLineBlameCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to toggle line blame annotations. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { TextEditorComparer, UriComparer } from '../comparers';\nimport { BuiltInCommands, GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Functions } from '../system';\nimport { Command, command, Commands, getRepoPathOrPrompt } from './common';\n\nexport interface CloseUnchangedFilesCommandArgs {\n\turis?: Uri[];\n}\n\n@command()\nexport class CloseUnchangedFilesCommand extends Command {\n\tprivate _onEditorChangedFn: ((editor: TextEditor | undefined) => void) | undefined;\n\n\tconstructor() {\n\t\tsuper(Commands.CloseUnchangedFiles);\n\t}\n\n\tasync execute(args?: CloseUnchangedFilesCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uris === undefined) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt(\n\t\t\t\t\t`Close all files except those changed in which repository${GlyphChars.Ellipsis}`\n\t\t\t\t);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status === undefined) return window.showWarningMessage('Unable to close unchanged files');\n\n\t\t\t\targs.uris = status.files.map(f => f.uri);\n\t\t\t}\n\n\t\t\tif (args.uris.length === 0) return commands.executeCommand(BuiltInCommands.CloseAllEditors);\n\n\t\t\tconst disposable = window.onDidChangeActiveTextEditor(\n\t\t\t\tFunctions.debounce(\n\t\t\t\t\t(e: TextEditor | undefined) => this._onEditorChangedFn && this._onEditorChangedFn(e),\n\t\t\t\t\t50\n\t\t\t\t)\n\t\t\t);\n\n\t\t\tlet editor = window.activeTextEditor;\n\n\t\t\tlet count = 0;\n\t\t\tlet loopCount = 0;\n\t\t\tconst editors: TextEditor[] = [];\n\n\t\t\t// Find out how many editors there are\n\t\t\twhile (true) {\n\t\t\t\tif (editor != null) {\n\t\t\t\t\tlet found = false;\n\t\t\t\t\tfor (const e of editors) {\n\t\t\t\t\t\tif (TextEditorComparer.equals(e, editor, { useId: true, usePosition: true })) {\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (found) break;\n\n\t\t\t\t\t// Start counting at the first real editor\n\t\t\t\t\tcount++;\n\t\t\t\t\teditors.push(editor);\n\t\t\t\t} else if (count !== 0) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\n\t\t\t\teditor = await this.nextEditor();\n\n\t\t\t\tloopCount++;\n\t\t\t\t// Break out if we've looped 4 times and haven't found any editors\n\t\t\t\tif (loopCount >= 4 && editors.length === 0) break;\n\t\t\t}\n\n\t\t\tif (editors.length) {\n\t\t\t\teditor = window.activeTextEditor;\n\n\t\t\t\tfor (let i = 0; i <= count; i++) {\n\t\t\t\t\tif (\n\t\t\t\t\t\teditor == null ||\n\t\t\t\t\t\t(editor.document !== undefined &&\n\t\t\t\t\t\t\t(editor.document.isDirty ||\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\t\t\t\targs.uris.some(uri =>\n\t\t\t\t\t\t\t\t\tUriComparer.equals(uri, editor!.document && editor!.document.uri)\n\t\t\t\t\t\t\t\t)))\n\t\t\t\t\t) {\n\t\t\t\t\t\teditor = await this.nextEditor();\n\t\t\t\t\t} else {\n\t\t\t\t\t\teditor = await this.closeEditor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdisposable.dispose();\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'CloseUnchangedFilesCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to close all unchanged files');\n\t\t}\n\t}\n\n\tprivate async closeEditor(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\tconst editor = window.activeTextEditor;\n\n\t\tvoid (await commands.executeCommand(BuiltInCommands.CloseActiveEditor));\n\n\t\tif (editor !== window.activeTextEditor) {\n\t\t\treturn window.activeTextEditor;\n\t\t}\n\n\t\treturn this.waitForEditorChange(timeout);\n\t}\n\n\tprivate async nextEditor(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\tconst editor = window.activeTextEditor;\n\n\t\tvoid (await commands.executeCommand(BuiltInCommands.NextEditor));\n\n\t\tif (editor !== window.activeTextEditor) {\n\t\t\treturn window.activeTextEditor;\n\t\t}\n\n\t\treturn this.waitForEditorChange(timeout);\n\t}\n\n\tprivate waitForEditorChange(timeout: number = 500): Promise<TextEditor | undefined> {\n\t\treturn new Promise<TextEditor>((resolve, reject) => {\n\t\t\tlet timer: NodeJS.Timer | undefined;\n\n\t\t\tthis._onEditorChangedFn = (editor: TextEditor | undefined) => {\n\t\t\t\tif (timer) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = undefined;\n\n\t\t\t\t\tresolve(editor);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\ttimer = undefined;\n\n\t\t\t\tresolve(window.activeTextEditor);\n\t\t\t}, timeout);\n\t\t});\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\n\nexport interface CopyMessageToClipboardCommandArgs {\n\tmessage?: string;\n\tsha?: string;\n}\n\n@command()\nexport class CopyMessageToClipboardCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyMessageToClipboard);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: CopyMessageToClipboardCommandArgs) {\n\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.commit.sha;\n\t\t\treturn this.execute(context.editor, context.node.commit.uri, args);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: CopyMessageToClipboardCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tlet repoPath;\n\t\t\t// If we don't have an editor then get the message of the last commit to the branch\n\t\t\tif (uri == null) {\n\t\t\t\trepoPath = await Container.git.getActiveRepoPath(editor);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst log = await Container.git.getLog(repoPath, { maxCount: 1 });\n\t\t\t\tif (!log) return undefined;\n\n\t\t\t\targs.message = Iterables.first(log.commits.values()).message;\n\t\t\t} else if (args.message === undefined) {\n\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\t\trepoPath = gitUri.repoPath;\n\n\t\t\t\tif (args.sha === undefined) {\n\t\t\t\t\tconst blameline = (editor && editor.selection.active.line) || 0;\n\t\t\t\t\tif (blameline < 0) return undefined;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst blame =\n\t\t\t\t\t\t\teditor && editor.document && editor.document.isDirty\n\t\t\t\t\t\t\t\t? await Container.git.getBlameForLineContents(\n\t\t\t\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\t\t\t\tblameline,\n\t\t\t\t\t\t\t\t\t\teditor.document.getText()\n\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\t\t\tif (!blame) return undefined;\n\n\t\t\t\t\t\tif (blame.commit.isUncommitted) return undefined;\n\n\t\t\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\t\t\tif (!repoPath) {\n\t\t\t\t\t\t\trepoPath = blame.commit.repoPath;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tLogger.error(ex, 'CopyMessageToClipboardCommand', `getBlameForLine(${blameline})`);\n\t\t\t\t\t\treturn Messages.showGenericErrorMessage('Unable to copy message');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Get the full commit message -- since blame only returns the summary\n\t\t\t\tconst commit = await Container.git.getCommit(repoPath!, args.sha);\n\t\t\t\tif (commit === undefined) return undefined;\n\n\t\t\t\targs.message = commit.message;\n\t\t\t}\n\n\t\t\tvoid (await env.clipboard.writeText(args.message));\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tif (ex.message.includes(\"Couldn't find the required `xsel` binary\")) {\n\t\t\t\twindow.showErrorMessage(\n\t\t\t\t\t'Unable to copy message, xsel is not installed. Please install it via your package manager, e.g. `sudo apt install xsel`'\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'CopyMessageToClipboardCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to copy message');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { StatusFileNode } from '../views/nodes';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\nimport { OpenFileInRemoteCommandArgs } from './openFileInRemote';\n\nexport interface CopyRemoteFileUrlToClipboardCommandArgs {\n\trange?: boolean;\n\tsha?: string;\n}\n\n@command()\nexport class CopyRemoteFileUrlToClipboardCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyRemoteFileUrlToClipboard);\n\t}\n\n\tprotected preExecute(context: CommandContext, args: CopyRemoteFileUrlToClipboardCommandArgs = { range: true }) {\n\t\tif (context.type === 'uris' || context.type === 'scm-states') {\n\t\t\targs = { ...args, range: false };\n\t\t} else if (isCommandViewContextWithCommit(context)) {\n\t\t\targs = { ...args, range: false, sha: context.node.commit.sha };\n\n\t\t\t// If it is a StatusFileNode then don't include the sha, since it hasn't been pushed yet\n\t\t\tif (context.node instanceof StatusFileNode) {\n\t\t\t\targs.sha = undefined;\n\t\t\t}\n\n\t\t\treturn this.execute(\n\t\t\t\tcontext.editor,\n\t\t\t\tcontext.node.commit.isFile ? context.node.commit.uri : context.node.uri,\n\t\t\t\targs\n\t\t\t);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args: CopyRemoteFileUrlToClipboardCommandArgs = { range: true }) {\n\t\tif (args.sha === undefined) {\n\t\t\turi = getCommandUri(uri, editor);\n\t\t\tif (uri == null) return undefined;\n\n\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\tif (!gitUri.repoPath) return undefined;\n\n\t\t\targs = { ...args };\n\t\t\tif (gitUri.sha === undefined) {\n\t\t\t\tconst commit = await Container.git.getCommitForFile(gitUri.repoPath, gitUri.fsPath, {\n\t\t\t\t\tfirstIfNotFound: true\n\t\t\t\t});\n\n\t\t\t\tif (commit !== undefined) {\n\t\t\t\t\targs.sha = commit.sha;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\targs.sha = gitUri.sha;\n\t\t\t}\n\t\t}\n\n\t\tconst commandArgs: OpenFileInRemoteCommandArgs = { ...args, clipboard: true };\n\t\treturn commands.executeCommand(Commands.OpenFileInRemote, uri, commandArgs);\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\n\nexport interface CopyShaToClipboardCommandArgs {\n\tsha?: string;\n}\n\n@command()\nexport class CopyShaToClipboardCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.CopyShaToClipboard);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: CopyShaToClipboardCommandArgs) {\n\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.commit.sha;\n\t\t\treturn this.execute(context.editor, context.node.commit.uri, args);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: CopyShaToClipboardCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\t// If we don't have an editor then get the sha of the last commit to the branch\n\t\t\tif (uri == null) {\n\t\t\t\tconst repoPath = await Container.git.getActiveRepoPath(editor);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst log = await Container.git.getLog(repoPath, { maxCount: 1 });\n\t\t\t\tif (!log) return undefined;\n\n\t\t\t\targs.sha = Iterables.first(log.commits.values()).sha;\n\t\t\t} else if (args.sha === undefined) {\n\t\t\t\tconst blameline = (editor && editor.selection.active.line) || 0;\n\t\t\t\tif (blameline < 0) return undefined;\n\n\t\t\t\ttry {\n\t\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\t\t\t\tconst blame =\n\t\t\t\t\t\teditor && editor.document && editor.document.isDirty\n\t\t\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\t\tif (blame === undefined) return undefined;\n\n\t\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tLogger.error(ex, 'CopyShaToClipboardCommand', `getBlameForLine(${blameline})`);\n\t\t\t\t\treturn Messages.showGenericErrorMessage('Unable to copy commit id');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvoid (await env.clipboard.writeText(args.sha));\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tif (ex.message.includes(\"Couldn't find the required `xsel` binary\")) {\n\t\t\t\twindow.showErrorMessage(\n\t\t\t\t\t'Unable to copy commit id, xsel is not installed. Please install it via your package manager, e.g. `sudo apt install xsel`'\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'CopyShaToClipboardCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to copy commit id');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, ReferencesQuickPick, ReferencesQuickPickIncludes } from '../quickpicks';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt\n} from './common';\n\nexport interface DiffBranchWithCommandArgs {\n\tref1?: string;\n\tref2?: string;\n}\n\n@command()\nexport class DiffBranchWithCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.DiffHeadWith,\n\t\t\tCommands.DiffWorkingWith,\n\t\t\tCommands.DiffHeadWithBranch,\n\t\t\tCommands.DiffWorkingWithBranch\n\t\t]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: DiffBranchWithCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.DiffHeadWith:\n\t\t\tcase Commands.DiffHeadWithBranch:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = 'HEAD';\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.DiffWorkingWith:\n\t\t\tcase Commands.DiffWorkingWithBranch:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = '';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffBranchWithCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\tif (args.ref1 === undefined) return undefined;\n\n\t\ttry {\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\t\turi,\n\t\t\t\teditor,\n\t\t\t\t`Compare in which repository${GlyphChars.Ellipsis}`\n\t\t\t);\n\t\t\tif (!repoPath) return undefined;\n\n\t\t\tif (!args.ref2) {\n\t\t\t\tlet checkmarks;\n\t\t\t\tlet placeHolder;\n\t\t\t\tswitch (args.ref1) {\n\t\t\t\t\tcase '':\n\t\t\t\t\t\tcheckmarks = false;\n\t\t\t\t\t\tplaceHolder = `Compare Working Tree with${GlyphChars.Ellipsis}`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'HEAD':\n\t\t\t\t\t\tcheckmarks = false;\n\t\t\t\t\t\tplaceHolder = `Compare HEAD with${GlyphChars.Ellipsis}`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcheckmarks = true;\n\t\t\t\t\t\tplaceHolder = `Compare ${args.ref1} with${GlyphChars.Ellipsis}`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(placeHolder, {\n\t\t\t\t\tallowEnteringRefs: true,\n\t\t\t\t\tchecked: args.ref1,\n\t\t\t\t\tcheckmarks: checkmarks,\n\t\t\t\t\tinclude: ReferencesQuickPickIncludes.BranchesAndTags | ReferencesQuickPickIncludes.WorkingTree\n\t\t\t\t});\n\t\t\t\tif (pick === undefined) return undefined;\n\n\t\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t\targs.ref2 = pick.ref;\n\t\t\t\tif (args.ref2 === undefined) return undefined;\n\t\t\t}\n\n\t\t\tawait Container.compareView.compare(repoPath, args.ref1, args.ref2);\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'DiffBranchWithBranchCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open branch compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../quickpicks';\nimport { CompareResultsNode } from '../views/nodes';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandViewContextWithRef\n} from './common';\n\nexport interface DiffDirectoryCommandArgs {\n\tref1?: string;\n\tref2?: string;\n}\n\n@command()\nexport class DiffDirectoryCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.DiffDirectory,\n\t\t\tCommands.DiffDirectoryWithHead,\n\t\t\tCommands.ViewsOpenDirectoryDiff,\n\t\t\tCommands.ViewsOpenDirectoryDiffWithWorking\n\t\t]);\n\t}\n\n\tprotected async preExecute(context: CommandContext, args?: DiffDirectoryCommandArgs) {\n\t\tswitch (context.command) {\n\t\t\tcase Commands.DiffDirectoryWithHead:\n\t\t\t\targs = { ...args };\n\t\t\t\targs.ref1 = 'HEAD';\n\t\t\t\targs.ref2 = undefined;\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.ViewsOpenDirectoryDiff:\n\t\t\t\tif (context.type === 'viewItem' && context.node instanceof CompareResultsNode) {\n\t\t\t\t\targs = { ...args };\n\t\t\t\t\t[args.ref1, args.ref2] = await context.node.getDiffRefs();\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase Commands.ViewsOpenDirectoryDiffWithWorking:\n\t\t\t\tif (isCommandViewContextWithRef(context)) {\n\t\t\t\t\targs = { ...args };\n\t\t\t\t\targs.ref1 = context.node.ref;\n\t\t\t\t\targs.ref2 = undefined;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffDirectoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\t\turi,\n\t\t\t\teditor,\n\t\t\t\t`Compare directory in which repository${GlyphChars.Ellipsis}`\n\t\t\t);\n\t\t\tif (!repoPath) return undefined;\n\n\t\t\tif (!args.ref1) {\n\t\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(\n\t\t\t\t\t`Compare Working Tree with${GlyphChars.Ellipsis}`,\n\t\t\t\t\t{ allowEnteringRefs: true, checkmarks: false }\n\t\t\t\t);\n\t\t\t\tif (pick === undefined) return undefined;\n\n\t\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t\targs.ref1 = pick.ref;\n\t\t\t\tif (args.ref1 === undefined) return undefined;\n\t\t\t}\n\n\t\t\tawait Container.git.openDirectoryDiff(repoPath, args.ref1, args.ref2);\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tconst msg = ex && ex.toString();\n\t\t\tif (msg === 'No diff tool found') {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to open directory compare because there is no Git diff tool configured',\n\t\t\t\t\t'View Git Docs'\n\t\t\t\t);\n\t\t\t\tif (!result) return undefined;\n\n\t\t\t\treturn env.openExternal(\n\t\t\t\t\tUri.parse('https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool')\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'DiffDirectoryCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open directory compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffLineWithPreviousCommandArgs {\n\tcommit?: GitCommit;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffLineWithPreviousCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffLineWithPrevious);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffLineWithPreviousCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tconst gitUri = args.commit !== undefined ? GitUri.fromCommit(args.commit) : await GitUri.fromUri(uri);\n\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getPreviousLineDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\targs.line,\n\t\t\t\tgitUri.sha\n\t\t\t);\n\n\t\t\tif (diffUris === undefined || diffUris.previous === undefined) {\n\t\t\t\treturn Messages.showCommitHasNoPreviousCommitWarningMessage();\n\t\t\t}\n\n\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha || '',\n\t\t\t\t\turi: diffUris.previous.documentUri()\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha || '',\n\t\t\t\t\turi: diffUris.current.documentUri()\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffLineWithPreviousCommand',\n\t\t\t\t`getPreviousLineDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`\n\t\t\t);\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffLineWithWorkingCommandArgs {\n\tcommit?: GitCommit;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffLineWithWorkingCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffLineWithWorking);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffLineWithWorkingCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tif (args.commit === undefined || args.commit.isUncommitted) {\n\t\t\tconst blameline = args.line;\n\t\t\tif (blameline < 0) return undefined;\n\n\t\t\ttry {\n\t\t\t\tconst blame =\n\t\t\t\t\teditor && editor.document && editor.document.isDirty\n\t\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame === undefined) {\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to open compare');\n\t\t\t\t}\n\n\t\t\t\targs.commit = blame.commit;\n\n\t\t\t\t// If the line is uncommitted, change the previous commit\n\t\t\t\tif (args.commit.isUncommitted) {\n\t\t\t\t\tconst status = await Container.git.getStatusForFile(gitUri.repoPath!, gitUri.fsPath);\n\t\t\t\t\targs.commit = args.commit.with({\n\t\t\t\t\t\tsha:\n\t\t\t\t\t\t\tstatus !== undefined && status.indexStatus !== undefined\n\t\t\t\t\t\t\t\t? GitService.uncommittedStagedSha\n\t\t\t\t\t\t\t\t: args.commit.previousSha!,\n\t\t\t\t\t\tfileName: args.commit.previousFileName!,\n\t\t\t\t\t\toriginalFileName: null,\n\t\t\t\t\t\tpreviousSha: null,\n\t\t\t\t\t\tpreviousFileName: null\n\t\t\t\t\t});\n\t\t\t\t\t// editor lines are 0-based\n\t\t\t\t\targs.line = blame.line.line - 1;\n\t\t\t\t}\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'DiffLineWithWorkingCommand', `getBlameForLine(${blameline})`);\n\t\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t\t}\n\t\t}\n\n\t\tconst workingUri = await args.commit.getWorkingUri();\n\t\tif (workingUri === undefined) {\n\t\t\treturn window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\t\t}\n\n\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\trepoPath: args.commit.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: args.commit.sha,\n\t\t\t\turi: args.commit.uri\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: workingUri\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions\n\t\t};\n\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, Range, TextDocumentShowOptions, TextEditor, Uri, ViewColumn } from 'vscode';\nimport { BuiltInCommands, GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands } from './common';\n\nexport interface DiffWithCommandArgsRevision {\n\tsha: string;\n\turi: Uri;\n\ttitle?: string;\n}\n\nexport interface DiffWithCommandArgs {\n\tlhs: DiffWithCommandArgsRevision;\n\trhs: DiffWithCommandArgsRevision;\n\trepoPath: string | undefined;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithCommand extends ActiveEditorCommand {\n\tstatic getMarkdownCommandArgs(args: DiffWithCommandArgs): string;\n\tstatic getMarkdownCommandArgs(commit: GitCommit, line?: number): string;\n\tstatic getMarkdownCommandArgs(argsOrCommit: DiffWithCommandArgs | GitCommit, line?: number): string {\n\t\tlet args: DiffWithCommandArgs | GitCommit;\n\t\tif (GitCommit.is(argsOrCommit)) {\n\t\t\tconst commit = argsOrCommit;\n\n\t\t\tif (commit.isUncommitted) {\n\t\t\t\targs = {\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: 'HEAD',\n\t\t\t\t\t\turi: commit.uri\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: '',\n\t\t\t\t\t\turi: commit.uri\n\t\t\t\t\t},\n\t\t\t\t\tline: line\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\targs = {\n\t\t\t\t\trepoPath: commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: commit.previousSha !== undefined ? commit.previousSha : GitService.deletedOrMissingSha,\n\t\t\t\t\t\turi: commit.previousUri\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: commit.sha,\n\t\t\t\t\t\turi: commit.uri\n\t\t\t\t\t},\n\t\t\t\t\tline: line\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\targs = argsOrCommit;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<DiffWithCommandArgs>(Commands.DiffWith, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.DiffWith);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithCommandArgs): Promise<any> {\n\t\tif (args === undefined || args.lhs === undefined || args.rhs === undefined) return undefined;\n\n\t\targs = {\n\t\t\t...args,\n\t\t\tlhs: { ...args.lhs },\n\t\t\trhs: { ...args.rhs },\n\t\t\tshowOptions: args.showOptions === undefined ? undefined : { ...args.showOptions }\n\t\t};\n\n\t\tif (args.repoPath === undefined) return undefined;\n\n\t\ttry {\n\t\t\tlet lhsSha = args.lhs.sha;\n\t\t\tlet rhsSha = args.rhs.sha;\n\n\t\t\t[args.lhs.sha, args.rhs.sha] = await Promise.all([\n\t\t\t\tawait Container.git.resolveReference(args.repoPath, args.lhs.sha, args.lhs.uri),\n\t\t\t\tawait Container.git.resolveReference(args.repoPath, args.rhs.sha, args.rhs.uri)\n\t\t\t]);\n\n\t\t\tif (args.lhs.sha !== GitService.deletedOrMissingSha) {\n\t\t\t\tlhsSha = args.lhs.sha;\n\t\t\t}\n\n\t\t\tif (args.rhs.sha && args.rhs.sha !== GitService.deletedOrMissingSha) {\n\t\t\t\t// Ensure that the file still exists in this commit\n\t\t\t\tconst status = await Container.git.getFileStatusForCommit(\n\t\t\t\t\targs.repoPath,\n\t\t\t\t\targs.rhs.uri.fsPath,\n\t\t\t\t\targs.rhs.sha\n\t\t\t\t);\n\t\t\t\tif (status !== undefined && status.status === 'D') {\n\t\t\t\t\targs.rhs.sha = GitService.deletedOrMissingSha;\n\t\t\t\t} else {\n\t\t\t\t\trhsSha = args.rhs.sha;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst [lhs, rhs] = await Promise.all([\n\t\t\t\tContainer.git.getVersionedUri(args.repoPath, args.lhs.uri.fsPath, args.lhs.sha),\n\t\t\t\tContainer.git.getVersionedUri(args.repoPath, args.rhs.uri.fsPath, args.rhs.sha)\n\t\t\t]);\n\n\t\t\tlet rhsSuffix = GitService.shortenSha(rhsSha, { strings: { uncommitted: 'Working Tree' } }) || '';\n\t\t\tif (rhs === undefined) {\n\t\t\t\tif (GitService.isUncommitted(args.rhs.sha)) {\n\t\t\t\t\trhsSuffix = 'deleted';\n\t\t\t\t} else if (rhsSuffix.length === 0 && args.rhs.sha === GitService.deletedOrMissingSha) {\n\t\t\t\t\trhsSuffix = 'not in Working Tree';\n\t\t\t\t} else {\n\t\t\t\t\trhsSuffix = `deleted${rhsSuffix.length === 0 ? '' : ` in ${rhsSuffix}`}`;\n\t\t\t\t}\n\t\t\t} else if (lhs === undefined) {\n\t\t\t\trhsSuffix = `added${rhsSuffix.length === 0 ? '' : ` in ${rhsSuffix}`}`;\n\t\t\t}\n\n\t\t\tlet lhsSuffix = args.lhs.sha !== GitService.deletedOrMissingSha ? GitService.shortenSha(lhsSha) || '' : '';\n\t\t\tif (lhs === undefined && args.rhs.sha.length === 0) {\n\t\t\t\tif (rhs !== undefined) {\n\t\t\t\t\tlhsSuffix = lhsSuffix.length === 0 ? '' : `not in ${lhsSuffix}`;\n\t\t\t\t\trhsSuffix = '';\n\t\t\t\t} else {\n\t\t\t\t\tlhsSuffix = `deleted${lhsSuffix.length === 0 ? '' : ` in ${lhsSuffix}`}`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.lhs.title === undefined && (lhs !== undefined || lhsSuffix.length !== 0)) {\n\t\t\t\targs.lhs.title = `${paths.basename(args.lhs.uri.fsPath)}${lhsSuffix ? ` (${lhsSuffix})` : ''}`;\n\t\t\t}\n\t\t\tif (args.rhs.title === undefined) {\n\t\t\t\targs.rhs.title = `${paths.basename(args.rhs.uri.fsPath)}${rhsSuffix ? ` (${rhsSuffix})` : ''}`;\n\t\t\t}\n\n\t\t\tconst title =\n\t\t\t\targs.lhs.title !== undefined && args.rhs.title !== undefined\n\t\t\t\t\t? `${args.lhs.title} ${GlyphChars.ArrowLeftRightLong} ${args.rhs.title}`\n\t\t\t\t\t: args.lhs.title || args.rhs.title;\n\n\t\t\tif (args.showOptions === undefined) {\n\t\t\t\targs.showOptions = {};\n\t\t\t}\n\n\t\t\tif (args.showOptions.viewColumn === undefined) {\n\t\t\t\targs.showOptions.viewColumn = ViewColumn.Active;\n\t\t\t}\n\n\t\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\treturn await commands.executeCommand(\n\t\t\t\tBuiltInCommands.Diff,\n\t\t\t\tlhs === undefined\n\t\t\t\t\t? GitUri.toRevisionUri(GitService.deletedOrMissingSha, args.lhs.uri.fsPath, args.repoPath)\n\t\t\t\t\t: lhs,\n\t\t\t\trhs === undefined\n\t\t\t\t\t? GitUri.toRevisionUri(GitService.deletedOrMissingSha, args.rhs.uri.fsPath, args.repoPath)\n\t\t\t\t\t: rhs,\n\t\t\t\ttitle,\n\t\t\t\targs.showOptions\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'DiffWithCommand', 'getVersionedFile');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, Range, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitLogCommit, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, CommandContext, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithNextCommandArgs {\n\tcommit?: GitLogCommit;\n\trange?: Range;\n\n\tinDiffLeftEditor?: boolean;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithNextCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithNext, Commands.DiffWithNextInDiffLeft]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: DiffWithNextCommandArgs) {\n\t\tif (context.command === Commands.DiffWithNextInDiffLeft) {\n\t\t\targs = { ...args };\n\t\t\targs.inDiffLeftEditor = true;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithNextCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tconst gitUri = args.commit !== undefined ? GitUri.fromCommit(args.commit) : await GitUri.fromUri(uri);\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getNextDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\tgitUri.sha,\n\t\t\t\t// If we are in the left-side of the diff editor, we need to skip forward 1 more revision\n\t\t\t\targs.inDiffLeftEditor ? 1 : 0\n\t\t\t);\n\n\t\t\tif (diffUris === undefined || diffUris.next === undefined) return undefined;\n\n\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.current.sha || '',\n\t\t\t\t\turi: diffUris.current.documentUri()\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.next.sha || '',\n\t\t\t\t\turi: diffUris.next.documentUri()\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffWithNextCommand',\n\t\t\t\t`getNextDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`\n\t\t\t);\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitCommit, GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, CommandContext, Commands, getCommandUri, openEditor } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithPreviousCommandArgs {\n\tcommit?: GitCommit;\n\n\tinDiffRightEditor?: boolean;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithPreviousCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithPrevious, Commands.DiffWithPreviousInDiffRight]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: DiffWithPreviousCommandArgs) {\n\t\tif (context.command === Commands.DiffWithPreviousInDiffRight) {\n\t\t\targs = { ...args };\n\t\t\targs.inDiffRightEditor = true;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithPreviousCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tlet gitUri;\n\t\tif (args.commit !== undefined) {\n\t\t\tif (!args.commit.isUncommitted) {\n\t\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\t\trepoPath: args.commit.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: `${args.commit.sha}^`,\n\t\t\t\t\t\turi: args.commit.originalUri\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: args.commit.sha || '',\n\t\t\t\t\t\turi: args.commit.uri\n\t\t\t\t\t},\n\t\t\t\t\tline: args.line,\n\t\t\t\t\tshowOptions: args.showOptions\n\t\t\t\t};\n\t\t\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t\t}\n\n\t\t\tgitUri = GitUri.fromCommit(args.commit);\n\t\t} else {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\ttry {\n\t\t\tconst diffUris = await Container.git.getPreviousDiffUris(\n\t\t\t\tgitUri.repoPath!,\n\t\t\t\tgitUri,\n\t\t\t\tgitUri.sha,\n\t\t\t\t// If we are in the right-side of the diff editor, we need to skip back 1 more revision\n\t\t\t\targs.inDiffRightEditor ? 1 : 0\n\t\t\t);\n\n\t\t\tif (diffUris === undefined || diffUris.previous === undefined) {\n\t\t\t\tif (diffUris === undefined) return Messages.showCommitHasNoPreviousCommitWarningMessage();\n\n\t\t\t\t// If we have no previous and the current is the working file, just open the working file\n\t\t\t\tif (diffUris.current.sha === undefined) {\n\t\t\t\t\treturn openEditor(diffUris.current, args.showOptions);\n\t\t\t\t}\n\n\t\t\t\tif (!diffUris.current.isUncommittedStaged) {\n\t\t\t\t\treturn Messages.showCommitHasNoPreviousCommitWarningMessage();\n\t\t\t\t}\n\n\t\t\t\t// If we have no previous and the current is staged, then diff staged with missing\n\t\t\t\tdiffUris.previous = GitUri.fromFile(\n\t\t\t\t\tdiffUris.current.fileName,\n\t\t\t\t\tdiffUris.current.repoPath!,\n\t\t\t\t\tGitService.deletedOrMissingSha\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\trepoPath: diffUris.current.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: diffUris.previous.sha || '',\n\t\t\t\t\turi: diffUris.previous.documentUri()\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: diffUris.current.sha || '',\n\t\t\t\t\turi: diffUris.current.documentUri()\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(\n\t\t\t\tex,\n\t\t\t\t'DiffWithPreviousCommand',\n\t\t\t\t`getPreviousDiffUris(${gitUri.repoPath}, ${gitUri.fsPath}, ${gitUri.sha})`\n\t\t\t);\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t}\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitService, GitUri } from '../git/gitService';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithRefCommandArgs {\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class DiffWithRefCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.DiffWithRef, Commands.DiffWithBranch]);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithRefCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return Messages.showNoRepositoryWarningMessage('Unable to open file compare');\n\n\t\tconst pick = await new ReferencesQuickPick(gitUri.repoPath).show(\n\t\t\t`Compare ${gitUri.getFormattedPath()} with${GlyphChars.Ellipsis}`,\n\t\t\t{\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tcheckmarks: false,\n\t\t\t\tgoBack: args.goBackCommand\n\t\t\t}\n\t\t);\n\t\tif (pick === undefined) return undefined;\n\n\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\tconst ref = pick.ref;\n\t\tif (ref === undefined) return undefined;\n\n\t\tlet renamedUri: Uri | undefined;\n\t\tlet renamedTitle: string | undefined;\n\n\t\t// Check to see if this file has been renamed\n\t\tconst files = await Container.git.getDiffStatus(gitUri.repoPath, 'HEAD', ref, { filter: 'R' });\n\t\tif (files !== undefined) {\n\t\t\tconst fileName = Strings.normalizePath(paths.relative(gitUri.repoPath, gitUri.fsPath));\n\t\t\tconst rename = files.find(s => s.fileName === fileName);\n\t\t\tif (rename !== undefined && rename.originalFileName !== undefined) {\n\t\t\t\trenamedUri = GitUri.resolveToUri(rename.originalFileName, gitUri.repoPath);\n\t\t\t\trenamedTitle = `${paths.basename(rename.originalFileName)} (${GitService.shortenSha(ref)})`;\n\t\t\t}\n\t\t}\n\n\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\trepoPath: gitUri.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: pick.remote ? `remotes/${ref}` : ref,\n\t\t\t\turi: renamedUri || (gitUri as Uri),\n\t\t\t\ttitle: renamedTitle || `${paths.basename(gitUri.fsPath)} (${GitService.shortenSha(ref)})`\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: gitUri as Uri\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions\n\t\t};\n\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t}\n}\n","'use strict';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitReference, GitTag, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, FileHistoryQuickPick, ShowFileHistoryFromQuickPickItem } from '../quickpicks';\nimport { Iterables, Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithRevisionCommandArgs {\n\treference?: GitBranch | GitTag | GitReference;\n\tmaxCount?: number;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tnextPageCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class DiffWithRevisionCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffWithRevision);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithRevisionCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\tconst placeHolder = `Compare ${gitUri.getFormattedPath({\n\t\t\tsuffix: args.reference ? ` (${args.reference.name})` : undefined\n\t\t})}${gitUri.sha ? ` ${Strings.pad(GlyphChars.Dot, 1, 1)} ${gitUri.shortSha}` : ''} with revision${\n\t\t\tGlyphChars.Ellipsis\n\t\t}`;\n\n\t\tconst progressCancellation = FileHistoryQuickPick.showProgress(placeHolder);\n\t\ttry {\n\t\t\tconst log = await Container.git.getLogForFile(gitUri.repoPath, gitUri.fsPath, {\n\t\t\t\tmaxCount: args.maxCount,\n\t\t\t\tref: (args.reference && args.reference.ref) || gitUri.sha\n\t\t\t});\n\t\t\tif (log === undefined) {\n\t\t\t\tif (args.reference) {\n\t\t\t\t\treturn window.showWarningMessage(`The file could not be found in ${args.reference.name}`);\n\t\t\t\t}\n\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to open history compare');\n\t\t\t}\n\n\t\t\tif (progressCancellation.token.isCancellationRequested) return undefined;\n\n\t\t\tlet previousPageCommand: CommandQuickPickItem | undefined = undefined;\n\n\t\t\tlet commandArgs: DiffWithRevisionCommandArgs;\n\t\t\tif (log.truncated) {\n\t\t\t\tcommandArgs = { ...args };\n\t\t\t\tconst npc = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(arrow-right) Show Next Commits',\n\t\t\t\t\t\tdescription: `shows ${log.maxCount} newer commits`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.DiffWithRevision,\n\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t);\n\n\t\t\t\tconst last = Iterables.last(log.commits.values());\n\t\t\t\tif (last != null) {\n\t\t\t\t\tcommandArgs = { ...args, nextPageCommand: npc };\n\t\t\t\t\tpreviousPageCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(arrow-left) Show Previous Commits',\n\t\t\t\t\t\t\tdescription: `shows ${log.maxCount} older commits`\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.DiffWithRevision,\n\t\t\t\t\t\t[new GitUri(uri, last), commandArgs]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcommandArgs = { ...args };\n\t\t\tconst icon = GitTag.isOfRefType(args.reference)\n\t\t\t\t? '$(tag) '\n\t\t\t\t: GitBranch.isOfRefType(args.reference)\n\t\t\t\t? '$(git-branch) '\n\t\t\t\t: '';\n\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\tdescription: `to history of ${gitUri.getFormattedPath()}${\n\t\t\t\t\t\targs.reference\n\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}${icon}${args.reference.name}`\n\t\t\t\t\t\t\t: gitUri.sha\n\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}$(git-commit) ${gitUri.shortSha}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t}`\n\t\t\t\t},\n\t\t\t\tCommands.DiffWithRevision,\n\t\t\t\t[uri, commandArgs]\n\t\t\t);\n\n\t\t\tcommandArgs = { ...args, maxCount: 0 };\n\t\t\tconst pick = await FileHistoryQuickPick.show(log, gitUri, placeHolder, {\n\t\t\t\tpickerOnly: true,\n\t\t\t\tprogressCancellation: progressCancellation,\n\t\t\t\tcurrentCommand: currentCommand,\n\t\t\t\tnextPageCommand: args.nextPageCommand,\n\t\t\t\tpreviousPageCommand: previousPageCommand,\n\t\t\t\tshowAllCommand: log.truncated\n\t\t\t\t\t? new CommandQuickPickItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: '$(sync) Show All Commits',\n\t\t\t\t\t\t\t\tdescription: 'this may take a while'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tCommands.DiffWithRevision,\n\t\t\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined\n\t\t\t});\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (pick instanceof ShowFileHistoryFromQuickPickItem) {\n\t\t\t\tconst reference = await pick.execute();\n\t\t\t\tif (reference === undefined) return undefined;\n\t\t\t\tif (reference instanceof CommandQuickPickItem) return reference.execute();\n\n\t\t\t\tcommandArgs = {\n\t\t\t\t\t...args,\n\t\t\t\t\treference: reference.item\n\t\t\t\t};\n\t\t\t\treturn commands.executeCommand(Commands.DiffWithRevision, gitUri, commandArgs);\n\t\t\t}\n\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\tconst ref = pick.item.sha;\n\n\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\tlhs: {\n\t\t\t\t\tsha: ref,\n\t\t\t\t\turi: gitUri as Uri\n\t\t\t\t},\n\t\t\t\trhs: {\n\t\t\t\t\tsha: '',\n\t\t\t\t\turi: gitUri as Uri\n\t\t\t\t},\n\t\t\t\tline: args.line,\n\t\t\t\tshowOptions: args.showOptions\n\t\t\t};\n\t\t\treturn await commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'DiffWithRevisionCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open compare');\n\t\t} finally {\n\t\t\tprogressCancellation.cancel();\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitService, GitUri } from '../git/gitService';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { DiffWithCommandArgs } from './diffWith';\n\nexport interface DiffWithWorkingCommandArgs {\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class DiffWithWorkingCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.DiffWithWorking);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: DiffWithWorkingCommandArgs): Promise<any> {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\t// if (args.commit === undefined || args.commit.isUncommitted) {\n\t\t// If the sha is missing, just let the user know the file matches\n\t\tif (gitUri.sha === undefined) return window.showInformationMessage('File matches the working tree');\n\t\tif (gitUri.sha === GitService.deletedOrMissingSha) {\n\t\t\treturn window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\t\t}\n\n\t\t// If we are a fake \"staged\" sha, check the status\n\t\tif (gitUri.isUncommittedStaged) {\n\t\t\tconst status = await Container.git.getStatusForFile(gitUri.repoPath!, gitUri.fsPath);\n\t\t\tif (status !== undefined && status.indexStatus !== undefined) {\n\t\t\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\t\t\trepoPath: gitUri.repoPath,\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: GitService.uncommittedStagedSha,\n\t\t\t\t\t\turi: gitUri.documentUri()\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: '',\n\t\t\t\t\t\turi: gitUri.documentUri()\n\t\t\t\t\t},\n\t\t\t\t\tline: args.line,\n\t\t\t\t\tshowOptions: args.showOptions\n\t\t\t\t};\n\n\t\t\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t\t\t}\n\t\t}\n\n\t\turi = gitUri.toFileUri();\n\n\t\tconst workingUri = await Container.git.getWorkingUri(gitUri.repoPath!, uri);\n\t\tif (workingUri === undefined) {\n\t\t\treturn window.showWarningMessage('Unable to open compare. File has been deleted from the working tree');\n\t\t}\n\n\t\tconst diffArgs: DiffWithCommandArgs = {\n\t\t\trepoPath: gitUri.repoPath,\n\t\t\tlhs: {\n\t\t\t\tsha: gitUri.sha,\n\t\t\t\turi: uri\n\t\t\t},\n\t\t\trhs: {\n\t\t\t\tsha: '',\n\t\t\t\turi: workingUri\n\t\t\t},\n\t\t\tline: args.line,\n\t\t\tshowOptions: args.showOptions\n\t\t};\n\t\treturn commands.executeCommand(Commands.DiffWith, diffArgs);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { GitUri } from '../git/gitService';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, openWorkspace } from './common';\nimport { toGitLensFSUri } from '../git/fsProvider';\nimport { BuiltInCommands } from '../constants';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\n\nexport interface ExploreRepoAtRevisionCommandArgs {\n\turi?: Uri;\n}\n\n@command()\nexport class ExploreRepoAtRevisionCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.ExploreRepoAtRevision);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: ExploreRepoAtRevisionCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return undefined;\n\t\t\t} else {\n\t\t\t\turi = args.uri;\n\t\t\t}\n\n\t\t\tlet gitUri = await GitUri.fromUri(uri);\n\t\t\tif (gitUri.sha === undefined) return undefined;\n\n\t\t\turi = toGitLensFSUri(gitUri.sha, gitUri.repoPath!);\n\t\t\tgitUri = GitUri.fromRevisionUri(uri);\n\n\t\t\topenWorkspace(uri, `${paths.basename(gitUri.repoPath!)} @ ${gitUri.shortSha}`);\n\n\t\t\tvoid commands.executeCommand(BuiltInCommands.FocusFilesExplorer);\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ExploreRepoAtRevisionCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open the repository to the specified revision');\n\t\t}\n\t}\n}\n","'use strict';\nimport { env, SourceControlResourceState, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Arrays } from '../system';\nimport {\n\tcommand,\n\tCommand,\n\tCommandContext,\n\tCommands,\n\tgetRepoPathOrPrompt,\n\tisCommandViewContextWithFileCommit,\n\tisCommandViewContextWithFileRefs\n} from './common';\n\nenum Status {\n\tINDEX_MODIFIED,\n\tINDEX_ADDED,\n\tINDEX_DELETED,\n\tINDEX_RENAMED,\n\tINDEX_COPIED,\n\n\tMODIFIED,\n\tDELETED,\n\tUNTRACKED,\n\tIGNORED,\n\n\tADDED_BY_US,\n\tADDED_BY_THEM,\n\tDELETED_BY_US,\n\tDELETED_BY_THEM,\n\tBOTH_ADDED,\n\tBOTH_DELETED,\n\tBOTH_MODIFIED\n}\n\nenum ResourceGroupType {\n\tMerge,\n\tIndex,\n\tWorkingTree\n}\n\ninterface Resource extends SourceControlResourceState {\n\treadonly resourceGroupType: ResourceGroupType;\n\treadonly type: Status;\n}\n\ninterface ExternalDiffFile {\n\turi: Uri;\n\tstaged: boolean;\n\tref1?: string;\n\tref2?: string;\n}\n\nexport interface ExternalDiffCommandArgs {\n\tfiles?: ExternalDiffFile[];\n}\n\n@command()\nexport class ExternalDiffCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.ExternalDiff, Commands.ExternalDiffAll]);\n\t}\n\n\tprotected async preExecute(context: CommandContext, args?: ExternalDiffCommandArgs) {\n\t\targs = { ...args };\n\n\t\tif (isCommandViewContextWithFileCommit(context)) {\n\t\t\tconst ref1 = GitService.isUncommitted(context.node.commit.previousFileSha)\n\t\t\t\t? ''\n\t\t\t\t: context.node.commit.previousFileSha;\n\t\t\tconst ref2 = context.node.commit.isUncommitted ? '' : context.node.commit.sha;\n\n\t\t\targs.files = [\n\t\t\t\t{\n\t\t\t\t\turi: GitUri.fromFile(context.node.file, context.node.file.repoPath || context.node.repoPath),\n\t\t\t\t\tstaged: context.node.commit.isUncommittedStaged || context.node.file.indexStatus !== undefined,\n\t\t\t\t\tref1: ref1,\n\t\t\t\t\tref2: ref2\n\t\t\t\t}\n\t\t\t];\n\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\tif (isCommandViewContextWithFileRefs(context)) {\n\t\t\targs.files = [\n\t\t\t\t{\n\t\t\t\t\turi: GitUri.fromFile(context.node.file, context.node.file.repoPath || context.node.repoPath),\n\t\t\t\t\tstaged: context.node.file.indexStatus !== undefined,\n\t\t\t\t\tref1: context.node.ref1,\n\t\t\t\t\tref2: context.node.ref2\n\t\t\t\t}\n\t\t\t];\n\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\tif (args.files === undefined) {\n\t\t\tif (context.type === 'scm-states') {\n\t\t\t\targs.files = context.scmResourceStates.map(r => ({\n\t\t\t\t\turi: r.resourceUri,\n\t\t\t\t\tstaged: (r as Resource).resourceGroupType === ResourceGroupType.Index\n\t\t\t\t}));\n\t\t\t} else if (context.type === 'scm-groups') {\n\t\t\t\targs.files = Arrays.filterMap(context.scmResourceGroups[0].resourceStates, r =>\n\t\t\t\t\tthis.isModified(r)\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\turi: r.resourceUri,\n\t\t\t\t\t\t\t\tstaged: (r as Resource).resourceGroupType === ResourceGroupType.Index\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: undefined\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (context.command === Commands.ExternalDiffAll) {\n\t\t\tif (args.files === undefined) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt(`Open changes from which repository${GlyphChars.Ellipsis}`);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status === undefined) {\n\t\t\t\t\treturn window.showInformationMessage(\"The repository doesn't have any changes\");\n\t\t\t\t}\n\n\t\t\t\targs.files = [];\n\n\t\t\t\tfor (const file of status.files) {\n\t\t\t\t\tif (file.indexStatus === 'M') {\n\t\t\t\t\t\targs.files.push({ uri: file.uri, staged: true });\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file.workingTreeStatus === 'M') {\n\t\t\t\t\t\targs.files.push({ uri: file.uri, staged: false });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tprivate isModified(resource: SourceControlResourceState) {\n\t\tconst status = (resource as Resource).type;\n\t\treturn status === Status.BOTH_MODIFIED || status === Status.INDEX_MODIFIED || status === Status.MODIFIED;\n\t}\n\n\tasync execute(args?: ExternalDiffCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tlet repoPath;\n\t\t\tif (args.files === undefined) {\n\t\t\t\tconst editor = window.activeTextEditor;\n\t\t\t\tif (editor === undefined) return undefined;\n\n\t\t\t\trepoPath = await Container.git.getRepoPathOrActive(undefined, editor);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst uri = editor.document.uri;\n\t\t\t\tconst status = await Container.git.getStatusForFile(repoPath, uri.fsPath);\n\t\t\t\tif (status === undefined) {\n\t\t\t\t\treturn window.showInformationMessage(\"The current file doesn't have any changes\");\n\t\t\t\t}\n\n\t\t\t\targs.files = [];\n\t\t\t\tif (status.indexStatus === 'M') {\n\t\t\t\t\targs.files.push({ uri: status.uri, staged: true });\n\t\t\t\t}\n\n\t\t\t\tif (status.workingTreeStatus === 'M') {\n\t\t\t\t\targs.files.push({ uri: status.uri, staged: false });\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trepoPath = await Container.git.getRepoPath(args.files[0].uri.fsPath);\n\t\t\t\tif (!repoPath) return undefined;\n\t\t\t}\n\n\t\t\tconst tool = await Container.git.getDiffTool(repoPath);\n\t\t\tif (tool === undefined) {\n\t\t\t\tconst result = await window.showWarningMessage(\n\t\t\t\t\t'Unable to open changes in diff tool. No Git diff tool is configured',\n\t\t\t\t\t'View Git Docs'\n\t\t\t\t);\n\t\t\t\tif (!result) return undefined;\n\n\t\t\t\treturn env.openExternal(\n\t\t\t\t\tUri.parse('https://git-scm.com/docs/git-config#Documentation/git-config.txt-difftool')\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tfor (const file of args.files) {\n\t\t\t\tvoid Container.git.openDiffTool(repoPath, file.uri, {\n\t\t\t\t\tref1: file.ref1,\n\t\t\t\t\tref2: file.ref2,\n\t\t\t\t\tstaged: file.staged,\n\t\t\t\t\ttool: tool\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ExternalDiffCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open changes in diff tool');\n\t\t}\n\t}\n}\n","'use strict';\nimport { command, Command, CommandContext, Commands, isCommandViewContextWithContributor } from './common';\nimport { Container } from '../container';\n\nexport interface InviteToLiveShareCommandArgs {\n\temail?: string;\n}\n\n@command()\nexport class InviteToLiveShareCommand extends Command {\n\tstatic getMarkdownCommandArgs(args: InviteToLiveShareCommandArgs): string;\n\tstatic getMarkdownCommandArgs(email: string | undefined): string;\n\tstatic getMarkdownCommandArgs(argsOrEmail: InviteToLiveShareCommandArgs | string | undefined): string {\n\t\tconst args =\n\t\t\targsOrEmail === undefined || typeof argsOrEmail === 'string' ? { email: argsOrEmail } : argsOrEmail;\n\t\treturn super.getMarkdownCommandArgsCore<InviteToLiveShareCommandArgs>(Commands.InviteToLiveShare, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.InviteToLiveShare);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: InviteToLiveShareCommandArgs) {\n\t\tif (isCommandViewContextWithContributor(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.email = context.node.contributor.email;\n\t\t\treturn this.execute(args);\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: InviteToLiveShareCommandArgs) {\n\t\tif (args != null && args.email) {\n\t\t\tconst contact = await Container.vsls.getContact(args.email);\n\t\t\tif (contact != null) {\n\t\t\t\treturn contact.invite();\n\t\t\t}\n\t\t}\n\n\t\treturn Container.vsls.startSession();\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitUri, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandViewContextWithRemote\n} from './common';\nimport { OpenInRemoteCommandArgs } from './openInRemote';\n\nexport interface OpenBranchesInRemoteCommandArgs {\n\tremote?: string;\n}\n\n@command()\nexport class OpenBranchesInRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenBranchesInRemote);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: OpenBranchesInRemoteCommandArgs) {\n\t\tif (isCommandViewContextWithRemote(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.remote = context.node.remote.name;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenBranchesInRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri && (await GitUri.fromUri(uri));\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\t`Open branches on remote for which repository${GlyphChars.Ellipsis}`\n\t\t);\n\t\tif (!repoPath) return undefined;\n\n\t\ttry {\n\t\t\tconst remotes = await Container.git.getRemotes(repoPath);\n\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Branches\n\t\t\t\t},\n\t\t\t\tremote: args && args.remote,\n\t\t\t\tremotes: remotes\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.OpenInRemote, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenBranchesInRemoteCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to open branches on remote provider. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitUri, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { CommandQuickPickItem, ReferencesQuickPick, ReferencesQuickPickIncludes } from '../quickpicks';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandViewContextWithBranch\n} from './common';\nimport { OpenInRemoteCommandArgs } from './openInRemote';\n\nexport interface OpenBranchInRemoteCommandArgs {\n\tbranch?: string;\n\tremote?: string;\n}\n\n@command()\nexport class OpenBranchInRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenBranchInRemote);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: OpenBranchInRemoteCommandArgs) {\n\t\tif (isCommandViewContextWithBranch(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.branch = context.node.branch.name;\n\t\t\targs.remote = context.node.branch.getRemoteName();\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenBranchInRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri && (await GitUri.fromUri(uri));\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\t`Open branch on remote for which repository${GlyphChars.Ellipsis}`\n\t\t);\n\t\tif (!repoPath) return undefined;\n\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.branch === undefined) {\n\t\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(\n\t\t\t\t\t`Open which branch on remote${GlyphChars.Ellipsis}`,\n\t\t\t\t\t{\n\t\t\t\t\t\tautoPick: true,\n\t\t\t\t\t\tcheckmarks: false,\n\t\t\t\t\t\tfilterBranches: b => b.tracking !== undefined,\n\t\t\t\t\t\tinclude: ReferencesQuickPickIncludes.Branches\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (pick === undefined || pick instanceof CommandQuickPickItem) return undefined;\n\n\t\t\t\targs.branch = pick.ref;\n\t\t\t}\n\n\t\t\tconst remotes = await Container.git.getRemotes(repoPath);\n\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Branch,\n\t\t\t\t\tbranch: args.branch || 'HEAD'\n\t\t\t\t},\n\t\t\t\tremote: args.remote,\n\t\t\t\tremotes: remotes\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.OpenInRemote, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenBranchInRemoteCommandArgs');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to open branch on remote provider. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { Arrays } from '../system';\nimport { Command, command, Commands, getRepoPathOrPrompt, openEditor } from './common';\n\nexport interface OpenChangedFilesCommandArgs {\n\turis?: Uri[];\n}\n\n@command()\nexport class OpenChangedFilesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.OpenChangedFiles);\n\t}\n\n\tasync execute(args?: OpenChangedFilesCommandArgs) {\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.uris === undefined) {\n\t\t\t\tconst repoPath = await getRepoPathOrPrompt(\n\t\t\t\t\t`Open all files changed in which repository${GlyphChars.Ellipsis}`\n\t\t\t\t);\n\t\t\t\tif (!repoPath) return undefined;\n\n\t\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\t\tif (status === undefined) return window.showWarningMessage('Unable to open changed files');\n\n\t\t\t\targs.uris = Arrays.filterMap(status.files, f => (f.status !== 'D' ? f.uri : undefined));\n\t\t\t}\n\n\t\t\tfor (const uri of args.uris) {\n\t\t\t\tawait openEditor(uri, { preserveFocus: true, preview: false });\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenChangedFilesCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open all changed files');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\nimport { OpenInRemoteCommandArgs } from './openInRemote';\n\nexport interface OpenCommitInRemoteCommandArgs {\n\tsha?: string;\n}\n\n@command()\nexport class OpenCommitInRemoteCommand extends ActiveEditorCommand {\n\tstatic getMarkdownCommandArgs(sha: string): string;\n\tstatic getMarkdownCommandArgs(args: OpenCommitInRemoteCommandArgs): string;\n\tstatic getMarkdownCommandArgs(argsOrSha: OpenCommitInRemoteCommandArgs | string): string {\n\t\tconst args: OpenCommitInRemoteCommandArgs = typeof argsOrSha === 'string' ? { sha: argsOrSha } : argsOrSha;\n\t\treturn super.getMarkdownCommandArgsCore<OpenCommitInRemoteCommandArgs>(Commands.OpenCommitInRemote, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.OpenCommitInRemote);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: OpenCommitInRemoteCommandArgs) {\n\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.commit.sha;\n\t\t\treturn this.execute(context.editor, context.node.commit.uri, args);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenCommitInRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return undefined;\n\n\t\targs = { ...args };\n\n\t\ttry {\n\t\t\tif (args.sha === undefined) {\n\t\t\t\tconst blameline = editor == null ? 0 : editor.selection.active.line;\n\t\t\t\tif (blameline < 0) return undefined;\n\n\t\t\t\tconst blame =\n\t\t\t\t\teditor && editor.document && editor.document.isDirty\n\t\t\t\t\t\t? await Container.git.getBlameForLineContents(gitUri, blameline, editor.document.getText())\n\t\t\t\t\t\t: await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame === undefined) {\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage(\n\t\t\t\t\t\t'Unable to open commit on remote provider'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tlet commit = blame.commit;\n\t\t\t\t// If the line is uncommitted, find the previous commit\n\t\t\t\tif (commit.isUncommitted) {\n\t\t\t\t\tcommit = commit.with({\n\t\t\t\t\t\tsha: commit.previousSha,\n\t\t\t\t\t\tfileName: commit.previousFileName,\n\t\t\t\t\t\tpreviousSha: null,\n\t\t\t\t\t\tpreviousFileName: null\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\targs.sha = commit.sha;\n\t\t\t}\n\n\t\t\tconst remotes = await Container.git.getRemotes(gitUri.repoPath);\n\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Commit,\n\t\t\t\t\tsha: args.sha\n\t\t\t\t},\n\t\t\t\tremotes: remotes\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.OpenInRemote, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenCommitInRemoteCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to open commit on remote provider. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, Range, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitService, GitUri, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { CommandQuickPickItem, ReferencesQuickPick, ReferencesQuickPickIncludes } from '../quickpicks';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithBranch,\n\tisCommandViewContextWithCommit\n} from './common';\nimport { OpenInRemoteCommandArgs } from './openInRemote';\nimport { Strings } from '../system';\nimport { UriComparer } from '../comparers';\n\nexport interface OpenFileInRemoteCommandArgs {\n\tbranch?: string;\n\tclipboard?: boolean;\n\trange?: boolean;\n\tsha?: string;\n}\n\n@command()\nexport class OpenFileInRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenFileInRemote);\n\t}\n\n\tprotected preExecute(context: CommandContext, args: OpenFileInRemoteCommandArgs = { range: true }) {\n\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.range = false;\n\t\t\tif (isCommandViewContextWithBranch(context)) {\n\t\t\t\targs.branch = context.node.branch !== undefined ? context.node.branch.name : undefined;\n\t\t\t}\n\n\t\t\treturn this.execute(\n\t\t\t\tcontext.editor,\n\t\t\t\tcontext.node.commit.isFile ? context.node.commit.uri : context.node.uri,\n\t\t\t\targs\n\t\t\t);\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args: OpenFileInRemoteCommandArgs = { range: true }) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return undefined;\n\n\t\ttry {\n\t\t\tconst remotes = await Container.git.getRemotes(gitUri.repoPath);\n\t\t\tconst range =\n\t\t\t\targs.range && editor != null && UriComparer.equals(editor.document.uri, uri)\n\t\t\t\t\t? new Range(\n\t\t\t\t\t\t\teditor.selection.start.with({ line: editor.selection.start.line + 1 }),\n\t\t\t\t\t\t\teditor.selection.end.with({ line: editor.selection.end.line + 1 })\n\t\t\t\t\t  )\n\t\t\t\t\t: undefined;\n\t\t\tlet sha = args.sha || gitUri.sha;\n\n\t\t\tif (args.branch === undefined && sha !== undefined && !GitService.isSha(sha) && remotes.length !== 0) {\n\t\t\t\tconst [remotePart, branchPart] = Strings.splitSingle(sha, '/');\n\t\t\t\tif (branchPart !== undefined) {\n\t\t\t\t\tif (remotes.some(r => r.name === remotePart)) {\n\t\t\t\t\t\targs.branch = branchPart;\n\t\t\t\t\t\tsha = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.branch === undefined && args.sha === undefined) {\n\t\t\t\tconst branch = await Container.git.getBranch(gitUri.repoPath);\n\t\t\t\tif (branch === undefined || branch.tracking === undefined) {\n\t\t\t\t\tconst pick = await new ReferencesQuickPick(gitUri.repoPath).show(\n\t\t\t\t\t\targs.clipboard\n\t\t\t\t\t\t\t? `Copy url for ${gitUri.relativePath} to clipboard for which branch${GlyphChars.Ellipsis}`\n\t\t\t\t\t\t\t: `Open ${gitUri.relativePath} on remote for which branch${GlyphChars.Ellipsis}`,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tautoPick: true,\n\t\t\t\t\t\t\tcheckmarks: false,\n\t\t\t\t\t\t\tfilterBranches: b => b.tracking !== undefined,\n\t\t\t\t\t\t\tinclude: ReferencesQuickPickIncludes.Branches\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tif (pick === undefined || pick instanceof CommandQuickPickItem) return undefined;\n\n\t\t\t\t\targs.branch = pick.ref;\n\t\t\t\t} else {\n\t\t\t\t\targs.branch = branch.name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tresource:\n\t\t\t\t\tsha === undefined\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\ttype: RemoteResourceType.File,\n\t\t\t\t\t\t\t\tbranch: args.branch || 'HEAD',\n\t\t\t\t\t\t\t\tfileName: gitUri.relativePath,\n\t\t\t\t\t\t\t\trange: range\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\ttype: RemoteResourceType.Revision,\n\t\t\t\t\t\t\t\tbranch: args.branch || 'HEAD',\n\t\t\t\t\t\t\t\tfileName: gitUri.relativePath,\n\t\t\t\t\t\t\t\trange: range,\n\t\t\t\t\t\t\t\tsha: sha\n\t\t\t\t\t\t  },\n\t\t\t\tremotes: remotes,\n\t\t\t\tclipboard: args.clipboard\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.OpenInRemote, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenFileInRemoteCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to open file on remote provider. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { CancellationTokenSource, commands, Range, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitReference, GitTag, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, FileHistoryQuickPick, ShowFileHistoryFromQuickPickItem } from '../quickpicks';\nimport { Iterables, Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, openEditor } from './common';\n\nexport interface OpenFileRevisionCommandArgs {\n\treference?: GitBranch | GitTag | GitReference;\n\turi?: Uri;\n\tmaxCount?: number;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n\tnextPageCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class OpenFileRevisionCommand extends ActiveEditorCommand {\n\tstatic getMarkdownCommandArgs(args: OpenFileRevisionCommandArgs): string;\n\tstatic getMarkdownCommandArgs(uri: Uri, annotationType?: FileAnnotationType, line?: number): string;\n\tstatic getMarkdownCommandArgs(\n\t\targsOrUri: OpenFileRevisionCommandArgs | Uri,\n\t\tannotationType?: FileAnnotationType,\n\t\tline?: number\n\t): string {\n\t\tlet args: OpenFileRevisionCommandArgs | Uri;\n\t\tif (argsOrUri instanceof Uri) {\n\t\t\tconst uri = argsOrUri;\n\n\t\t\targs = {\n\t\t\t\turi: uri,\n\t\t\t\tline: line,\n\t\t\t\tannotationType: annotationType\n\t\t\t};\n\t\t} else {\n\t\t\targs = argsOrUri;\n\t\t}\n\n\t\treturn super.getMarkdownCommandArgsCore<OpenFileRevisionCommandArgs>(Commands.OpenFileRevision, args);\n\t}\n\n\tconstructor() {\n\t\tsuper(Commands.OpenFileRevision);\n\t}\n\n\tasync execute(editor: TextEditor | undefined, uri?: Uri, args?: OpenFileRevisionCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\tlet progressCancellation: CancellationTokenSource | undefined;\n\n\t\ttry {\n\t\t\tlet commandArgs: OpenFileRevisionCommandArgs;\n\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return undefined;\n\n\t\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\t\t\tconst placeHolder = `Open revision of ${gitUri.getFormattedPath({\n\t\t\t\t\tsuffix: args.reference ? ` (${args.reference.name})` : undefined\n\t\t\t\t})}${gitUri.sha ? ` ${Strings.pad(GlyphChars.Dot, 1, 1)} ${gitUri.shortSha}` : ''}${\n\t\t\t\t\tGlyphChars.Ellipsis\n\t\t\t\t}`;\n\n\t\t\t\tprogressCancellation = FileHistoryQuickPick.showProgress(placeHolder);\n\n\t\t\t\tconst log = await Container.git.getLogForFile(gitUri.repoPath, gitUri.fsPath, {\n\t\t\t\t\tmaxCount: args.maxCount,\n\t\t\t\t\tref: (args.reference && args.reference.ref) || gitUri.sha\n\t\t\t\t});\n\t\t\t\tif (log === undefined) {\n\t\t\t\t\tif (args.reference) {\n\t\t\t\t\t\treturn window.showWarningMessage(`The file could not be found in ${args.reference.name}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to open history compare');\n\t\t\t\t}\n\n\t\t\t\tif (progressCancellation.token.isCancellationRequested) return undefined;\n\n\t\t\t\tlet previousPageCommand: CommandQuickPickItem | undefined = undefined;\n\n\t\t\t\tif (log.truncated) {\n\t\t\t\t\tcommandArgs = { ...args };\n\t\t\t\t\tconst npc = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(arrow-right) Show Next Commits',\n\t\t\t\t\t\t\tdescription: `shows ${log.maxCount} newer commits`\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.OpenFileRevision,\n\t\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t\t);\n\n\t\t\t\t\tconst last = Iterables.last(log.commits.values());\n\t\t\t\t\tif (last != null) {\n\t\t\t\t\t\tcommandArgs = { ...args, nextPageCommand: npc };\n\t\t\t\t\t\tpreviousPageCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: '$(arrow-left) Show Previous Commits',\n\t\t\t\t\t\t\t\tdescription: `shows ${log.maxCount} older commits`\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tCommands.OpenFileRevision,\n\t\t\t\t\t\t\t[new GitUri(uri, last), commandArgs]\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcommandArgs = { ...args };\n\t\t\t\tconst icon = GitTag.isOfRefType(args.reference)\n\t\t\t\t\t? '$(tag) '\n\t\t\t\t\t: GitBranch.isOfRefType(args.reference)\n\t\t\t\t\t? '$(git-branch) '\n\t\t\t\t\t: '';\n\t\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\tdescription: `to history of ${gitUri.getFormattedPath()}${\n\t\t\t\t\t\t\targs.reference\n\t\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}${icon}${args.reference.name}`\n\t\t\t\t\t\t\t\t: gitUri.sha\n\t\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}$(git-commit) ${gitUri.shortSha}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.OpenFileRevision,\n\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t);\n\n\t\t\t\tcommandArgs = { ...args, maxCount: 0 };\n\t\t\t\tconst pick = await FileHistoryQuickPick.show(log, gitUri, placeHolder, {\n\t\t\t\t\tpickerOnly: true,\n\t\t\t\t\tprogressCancellation: progressCancellation,\n\t\t\t\t\tcurrentCommand: currentCommand,\n\t\t\t\t\tnextPageCommand: args.nextPageCommand,\n\t\t\t\t\tpreviousPageCommand: previousPageCommand,\n\t\t\t\t\tshowAllCommand: log.truncated\n\t\t\t\t\t\t? new CommandQuickPickItem(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: '$(sync) Show All Commits',\n\t\t\t\t\t\t\t\t\tdescription: 'this may take a while'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tCommands.OpenFileRevision,\n\t\t\t\t\t\t\t\t[uri, commandArgs]\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: undefined\n\t\t\t\t});\n\t\t\t\tif (pick === undefined) return undefined;\n\n\t\t\t\tif (pick instanceof ShowFileHistoryFromQuickPickItem) {\n\t\t\t\t\tconst reference = await pick.execute();\n\t\t\t\t\tif (reference === undefined) return undefined;\n\t\t\t\t\tif (reference instanceof CommandQuickPickItem) return reference.execute();\n\n\t\t\t\t\tcommandArgs = {\n\t\t\t\t\t\t...args,\n\t\t\t\t\t\treference: reference.item\n\t\t\t\t\t};\n\t\t\t\t\treturn commands.executeCommand(Commands.OpenFileRevision, gitUri, commandArgs);\n\t\t\t\t}\n\n\t\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t\targs.uri = GitUri.toRevisionUri(pick.item.sha, pick.item.uri.fsPath, pick.item.repoPath);\n\t\t\t}\n\n\t\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\t\tif (args.showOptions === undefined) {\n\t\t\t\t\targs.showOptions = {};\n\t\t\t\t}\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\tconst e = await openEditor(args.uri, { ...args.showOptions, rethrow: true });\n\t\t\tif (args.annotationType === undefined) return e;\n\n\t\t\treturn Container.fileAnnotations.show(e, args.annotationType, args.line);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenFileRevisionCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open file revision');\n\t\t} finally {\n\t\t\tprogressCancellation && progressCancellation.cancel();\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { GitBranch, GitReference, GitTag, GitUri } from '../git/gitService';\nimport { CommandQuickPickItem, ReferencesQuickPick } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, openEditor } from './common';\n\nexport interface OpenFileRevisionFromCommandArgs {\n\treference?: GitBranch | GitTag | GitReference;\n\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n}\n\n@command()\nexport class OpenFileRevisionFromCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.OpenFileRevisionFrom, Commands.OpenFileRevisionFromBranch]);\n\t}\n\n\tasync execute(editor: TextEditor | undefined, uri?: Uri, args?: OpenFileRevisionFromCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\t\tif (!gitUri.repoPath) return undefined;\n\n\t\targs = { ...args };\n\n\t\tif (args.reference === undefined) {\n\t\t\tconst placeHolder = `Open revision of ${gitUri.getFormattedPath()}${\n\t\t\t\tgitUri.sha ? ` ${Strings.pad(GlyphChars.Dot, 1, 1)} ${gitUri.shortSha}` : ''\n\t\t\t} from${GlyphChars.Ellipsis}`;\n\n\t\t\tconst pick = await new ReferencesQuickPick(gitUri.repoPath).show(placeHolder, {\n\t\t\t\tallowEnteringRefs: true,\n\t\t\t\tcheckmarks: false\n\t\t\t});\n\t\t\tif (pick === undefined) return undefined;\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\targs.reference = pick.item;\n\t\t}\n\n\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\tif (args.showOptions === undefined) {\n\t\t\t\targs.showOptions = {};\n\t\t\t}\n\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t}\n\n\t\treturn openEditor(GitUri.toRevisionUri(args.reference.ref, gitUri.fsPath, gitUri.repoPath), {\n\t\t\t...args.showOptions,\n\t\t\trethrow: true\n\t\t});\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { GitRemote, GitService, RemoteResource, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, OpenRemoteCommandQuickPickItem, RemotesQuickPick } from '../quickpicks';\nimport { Strings } from '../system';\nimport { ActiveEditorCommand, command, Commands } from './common';\n\nexport interface OpenInRemoteCommandArgs {\n\tremote?: string;\n\tremotes?: GitRemote[];\n\tresource?: RemoteResource;\n\tclipboard?: boolean;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class OpenInRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenInRemote);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: OpenInRemoteCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.remotes === undefined || args.resource === undefined) return undefined;\n\n\t\tif (args.remote !== undefined) {\n\t\t\tconst remotes = args.remotes.filter(r => r.name === args!.remote);\n\t\t\t// Only filter if we get some results\n\t\t\tif (remotes.length > 0) {\n\t\t\t\targs.remotes = remotes;\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tlet remote: GitRemote | undefined;\n\t\t\tif (args.remotes.length > 1) {\n\t\t\t\tremote = args.remotes.find(r => r.default);\n\t\t\t} else if (args.remotes.length === 1) {\n\t\t\t\tremote = args.remotes[0];\n\t\t\t}\n\n\t\t\tif (remote != null) {\n\t\t\t\tthis.ensureRemoteBranchName(args);\n\t\t\t\tconst command = new OpenRemoteCommandQuickPickItem(remote, args.resource, args.clipboard);\n\t\t\t\treturn await command.execute();\n\t\t\t}\n\n\t\t\tconst verb = args.clipboard ? 'Copy url for' : 'Open';\n\t\t\tconst suffix = args.clipboard ? `to clipboard from${GlyphChars.Ellipsis}` : `on${GlyphChars.Ellipsis}`;\n\t\t\tlet placeHolder = '';\n\t\t\tswitch (args.resource.type) {\n\t\t\t\tcase RemoteResourceType.Branch:\n\t\t\t\t\tthis.ensureRemoteBranchName(args);\n\t\t\t\t\tplaceHolder = `${verb} ${args.resource.branch} branch ${suffix}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Commit:\n\t\t\t\t\tplaceHolder = `${verb} commit ${GitService.shortenSha(args.resource.sha)} ${suffix}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.File:\n\t\t\t\t\tplaceHolder = `${verb} ${args.resource.fileName} ${suffix}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RemoteResourceType.Revision:\n\t\t\t\t\tif (args.resource.commit !== undefined && args.resource.commit.isFile) {\n\t\t\t\t\t\tif (args.resource.commit.status === 'D') {\n\t\t\t\t\t\t\targs.resource.sha = args.resource.commit.previousSha;\n\t\t\t\t\t\t\tplaceHolder = `${verb} ${args.resource.fileName} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${\n\t\t\t\t\t\t\t\targs.resource.commit.previousShortSha\n\t\t\t\t\t\t\t} ${suffix}`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\targs.resource.sha = args.resource.commit.sha;\n\t\t\t\t\t\t\tplaceHolder = `${verb} ${args.resource.fileName} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${\n\t\t\t\t\t\t\t\targs.resource.commit.shortSha\n\t\t\t\t\t\t\t} ${suffix}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst shortFileSha =\n\t\t\t\t\t\t\targs.resource.sha === undefined ? '' : GitService.shortenSha(args.resource.sha);\n\t\t\t\t\t\tconst shaSuffix = shortFileSha ? ` ${Strings.pad(GlyphChars.Dot, 1, 1)} ${shortFileSha}` : '';\n\n\t\t\t\t\t\tplaceHolder = `${verb} ${args.resource.fileName}${shaSuffix} ${suffix}`;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst pick = await RemotesQuickPick.show(\n\t\t\t\targs.remotes,\n\t\t\t\tplaceHolder,\n\t\t\t\targs.resource,\n\t\t\t\targs.clipboard,\n\t\t\t\targs.goBackCommand\n\t\t\t);\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\treturn await pick.execute();\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenInRemoteCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open in remote provider');\n\t\t}\n\t}\n\n\tprivate ensureRemoteBranchName(args: OpenInRemoteCommandArgs) {\n\t\tif (\n\t\t\targs.remotes === undefined ||\n\t\t\targs.resource === undefined ||\n\t\t\targs.resource.type !== RemoteResourceType.Branch\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Check to see if the remote is in the branch\n\t\tconst [remotePart, branchPart] = Strings.splitSingle(args.resource.branch, '/');\n\t\tif (branchPart === undefined) return;\n\n\t\tconst remote = args.remotes.find(r => r.name === remotePart);\n\t\tif (remote === undefined) return;\n\n\t\targs.resource.branch = branchPart;\n\t\targs.remotes = [remote];\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitUri, RemoteResourceType } from '../git/gitService';\nimport { Logger } from '../logger';\nimport {\n\tActiveEditorCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tgetRepoPathOrActiveOrPrompt,\n\tisCommandViewContextWithRemote\n} from './common';\nimport { OpenInRemoteCommandArgs } from './openInRemote';\n\nexport interface OpenRepoInRemoteCommandArgs {\n\tremote?: string;\n}\n\n@command()\nexport class OpenRepoInRemoteCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenRepoInRemote);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: OpenRepoInRemoteCommandArgs) {\n\t\tif (isCommandViewContextWithRemote(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.remote = context.node.remote.name;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: OpenRepoInRemoteCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri && (await GitUri.fromUri(uri));\n\n\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\tgitUri,\n\t\t\teditor,\n\t\t\t`Open which repository on remote${GlyphChars.Ellipsis}`\n\t\t);\n\t\tif (!repoPath) return undefined;\n\n\t\ttry {\n\t\t\tconst remotes = await Container.git.getRemotes(repoPath);\n\n\t\t\tconst commandArgs: OpenInRemoteCommandArgs = {\n\t\t\t\tresource: {\n\t\t\t\t\ttype: RemoteResourceType.Repo\n\t\t\t\t},\n\t\t\t\tremote: args && args.remote,\n\t\t\t\tremotes: remotes\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.OpenInRemote, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenRepoInRemoteCommand');\n\t\t\treturn window.showErrorMessage(\n\t\t\t\t'Unable to open repository on remote provider. See output channel for more details'\n\t\t\t);\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextDocumentShowOptions, TextEditor, Uri } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, openEditor } from './common';\n\nexport interface OpenRevisionFileCommandArgs {\n\turi?: Uri;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenRevisionFileCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenRevisionFile);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: OpenRevisionFileCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return undefined;\n\t\t\t} else {\n\t\t\t\turi = args.uri;\n\t\t\t}\n\n\t\t\targs.uri = await GitUri.fromUri(uri);\n\t\t\tif (GitUri.is(args.uri) && args.uri.sha) {\n\t\t\t\tconst commit = await Container.git.getCommit(args.uri.repoPath!, args.uri.sha);\n\n\t\t\t\targs.uri =\n\t\t\t\t\tcommit !== undefined && commit.status === 'D'\n\t\t\t\t\t\t? GitUri.toRevisionUri(commit.previousSha!, commit.previousUri.fsPath, commit.repoPath)\n\t\t\t\t\t\t: GitUri.toRevisionUri(args.uri);\n\t\t\t}\n\n\t\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\t\tif (args.showOptions === undefined) {\n\t\t\t\t\targs.showOptions = {};\n\t\t\t\t}\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\tconst e = await openEditor(args.uri, { ...args.showOptions, rethrow: true });\n\t\t\tif (args.annotationType === undefined) return e;\n\n\t\t\treturn Container.fileAnnotations.show(e, args.annotationType, args.line);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenRevisionFileCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open file revision');\n\t\t}\n\t}\n}\n","'use strict';\nimport { Range, TextDocumentShowOptions, TextEditor, Uri, window } from 'vscode';\nimport { FileAnnotationType } from '../configuration';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { ActiveEditorCommand, command, Commands, getCommandUri, openEditor } from './common';\n\nexport interface OpenWorkingFileCommandArgs {\n\turi?: Uri;\n\tline?: number;\n\tshowOptions?: TextDocumentShowOptions;\n\tannotationType?: FileAnnotationType;\n}\n\n@command()\nexport class OpenWorkingFileCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper(Commands.OpenWorkingFile);\n\t}\n\n\tasync execute(editor: TextEditor, uri?: Uri, args?: OpenWorkingFileCommandArgs) {\n\t\targs = { ...args };\n\t\tif (args.line === undefined) {\n\t\t\targs.line = editor == null ? 0 : editor.selection.active.line;\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.uri == null) {\n\t\t\t\turi = getCommandUri(uri, editor);\n\t\t\t\tif (uri == null) return undefined;\n\t\t\t} else {\n\t\t\t\turi = args.uri;\n\t\t\t}\n\n\t\t\targs.uri = await GitUri.fromUri(uri);\n\t\t\tif (GitUri.is(args.uri) && args.uri.sha) {\n\t\t\t\tconst workingUri = await Container.git.getWorkingUri(args.uri.repoPath!, args.uri);\n\t\t\t\tif (workingUri === undefined) {\n\t\t\t\t\treturn window.showWarningMessage(\n\t\t\t\t\t\t'Unable to open working file. File could not be found in the working tree'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\targs.uri = new GitUri(workingUri, args.uri.repoPath);\n\t\t\t}\n\n\t\t\tif (args.line !== undefined && args.line !== 0) {\n\t\t\t\tif (args.showOptions === undefined) {\n\t\t\t\t\targs.showOptions = {};\n\t\t\t\t}\n\t\t\t\targs.showOptions.selection = new Range(args.line, 0, args.line, 0);\n\t\t\t}\n\n\t\t\tconst e = await openEditor(args.uri, { ...args.showOptions, rethrow: true });\n\t\t\tif (args.annotationType === undefined) return e;\n\n\t\t\treturn Container.fileAnnotations.show(e, args.annotationType, args.line);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'OpenWorkingFileCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to open working file');\n\t\t}\n\t}\n}\n","'use strict';\nimport { QuickPick } from 'vscode';\nimport { Arrays } from '../system';\nimport { GitBranch, GitTag, Repository } from '../git/git';\nimport { BranchQuickPickItem, CommitQuickPickItem, TagQuickPickItem } from '../quickpicks';\nimport { Container } from '../container';\n\nexport async function getBranchesAndOrTags(\n\trepos: Repository | Repository[],\n\tincludeTags: boolean,\n\t{\n\t\tfilterBranches,\n\t\tfilterTags,\n\t\tpicked\n\t}: { filterBranches?: (b: GitBranch) => boolean; filterTags?: (t: GitTag) => boolean; picked?: string } = {}\n) {\n\tlet branches: GitBranch[];\n\tlet tags: GitTag[] | undefined;\n\n\tlet singleRepo = false;\n\tif (repos instanceof Repository || repos.length === 1) {\n\t\tsingleRepo = true;\n\t\tconst repo = repos instanceof Repository ? repos : repos[0];\n\n\t\t[branches, tags] = await Promise.all<GitBranch[], GitTag[] | undefined>([\n\t\t\trepo.getBranches({ filter: filterBranches, sort: true }),\n\t\t\tincludeTags ? repo.getTags({ filter: filterTags, includeRefs: true, sort: true }) : undefined\n\t\t]);\n\t} else {\n\t\tconst [branchesByRepo, tagsByRepo] = await Promise.all<GitBranch[][], GitTag[][] | undefined>([\n\t\t\tPromise.all(repos.map(r => r.getBranches({ filter: filterBranches, sort: true }))),\n\t\t\tincludeTags\n\t\t\t\t? Promise.all(repos.map(r => r.getTags({ filter: filterTags, includeRefs: true, sort: true })))\n\t\t\t\t: undefined\n\t\t]);\n\n\t\tbranches = GitBranch.sort(\n\t\t\tArrays.intersection(...branchesByRepo, ((b1: GitBranch, b2: GitBranch) => b1.name === b2.name) as any)\n\t\t);\n\n\t\tif (includeTags) {\n\t\t\ttags = GitTag.sort(\n\t\t\t\tArrays.intersection(...tagsByRepo!, ((t1: GitTag, t2: GitTag) => t1.name === t2.name) as any)\n\t\t\t);\n\t\t}\n\t}\n\n\tif (!includeTags) {\n\t\treturn Promise.all(\n\t\t\tbranches.map(b =>\n\t\t\t\tBranchQuickPickItem.create(b, undefined, {\n\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\tref: singleRepo,\n\t\t\t\t\tstatus: singleRepo,\n\t\t\t\t\ttype: 'remote'\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t}\n\n\treturn Promise.all<BranchQuickPickItem | TagQuickPickItem>([\n\t\t...branches!\n\t\t\t.filter(b => !b.remote)\n\t\t\t.map(b =>\n\t\t\t\tBranchQuickPickItem.create(b, picked != null && b.ref === picked, {\n\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\tref: singleRepo,\n\t\t\t\t\tstatus: singleRepo\n\t\t\t\t})\n\t\t\t),\n\t\t...tags!.map(t =>\n\t\t\tTagQuickPickItem.create(t, picked != null && t.ref === picked, {\n\t\t\t\tref: singleRepo,\n\t\t\t\ttype: true\n\t\t\t})\n\t\t),\n\t\t...branches!\n\t\t\t.filter(b => b.remote)\n\t\t\t.map(b =>\n\t\t\t\tBranchQuickPickItem.create(b, picked != null && b.ref === picked, {\n\t\t\t\t\tcurrent: singleRepo ? 'checkmark' : false,\n\t\t\t\t\ttype: 'remote'\n\t\t\t\t})\n\t\t\t)\n\t]);\n}\n\nexport function getValidateGitReferenceFn(repo: Repository | Repository[]) {\n\treturn async (quickpick: QuickPick<any>, value: string) => {\n\t\tif (Array.isArray(repo)) {\n\t\t\tif (Repository.length !== 1) return false;\n\n\t\t\trepo = repo[0];\n\t\t}\n\n\t\tif (!(await Container.git.validateReference(repo.path, value))) return false;\n\n\t\tconst commit = await Container.git.getCommit(repo.path, value);\n\t\tquickpick.items = [CommitQuickPickItem.create(commit!, true, { compact: true, icon: true, match: value })];\n\t\treturn true;\n\t};\n}\n","'use strict';\nimport { InputBox, QuickInputButton, QuickPick, QuickPickItem, Uri } from 'vscode';\nimport { Directive, DirectiveQuickPickItem } from '../quickpicks';\nimport { Container } from '../container';\nimport { Keys } from '../keyboard';\n\nexport * from './quickCommand.helpers';\n\nexport class ToggleQuickInputButton implements QuickInputButton {\n\tconstructor(\n\t\tprivate _off: { icon: string; tooltip: string },\n\t\tprivate _on: { icon: string; tooltip: string },\n\t\tprivate _toggled = false\n\t) {\n\t\tthis._iconPath = this.getIconPath();\n\t}\n\n\tprivate _iconPath: { light: Uri; dark: Uri };\n\tget iconPath(): { light: Uri; dark: Uri } {\n\t\treturn this._iconPath;\n\t}\n\n\tget tooltip(): string {\n\t\treturn this._toggled ? this._on.tooltip : this._off.tooltip;\n\t}\n\n\tget on() {\n\t\treturn this._toggled;\n\t}\n\tset on(value: boolean) {\n\t\tthis._toggled = value;\n\t\tthis._iconPath = this.getIconPath();\n\t}\n\n\tprivate getIconPath() {\n\t\treturn {\n\t\t\tdark: Uri.file(\n\t\t\t\tContainer.context.asAbsolutePath(`images/dark/icon-${this.on ? this._on.icon : this._off.icon}.svg`)\n\t\t\t),\n\t\t\tlight: Uri.file(\n\t\t\t\tContainer.context.asAbsolutePath(`images/light/icon-${this.on ? this._on.icon : this._off.icon}.svg`)\n\t\t\t)\n\t\t};\n\t}\n}\n\nexport class SelectableQuickInputButton extends ToggleQuickInputButton {\n\tconstructor(tooltip: string, icon: string, selected: boolean = false) {\n\t\tsuper({ tooltip: tooltip, icon: icon }, { tooltip: tooltip, icon: `${icon}-selected` }, selected);\n\t}\n}\n\nexport class BreakQuickCommand extends Error {\n\tconstructor() {\n\t\tsuper('break');\n\t}\n}\n\nexport interface QuickInputStep {\n\tadditionalButtons?: QuickInputButton[];\n\tbuttons?: QuickInputButton[];\n\tkeys?: StepNavigationKeys[];\n\tplaceholder?: string;\n\ttitle?: string;\n\tvalue?: string;\n\n\tonDidClickButton?(input: InputBox, button: QuickInputButton): void;\n\tonDidPressKey?(quickpick: InputBox, key: Keys): void | Promise<void>;\n\tvalidate?(value: string | undefined): [boolean, string | undefined] | Promise<[boolean, string | undefined]>;\n}\n\nexport function isQuickInputStep(item: QuickPickStep | QuickInputStep): item is QuickInputStep {\n\treturn (item as QuickPickStep).items === undefined;\n}\n\nexport interface QuickPickStep<T extends QuickPickItem = any> {\n\tadditionalButtons?: QuickInputButton[];\n\tbuttons?: QuickInputButton[];\n\titems: (DirectiveQuickPickItem | T)[] | DirectiveQuickPickItem[];\n\tkeys?: StepNavigationKeys[];\n\tmatchOnDescription?: boolean;\n\tmatchOnDetail?: boolean;\n\tmultiselect?: boolean;\n\tplaceholder?: string;\n\tselectedItems?: QuickPickItem[];\n\ttitle?: string;\n\tvalue?: string;\n\n\tonDidAccept?(quickpick: QuickPick<T>): boolean | Promise<boolean>;\n\tonDidChangeValue?(quickpick: QuickPick<T>): boolean | Promise<boolean>;\n\tonDidClickButton?(quickpick: QuickPick<T>, button: QuickInputButton): void;\n\tonDidPressKey?(quickpick: QuickPick<T>, key: Keys): void | Promise<void>;\n\tonValidateValue?(quickpick: QuickPick<T>, value: string, items: T[]): boolean | Promise<boolean>;\n\tvalidate?(selection: T[]): boolean;\n}\n\nexport function isQuickPickStep(item: QuickPickStep | QuickInputStep): item is QuickPickStep {\n\treturn (item as QuickPickStep).items !== undefined;\n}\n\nexport type StepAsyncGenerator = AsyncGenerator<QuickPickStep | QuickInputStep, undefined, any | undefined>;\ntype StepItemType<T> = T extends QuickPickStep<infer U> ? U[] : T extends QuickInputStep ? string : never;\nexport type StepNavigationKeys = Exclude<Exclude<Exclude<Keys, 'left'>, 'alt+left'>, 'ctrl+left'>;\nexport type StepSelection<T> = T extends QuickPickStep<infer U>\n\t? U[] | Directive\n\t: T extends QuickInputStep\n\t? string | Directive\n\t: never;\nexport type StepState<T> = Partial<T> & { counter: number; confirm?: boolean };\n\nexport abstract class QuickCommandBase<TState = any> implements QuickPickItem {\n\tstatic is(item: QuickPickItem): item is QuickCommandBase {\n\t\treturn item instanceof QuickCommandBase;\n\t}\n\n\treadonly description?: string;\n\treadonly detail?: string;\n\n\tprotected _initialState?: StepState<TState>;\n\n\tprivate _current: QuickPickStep | QuickInputStep | undefined;\n\tprivate _stepsIterator: StepAsyncGenerator | undefined;\n\n\tconstructor(\n\t\tpublic readonly key: string,\n\t\tpublic readonly label: string,\n\t\tpublic readonly title: string,\n\t\toptions: {\n\t\t\tdescription?: string;\n\t\t\tdetail?: string;\n\t\t} = {}\n\t) {\n\t\tthis.description = options.description;\n\t\tthis.detail = options.detail;\n\t}\n\n\tget canConfirm(): boolean {\n\t\treturn true;\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn true;\n\t}\n\n\tprivate _picked: boolean = false;\n\tget picked() {\n\t\treturn this._picked;\n\t}\n\tset picked(value: boolean) {\n\t\tthis._picked = value;\n\t\tif (!value) {\n\t\t\tthis._pickedVia = 'menu';\n\t\t}\n\t}\n\n\tprivate _pickedVia: 'menu' | 'command' = 'menu';\n\tget pickedVia() {\n\t\treturn this._pickedVia;\n\t}\n\tset pickedVia(value: 'menu' | 'command') {\n\t\tthis._pickedVia = value;\n\t}\n\n\tget skipConfirmKey(): string {\n\t\treturn `${this.key}:${this.pickedVia}`;\n\t}\n\n\tconfirm(override?: boolean) {\n\t\tif (!this.canConfirm || !this.canSkipConfirm) return true;\n\n\t\treturn override !== undefined\n\t\t\t? override\n\t\t\t: !Container.config.gitCommands.skipConfirmations.includes(this.skipConfirmKey);\n\t}\n\n\tisMatch(name: string) {\n\t\treturn this.label === name;\n\t}\n\n\tprotected abstract steps(): StepAsyncGenerator;\n\n\tasync previous(): Promise<QuickPickStep | QuickInputStep | undefined> {\n\t\treturn (await this.next(Directive.Back)).value;\n\t}\n\n\tasync next(value?: StepSelection<any>): Promise<IteratorResult<QuickPickStep | QuickInputStep>> {\n\t\tif (this._stepsIterator === undefined) {\n\t\t\tthis._stepsIterator = this.steps();\n\t\t}\n\n\t\tconst result = await this._stepsIterator.next(value);\n\t\tthis._current = result.value;\n\n\t\tif (result.done) {\n\t\t\tthis._initialState = undefined;\n\t\t\tthis._stepsIterator = undefined;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget value(): QuickPickStep | QuickInputStep | undefined {\n\t\treturn this._current;\n\t}\n\n\tprotected createConfirmStep<T extends QuickPickItem>(\n\t\ttitle: string,\n\t\tconfirmations: T[],\n\t\tcancel?: DirectiveQuickPickItem,\n\t\toptions: Partial<QuickPickStep<T>> = {}\n\t): QuickPickStep<T> {\n\t\treturn this.createPickStep<T>({\n\t\t\tplaceholder: `Confirm ${this.title}`,\n\t\t\ttitle: title,\n\t\t\titems: [...confirmations, cancel || DirectiveQuickPickItem.create(Directive.Cancel)],\n\t\t\tselectedItems: [confirmations.find(c => c.picked) || confirmations[0]],\n\t\t\t...options\n\t\t});\n\t}\n\n\tprotected createInputStep(step: QuickInputStep): QuickInputStep {\n\t\treturn step;\n\t}\n\n\tprotected createPickStep<T extends QuickPickItem>(step: QuickPickStep<T>): QuickPickStep<T> {\n\t\treturn step;\n\t}\n\n\tprotected async canInputStepMoveNext<T extends QuickInputStep>(\n\t\tstep: T,\n\t\tstate: { counter: number },\n\t\tvalue: Directive | string\n\t) {\n\t\t//: value is string\n\t\tif (value === Directive.Cancel) throw new BreakQuickCommand();\n\t\tif (value === Directive.Back) {\n\t\t\tstate.counter--;\n\t\t\tif (state.counter < 0) {\n\t\t\t\tstate.counter = 0;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (value === undefined) return false;\n\n\t\tif (step.validate === undefined || (await step.validate(value))) {\n\t\t\tstate.counter++;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprotected canPickStepMoveNext<T extends QuickPickStep>(\n\t\tstep: T,\n\t\tstate: { counter: number },\n\t\tselection: StepItemType<T> | Directive\n\t): selection is StepItemType<T> {\n\t\tif (selection === Directive.Cancel) throw new BreakQuickCommand();\n\t\tif (selection === Directive.Back) {\n\t\t\tstate.counter--;\n\t\t\tif (state.counter < 0) {\n\t\t\t\tstate.counter = 0;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\n\t\tif (selection === undefined) return false;\n\n\t\tif (step.validate === undefined || step.validate(selection)) {\n\t\t\tstate.counter++;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport { Iterables, Strings } from '../../system';\nimport {\n\tgetBranchesAndOrTags,\n\tgetValidateGitReferenceFn,\n\tQuickCommandBase,\n\tQuickPickStep,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState\n} from '../quickCommand';\nimport {\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tFlagsQuickPickItem,\n\tReferencesQuickPickItem,\n\tRepositoryQuickPickItem\n} from '../../quickpicks';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport { Logger } from '../../logger';\n\ntype Flags = '--edit';\n\ninterface State {\n\trepo: Repository;\n\treferences?: GitReference[];\n\tflags: Flags[];\n}\n\nexport interface CherryPickGitCommandArgs {\n\treadonly command: 'cherry-pick';\n\tstate?: Partial<State>;\n}\n\nexport class CherryPickGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: CherryPickGitCommandArgs) {\n\t\tsuper('cherry-pick', 'cherry-pick', 'Cherry Pick', {\n\t\t\tdescription: 'integrates changes from specified commits into the current branch'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.references !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: State) {\n\t\trunGitCommandInTerminal(\n\t\t\t'cherry-pick',\n\t\t\t[...state.flags, ...state.references!.map(c => c.ref).reverse()].join(' '),\n\t\t\tstate.repo.path,\n\t\t\ttrue\n\t\t);\n\t}\n\n\tisMatch(name: string) {\n\t\treturn super.isMatch(name) || name === 'cherry';\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\t\tlet selectedBranchOrTag: GitReference | undefined;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst destination = await state.repo.getBranch();\n\t\t\t\tif (destination === undefined) break;\n\n\t\t\t\tif (state.references === undefined || state.counter < 2) {\n\t\t\t\t\tconst destId = destination.id;\n\n\t\t\t\t\tconst step = this.createPickStep<ReferencesQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} into ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder: `Choose a branch or tag to cherry-pick from${GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t3\n\t\t\t\t\t\t)}(select or enter a reference)`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems: await getBranchesAndOrTags(state.repo, true, {\n\t\t\t\t\t\t\tfilterBranches: b => b.id !== destId\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tonValidateValue: getValidateGitReferenceFn(state.repo)\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (GitReference.isOfRefType(selection[0].item)) {\n\t\t\t\t\t\tstate.references = [selection[0].item];\n\t\t\t\t\t\tselectedBranchOrTag = undefined;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedBranchOrTag = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (selectedBranchOrTag !== undefined && state.counter < 3) {\n\t\t\t\t\tconst log = await Container.git.getLog(state.repo.path, {\n\t\t\t\t\t\tref: `${destination.ref}..${selectedBranchOrTag.ref}`,\n\t\t\t\t\t\tmerges: false\n\t\t\t\t\t});\n\n\t\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} onto ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tmultiselect: log !== undefined,\n\t\t\t\t\t\tplaceholder:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? `${selectedBranchOrTag.name} has no pickable commits`\n\t\t\t\t\t\t\t\t: `Choose commits to cherry-pick onto ${destination.name}`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\t\t\t\t\tstate.references\n\t\t\t\t\t\t\t\t\t\t\t\t\t? state.references.some(r => r.ref === commit.ref)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t\t\t\t\t{ compact: true, icon: true }\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.references = selection.map(i => i.item);\n\t\t\t\t}\n\n\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t[\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\tdescription: `${\n\t\t\t\t\t\t\t\tstate.references!.length === 1\n\t\t\t\t\t\t\t\t\t? state.references![0].name\n\t\t\t\t\t\t\t\t\t: `${state.references!.length} commits`\n\t\t\t\t\t\t\t} onto ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will apply ${\n\t\t\t\t\t\t\t\tstate.references!.length === 1\n\t\t\t\t\t\t\t\t\t? `commit ${state.references![0].name}`\n\t\t\t\t\t\t\t\t\t: `${state.references!.length} commits`\n\t\t\t\t\t\t\t} onto ${destination.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--edit'], {\n\t\t\t\t\t\t\tlabel: `${this.title} & Edit`,\n\t\t\t\t\t\t\tdescription: `--edit ${\n\t\t\t\t\t\t\t\tstate.references!.length === 1\n\t\t\t\t\t\t\t\t\t? state.references![0].name\n\t\t\t\t\t\t\t\t\t: `${state.references!.length} commits`\n\t\t\t\t\t\t\t} onto ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will edit and apply ${\n\t\t\t\t\t\t\t\tstate.references!.length === 1\n\t\t\t\t\t\t\t\t\t? `commit ${state.references![0].name}`\n\t\t\t\t\t\t\t\t\t: `${state.references!.length} commits`\n\t\t\t\t\t\t\t} onto ${destination.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = selection[0].item;\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { Repository } from '../../git/gitService';\nimport { QuickCommandBase, QuickPickStep, StepAsyncGenerator, StepSelection, StepState } from '../quickCommand';\nimport { FlagsQuickPickItem, RepositoryQuickPickItem } from '../../quickpicks';\nimport { Dates, Strings } from '../../system';\nimport { GlyphChars } from '../../constants';\nimport { Logger } from '../../logger';\n\ntype Flags = '--all' | '--prune';\n\ninterface State {\n\trepos: Repository[];\n\tflags: Flags[];\n}\n\nexport interface FetchGitCommandArgs {\n\treadonly command: 'fetch';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n}\n\nexport class FetchGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: FetchGitCommandArgs) {\n\t\tsuper('fetch', 'fetch', 'Fetch', { description: 'fetches changes from one or more remotes' });\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repos !== undefined && args.state.repos.length !== 0) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\texecute(state: State) {\n\t\treturn Container.git.fetchAll(state.repos, {\n\t\t\tall: state.flags.includes('--all'),\n\t\t\tprune: state.flags.includes('--prune')\n\t\t});\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repos === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repos = [repos[0]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet actives: Repository[];\n\t\t\t\t\t\tif (state.repos) {\n\t\t\t\t\t\t\tactives = state.repos;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst active = await Container.git.getActiveRepository();\n\t\t\t\t\t\t\tactives = active ? [active] : [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\tmultiselect: true,\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose repositories',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(repo =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(repo, actives.some(r => r.id === repo.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repos = selection.map(i => i.item);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\t\tlet fetchedOn = '';\n\t\t\t\t\tif (state.repos.length === 1) {\n\t\t\t\t\t\tconst lastFetched = await state.repos[0].getLastFetched();\n\t\t\t\t\t\tif (lastFetched !== 0) {\n\t\t\t\t\t\t\tfetchedOn = `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched ${Dates.getFormatter(\n\t\t\t\t\t\t\t\tnew Date(lastFetched)\n\t\t\t\t\t\t\t).fromNow()}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t? `${state.repos[0].formattedName}${fetchedOn}`\n\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\t\t\tdetail: `Will fetch ${\n\t\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--prune'], {\n\t\t\t\t\t\t\t\tlabel: `${this.title} & Prune`,\n\t\t\t\t\t\t\t\tdescription: '--prune',\n\t\t\t\t\t\t\t\tdetail: `Will fetch and prune ${\n\t\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--all'], {\n\t\t\t\t\t\t\t\tlabel: `${this.title} All`,\n\t\t\t\t\t\t\t\tdescription: '--all',\n\t\t\t\t\t\t\t\tdetail: `Will fetch all remotes of ${\n\t\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--all', '--prune'], {\n\t\t\t\t\t\t\t\tlabel: `${this.title} All & Prune`,\n\t\t\t\t\t\t\t\tdescription: '--all --prune',\n\t\t\t\t\t\t\t\tdetail: `Will fetch and prune all remotes of ${\n\t\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t]\n\t\t\t\t\t);\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.flags = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport {\n\tgetBranchesAndOrTags,\n\tgetValidateGitReferenceFn,\n\tQuickCommandBase,\n\tQuickPickStep,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState\n} from '../quickCommand';\nimport {\n\tDirective,\n\tDirectiveQuickPickItem,\n\tFlagsQuickPickItem,\n\tReferencesQuickPickItem,\n\tRepositoryQuickPickItem\n} from '../../quickpicks';\nimport { Strings } from '../../system';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport { Logger } from '../../logger';\n\ntype Flags = '--ff-only' | '--no-ff' | '--squash';\n\ninterface State {\n\trepo: Repository;\n\treference: GitReference;\n\tflags: Flags[];\n}\n\nexport interface MergeGitCommandArgs {\n\treadonly command: 'merge';\n\tstate?: Partial<State>;\n}\n\nexport class MergeGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: MergeGitCommandArgs) {\n\t\tsuper('merge', 'merge', 'Merge', {\n\t\t\tdescription: 'integrates changes from a specified branch into the current branch'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.reference !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: State) {\n\t\trunGitCommandInTerminal('merge', [...state.flags, state.reference.ref].join(' '), state.repo.path, true);\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst destination = await state.repo.getBranch();\n\t\t\t\tif (destination === undefined) break;\n\n\t\t\t\tif (state.reference === undefined || state.counter < 2) {\n\t\t\t\t\tconst destId = destination.id;\n\n\t\t\t\t\tconst step = this.createPickStep<ReferencesQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} into ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder: `Choose a branch or tag to merge into ${destination.name}${GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t3\n\t\t\t\t\t\t)}(select or enter a reference)`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems: await getBranchesAndOrTags(state.repo, true, {\n\t\t\t\t\t\t\tfilterBranches: b => b.id !== destId,\n\t\t\t\t\t\t\tpicked: state.reference && state.reference.ref\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tonValidateValue: getValidateGitReferenceFn(state.repo)\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tconst count =\n\t\t\t\t\t(await Container.git.getCommitCount(state.repo.path, [\n\t\t\t\t\t\t`${destination.name}..${state.reference.name}`\n\t\t\t\t\t])) || 0;\n\t\t\t\tif (count === 0) {\n\t\t\t\t\tconst step = this.createConfirmStep(\n\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t\t[],\n\n\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\tdetail: `${destination.name} is up to date with ${state.reference.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tyield step;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t[\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\tdescription: `${state.reference.name} into ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will merge ${Strings.pluralize('commit', count)} from ${\n\t\t\t\t\t\t\t\tstate.reference.name\n\t\t\t\t\t\t\t} into ${destination.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--ff-only'], {\n\t\t\t\t\t\t\tlabel: `Fast-forward ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--ff-only ${state.reference.name} into ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will fast-forward merge ${Strings.pluralize('commit', count)} from ${\n\t\t\t\t\t\t\t\tstate.reference.name\n\t\t\t\t\t\t\t} into ${destination.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--no-ff'], {\n\t\t\t\t\t\t\tlabel: `No Fast-forward ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--no-ff ${state.reference.name} into ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will create a merge commit when merging ${Strings.pluralize(\n\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\tcount\n\t\t\t\t\t\t\t)} from ${state.reference.name} into ${destination.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--squash'], {\n\t\t\t\t\t\t\tlabel: `Squash ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--squash ${state.reference.name} into ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will squash ${Strings.pluralize('commit', count)} from ${\n\t\t\t\t\t\t\t\tstate.reference.name\n\t\t\t\t\t\t\t} into one when merging into ${destination.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = selection[0].item;\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { QuickInputButton, Uri } from 'vscode';\nimport { Container } from '../../container';\nimport { Repository } from '../../git/gitService';\nimport { QuickCommandBase, QuickPickStep, StepAsyncGenerator, StepSelection, StepState } from '../quickCommand';\nimport { FlagsQuickPickItem, RepositoryQuickPickItem } from '../../quickpicks';\nimport { Dates, Strings } from '../../system';\nimport { GlyphChars } from '../../constants';\nimport { Logger } from '../../logger';\n\ntype Flags = '--rebase';\n\ninterface State {\n\trepos: Repository[];\n\tflags: Flags[];\n}\n\nexport interface PullGitCommandArgs {\n\treadonly command: 'pull';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n}\n\nexport class PullGitCommand extends QuickCommandBase<State> {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly Fetch: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-sync.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-sync.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Fetch'\n\t\t};\n\t};\n\n\tconstructor(args?: PullGitCommandArgs) {\n\t\tsuper('pull', 'pull', 'Pull', {\n\t\t\tdescription: 'fetches and integrates changes from a remote into the current branch'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repos !== undefined && args.state.repos.length !== 0) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\texecute(state: State) {\n\t\treturn Container.git.pullAll(state.repos, { rebase: state.flags.includes('--rebase') });\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repos === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repos = [repos[0]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet actives: Repository[];\n\t\t\t\t\t\tif (state.repos) {\n\t\t\t\t\t\t\tactives = state.repos;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst active = await Container.git.getActiveRepository();\n\t\t\t\t\t\t\tactives = active ? [active] : [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\tmultiselect: true,\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose repositories',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(repo =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(repo, actives.some(r => r.id === repo.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repos = selection.map(i => i.item);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\t\tlet step: QuickPickStep<FlagsQuickPickItem<Flags>>;\n\t\t\t\t\tif (state.repos.length > 1) {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\t\tstate.repos.length\n\t\t\t\t\t\t\t} repositories`,\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\t\t\t\tdetail: `Will pull ${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--rebase'], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} with Rebase`,\n\t\t\t\t\t\t\t\t\tdescription: '--rebase',\n\t\t\t\t\t\t\t\t\tdetail: `Will pull with rebase ${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = await this.getSingleRepoConfirmStep(state);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.flags = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async getSingleRepoConfirmStep(state: StepState<State>) {\n\t\tconst repo = state.repos![0];\n\t\tconst [status, lastFetched] = await Promise.all([repo.getStatus(), repo.getLastFetched()]);\n\n\t\tconst title = `Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${repo.formattedName}`;\n\n\t\tlet detail = repo.formattedName;\n\t\tlet fetchedOn = '';\n\t\tif (lastFetched !== 0 && status !== undefined) {\n\t\t\tdetail = Strings.pluralize('commit', status.state.behind);\n\n\t\t\tfetchedOn = `${Strings.pad(GlyphChars.Dot, 2, 2)}Last fetched ${Dates.getFormatter(\n\t\t\t\tnew Date(lastFetched)\n\t\t\t).fromNow()}`;\n\t\t}\n\n\t\tconst step = this.createConfirmStep<FlagsQuickPickItem<Flags>>(\n\t\t\t`${title}${fetchedOn}`,\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags!, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tdetail: `Will pull ${detail}`\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags!, ['--rebase'], {\n\t\t\t\t\tlabel: `${this.title} with Rebase`,\n\t\t\t\t\tdescription: '--rebase',\n\t\t\t\t\tdetail: `Will pull ${detail} with rebase`\n\t\t\t\t})\n\t\t\t],\n\t\t\tundefined,\n\t\t\t{\n\t\t\t\tadditionalButtons: [this.Buttons.Fetch],\n\t\t\t\tonDidClickButton: async (quickpick, button) => {\n\t\t\t\t\tif (button !== this.Buttons.Fetch) return;\n\t\t\t\t\tquickpick.title = `${title}${Strings.pad(GlyphChars.Dot, 2, 2)}Fetching${GlyphChars.Ellipsis}`;\n\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\tquickpick.enabled = false;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait repo.fetch({ progress: true });\n\t\t\t\t\t\tconst step = await this.getSingleRepoConfirmStep(state);\n\t\t\t\t\t\tquickpick.title = step.title;\n\t\t\t\t\t\tquickpick.items = step.items as FlagsQuickPickItem<Flags>[];\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn step;\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { Repository } from '../../git/gitService';\nimport { QuickCommandBase, QuickPickStep, StepAsyncGenerator, StepSelection, StepState } from '../quickCommand';\nimport { Directive, DirectiveQuickPickItem, FlagsQuickPickItem, RepositoryQuickPickItem } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport { GlyphChars } from '../../constants';\nimport { Logger } from '../../logger';\n\ntype Flags = '--force';\n\ninterface State {\n\trepos: Repository[];\n\tflags: Flags[];\n}\n\nexport interface PushGitCommandArgs {\n\treadonly command: 'push';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n}\n\nexport class PushGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: PushGitCommandArgs) {\n\t\tsuper('push', 'push', 'Push', {\n\t\t\tdescription: 'pushes changes from the current branch to a remote'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repos !== undefined && args.state.repos.length !== 0) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\texecute(state: State) {\n\t\treturn Container.git.pushAll(state.repos, { force: state.flags.includes('--force') });\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repos === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repos = [repos[0]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet actives: Repository[];\n\t\t\t\t\t\tif (state.repos) {\n\t\t\t\t\t\t\tactives = state.repos;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst active = await Container.git.getActiveRepository();\n\t\t\t\t\t\t\tactives = active ? [active] : [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\tmultiselect: true,\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose repositories',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(repo =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(repo, actives.some(r => r.id === repo.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repos = selection.map(i => i.item);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\t\tlet step: QuickPickStep<FlagsQuickPickItem<Flags>>;\n\t\t\t\t\tif (state.repos.length > 1) {\n\t\t\t\t\t\tstep = this.createConfirmStep(\n\t\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\t\tstate.repos.length\n\t\t\t\t\t\t\t} repositories`,\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\t\t\t\tdetail: `Will push ${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--force'], {\n\t\t\t\t\t\t\t\t\tlabel: `Force ${this.title}`,\n\t\t\t\t\t\t\t\t\tdescription: '--force',\n\t\t\t\t\t\t\t\t\tdetail: `Will force push ${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep = await this.getSingleRepoConfirmStep(state);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.flags = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async getSingleRepoConfirmStep(state: StepState<State>) {\n\t\tconst repo = state.repos![0];\n\t\tconst status = await repo.getStatus();\n\n\t\tlet detail = repo.formattedName;\n\t\tif (status !== undefined) {\n\t\t\tif (status.state.ahead === 0) {\n\t\t\t\treturn this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${repo.formattedName}`,\n\t\t\t\t\t[],\n\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\tdetail: 'No commits to push'\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdetail = Strings.pluralize('commit', status.state.ahead);\n\t\t}\n\n\t\treturn this.createConfirmStep(\n\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${repo.formattedName}`,\n\t\t\t[\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags!, [], {\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\tdescription: '',\n\t\t\t\t\tdetail: `Will push ${detail}`\n\t\t\t\t}),\n\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags!, ['--force'], {\n\t\t\t\t\tlabel: `Force ${this.title}`,\n\t\t\t\t\tdescription: '--force',\n\t\t\t\t\tdetail: `Will force push ${detail}`\n\t\t\t\t})\n\t\t\t]\n\t\t);\n\t}\n}\n","'use strict';\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport {\n\tgetBranchesAndOrTags,\n\tgetValidateGitReferenceFn,\n\tQuickCommandBase,\n\tQuickPickStep,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState,\n\tToggleQuickInputButton\n} from '../quickCommand';\nimport {\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tFlagsQuickPickItem,\n\tReferencesQuickPickItem,\n\tRefQuickPickItem,\n\tRepositoryQuickPickItem\n} from '../../quickpicks';\nimport { Iterables, Strings } from '../../system';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport { Logger } from '../../logger';\n\ntype Flags = '--interactive';\n\ninterface State {\n\trepo: Repository;\n\treference: GitReference;\n\tflags: Flags[];\n}\n\nexport interface RebaseGitCommandArgs {\n\treadonly command: 'rebase';\n\tstate?: Partial<State>;\n}\n\nexport class RebaseGitCommand extends QuickCommandBase<State> {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly PickBranchOrCommit = class extends ToggleQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper(\n\t\t\t\t\t{ tooltip: 'Use the selected Branch or Tag', icon: 'branch' },\n\t\t\t\t\t{ tooltip: 'Choose a commit from the selected Branch or Tag', icon: 'commit' },\n\t\t\t\t\ton\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t};\n\n\tconstructor(args?: RebaseGitCommandArgs) {\n\t\tsuper('rebase', 'rebase', 'Rebase', {\n\t\t\tdescription:\n\t\t\t\t'integrates changes from a specified branch into the current branch, by changing the base of the branch and reapplying the commits on top'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.reference !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: State) {\n\t\trunGitCommandInTerminal('rebase', [...state.flags, state.reference.ref].join(' '), state.repo.path, true);\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\t\tlet selectedBranchOrTag: GitReference | undefined;\n\t\tlet pickCommit = false;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst destination = await state.repo.getBranch();\n\t\t\t\tif (destination === undefined) break;\n\n\t\t\t\tif (state.reference === undefined || state.counter < 2) {\n\t\t\t\t\tconst pickBranchOrCommitButton: ToggleQuickInputButton = new this.Buttons.PickBranchOrCommit(\n\t\t\t\t\t\tpickCommit\n\t\t\t\t\t);\n\n\t\t\t\t\tconst step = this.createPickStep<ReferencesQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder: `Choose a branch or tag to rebase ${\n\t\t\t\t\t\t\tdestination.name\n\t\t\t\t\t\t} onto${GlyphChars.Space.repeat(3)}(select or enter a reference)`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems: await getBranchesAndOrTags(state.repo, true, {\n\t\t\t\t\t\t\tpicked: state.reference && state.reference.ref\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tadditionalButtons: [pickBranchOrCommitButton],\n\t\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\t\tpickCommit = !pickCommit;\n\t\t\t\t\t\t\tpickBranchOrCommitButton.on = pickCommit;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonValidateValue: getValidateGitReferenceFn(state.repo)\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = selection[0].item;\n\t\t\t\t\tif (state.reference.ref === destination.ref) {\n\t\t\t\t\t\tpickCommit = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tselectedBranchOrTag = state.reference;\n\t\t\t\t}\n\n\t\t\t\tif (pickCommit && selectedBranchOrTag !== undefined && state.counter < 3) {\n\t\t\t\t\tconst log = await Container.git.getLog(state.repo.path, {\n\t\t\t\t\t\tref: selectedBranchOrTag.ref,\n\t\t\t\t\t\tmerges: false\n\t\t\t\t\t});\n\n\t\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem | RefQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? `${selectedBranchOrTag.name} has no commits`\n\t\t\t\t\t\t\t\t: `Choose a commit to rebase ${destination.name} onto`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(commit, undefined, {\n\t\t\t\t\t\t\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\t\t\t\t\t\t\ticon: true\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  ],\n\t\t\t\t\t\tonValidateValue: getValidateGitReferenceFn(state.repo)\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = GitReference.create(selection[0].item.ref);\n\t\t\t\t}\n\n\t\t\t\tconst count =\n\t\t\t\t\t(await Container.git.getCommitCount(state.repo.path, [\n\t\t\t\t\t\t`${state.reference.ref}..${destination.ref}`\n\t\t\t\t\t])) || 0;\n\t\t\t\tif (count === 0) {\n\t\t\t\t\tconst step = this.createConfirmStep(\n\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t\t[],\n\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel, true, {\n\t\t\t\t\t\t\tlabel: `Cancel ${this.title}`,\n\t\t\t\t\t\t\tdetail: `${destination.name} is up to date with ${state.reference.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t\tyield step;\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t[\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\tdescription: `${destination.name} with ${state.reference.name}`,\n\t\t\t\t\t\t\tdetail: `Will update ${destination.name} by applying ${Strings.pluralize(\n\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\tcount\n\t\t\t\t\t\t\t)} on top of ${state.reference.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--interactive'], {\n\t\t\t\t\t\t\tlabel: `Interactive ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--interactive ${destination.name} with ${state.reference.name}`,\n\t\t\t\t\t\t\tdetail: `Will interactively update ${destination.name} by applying ${Strings.pluralize(\n\t\t\t\t\t\t\t\t'commit',\n\t\t\t\t\t\t\t\tcount\n\t\t\t\t\t\t\t)} on top of ${state.reference.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = selection[0].item;\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport { Iterables, Strings } from '../../system';\nimport { QuickCommandBase, QuickPickStep, StepAsyncGenerator, StepSelection, StepState } from '../quickCommand';\nimport {\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tFlagsQuickPickItem,\n\tRepositoryQuickPickItem\n} from '../../quickpicks';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport { Logger } from '../../logger';\n\ntype Flags = '--hard';\n\ninterface State {\n\trepo: Repository;\n\treference?: GitReference;\n\tflags: Flags[];\n}\n\nexport interface ResetGitCommandArgs {\n\treadonly command: 'reset';\n\tstate?: Partial<State>;\n}\n\nexport class ResetGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: ResetGitCommandArgs) {\n\t\tsuper('reset', 'reset', 'Reset', { description: 'resets the current branch to a specified commit' });\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.reference !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: State) {\n\t\trunGitCommandInTerminal('reset', [...state.flags, state.reference!.ref].join(' '), state.repo.path, true);\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst destination = await state.repo.getBranch();\n\t\t\t\tif (destination === undefined) break;\n\n\t\t\t\tif (state.reference === undefined || state.counter < 2) {\n\t\t\t\t\tconst log = await Container.git.getLog(state.repo.path, {\n\t\t\t\t\t\tref: destination.ref,\n\t\t\t\t\t\tmerges: false\n\t\t\t\t\t});\n\n\t\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder:\n\t\t\t\t\t\t\tlog === undefined ? `${destination.name} has no commits` : 'Choose commit to reset to',\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\t\t\t\t\tstate.reference ? state.reference.ref === commit.ref : undefined,\n\t\t\t\t\t\t\t\t\t\t\t\t{ compact: true, icon: true }\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<Flags>> = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t[\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, [], {\n\t\t\t\t\t\t\tlabel: `Soft ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--soft ${destination.name} to ${state.reference.name}`,\n\t\t\t\t\t\t\tdetail: `Will soft reset (leaves changes in the working tree) ${destination.name} to ${state.reference.name}`\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tFlagsQuickPickItem.create<Flags>(state.flags, ['--hard'], {\n\t\t\t\t\t\t\tlabel: `Hard ${this.title}`,\n\t\t\t\t\t\t\tdescription: `--hard ${destination.name} to ${state.reference.name}`,\n\t\t\t\t\t\t\tdetail: `Will hard reset (discards all changes) ${destination.name} to ${state.reference.name}`\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = selection[0].item;\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { Container } from '../../container';\nimport { GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport { Iterables, Strings } from '../../system';\nimport { QuickCommandBase, StepAsyncGenerator, StepSelection, StepState } from '../quickCommand';\nimport { CommitQuickPickItem, Directive, DirectiveQuickPickItem, RepositoryQuickPickItem } from '../../quickpicks';\nimport { runGitCommandInTerminal } from '../../terminal';\nimport { Logger } from '../../logger';\n\ninterface State {\n\trepo: Repository;\n\treferences?: GitReference[];\n}\n\nexport interface RevertGitCommandArgs {\n\treadonly command: 'revert';\n\tstate?: Partial<State>;\n}\n\nexport class RevertGitCommand extends QuickCommandBase<State> {\n\tconstructor(args?: RevertGitCommandArgs) {\n\t\tsuper('revert', 'revert', 'Revert', {\n\t\t\tdescription: 'undoes the changes of specified commits, by creating new commits with inverted changes'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.references !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: true,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\texecute(state: State) {\n\t\trunGitCommandInTerminal(\n\t\t\t'revert',\n\t\t\t[...state.references!.map(c => c.ref).reverse()].join(' '),\n\t\t\tstate.repo.path,\n\t\t\ttrue\n\t\t);\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst destination = await state.repo.getBranch();\n\t\t\t\tif (destination === undefined) break;\n\n\t\t\t\tif (state.references === undefined || state.counter < 2) {\n\t\t\t\t\tconst log = await Container.git.getLog(state.repo.path, {\n\t\t\t\t\t\tref: destination.ref,\n\t\t\t\t\t\tmerges: false\n\t\t\t\t\t});\n\n\t\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title} on ${destination.name}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tmultiselect: log !== undefined,\n\t\t\t\t\t\tplaceholder:\n\t\t\t\t\t\t\tlog === undefined ? `${destination.name} has no commits` : 'Choose commits to revert',\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems:\n\t\t\t\t\t\t\tlog === undefined\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...Iterables.map(log.commits.values(), commit =>\n\t\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\t\t\t\t\tstate.references\n\t\t\t\t\t\t\t\t\t\t\t\t\t? state.references.some(r => r.ref === commit.ref)\n\t\t\t\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t\t\t\t\t{ compact: true, icon: true }\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.references = selection.map(i => i.item);\n\t\t\t\t}\n\n\t\t\t\tconst step = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\tdescription: `${\n\t\t\t\t\t\t\t\tstate.references.length === 1\n\t\t\t\t\t\t\t\t\t? state.references[0].name\n\t\t\t\t\t\t\t\t\t: `${state.references.length} commits`\n\t\t\t\t\t\t\t} on ${destination.name}`,\n\t\t\t\t\t\t\tdetail: `Will revert ${\n\t\t\t\t\t\t\t\tstate.references.length === 1\n\t\t\t\t\t\t\t\t\t? `commit ${state.references[0].name}`\n\t\t\t\t\t\t\t\t\t: `${state.references.length} commits`\n\t\t\t\t\t\t\t} on ${destination.name}`\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { QuickInputButton, Uri } from 'vscode';\nimport { Container } from '../../container';\nimport {\n\tGitLog,\n\tGitLogCommit,\n\tGitService,\n\tRepository,\n\tsearchOperators,\n\tSearchOperators,\n\tSearchPattern\n} from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport {\n\tQuickCommandBase,\n\tSelectableQuickInputButton,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState\n} from '../quickCommand';\nimport { CommandQuickPickItem, CommitQuickPick, RepositoryQuickPickItem } from '../../quickpicks';\nimport { Iterables, Strings } from '../../system';\nimport { Logger } from '../../logger';\nimport {\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tQuickPickItemOfT\n} from '../../quickpicks/gitQuickPicks';\n\ninterface State extends Required<SearchPattern> {\n\trepo: Repository;\n\tshowResultsInView: boolean;\n}\n\nexport interface SearchGitCommandArgs {\n\treadonly command: 'search';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n\tprefillOnly?: boolean;\n}\n\nconst searchOperatorToTitleMap = new Map<SearchOperators, string>([\n\t['', 'Search by Message'],\n\t['=:', 'Search by Message'],\n\t['message:', 'Search by Message'],\n\t['@:', 'Search by Author'],\n\t['author:', 'Search by Author'],\n\t['#:', 'Search by Commit ID'],\n\t['commit:', 'Search by Commit ID'],\n\t['?:', 'Search by File'],\n\t['file:', 'Search by File'],\n\t['~:', 'Search by Changes'],\n\t['change:', 'Search by Changes']\n]);\n\nexport class SearchGitCommand extends QuickCommandBase<State> {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly MatchCase = class extends SelectableQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper('Match Case', 'match-case', on);\n\t\t\t}\n\t\t};\n\n\t\tstatic readonly MatchAll = class extends SelectableQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper('Match All', 'match-all', on);\n\t\t\t}\n\t\t};\n\n\t\tstatic readonly MatchRegex = class extends SelectableQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper('Match using Regular Expressions', 'match-regex', on);\n\t\t\t}\n\t\t};\n\n\t\tstatic readonly RevealInView: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-eye.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-eye.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Reveal Commit in Repositories View'\n\t\t};\n\n\t\tstatic readonly ShowInView: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-open.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-open.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Show Commit in Search Commits View'\n\t\t};\n\n\t\tstatic readonly ShowResultsInView = class extends SelectableQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper('Show Results in Search Commits View', 'eye', on);\n\t\t\t}\n\t\t};\n\t};\n\n\tconstructor(args?: SearchGitCommandArgs) {\n\t\tsuper('search', 'search', 'Search', {\n\t\t\tdescription: 'aka grep, searches for commits'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.pattern !== undefined && !args.prefillOnly) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canConfirm(): boolean {\n\t\treturn false;\n\t}\n\n\tisMatch(name: string) {\n\t\treturn super.isMatch(name) || name === 'grep';\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\t\tlet pickedCommit: GitLogCommit | undefined;\n\t\tlet resultsKey: string | undefined;\n\t\tlet resultsPromise: Promise<GitLog | undefined> | undefined;\n\n\t\tconst cfg = Container.config.gitCommands.search;\n\t\tif (state.matchAll === undefined) {\n\t\t\tstate.matchAll = cfg.matchAll;\n\t\t}\n\t\tif (state.matchCase === undefined) {\n\t\t\tstate.matchCase = cfg.matchCase;\n\t\t}\n\t\tif (state.matchRegex === undefined) {\n\t\t\tstate.matchRegex = cfg.matchRegex;\n\t\t}\n\t\tif (state.showResultsInView === undefined) {\n\t\t\tstate.showResultsInView = cfg.showResultsInView;\n\t\t}\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose repositories',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (state.pattern === undefined || state.counter < 2) {\n\t\t\t\t\tconst items: QuickPickItemOfT<SearchOperators>[] = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: searchOperatorToTitleMap.get('')!,\n\t\t\t\t\t\t\tdescription: `pattern or message: pattern or =: pattern ${GlyphChars.Dash} use quotes to search for phrases`,\n\t\t\t\t\t\t\titem: 'message:'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: searchOperatorToTitleMap.get('author:')!,\n\t\t\t\t\t\t\tdescription: 'author: pattern or @: pattern',\n\t\t\t\t\t\t\titem: 'author:'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: searchOperatorToTitleMap.get('commit:')!,\n\t\t\t\t\t\t\tdescription: 'commit: sha or #: sha',\n\t\t\t\t\t\t\titem: 'commit:'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: searchOperatorToTitleMap.get('file:')!,\n\t\t\t\t\t\t\tdescription: 'file: glob or ?: glob',\n\t\t\t\t\t\t\titem: 'file:'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: searchOperatorToTitleMap.get('change:')!,\n\t\t\t\t\t\t\tdescription: 'change: pattern or ~: pattern',\n\t\t\t\t\t\t\titem: 'change:'\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t\tconst titleSuffix = `${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`;\n\n\t\t\t\t\tconst matchCaseButton: SelectableQuickInputButton = new this.Buttons.MatchCase(state.matchCase);\n\t\t\t\t\tconst matchAllButton: SelectableQuickInputButton = new this.Buttons.MatchAll(state.matchAll);\n\t\t\t\t\tconst matchRegexButton: SelectableQuickInputButton = new this.Buttons.MatchRegex(state.matchRegex);\n\t\t\t\t\tconst showResultsInViewButton: SelectableQuickInputButton = new this.Buttons.ShowResultsInView(\n\t\t\t\t\t\tstate.showResultsInView\n\t\t\t\t\t);\n\n\t\t\t\t\tconst step = this.createPickStep<QuickPickItemOfT<string>>({\n\t\t\t\t\t\ttitle: `${this.title}${titleSuffix}`,\n\t\t\t\t\t\tplaceholder: 'e.g. \"Updates dependencies\" author:eamodio',\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\tadditionalButtons: [matchCaseButton, matchAllButton, matchRegexButton, showResultsInViewButton],\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tvalue: state.pattern,\n\t\t\t\t\t\tonDidAccept: (quickpick): boolean => {\n\t\t\t\t\t\t\tconst pick = quickpick.selectedItems[0];\n\t\t\t\t\t\t\tif (!searchOperators.has(pick.item)) return true;\n\n\t\t\t\t\t\t\tconst value = quickpick.value.trim();\n\t\t\t\t\t\t\tif (value.length === 0 || searchOperators.has(value)) {\n\t\t\t\t\t\t\t\tquickpick.value = pick.item;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tquickpick.value = `${value} ${pick.item}`;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvoid step.onDidChangeValue!(quickpick);\n\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\t\tif (button === matchCaseButton) {\n\t\t\t\t\t\t\t\tstate.matchCase = !state.matchCase;\n\t\t\t\t\t\t\t\tmatchCaseButton.on = state.matchCase;\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (button === matchAllButton) {\n\t\t\t\t\t\t\t\tstate.matchAll = !state.matchAll;\n\t\t\t\t\t\t\t\tmatchAllButton.on = state.matchAll;\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (button === matchRegexButton) {\n\t\t\t\t\t\t\t\tstate.matchRegex = !state.matchRegex;\n\t\t\t\t\t\t\t\tmatchRegexButton.on = state.matchRegex;\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (button === showResultsInViewButton) {\n\t\t\t\t\t\t\t\tstate.showResultsInView = !state.showResultsInView;\n\t\t\t\t\t\t\t\tshowResultsInViewButton.on = state.showResultsInView;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonDidChangeValue: (quickpick): boolean => {\n\t\t\t\t\t\t\tconst operations = GitService.parseSearchOperations(quickpick.value.trim());\n\n\t\t\t\t\t\t\tquickpick.title =\n\t\t\t\t\t\t\t\toperations.size === 0 || operations.size > 1\n\t\t\t\t\t\t\t\t\t? `${this.title}${titleSuffix}`\n\t\t\t\t\t\t\t\t\t: `${searchOperatorToTitleMap.get(operations.keys().next().value)!}${titleSuffix}`;\n\n\t\t\t\t\t\t\tif (quickpick.value.length === 0) {\n\t\t\t\t\t\t\t\tquickpick.items = items;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tquickpick.items = [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: 'Search for',\n\t\t\t\t\t\t\t\t\t\tdescription: quickpick.value,\n\t\t\t\t\t\t\t\t\t\titem: quickpick.value\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.pattern = selection[0].item.trim();\n\t\t\t\t}\n\n\t\t\t\tconst search: SearchPattern = {\n\t\t\t\t\tpattern: state.pattern,\n\t\t\t\t\tmatchAll: state.matchAll,\n\t\t\t\t\tmatchCase: state.matchCase,\n\t\t\t\t\tmatchRegex: state.matchRegex\n\t\t\t\t};\n\t\t\t\tconst searchKey = SearchPattern.toKey(search);\n\n\t\t\t\tif (resultsPromise === undefined || resultsKey !== searchKey) {\n\t\t\t\t\tresultsPromise = Container.git.getLogForSearch(state.repo.path, search);\n\t\t\t\t\tresultsKey = searchKey;\n\t\t\t\t}\n\n\t\t\t\tif (state.showResultsInView) {\n\t\t\t\t\tvoid Container.searchView.search(\n\t\t\t\t\t\tstate.repo.path,\n\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: { label: `for ${state.pattern}` }\n\t\t\t\t\t\t},\n\t\t\t\t\t\tresultsPromise\n\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst results = await resultsPromise;\n\n\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem>({\n\t\t\t\t\ttitle: `${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${state.repo.formattedName}`,\n\t\t\t\t\tplaceholder:\n\t\t\t\t\t\tresults === undefined\n\t\t\t\t\t\t\t? `No results for ${state.pattern}`\n\t\t\t\t\t\t\t: `${Strings.pluralize('result', results.count, {\n\t\t\t\t\t\t\t\t\tnumber: results.truncated ? `${results.count}+` : undefined\n\t\t\t\t\t\t\t  })} for ${state.pattern}`,\n\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\titems:\n\t\t\t\t\t\tresults === undefined\n\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t...Iterables.map(results.commits.values(), commit =>\n\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\tcommit,\n\t\t\t\t\t\t\t\t\t\t\tcommit.ref === (pickedCommit && pickedCommit.ref),\n\t\t\t\t\t\t\t\t\t\t\t{ compact: true, icon: true }\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t  ],\n\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView, this.Buttons.ShowInView],\n\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\tif (button === this.Buttons.ShowInView) {\n\t\t\t\t\t\t\tvoid Container.searchView.search(\n\t\t\t\t\t\t\t\tstate.repo!.path,\n\t\t\t\t\t\t\t\tsearch,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: { label: `for ${state.pattern}` }\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tresults\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\tvoid Container.repositoriesView.revealCommit(quickpick.activeItems[0].item, {\n\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tconst commit = quickpick.activeItems[0].item;\n\t\t\t\t\t\tif (key === 'ctrl+right') {\n\t\t\t\t\t\t\tawait Container.repositoriesView.revealCommit(commit, {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tawait Container.searchView.search(\n\t\t\t\t\t\t\t\tcommit.repoPath,\n\t\t\t\t\t\t\t\t{ pattern: SearchPattern.fromCommit(commit) },\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: { label: `for commit id ${commit.shortSha}` }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tpickedCommit = selection[0].item;\n\n\t\t\t\tif (pickedCommit !== undefined) {\n\t\t\t\t\tconst step = this.createPickStep<CommandQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${pickedCommit.shortSha}`,\n\t\t\t\t\t\tplaceholder: `${pickedCommit.shortSha} ${Strings.pad(GlyphChars.Dot, 1, 1)} ${\n\t\t\t\t\t\t\tpickedCommit.author ? `${pickedCommit.author}, ` : ''\n\t\t\t\t\t\t}${pickedCommit.formattedDate} ${Strings.pad(\n\t\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\t1\n\t\t\t\t\t\t)} ${pickedCommit.getShortMessage()}`,\n\t\t\t\t\t\titems: await CommitQuickPick.getItems(pickedCommit, pickedCommit.toGitUri(), {\n\t\t\t\t\t\t\tshowChanges: false\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView, this.Buttons.ShowInView],\n\t\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\t\tif (button === this.Buttons.ShowInView) {\n\t\t\t\t\t\t\t\tvoid Container.searchView.search(\n\t\t\t\t\t\t\t\t\tpickedCommit!.repoPath,\n\t\t\t\t\t\t\t\t\t{ pattern: SearchPattern.fromCommit(pickedCommit!) },\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: { label: `for commit id ${pickedCommit!.shortSha}` }\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\t\tvoid Container.repositoriesView.revealCommit(pickedCommit!, {\n\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst command = selection[0];\n\t\t\t\t\tif (command instanceof CommandQuickPickItem) {\n\t\t\t\t\t\tcommand.execute();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { QuickInputButton, QuickInputButtons, QuickPickItem, Uri, window } from 'vscode';\nimport { Container } from '../../container';\nimport { GitStashCommit, GitUri, Repository } from '../../git/gitService';\nimport {\n\tBreakQuickCommand,\n\tQuickCommandBase,\n\tQuickPickStep,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState\n} from '../quickCommand';\nimport {\n\tCommandQuickPickItem,\n\tCommitQuickPick,\n\tCommitQuickPickItem,\n\tDirective,\n\tDirectiveQuickPickItem,\n\tFlagsQuickPickItem,\n\tQuickPickItemOfT,\n\tRepositoryQuickPickItem\n} from '../../quickpicks';\nimport { Iterables, Strings } from '../../system';\nimport { GlyphChars } from '../../constants';\nimport { Logger } from '../../logger';\nimport { Messages } from '../../messages';\n\ninterface ApplyState {\n\tsubcommand: 'apply';\n\trepo: Repository;\n\tstash: { stashName: string; message: string; ref: string; repoPath: string };\n}\n\ninterface DropState {\n\tsubcommand: 'drop';\n\trepo: Repository;\n\tstash: { stashName: string; message: string; ref: string; repoPath: string };\n}\n\ninterface ListState {\n\tsubcommand: 'list';\n\trepo: Repository;\n}\n\ninterface PopState {\n\tsubcommand: 'pop';\n\trepo: Repository;\n\tstash: { stashName: string; message: string; ref: string; repoPath: string };\n}\n\ntype PushFlags = '--include-untracked' | '--keep-index';\n\ninterface PushState {\n\tsubcommand: 'push';\n\trepo: Repository;\n\tmessage?: string;\n\turis?: Uri[];\n\tflags: PushFlags[];\n}\n\ntype State = ApplyState | DropState | ListState | PopState | PushState;\ntype StashStepState<T> = StepState<T> & { repo: Repository };\n\nconst subcommandToSubtitleMap = new Map<State['subcommand'], string>([\n\t['apply', 'Apply'],\n\t['drop', 'Drop'],\n\t['list', 'List'],\n\t['pop', 'Pop'],\n\t['push', 'Push']\n]);\nfunction getSubtitle(subcommand: State['subcommand'] | undefined) {\n\treturn subcommand === undefined ? '' : subcommandToSubtitleMap.get(subcommand);\n}\n\nexport interface StashGitCommandArgs {\n\treadonly command: 'stash';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n}\n\nexport class StashGitCommand extends QuickCommandBase<State> {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly RevealInView: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-eye.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-eye.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Reveal Stash in Repositories View'\n\t\t};\n\t};\n\n\tprivate _subcommand: string | undefined;\n\n\tconstructor(args?: StashGitCommandArgs) {\n\t\tsuper('stash', 'stash', 'Stash', {\n\t\t\tdescription: 'shelves (stashes) local changes to be reapplied later'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.subcommand !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.repo !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tswitch (args.state.subcommand) {\n\t\t\tcase 'apply':\n\t\t\tcase 'drop':\n\t\t\tcase 'pop':\n\t\t\t\tif (args.state.stash !== undefined) {\n\t\t\t\t\tcounter++;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'push':\n\t\t\t\tif (args.state.message !== undefined) {\n\t\t\t\t\tcounter++;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tget canConfirm(): boolean {\n\t\treturn this._subcommand !== undefined && this._subcommand !== 'list';\n\t}\n\n\tget canSkipConfirm(): boolean {\n\t\treturn this._subcommand === 'drop' ? false : super.canSkipConfirm;\n\t}\n\n\tget skipConfirmKey() {\n\t\treturn `${this.key}${this._subcommand === undefined ? '' : `-${this._subcommand}`}:${this.pickedVia}`;\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (state.subcommand === undefined || state.counter < 1) {\n\t\t\t\t\tthis._subcommand = undefined;\n\n\t\t\t\t\tconst step = this.createPickStep<QuickPickItemOfT<State['subcommand']>>({\n\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\tplaceholder: `Choose a ${this.label} command`,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'apply',\n\t\t\t\t\t\t\t\tdescription: 'integrates changes from the specified stash into the current branch',\n\t\t\t\t\t\t\t\tpicked: state.subcommand === 'apply',\n\t\t\t\t\t\t\t\titem: 'apply'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'drop',\n\t\t\t\t\t\t\t\tdescription: 'deletes the specified stash',\n\t\t\t\t\t\t\t\tpicked: state.subcommand === 'drop',\n\t\t\t\t\t\t\t\titem: 'drop'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'list',\n\t\t\t\t\t\t\t\tdescription: 'lists the saved stashes',\n\t\t\t\t\t\t\t\tpicked: state.subcommand === 'list',\n\t\t\t\t\t\t\t\titem: 'list'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'pop',\n\t\t\t\t\t\t\t\tdescription:\n\t\t\t\t\t\t\t\t\t'integrates changes from the specified stash into the current branch and deletes the stash',\n\t\t\t\t\t\t\t\tpicked: state.subcommand === 'pop',\n\t\t\t\t\t\t\t\titem: 'pop'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'push',\n\t\t\t\t\t\t\t\tdescription:\n\t\t\t\t\t\t\t\t\t'saves your local changes to a new stash and discards them from the working tree and index',\n\t\t\t\t\t\t\t\tpicked: state.subcommand === 'push',\n\t\t\t\t\t\t\t\titem: 'push'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tbuttons: [QuickInputButtons.Back]\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.subcommand = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tthis._subcommand = state.subcommand;\n\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repo === undefined || state.counter < 2) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repo = repos[0];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst active = state.repo ? state.repo : await Container.git.getActiveRepository();\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\t\tplaceholder: 'Choose a repository',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(r =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(r, r.id === (active && active.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repo = selection[0].item;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tswitch (state.subcommand) {\n\t\t\t\t\tcase 'apply':\n\t\t\t\t\tcase 'pop':\n\t\t\t\t\t\tyield* this.applyOrPop(state as StashStepState<ApplyState | PopState>);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'drop':\n\t\t\t\t\t\tyield* this.drop(state as StashStepState<DropState>);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'list':\n\t\t\t\t\t\tyield* this.list(state as StashStepState<ListState>);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'push':\n\t\t\t\t\t\tyield* this.push(state as StashStepState<PushState>);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\tstate.counter--;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t} catch (ex) {\n\t\t\t\tif (ex instanceof BreakQuickCommand) break;\n\n\t\t\t\tLogger.error(ex, `${this.title}.${state.subcommand}`);\n\n\t\t\t\tswitch (state.subcommand) {\n\t\t\t\t\tcase 'apply':\n\t\t\t\t\tcase 'pop':\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tex.message.includes(\n\t\t\t\t\t\t\t\t'Your local changes to the following files would be overwritten by merge'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tvoid window.showWarningMessage(\n\t\t\t\t\t\t\t\t'Unable to apply stash. Your working tree changes would be overwritten'\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t} else if (ex.message.includes('Auto-merging') && ex.message.includes('CONFLICT')) {\n\t\t\t\t\t\t\tvoid window.showInformationMessage('Stash applied with conflicts');\n\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid Messages.showGenericErrorMessage(\n\t\t\t\t\t\t\t`Unable to apply stash \\u2014 ${ex.message.trim().replace(/\\n+?/g, '; ')}`\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn undefined;\n\n\t\t\t\t\tcase 'drop':\n\t\t\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to delete stash');\n\n\t\t\t\t\t\treturn undefined;\n\n\t\t\t\t\tcase 'push':\n\t\t\t\t\t\tif (ex.message.includes('newer version of Git')) {\n\t\t\t\t\t\t\tvoid window.showErrorMessage(`Unable to stash changes. ${ex.message}`);\n\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid Messages.showGenericErrorMessage('Unable to stash changes');\n\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async *applyOrPop(state: StashStepState<ApplyState> | StashStepState<PopState>): StepAsyncGenerator {\n\t\twhile (true) {\n\t\t\tif (state.stash === undefined || state.counter < 3) {\n\t\t\t\tconst stash = await Container.git.getStashList(state.repo.path);\n\n\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem<GitStashCommit>>({\n\t\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}`,\n\t\t\t\t\tplaceholder:\n\t\t\t\t\t\tstash === undefined\n\t\t\t\t\t\t\t? `${state.repo.formattedName} has no stashes`\n\t\t\t\t\t\t\t: 'Choose a stash to apply to your working tree',\n\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\titems:\n\t\t\t\t\t\tstash === undefined\n\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t...Iterables.map(stash.commits.values(), c =>\n\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\tc,\n\t\t\t\t\t\t\t\t\t\t\tc.stashName === (state.stash && state.stash.stashName),\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tcompact: true\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t  ],\n\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(quickpick.activeItems[0].item, {\n\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStashes(state.repo.path, {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tconst stash = quickpick.activeItems[0].item;\n\t\t\t\t\t\tawait Container.repositoriesView.revealStash(stash, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstate.stash = selection[0].item;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst message =\n\t\t\t\t\tstate.stash.message.length > 80\n\t\t\t\t\t\t? `${state.stash.message.substring(0, 80)}${GlyphChars.Ellipsis}`\n\t\t\t\t\t\t: state.stash.message;\n\n\t\t\t\tconst step = this.createConfirmStep<QuickPickItem & { command: 'apply' | 'pop' }>(\n\t\t\t\t\t`Confirm ${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}`,\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\t\tdescription: `${state.stash.stashName}${Strings.pad(GlyphChars.Dash, 2, 2)}${message}`,\n\t\t\t\t\t\t\tdetail:\n\t\t\t\t\t\t\t\tstate.subcommand === 'pop'\n\t\t\t\t\t\t\t\t\t? `Will delete ${\n\t\t\t\t\t\t\t\t\t\t\tstate.stash!.stashName\n\t\t\t\t\t\t\t\t\t  } and apply the changes to the working tree of ${state.repo.formattedName}`\n\t\t\t\t\t\t\t\t\t: `Will apply the changes from ${state.stash!.stashName} to the working tree of ${\n\t\t\t\t\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t\t\t\t  }`,\n\t\t\t\t\t\t\tcommand: state.subcommand!\n\t\t\t\t\t\t},\n\t\t\t\t\t\t// Alternate confirmation (if pop then apply, and vice versa)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: `${this.title} ${state.subcommand === 'pop' ? 'Apply' : 'Pop'}`,\n\t\t\t\t\t\t\tdescription: `${state.stash!.stashName}${Strings.pad(GlyphChars.Dash, 2, 2)}${message}`,\n\t\t\t\t\t\t\tdetail:\n\t\t\t\t\t\t\t\tstate.subcommand === 'pop'\n\t\t\t\t\t\t\t\t\t? `Will apply the changes from ${state.stash!.stashName} to the working tree of ${\n\t\t\t\t\t\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t: `Will delete ${\n\t\t\t\t\t\t\t\t\t\t\tstate.stash!.stashName\n\t\t\t\t\t\t\t\t\t  } and apply the changes to the working tree of ${state.repo.formattedName}`,\n\t\t\t\t\t\t\tcommand: state.subcommand === 'pop' ? 'apply' : 'pop'\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tundefined,\n\t\t\t\t\t{\n\t\t\t\t\t\tplaceholder: `Confirm ${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(state.stash!, {\n\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstate.subcommand = selection[0].command;\n\t\t\t}\n\n\t\t\tvoid Container.git.stashApply(state.repo.path, state.stash!.stashName, state.subcommand === 'pop');\n\n\t\t\tthrow new BreakQuickCommand();\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async *drop(state: StashStepState<DropState>): StepAsyncGenerator {\n\t\twhile (true) {\n\t\t\tif (state.stash === undefined || state.counter < 3) {\n\t\t\t\tconst stash = await Container.git.getStashList(state.repo.path);\n\n\t\t\t\tconst step = this.createPickStep<CommitQuickPickItem<GitStashCommit>>({\n\t\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}`,\n\t\t\t\t\tplaceholder:\n\t\t\t\t\t\tstash === undefined ? `${state.repo.formattedName} has no stashes` : 'Choose a stash to delete',\n\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\titems:\n\t\t\t\t\t\tstash === undefined\n\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t...Iterables.map(stash.commits.values(), c =>\n\t\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(\n\t\t\t\t\t\t\t\t\t\t\tc,\n\t\t\t\t\t\t\t\t\t\t\tc.stashName === (state.stash && state.stash.stashName),\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tcompact: true\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t  ],\n\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(quickpick.activeItems[0].item, {\n\t\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStashes(state.repo.path, {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tconst stash = quickpick.activeItems[0].item;\n\t\t\t\t\t\tawait Container.repositoriesView.revealStash(stash, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstate.stash = selection[0].item;\n\t\t\t}\n\n\t\t\tconst message =\n\t\t\t\tstate.stash.message.length > 80\n\t\t\t\t\t? `${state.stash.message.substring(0, 80)}${GlyphChars.Ellipsis}`\n\t\t\t\t\t: state.stash.message;\n\n\t\t\tconst step = this.createConfirmStep(\n\t\t\t\t`Confirm ${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t}`,\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\tdescription: `${state.stash.stashName}${Strings.pad(GlyphChars.Dash, 2, 2)}${message}`,\n\t\t\t\t\t\tdetail: `Will delete ${state.stash.stashName}`\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tundefined,\n\t\t\t\t{\n\t\t\t\t\tplaceholder: `Confirm ${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(state.stash!, {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvoid Container.git.stashDelete(state.repo.path, state.stash.stashName);\n\n\t\t\tthrow new BreakQuickCommand();\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate async *list(state: StashStepState<ListState>): StepAsyncGenerator {\n\t\tlet pickedStash: GitStashCommit | undefined;\n\n\t\twhile (true) {\n\t\t\tconst stash = await Container.git.getStashList(state.repo.path);\n\n\t\t\tconst step = this.createPickStep<CommitQuickPickItem<GitStashCommit>>({\n\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t}`,\n\t\t\t\tplaceholder: stash === undefined ? `${state.repo.formattedName} has no stashes` : 'Choose a stash',\n\t\t\t\tmatchOnDetail: true,\n\t\t\t\titems:\n\t\t\t\t\tstash === undefined\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Back, true),\n\t\t\t\t\t\t\t\tDirectiveQuickPickItem.create(Directive.Cancel)\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t...Iterables.map(stash.commits.values(), c =>\n\t\t\t\t\t\t\t\t\tCommitQuickPickItem.create(c, c.ref === (pickedStash && pickedStash.ref), {\n\t\t\t\t\t\t\t\t\t\tcompact: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t  ],\n\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\tif (button === this.Buttons.RevealInView) {\n\t\t\t\t\t\tif (quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(quickpick.activeItems[0].item, {\n\t\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvoid Container.repositoriesView.revealStashes(state.repo.path, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tkeys: ['right', 'alt+right', 'ctrl+right'],\n\t\t\t\tonDidPressKey: async (quickpick, key) => {\n\t\t\t\t\tif (quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\tconst stash = quickpick.activeItems[0].item;\n\t\t\t\t\tawait Container.repositoriesView.revealStash(stash, {\n\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\tfocus: false,\n\t\t\t\t\t\texpand: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpickedStash = selection[0].item;\n\n\t\t\tif (pickedStash !== undefined) {\n\t\t\t\tconst step = this.createPickStep<CommandQuickPickItem>({\n\t\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${pickedStash.shortSha}`,\n\t\t\t\t\tplaceholder: `${\n\t\t\t\t\t\tpickedStash.number === undefined ? '' : `${pickedStash.number}: `\n\t\t\t\t\t}${pickedStash.getShortMessage()}`,\n\t\t\t\t\titems: await CommitQuickPick.getItems(pickedStash, pickedStash.toGitUri(), { showChanges: false }),\n\t\t\t\t\tadditionalButtons: [this.Buttons.RevealInView],\n\t\t\t\t\tonDidClickButton: (quickpick, button) => {\n\t\t\t\t\t\tif (button !== this.Buttons.RevealInView) return;\n\n\t\t\t\t\t\tvoid Container.repositoriesView.revealStash(pickedStash!, {\n\t\t\t\t\t\t\tselect: true,\n\t\t\t\t\t\t\texpand: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst command = selection[0];\n\t\t\t\tif (command instanceof CommandQuickPickItem) {\n\t\t\t\t\tcommand.execute();\n\n\t\t\t\t\tthrow new BreakQuickCommand();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/require-await\n\tprivate async *push(state: StashStepState<PushState>): StepAsyncGenerator {\n\t\tif (state.flags == null) {\n\t\t\tstate.flags = [];\n\t\t}\n\n\t\twhile (true) {\n\t\t\tif (state.message === undefined || state.counter < 3) {\n\t\t\t\tconst step = this.createInputStep({\n\t\t\t\t\ttitle: `${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}`,\n\t\t\t\t\tplaceholder: 'Please provide a stash message',\n\t\t\t\t\tvalue: state.message\n\t\t\t\t});\n\n\t\t\t\tconst value: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!(await this.canInputStepMoveNext(step, state, value))) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstate.message = value;\n\t\t\t}\n\n\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\tconst step: QuickPickStep<FlagsQuickPickItem<PushFlags>> = this.createConfirmStep(\n\t\t\t\t\t`Confirm ${this.title} ${getSubtitle(state.subcommand)}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\tstate.repo.formattedName\n\t\t\t\t\t}`,\n\t\t\t\t\tstate.uris === undefined || state.uris.length === 0\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, [], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\t\t\t\tdescription: state.message,\n\t\t\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--include-untracked'], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)} & Include Untracked`,\n\t\t\t\t\t\t\t\t\tdescription: `--include-untracked ${state.message}`,\n\t\t\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes, including untracked files'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--keep-index'], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)} & Keep Staged`,\n\t\t\t\t\t\t\t\t\tdescription: `--keep-index ${state.message}`,\n\t\t\t\t\t\t\t\t\tdetail: 'Will stash uncommitted changes, but will keep staged files intact'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, [], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)}`,\n\t\t\t\t\t\t\t\t\tdescription: state.message,\n\t\t\t\t\t\t\t\t\tdetail: `Will stash changes in ${\n\t\t\t\t\t\t\t\t\t\tstate.uris.length === 1\n\t\t\t\t\t\t\t\t\t\t\t? GitUri.getFormattedPath(state.uris[0], { relativeTo: state.repo.path })\n\t\t\t\t\t\t\t\t\t\t\t: `${state.uris.length} files`\n\t\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tFlagsQuickPickItem.create<PushFlags>(state.flags, ['--keep-index'], {\n\t\t\t\t\t\t\t\t\tlabel: `${this.title} ${getSubtitle(state.subcommand)} & Keep Staged`,\n\t\t\t\t\t\t\t\t\tdescription: `--keep-index ${state.message}`,\n\t\t\t\t\t\t\t\t\tdetail: `Will stash changes in ${\n\t\t\t\t\t\t\t\t\t\tstate.uris.length === 1\n\t\t\t\t\t\t\t\t\t\t\t? GitUri.getFormattedPath(state.uris[0], { relativeTo: state.repo.path })\n\t\t\t\t\t\t\t\t\t\t\t: `${state.uris.length} files`\n\t\t\t\t\t\t\t\t\t}, but will keep staged files intact`\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t  ],\n\t\t\t\t\tundefined,\n\t\t\t\t\t{ placeholder: `Confirm ${this.title} ${getSubtitle(state.subcommand)}` }\n\t\t\t\t);\n\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tstate.flags = selection[0].item;\n\t\t\t}\n\n\t\t\tvoid Container.git.stashSave(state.repo.path, state.message, state.uris, {\n\t\t\t\tincludeUntracked: state.flags.includes('--include-untracked'),\n\t\t\t\tkeepIndex: state.flags.includes('--keep-index')\n\t\t\t});\n\n\t\t\tthrow new BreakQuickCommand();\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\n/* eslint-disable no-loop-func */\nimport { ProgressLocation, window } from 'vscode';\nimport { Container } from '../../container';\nimport { GitBranch, GitReference, Repository } from '../../git/gitService';\nimport { GlyphChars } from '../../constants';\nimport {\n\tgetBranchesAndOrTags,\n\tgetValidateGitReferenceFn,\n\tQuickCommandBase,\n\tSelectableQuickInputButton,\n\tStepAsyncGenerator,\n\tStepSelection,\n\tStepState\n} from '../quickCommand';\nimport { ReferencesQuickPickItem, RepositoryQuickPickItem } from '../../quickpicks';\nimport { Strings } from '../../system';\nimport { Logger } from '../../logger';\n\ninterface State {\n\trepos: Repository[];\n\treference: GitBranch | GitReference;\n\tcreateBranch?: string;\n}\n\nexport interface SwitchGitCommandArgs {\n\treadonly command: 'switch';\n\tstate?: Partial<State>;\n\n\tconfirm?: boolean;\n}\n\nexport class SwitchGitCommand extends QuickCommandBase<State> {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly ShowTags = class extends SelectableQuickInputButton {\n\t\t\tconstructor(on = false) {\n\t\t\t\tsuper('Show Tags', 'tag', on);\n\t\t\t}\n\t\t};\n\t};\n\n\tconstructor(args?: SwitchGitCommandArgs) {\n\t\tsuper('switch', 'switch', 'Switch', {\n\t\t\tdescription: 'aka checkout, switches the current branch to a specified branch'\n\t\t});\n\n\t\tif (args == null || args.state === undefined) return;\n\n\t\tlet counter = 0;\n\t\tif (args.state.repos !== undefined && args.state.repos.length !== 0) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tif (args.state.reference !== undefined) {\n\t\t\tcounter++;\n\t\t}\n\n\t\tthis._initialState = {\n\t\t\tcounter: counter,\n\t\t\tconfirm: args.confirm,\n\t\t\t...args.state\n\t\t};\n\t}\n\n\tasync execute(state: State) {\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Switching ${\n\t\t\t\t\tstate.repos.length === 1 ? state.repos[0].formattedName : `${state.repos.length} repositories`\n\t\t\t\t} to ${state.reference.ref}`\n\t\t\t},\n\t\t\t() =>\n\t\t\t\tPromise.all(\n\t\t\t\t\tstate.repos.map(r =>\n\t\t\t\t\t\tr.checkout(state.reference.ref, { createBranch: state.createBranch, progress: false })\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t));\n\t}\n\n\tisMatch(name: string) {\n\t\treturn super.isMatch(name) || name === 'checkout';\n\t}\n\n\tprotected async *steps(): StepAsyncGenerator {\n\t\tconst state: StepState<State> = this._initialState === undefined ? { counter: 0 } : this._initialState;\n\t\tlet repos;\n\t\tlet showTags = false;\n\n\t\twhile (true) {\n\t\t\ttry {\n\t\t\t\tif (repos === undefined) {\n\t\t\t\t\trepos = [...(await Container.git.getOrderedRepositories())];\n\t\t\t\t}\n\n\t\t\t\tif (state.repos === undefined || state.counter < 1) {\n\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\tstate.counter++;\n\t\t\t\t\t\tstate.repos = [repos[0]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet actives: Repository[];\n\t\t\t\t\t\tif (state.repos) {\n\t\t\t\t\t\t\tactives = state.repos;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst active = await Container.git.getActiveRepository();\n\t\t\t\t\t\t\tactives = active ? [active] : [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst step = this.createPickStep<RepositoryQuickPickItem>({\n\t\t\t\t\t\t\tmultiselect: true,\n\t\t\t\t\t\t\ttitle: this.title,\n\t\t\t\t\t\t\tplaceholder: 'Choose repositories',\n\t\t\t\t\t\t\titems: await Promise.all(\n\t\t\t\t\t\t\t\trepos.map(repo =>\n\t\t\t\t\t\t\t\t\tRepositoryQuickPickItem.create(repo, actives.some(r => r.id === repo.id), {\n\t\t\t\t\t\t\t\t\t\tbranch: true,\n\t\t\t\t\t\t\t\t\t\tfetched: true,\n\t\t\t\t\t\t\t\t\t\tstatus: true\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.repos = selection.map(i => i.item);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (state.reference === undefined || state.counter < 2) {\n\t\t\t\t\tshowTags = state.repos.length === 1;\n\n\t\t\t\t\tconst showTagsButton: SelectableQuickInputButton = new this.Buttons.ShowTags(showTags);\n\n\t\t\t\t\tconst items = await getBranchesAndOrTags(\n\t\t\t\t\t\tstate.repos,\n\t\t\t\t\t\tshowTags,\n\t\t\t\t\t\tstate.repos.length === 1 ? undefined : { filterBranches: b => !b.remote }\n\t\t\t\t\t);\n\n\t\t\t\t\tconst step = this.createPickStep<ReferencesQuickPickItem>({\n\t\t\t\t\t\ttitle: `${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\tplaceholder: `Choose a branch${showTags ? ' or tag' : ''} to switch to${GlyphChars.Space.repeat(\n\t\t\t\t\t\t\t3\n\t\t\t\t\t\t)}(select or enter a reference)`,\n\t\t\t\t\t\tmatchOnDescription: true,\n\t\t\t\t\t\tmatchOnDetail: true,\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tselectedItems: state.reference\n\t\t\t\t\t\t\t? items.filter(ref => ref.label === state.reference!.ref)\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\tadditionalButtons: [showTagsButton],\n\t\t\t\t\t\tonDidClickButton: async (quickpick, button) => {\n\t\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\t\tquickpick.enabled = false;\n\n\t\t\t\t\t\t\tshowTags = !showTags;\n\t\t\t\t\t\t\tshowTagsButton.on = showTags;\n\n\t\t\t\t\t\t\tquickpick.placeholder = `Choose a branch${\n\t\t\t\t\t\t\t\tshowTags ? ' or tag' : ''\n\t\t\t\t\t\t\t} to switch to${GlyphChars.Space.repeat(3)}(select or enter a reference)`;\n\n\t\t\t\t\t\t\tquickpick.items = await getBranchesAndOrTags(\n\t\t\t\t\t\t\t\tstate.repos!,\n\t\t\t\t\t\t\t\tshowTags,\n\t\t\t\t\t\t\t\tstate.repos!.length === 1 ? undefined : { filterBranches: b => !b.remote }\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\tquickpick.enabled = true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonValidateValue: getValidateGitReferenceFn(state.repos)\n\t\t\t\t\t});\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tif (repos.length === 1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.reference = selection[0].item;\n\t\t\t\t}\n\n\t\t\t\tif (GitBranch.is(state.reference) && state.reference.remote) {\n\t\t\t\t\tconst branches = await Container.git.getBranches(state.reference.repoPath, {\n\t\t\t\t\t\tfilter: b => {\n\t\t\t\t\t\t\treturn b.tracking === state.reference!.name;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (branches.length === 0) {\n\t\t\t\t\t\tconst step = this.createInputStep({\n\t\t\t\t\t\t\ttitle: `${this.title} new branch to ${state.reference.ref}${Strings.pad(\n\t\t\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t\t2\n\t\t\t\t\t\t\t)}${\n\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\tplaceholder: 'Please provide a name for the local branch',\n\t\t\t\t\t\t\tvalue: state.reference.getName(),\n\t\t\t\t\t\t\tvalidate: async (value: string | undefined): Promise<[boolean, string | undefined]> => {\n\t\t\t\t\t\t\t\tif (value == null) return [false, undefined];\n\n\t\t\t\t\t\t\t\tvalue = value.trim();\n\t\t\t\t\t\t\t\tif (value.length === 0) return [false, 'Please enter a valid branch name'];\n\n\t\t\t\t\t\t\t\tconst valid = Boolean(await Container.git.validateBranchName(value));\n\t\t\t\t\t\t\t\treturn [valid, valid ? undefined : `'${value}' isn't a valid branch name`];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst value: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\t\tif (!(await this.canInputStepMoveNext(step, state, value))) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.createBranch = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.confirm(state.confirm)) {\n\t\t\t\t\tconst step = this.createConfirmStep(\n\t\t\t\t\t\t`Confirm ${this.title}${Strings.pad(GlyphChars.Dot, 2, 2)}${\n\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t}`,\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: this.title,\n\t\t\t\t\t\t\t\tdescription: state.createBranch\n\t\t\t\t\t\t\t\t\t? `${state.createBranch} (from ${state.reference.name}) `\n\t\t\t\t\t\t\t\t\t: state.reference.name,\n\t\t\t\t\t\t\t\tdetail: `Will ${\n\t\t\t\t\t\t\t\t\tstate.createBranch\n\t\t\t\t\t\t\t\t\t\t? `create and switch to ${state.createBranch} (from ${state.reference.name})`\n\t\t\t\t\t\t\t\t\t\t: `switch to ${state.reference.name}`\n\t\t\t\t\t\t\t\t} in ${\n\t\t\t\t\t\t\t\t\tstate.repos.length === 1\n\t\t\t\t\t\t\t\t\t\t? state.repos[0].formattedName\n\t\t\t\t\t\t\t\t\t\t: `${state.repos.length} repositories`\n\t\t\t\t\t\t\t\t}`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t);\n\t\t\t\t\tconst selection: StepSelection<typeof step> = yield step;\n\n\t\t\t\t\tif (!this.canPickStepMoveNext(step, state, selection)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.execute(state as State);\n\t\t\t\tbreak;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, this.title);\n\n\t\t\t\tthrow ex;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { Disposable, InputBox, QuickInputButton, QuickInputButtons, QuickPick, QuickPickItem, Uri, window } from 'vscode';\nimport { command, Command, Commands } from './common';\nimport { log } from '../system';\nimport {\n\tisQuickInputStep,\n\tisQuickPickStep,\n\tQuickCommandBase,\n\tQuickInputStep,\n\tQuickPickStep,\n\tStepSelection\n} from './quickCommand';\nimport { Directive, DirectiveQuickPickItem } from '../quickpicks';\nimport { CherryPickGitCommand, CherryPickGitCommandArgs } from './git/cherry-pick';\nimport { FetchGitCommand, FetchGitCommandArgs } from './git/fetch';\nimport { MergeGitCommand, MergeGitCommandArgs } from './git/merge';\nimport { PullGitCommand, PullGitCommandArgs } from './git/pull';\nimport { PushGitCommand, PushGitCommandArgs } from './git/push';\nimport { RebaseGitCommand, RebaseGitCommandArgs } from './git/rebase';\nimport { ResetGitCommand, ResetGitCommandArgs } from './git/reset';\nimport { RevertGitCommand, RevertGitCommandArgs } from './git/revert';\nimport { SearchGitCommand, SearchGitCommandArgs } from './git/search';\nimport { StashGitCommand, StashGitCommandArgs } from './git/stash';\nimport { SwitchGitCommand, SwitchGitCommandArgs } from './git/switch';\nimport { Container } from '../container';\nimport { configuration } from '../configuration';\nimport { KeyMapping } from '../keyboard';\n\nconst sanitizeLabel = /\\$\\(.+?\\)|\\s/g;\n\nexport type GitCommandsCommandArgs =\n\t| CherryPickGitCommandArgs\n\t| FetchGitCommandArgs\n\t| MergeGitCommandArgs\n\t| PullGitCommandArgs\n\t| PushGitCommandArgs\n\t| RebaseGitCommandArgs\n\t| ResetGitCommandArgs\n\t| RevertGitCommandArgs\n\t| SearchGitCommandArgs\n\t| StashGitCommandArgs\n\t| SwitchGitCommandArgs;\n\n@command()\nexport class GitCommandsCommand extends Command {\n\tprivate readonly Buttons = class {\n\t\tstatic readonly CloseOnFocusOut: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-pin-small.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-pin-small.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Keep Open'\n\t\t};\n\n\t\tstatic readonly KeepOpen: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-pin-small-selected.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-pin-small-selected.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Keep Open'\n\t\t};\n\n\t\tstatic readonly WillConfirm: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-check.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-check.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Will confirm'\n\t\t};\n\n\t\tstatic readonly WillConfirmForced: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-check.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-check.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Will always confirm'\n\t\t};\n\n\t\tstatic readonly WillSkipConfirm: QuickInputButton = {\n\t\t\ticonPath: {\n\t\t\t\tdark: Uri.file(Container.context.asAbsolutePath('images/dark/icon-no-check.svg')),\n\t\t\t\tlight: Uri.file(Container.context.asAbsolutePath('images/light/icon-no-check.svg'))\n\t\t\t},\n\t\t\ttooltip: 'Skips confirm'\n\t\t};\n\t};\n\n\tprivate _pickedVia: 'menu' | 'command' = 'menu';\n\n\tconstructor() {\n\t\tsuper(Commands.GitCommands);\n\t}\n\n\t@log({ args: false, correlate: true, singleLine: true, timed: false })\n\tasync execute(args?: GitCommandsCommandArgs) {\n\t\tconst commandsStep = new PickCommandStep(args);\n\n\t\tlet step: QuickPickStep | QuickInputStep | undefined = commandsStep;\n\n\t\tif (args) {\n\t\t\tconst command = commandsStep.find(args.command);\n\t\t\tif (command !== undefined) {\n\t\t\t\tthis._pickedVia = 'command';\n\t\t\t\tcommandsStep.setCommand(command, this._pickedVia);\n\n\t\t\t\tconst next = await command.next();\n\t\t\t\tif (next.done) return;\n\n\t\t\t\tstep = next.value;\n\t\t\t}\n\t\t}\n\n\t\twhile (step !== undefined) {\n\t\t\tif (isQuickPickStep(step)) {\n\t\t\t\tstep = await this.showPickStep(step, commandsStep);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (isQuickInputStep(step)) {\n\t\t\t\tstep = await this.showInputStep(step, commandsStep);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate async showInputStep(step: QuickInputStep, commandsStep: PickCommandStep) {\n\t\tconst input = window.createInputBox();\n\t\tinput.ignoreFocusOut = !configuration.get('gitCommands', 'closeOnFocusOut');\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\treturn await new Promise<QuickPickStep | QuickInputStep | undefined>(resolve => {\n\t\t\t\tconst goBack = async () => {\n\t\t\t\t\tinput.value = '';\n\t\t\t\t\tif (commandsStep.command !== undefined) {\n\t\t\t\t\t\tinput.busy = true;\n\t\t\t\t\t\tresolve((await commandsStep.command.previous()) || commandsStep);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tconst mapping: KeyMapping = {\n\t\t\t\t\tleft: { onDidPressKey: goBack }\n\t\t\t\t};\n\t\t\t\tif (step.onDidPressKey !== undefined && step.keys !== undefined && step.keys.length !== 0) {\n\t\t\t\t\tfor (const key of step.keys) {\n\t\t\t\t\t\tmapping[key] = {\n\t\t\t\t\t\t\tonDidPressKey: key => step.onDidPressKey!(input, key)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst scope = Container.keyboard.createScope(mapping);\n\t\t\t\tscope.start();\n\n\t\t\t\tdisposables.push(\n\t\t\t\t\tscope,\n\t\t\t\t\tinput.onDidHide(() => resolve()),\n\t\t\t\t\tinput.onDidTriggerButton(async e => {\n\t\t\t\t\t\tif (e === QuickInputButtons.Back) {\n\t\t\t\t\t\t\tinput.value = '';\n\t\t\t\t\t\t\tif (commandsStep.command !== undefined) {\n\t\t\t\t\t\t\t\tinput.busy = true;\n\t\t\t\t\t\t\t\tresolve((await commandsStep.command.previous()) || commandsStep);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e === this.Buttons.WillConfirmForced) return;\n\t\t\t\t\t\tif (e === this.Buttons.WillConfirm || e === this.Buttons.WillSkipConfirm) {\n\t\t\t\t\t\t\tawait this.toggleConfirmation(input, commandsStep.command);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e === this.Buttons.CloseOnFocusOut || e === this.Buttons.KeepOpen) {\n\t\t\t\t\t\t\tawait this.toggleKeepOpen(input, commandsStep.command);\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidClickButton !== undefined) {\n\t\t\t\t\t\t\tstep.onDidClickButton(input, e);\n\t\t\t\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tinput.onDidChangeValue(async e => {\n\t\t\t\t\t\tif (scope !== undefined) {\n\t\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.validate === undefined) return;\n\n\t\t\t\t\t\tconst [, message] = await step.validate(e);\n\t\t\t\t\t\tinput.validationMessage = message;\n\t\t\t\t\t}),\n\t\t\t\t\tinput.onDidAccept(async () => {\n\t\t\t\t\t\tresolve(await this.nextStep(input, commandsStep.command!, input.value));\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tinput.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\tinput.title = step.title;\n\t\t\t\tinput.placeholder = step.placeholder;\n\t\t\t\tif (step.value !== undefined) {\n\t\t\t\t\tinput.value = step.value;\n\t\t\t\t}\n\n\t\t\t\t// If we are starting over clear the previously active command\n\t\t\t\tif (commandsStep.command !== undefined && step === commandsStep) {\n\t\t\t\t\tthis._pickedVia = 'menu';\n\t\t\t\t\tcommandsStep.setCommand(undefined, this._pickedVia);\n\t\t\t\t}\n\n\t\t\t\tinput.show();\n\n\t\t\t\t// Manually trigger `onDidChangeValue`, because the InputBox seems to fail to call it properly\n\t\t\t\tif (step.value !== undefined) {\n\t\t\t\t\t// HACK: This is fragile!\n\t\t\t\t\t(input as any)._onDidChangeValueEmitter.fire(input.value);\n\t\t\t\t}\n\t\t\t});\n\t\t} finally {\n\t\t\tinput.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\tprivate async showPickStep(step: QuickPickStep, commandsStep: PickCommandStep) {\n\t\tconst quickpick = window.createQuickPick();\n\t\tquickpick.ignoreFocusOut = !configuration.get('gitCommands', 'closeOnFocusOut');\n\n\t\tconst disposables: Disposable[] = [];\n\n\t\ttry {\n\t\t\treturn await new Promise<QuickPickStep | QuickInputStep | undefined>(resolve => {\n\t\t\t\tconst goBack = async () => {\n\t\t\t\t\tquickpick.value = '';\n\t\t\t\t\tif (commandsStep.command !== undefined) {\n\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\tresolve((await commandsStep.command.previous()) || commandsStep);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tconst mapping: KeyMapping = {\n\t\t\t\t\tleft: { onDidPressKey: goBack }\n\t\t\t\t};\n\t\t\t\tif (step.onDidPressKey !== undefined && step.keys !== undefined && step.keys.length !== 0) {\n\t\t\t\t\tfor (const key of step.keys) {\n\t\t\t\t\t\tmapping[key] = {\n\t\t\t\t\t\t\tonDidPressKey: key => step.onDidPressKey!(quickpick, key)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst scope = Container.keyboard.createScope(mapping);\n\t\t\t\tscope.start();\n\n\t\t\t\tlet overrideItems = false;\n\n\t\t\t\tdisposables.push(\n\t\t\t\t\tscope,\n\t\t\t\t\tquickpick.onDidHide(() => resolve()),\n\t\t\t\t\tquickpick.onDidTriggerButton(async e => {\n\t\t\t\t\t\tif (e === QuickInputButtons.Back) {\n\t\t\t\t\t\t\tgoBack();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e === this.Buttons.WillConfirmForced) return;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\te === this.Buttons.CloseOnFocusOut ||\n\t\t\t\t\t\t\te === this.Buttons.KeepOpen ||\n\t\t\t\t\t\t\te === this.Buttons.WillConfirm ||\n\t\t\t\t\t\t\te === this.Buttons.WillSkipConfirm\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tlet command = commandsStep.command;\n\t\t\t\t\t\t\tif (command === undefined && quickpick.activeItems.length !== 0) {\n\t\t\t\t\t\t\t\tconst active = quickpick.activeItems[0];\n\t\t\t\t\t\t\t\tif (!QuickCommandBase.is(active)) return;\n\n\t\t\t\t\t\t\t\tcommand = active;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e === this.Buttons.WillConfirm || e === this.Buttons.WillSkipConfirm) {\n\t\t\t\t\t\t\t\tawait this.toggleConfirmation(quickpick, command);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e === this.Buttons.CloseOnFocusOut || e === this.Buttons.KeepOpen) {\n\t\t\t\t\t\t\t\tawait this.toggleKeepOpen(quickpick, command);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidClickButton !== undefined) {\n\t\t\t\t\t\t\tstep.onDidClickButton(quickpick, e);\n\t\t\t\t\t\t\tquickpick.buttons = this.getButtons(step, commandsStep.command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeValue(async e => {\n\t\t\t\t\t\tif (scope !== undefined) {\n\t\t\t\t\t\t\t// Pause the left/right keyboard commands if there is a value, otherwise the left/right arrows won't work in the input properly\n\t\t\t\t\t\t\tif (e.length !== 0) {\n\t\t\t\t\t\t\t\tawait scope.pause(['left', 'right']);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tawait scope.resume();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (step.onDidChangeValue !== undefined) {\n\t\t\t\t\t\t\tconst cancel = await step.onDidChangeValue(quickpick);\n\t\t\t\t\t\t\tif (cancel) return;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!overrideItems) {\n\t\t\t\t\t\t\tif (quickpick.canSelectMany && e === ' ') {\n\t\t\t\t\t\t\t\tquickpick.value = '';\n\t\t\t\t\t\t\t\tquickpick.selectedItems =\n\t\t\t\t\t\t\t\t\tquickpick.selectedItems.length === quickpick.items.length ? [] : quickpick.items;\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.endsWith(' ')) {\n\t\t\t\t\t\t\t\tif (quickpick.canSelectMany && quickpick.selectedItems.length !== 0) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tlet items;\n\t\t\t\t\t\t\t\tif (commandsStep.command === undefined) {\n\t\t\t\t\t\t\t\t\tconst command = commandsStep.find(quickpick.value.trim(), true);\n\t\t\t\t\t\t\t\t\tif (command === undefined) return;\n\n\t\t\t\t\t\t\t\t\tcommandsStep.setCommand(command, this._pickedVia);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconst cmd = quickpick.value.trim().toLowerCase();\n\t\t\t\t\t\t\t\t\tconst item = step.items.find(\n\t\t\t\t\t\t\t\t\t\ti => i.label.replace(sanitizeLabel, '').toLowerCase() === cmd\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tif (item === undefined) return;\n\n\t\t\t\t\t\t\t\t\titems = [item];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, items));\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Assume there is no matches (since there is no activeItems)\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!quickpick.canSelectMany &&\n\t\t\t\t\t\t\tcommandsStep.command !== undefined &&\n\t\t\t\t\t\t\te.trim().length !== 0 &&\n\t\t\t\t\t\t\t(overrideItems || quickpick.activeItems.length === 0)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (step.onValidateValue === undefined) return;\n\n\t\t\t\t\t\t\toverrideItems = await step.onValidateValue(quickpick, e.trim(), step.items);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toverrideItems = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// If we are no longer overriding the items, put them back (only if we need to)\n\t\t\t\t\t\tif (!overrideItems && quickpick.items.length !== step.items.length) {\n\t\t\t\t\t\t\tquickpick.items = step.items;\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidChangeActive(() => {\n\t\t\t\t\t\tif (commandsStep.command !== undefined || quickpick.activeItems.length === 0) return;\n\n\t\t\t\t\t\tconst command = quickpick.activeItems[0];\n\t\t\t\t\t\tif (!QuickCommandBase.is(command)) return;\n\n\t\t\t\t\t\tquickpick.buttons = this.getButtons(undefined, command);\n\t\t\t\t\t}),\n\t\t\t\t\tquickpick.onDidAccept(async () => {\n\t\t\t\t\t\tlet items = quickpick.selectedItems;\n\t\t\t\t\t\tif (items.length === 0) {\n\t\t\t\t\t\t\tif (!quickpick.canSelectMany || quickpick.activeItems.length === 0) {\n\t\t\t\t\t\t\t\tconst value = quickpick.value.trim();\n\t\t\t\t\t\t\t\tif (value.length === 0) return;\n\n\t\t\t\t\t\t\t\tif (step.onDidAccept === undefined) return;\n\n\t\t\t\t\t\t\t\tquickpick.busy = true;\n\n\t\t\t\t\t\t\t\tif (await step.onDidAccept(quickpick)) {\n\t\t\t\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, value));\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tquickpick.busy = false;\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\titems = quickpick.activeItems;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (items.length === 1) {\n\t\t\t\t\t\t\tconst item = items[0];\n\t\t\t\t\t\t\tif (DirectiveQuickPickItem.is(item)) {\n\t\t\t\t\t\t\t\tswitch (item.directive) {\n\t\t\t\t\t\t\t\t\tcase Directive.Cancel:\n\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\tcase Directive.Back:\n\t\t\t\t\t\t\t\t\t\tquickpick.value = '';\n\t\t\t\t\t\t\t\t\t\tif (commandsStep.command !== undefined) {\n\t\t\t\t\t\t\t\t\t\t\tquickpick.busy = true;\n\t\t\t\t\t\t\t\t\t\t\tresolve((await commandsStep.command.previous()) || commandsStep);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (commandsStep.command === undefined) {\n\t\t\t\t\t\t\tconst command = items[0];\n\t\t\t\t\t\t\tif (!QuickCommandBase.is(command)) return;\n\n\t\t\t\t\t\t\tcommandsStep.setCommand(command, this._pickedVia);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!quickpick.canSelectMany) {\n\t\t\t\t\t\t\tif (step.onDidAccept !== undefined) {\n\t\t\t\t\t\t\t\tquickpick.busy = true;\n\n\t\t\t\t\t\t\t\tconst next = await step.onDidAccept(quickpick);\n\n\t\t\t\t\t\t\t\tquickpick.busy = false;\n\n\t\t\t\t\t\t\t\tif (!next) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresolve(await this.nextStep(quickpick, commandsStep.command!, items as QuickPickItem[]));\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\t\tquickpick.title = step.title;\n\t\t\t\tquickpick.placeholder = step.placeholder;\n\t\t\t\tquickpick.matchOnDescription = Boolean(step.matchOnDescription);\n\t\t\t\tquickpick.matchOnDetail = Boolean(step.matchOnDetail);\n\t\t\t\tquickpick.canSelectMany = Boolean(step.multiselect);\n\n\t\t\t\tquickpick.items = step.items;\n\n\t\t\t\tif (quickpick.canSelectMany) {\n\t\t\t\t\tquickpick.selectedItems = step.selectedItems || quickpick.items.filter(i => i.picked);\n\t\t\t\t\tquickpick.activeItems = quickpick.selectedItems;\n\t\t\t\t} else {\n\t\t\t\t\tquickpick.activeItems = step.selectedItems || quickpick.items.filter(i => i.picked);\n\t\t\t\t}\n\n\t\t\t\t// If we are starting over clear the previously active command\n\t\t\t\tif (commandsStep.command !== undefined && step === commandsStep) {\n\t\t\t\t\tthis._pickedVia = 'menu';\n\t\t\t\t\tcommandsStep.setCommand(undefined, this._pickedVia);\n\t\t\t\t}\n\n\t\t\t\t// Needs to be after we reset the command\n\t\t\t\tquickpick.buttons = this.getButtons(step, commandsStep.command);\n\n\t\t\t\tif (step.value !== undefined) {\n\t\t\t\t\tquickpick.value = step.value;\n\t\t\t\t}\n\n\t\t\t\tquickpick.show();\n\n\t\t\t\t// Manually trigger `onDidChangeValue`, because the QuickPick seems to fail to call it properly\n\t\t\t\tif (step.value !== undefined) {\n\t\t\t\t\t// HACK: This is fragile!\n\t\t\t\t\t(quickpick as any)._onDidChangeValueEmitter.fire(quickpick.value);\n\t\t\t\t}\n\t\t\t});\n\t\t} finally {\n\t\t\tquickpick.dispose();\n\t\t\tdisposables.forEach(d => d.dispose());\n\t\t}\n\t}\n\n\tprivate getButtons(step: QuickInputStep | QuickPickStep | undefined, command?: QuickCommandBase) {\n\t\tconst buttons: QuickInputButton[] = [];\n\n\t\tif (step !== undefined) {\n\t\t\tif (step.buttons !== undefined) {\n\t\t\t\tbuttons.push(\n\t\t\t\t\t...step.buttons,\n\t\t\t\t\tconfiguration.get('gitCommands', 'closeOnFocusOut')\n\t\t\t\t\t\t? this.Buttons.CloseOnFocusOut\n\t\t\t\t\t\t: this.Buttons.KeepOpen\n\t\t\t\t);\n\t\t\t\treturn buttons;\n\t\t\t}\n\n\t\t\tbuttons.push(QuickInputButtons.Back);\n\n\t\t\tif (step.additionalButtons !== undefined) {\n\t\t\t\tbuttons.push(...step.additionalButtons);\n\t\t\t}\n\t\t}\n\n\t\tif (command !== undefined && command.canConfirm) {\n\t\t\tif (command.canSkipConfirm) {\n\t\t\t\tbuttons.push(command.confirm() ? this.Buttons.WillConfirm : this.Buttons.WillSkipConfirm);\n\t\t\t} else {\n\t\t\t\tbuttons.push(this.Buttons.WillConfirmForced);\n\t\t\t}\n\t\t}\n\n\t\tbuttons.push(\n\t\t\tconfiguration.get('gitCommands', 'closeOnFocusOut') ? this.Buttons.CloseOnFocusOut : this.Buttons.KeepOpen\n\t\t);\n\n\t\treturn buttons;\n\t}\n\n\tprivate async nextStep(\n\t\tquickInput: InputBox | QuickPick<QuickPickItem>,\n\t\tcommand: QuickCommandBase,\n\t\tvalue: StepSelection<any> | undefined\n\t) {\n\t\tquickInput.busy = true;\n\t\t// quickInput.enabled = false;\n\n\t\tconst next = await command.next(value);\n\t\tif (next.done) return undefined;\n\n\t\tquickInput.value = '';\n\t\treturn next.value;\n\t}\n\n\tprivate async toggleConfirmation(\n\t\tinput: InputBox | QuickPick<QuickPickItem>,\n\t\tcommand: QuickCommandBase | undefined\n\t) {\n\t\tif (command === undefined || command.skipConfirmKey === undefined) return;\n\n\t\tconst skipConfirmations = configuration.get('gitCommands', 'skipConfirmations') || [];\n\n\t\tconst index = skipConfirmations.indexOf(command.skipConfirmKey);\n\t\tif (index !== -1) {\n\t\t\tskipConfirmations.splice(index, 1);\n\t\t} else {\n\t\t\tskipConfirmations.push(command.skipConfirmKey);\n\t\t}\n\n\t\tvoid (await configuration.updateEffective('gitCommands', 'skipConfirmations', skipConfirmations));\n\n\t\tinput.buttons = this.getButtons(command.value, command);\n\t}\n\n\tprivate async toggleKeepOpen(input: InputBox | QuickPick<QuickPickItem>, command: QuickCommandBase | undefined) {\n\t\tconst closeOnFocusOut = !configuration.get('gitCommands', 'closeOnFocusOut');\n\n\t\tinput.ignoreFocusOut = !closeOnFocusOut;\n\t\tvoid (await configuration.updateEffective('gitCommands', 'closeOnFocusOut', closeOnFocusOut));\n\n\t\tinput.buttons = this.getButtons(command && command.value, command);\n\t}\n}\n\nclass PickCommandStep implements QuickPickStep {\n\treadonly buttons = [];\n\treadonly items: QuickCommandBase[];\n\treadonly matchOnDescription = true;\n\treadonly placeholder = 'Choose a git command';\n\treadonly title = 'GitLens';\n\n\tconstructor(args?: GitCommandsCommandArgs) {\n\t\tthis.items = [\n\t\t\tnew CherryPickGitCommand(args && args.command === 'cherry-pick' ? args : undefined),\n\t\t\tnew MergeGitCommand(args && args.command === 'merge' ? args : undefined),\n\t\t\tnew FetchGitCommand(args && args.command === 'fetch' ? args : undefined),\n\t\t\tnew PullGitCommand(args && args.command === 'pull' ? args : undefined),\n\t\t\tnew PushGitCommand(args && args.command === 'push' ? args : undefined),\n\t\t\tnew RebaseGitCommand(args && args.command === 'rebase' ? args : undefined),\n\t\t\tnew ResetGitCommand(args && args.command === 'reset' ? args : undefined),\n\t\t\tnew RevertGitCommand(args && args.command === 'revert' ? args : undefined),\n\t\t\tnew SearchGitCommand(args && args.command === 'search' ? args : undefined),\n\t\t\tnew StashGitCommand(args && args.command === 'stash' ? args : undefined),\n\t\t\tnew SwitchGitCommand(args && args.command === 'switch' ? args : undefined)\n\t\t];\n\t}\n\n\tprivate _active: QuickCommandBase | undefined;\n\tget command(): QuickCommandBase | undefined {\n\t\treturn this._active;\n\t}\n\n\tfind(commandName: string, fuzzy: boolean = false) {\n\t\tif (fuzzy) {\n\t\t\tconst cmd = commandName.toLowerCase();\n\t\t\treturn this.items.find(c => c.isMatch(cmd));\n\t\t}\n\n\t\treturn this.items.find(c => c.key === commandName);\n\t}\n\n\tsetCommand(value: QuickCommandBase | undefined, reason: 'menu' | 'command'): void {\n\t\tif (this._active !== undefined) {\n\t\t\tthis._active.picked = false;\n\t\t}\n\n\t\tthis._active = value;\n\n\t\tif (this._active !== undefined) {\n\t\t\tthis._active.picked = true;\n\t\t\tthis._active.pickedVia = reason;\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\nimport { GitCommandsCommandArgs } from '../commands';\n\n@command()\nexport class FetchRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.FetchRepositories);\n\t}\n\n\tasync execute() {\n\t\tconst repositories = await Container.git.getOrderedRepositories();\n\n\t\tconst args: GitCommandsCommandArgs = { command: 'fetch', state: { repos: repositories } };\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n}\n\n@command()\nexport class PullRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.PullRepositories);\n\t}\n\n\tasync execute() {\n\t\tconst repositories = await Container.git.getOrderedRepositories();\n\n\t\tconst args: GitCommandsCommandArgs = { command: 'pull', state: { repos: repositories } };\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n}\n\n@command()\nexport class PushRepositoriesCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.PushRepositories);\n\t}\n\n\tasync execute() {\n\t\tconst repositories = await Container.git.getOrderedRepositories();\n\n\t\tconst args: GitCommandsCommandArgs = { command: 'push', state: { repos: repositories } };\n\t\treturn commands.executeCommand(Commands.GitCommands, args);\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget } from 'vscode';\nimport { configuration } from '../configuration';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class ResetSuppressedWarningsCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ResetSuppressedWarnings);\n\t}\n\n\tasync execute() {\n\t\tawait configuration.update('advanced', 'messages', undefined, ConfigurationTarget.Global);\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { SearchResultsCommitsNode } from '../views/nodes';\nimport { Container } from '../container';\nimport { Command, command, CommandContext, Commands, isCommandViewContextWithRepo } from './common';\nimport { GitCommandsCommandArgs } from '../commands';\nimport { SearchPattern } from '../git/gitService';\n\nexport interface SearchCommitsCommandArgs {\n\tsearch?: Partial<SearchPattern>;\n\trepoPath?: string;\n\n\tprefillOnly?: boolean;\n\n\tshowInView?: boolean;\n}\n\n@command()\nexport class SearchCommitsCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.SearchCommits, Commands.SearchCommitsInView]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: SearchCommitsCommandArgs) {\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.showInView = true;\n\n\t\t\tif (context.node instanceof SearchResultsCommitsNode) {\n\t\t\t\targs.repoPath = context.node.repoPath;\n\t\t\t\targs.search = context.node.search;\n\t\t\t\targs.prefillOnly = true;\n\t\t\t}\n\n\t\t\tif (isCommandViewContextWithRepo(context)) {\n\t\t\t\targs.repoPath = context.node.repo.path;\n\t\t\t}\n\t\t} else if (context.command === Commands.SearchCommitsInView) {\n\t\t\targs = { ...args };\n\t\t\targs.showInView = true;\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: SearchCommitsCommandArgs) {\n\t\targs = { ...args };\n\n\t\tlet repo;\n\t\tif (args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository(args.repoPath);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'search',\n\t\t\tprefillOnly: args.prefillOnly,\n\t\t\tstate: {\n\t\t\t\trepo: repo,\n\t\t\t\t...args.search,\n\t\t\t\tshowResultsInView: args.showInView\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { ActiveEditorCommand, command, Commands, getCommandUri } from './common';\nimport { GitUri, SearchPattern } from '../git/gitService';\nimport { GitCommandsCommandArgs } from '../commands';\nimport { Messages } from '../messages';\nimport { Iterables } from '../system';\nimport { Logger } from '../logger';\n\nexport interface ShowCommitsInViewCommandArgs {\n\trefs?: string[];\n\trepoPath?: string;\n}\n\n@command()\nexport class ShowCommitsInViewCommand extends ActiveEditorCommand {\n\tconstructor() {\n\t\tsuper([Commands.ShowCommitInView, Commands.ShowCommitsInView]);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowCommitsInViewCommandArgs) {\n\t\targs = { ...args };\n\n\t\tif (args.refs === undefined) {\n\t\t\tif (editor == null) return undefined;\n\n\t\t\turi = getCommandUri(uri, editor);\n\t\t\tif (uri == null) return undefined;\n\n\t\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\t\targs.repoPath = gitUri.repoPath;\n\n\t\t\ttry {\n\t\t\t\t// Check for any uncommitted changes in the range\n\t\t\t\tconst blame = editor.document.isDirty\n\t\t\t\t\t? await Container.git.getBlameForRangeContents(gitUri, editor.selection, editor.document.getText())\n\t\t\t\t\t: await Container.git.getBlameForRange(gitUri, editor.selection);\n\t\t\t\tif (blame === undefined) {\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage(\n\t\t\t\t\t\t'Unable to show commits in Search Commits view'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\targs.refs = [\n\t\t\t\t\t...Iterables.filterMap(blame.commits.values(), c => (c.isUncommitted ? undefined : c.ref))\n\t\t\t\t];\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'ShowCommitsInViewCommand', 'getBlameForRange');\n\t\t\t\treturn Messages.showGenericErrorMessage('Unable to show commits in Search Commits view');\n\t\t\t}\n\t\t}\n\n\t\tlet repo;\n\t\tif (args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository(args.repoPath);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'search',\n\t\t\tstate: {\n\t\t\t\trepo: repo,\n\t\t\t\tpattern: SearchPattern.fromCommits(args.refs),\n\t\t\t\tshowResultsInView: true\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { command, Command, Commands, getLastCommand } from './common';\n\n@command()\nexport class ShowLastQuickPickCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ShowLastQuickPick);\n\t}\n\n\texecute() {\n\t\tconst command = getLastCommand();\n\t\tif (command === undefined) return Promise.resolve(undefined);\n\n\t\ttry {\n\t\t\treturn commands.executeCommand(command.command, ...command.args);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowLastQuickPickCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show last quick pick');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitLog, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tBranchHistoryQuickPick,\n\tCommandQuickPickItem,\n\tReferencesQuickPick,\n\tReferencesQuickPickIncludes\n} from '../quickpicks';\nimport { ActiveEditorCachedCommand, command, Commands, getCommandUri, getRepoPathOrActiveOrPrompt } from './common';\nimport { ShowQuickCommitDetailsCommandArgs } from './showQuickCommitDetails';\n\nexport interface ShowQuickBranchHistoryCommandArgs {\n\tbranch?: string;\n\tlog?: GitLog;\n\tmaxCount?: number;\n\trepoPath?: string;\n\n\tgoBackCommand?: CommandQuickPickItem;\n\tnextPageCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickBranchHistoryCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickBranchHistory);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickBranchHistoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\tconst gitUri = uri && (await GitUri.fromUri(uri));\n\n\t\targs = { ...args };\n\n\t\tlet progressCancellation =\n\t\t\targs.branch === undefined ? undefined : BranchHistoryQuickPick.showProgress(args.branch);\n\t\ttry {\n\t\t\tconst repoPath =\n\t\t\t\targs.repoPath ||\n\t\t\t\t(await getRepoPathOrActiveOrPrompt(\n\t\t\t\t\tgitUri,\n\t\t\t\t\teditor,\n\t\t\t\t\t`Show branch history in which repository${GlyphChars.Ellipsis}`\n\t\t\t\t));\n\t\t\tif (!repoPath) return undefined;\n\n\t\t\tif (args.branch === undefined) {\n\t\t\t\tlet goBackCommand;\n\t\t\t\tif (!(await Container.git.getRepoPathOrActive(uri, editor))) {\n\t\t\t\t\tgoBackCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\t\tdescription: 'to which repository'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t\t\t[uri, args]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst pick = await new ReferencesQuickPick(repoPath).show(\n\t\t\t\t\t`Show history for branch${GlyphChars.Ellipsis}`,\n\t\t\t\t\t{\n\t\t\t\t\t\tcheckmarks: false,\n\t\t\t\t\t\tgoBack: goBackCommand,\n\t\t\t\t\t\tinclude: ReferencesQuickPickIncludes.Branches\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif (pick === undefined) return undefined;\n\t\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t\targs.branch = pick.ref;\n\t\t\t\tif (args.branch === undefined) return undefined;\n\n\t\t\t\tprogressCancellation = BranchHistoryQuickPick.showProgress(args.branch);\n\t\t\t}\n\n\t\t\tif (args.log === undefined) {\n\t\t\t\targs.log = await Container.git.getLog(repoPath, {\n\t\t\t\t\tmaxCount: args.maxCount,\n\t\t\t\t\tref: (gitUri && gitUri.sha) || args.branch\n\t\t\t\t});\n\t\t\t\tif (args.log === undefined) return window.showWarningMessage('Unable to show branch history');\n\t\t\t}\n\n\t\t\tif (progressCancellation !== undefined && progressCancellation.token.isCancellationRequested) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst pick = await BranchHistoryQuickPick.show(\n\t\t\t\targs.log,\n\t\t\t\tgitUri,\n\t\t\t\targs.branch,\n\t\t\t\tprogressCancellation!,\n\t\t\t\targs.goBackCommand,\n\t\t\t\targs.nextPageCommand\n\t\t\t);\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\t// Create a command to get back to here\n\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\tdescription: `to history of ${GlyphChars.Space}$(git-branch) ${args.branch}`\n\t\t\t\t},\n\t\t\t\tCommands.ShowQuickBranchHistory,\n\t\t\t\t[uri, { ...args }]\n\t\t\t);\n\n\t\t\tconst commandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\tsha: pick.item.sha,\n\t\t\t\tcommit: pick.item,\n\t\t\t\trepoLog: args.log,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.ShowQuickCommitDetails, pick.item.toGitUri(), commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickBranchHistoryCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show branch history');\n\t\t} finally {\n\t\t\tprogressCancellation && progressCancellation.cancel();\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitLog, GitLogCommit, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, CommitQuickPick, CommitWithFileStatusQuickPickItem } from '../quickpicks';\nimport {\n\tActiveEditorCachedCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\nimport { ShowQuickCommitFileDetailsCommandArgs } from './showQuickCommitFileDetails';\n\nexport interface ShowQuickCommitDetailsCommandArgs {\n\tsha?: string;\n\tcommit?: GitCommit | GitLogCommit;\n\trepoLog?: GitLog;\n\trevealInView?: boolean;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickCommitDetailsCommand extends ActiveEditorCachedCommand {\n\tstatic getMarkdownCommandArgs(sha: string): string;\n\tstatic getMarkdownCommandArgs(args: ShowQuickCommitDetailsCommandArgs): string;\n\tstatic getMarkdownCommandArgs(argsOrSha: ShowQuickCommitDetailsCommandArgs | string): string {\n\t\tconst args = typeof argsOrSha === 'string' ? { sha: argsOrSha } : argsOrSha;\n\t\treturn super.getMarkdownCommandArgsCore<ShowQuickCommitDetailsCommandArgs>(\n\t\t\tCommands.ShowQuickCommitDetails,\n\t\t\targs\n\t\t);\n\t}\n\n\tconstructor() {\n\t\tsuper([Commands.RevealCommitInView, Commands.ShowQuickCommitDetails]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: ShowQuickCommitDetailsCommandArgs) {\n\t\tif (context.command === Commands.RevealCommitInView) {\n\t\t\targs = { ...args };\n\t\t\targs.revealInView = true;\n\t\t}\n\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.uri.sha;\n\n\t\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\t\targs.commit = context.node.commit;\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickCommitDetailsCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\tlet repoPath = gitUri.repoPath;\n\n\t\targs = { ...args };\n\t\tif (args.sha === undefined) {\n\t\t\tif (editor == null) return undefined;\n\n\t\t\tconst blameline = editor.selection.active.line;\n\t\t\tif (blameline < 0) return undefined;\n\n\t\t\ttry {\n\t\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame === undefined) {\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to show commit details');\n\t\t\t\t}\n\n\t\t\t\t// Because the previous sha of an uncommitted file isn't trust worthy we just have to kick out\n\t\t\t\tif (blame.commit.isUncommitted) {\n\t\t\t\t\treturn Messages.showLineUncommittedWarningMessage('Unable to show commit details');\n\t\t\t\t}\n\n\t\t\t\targs.sha = blame.commit.sha;\n\t\t\t\trepoPath = blame.commit.repoPath;\n\n\t\t\t\targs.commit = blame.commit;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'ShowQuickCommitDetailsCommand', `getBlameForLine(${blameline})`);\n\t\t\t\treturn Messages.showGenericErrorMessage('Unable to show commit details');\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.commit === undefined || args.commit.isFile) {\n\t\t\t\tif (args.repoLog !== undefined) {\n\t\t\t\t\targs.commit = args.repoLog.commits.get(args.sha);\n\t\t\t\t\t// If we can't find the commit, kill the repoLog\n\t\t\t\t\tif (args.commit === undefined) {\n\t\t\t\t\t\targs.repoLog = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (args.repoLog === undefined) {\n\t\t\t\t\tconst log = await Container.git.getLog(repoPath!, { maxCount: 2, ref: args.sha });\n\t\t\t\t\tif (log === undefined) {\n\t\t\t\t\t\treturn Messages.showCommitNotFoundWarningMessage('Unable to show commit details');\n\t\t\t\t\t}\n\n\t\t\t\t\targs.commit = log.commits.get(args.sha);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.commit === undefined) {\n\t\t\t\treturn Messages.showCommitNotFoundWarningMessage('Unable to show commit details');\n\t\t\t}\n\n\t\t\tif (args.revealInView) {\n\t\t\t\tvoid (await Container.repositoriesView.revealCommit(args.commit, {\n\t\t\t\t\tselect: true,\n\t\t\t\t\tfocus: true,\n\t\t\t\t\texpand: true\n\t\t\t\t}));\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (args.goBackCommand === undefined) {\n\t\t\t\tconst branch = await Container.git.getBranch(args.commit.repoPath);\n\t\t\t\tif (branch !== undefined) {\n\t\t\t\t\t// Create a command to get back to the branch history\n\t\t\t\t\targs.goBackCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\t\tdescription: `to ${branch.name} history`\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickCurrentBranchHistory,\n\t\t\t\t\t\t[args.commit.toGitUri()]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create a command to get back to where we are right now\n\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\tdescription: `to details of ${GlyphChars.Space}$(git-commit) ${args.commit.shortSha}`\n\t\t\t\t},\n\t\t\t\tCommands.ShowQuickCommitDetails,\n\t\t\t\t[args.commit.toGitUri(), args]\n\t\t\t);\n\n\t\t\tconst pick = await new CommitQuickPick(repoPath).show(args.commit as GitLogCommit, uri, {\n\t\t\t\tcurrentCommand: currentCommand,\n\t\t\t\tgoBackCommand: args.goBackCommand,\n\t\t\t\trepoLog: args.repoLog\n\t\t\t});\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (!(pick instanceof CommitWithFileStatusQuickPickItem)) return pick.execute();\n\n\t\t\tconst commandArgs: ShowQuickCommitFileDetailsCommandArgs = {\n\t\t\t\tcommit: pick.commit,\n\t\t\t\tsha: pick.sha,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.ShowQuickCommitFileDetails, pick.commit.toGitUri(), commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickCommitDetailsCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show commit details');\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitLog, GitLogCommit, GitService, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, CommitFileQuickPick } from '../quickpicks';\nimport {\n\tActiveEditorCachedCommand,\n\tcommand,\n\tCommandContext,\n\tCommands,\n\tgetCommandUri,\n\tisCommandViewContextWithCommit\n} from './common';\nimport { ShowQuickCommitDetailsCommandArgs } from './showQuickCommitDetails';\n\nexport interface ShowQuickCommitFileDetailsCommandArgs {\n\tsha?: string;\n\tcommit?: GitCommit | GitLogCommit;\n\tfileLog?: GitLog;\n\trevisionUri?: string;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickCommitFileDetailsCommand extends ActiveEditorCachedCommand {\n\tstatic getMarkdownCommandArgs(args: ShowQuickCommitFileDetailsCommandArgs): string {\n\t\treturn super.getMarkdownCommandArgsCore<ShowQuickCommitFileDetailsCommandArgs>(\n\t\t\tCommands.ShowQuickCommitFileDetails,\n\t\t\targs\n\t\t);\n\t}\n\n\tconstructor() {\n\t\tsuper([Commands.ShowQuickCommitFileDetails, Commands.ShowQuickRevisionDetails]);\n\t}\n\n\tprotected async preExecute(context: CommandContext, args?: ShowQuickCommitFileDetailsCommandArgs) {\n\t\tif (context.command === Commands.ShowQuickRevisionDetails && context.editor !== undefined) {\n\t\t\targs = { ...args };\n\n\t\t\tconst gitUri = await GitUri.fromUri(context.editor.document.uri);\n\t\t\targs.sha = gitUri.sha;\n\t\t}\n\n\t\tif (context.type === 'viewItem') {\n\t\t\targs = { ...args };\n\t\t\targs.sha = context.node.uri.sha;\n\n\t\t\tif (isCommandViewContextWithCommit(context)) {\n\t\t\t\targs.commit = context.node.commit;\n\t\t\t}\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickCommitFileDetailsCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return undefined;\n\n\t\targs = { ...args };\n\n\t\tlet gitUri;\n\t\tif (args.revisionUri !== undefined) {\n\t\t\tgitUri = GitUri.fromRevisionUri(Uri.parse(args.revisionUri));\n\t\t\targs.sha = gitUri.sha;\n\t\t} else {\n\t\t\tgitUri = await GitUri.fromUri(uri);\n\t\t}\n\n\t\tif (args.sha === undefined) {\n\t\t\tif (editor == null) return undefined;\n\n\t\t\tconst blameline = editor.selection.active.line;\n\t\t\tif (blameline < 0) return undefined;\n\n\t\t\ttry {\n\t\t\t\tconst blame = await Container.git.getBlameForLine(gitUri, blameline);\n\t\t\t\tif (blame === undefined) {\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to show commit file details');\n\t\t\t\t}\n\n\t\t\t\t// Because the previous sha of an uncommitted file isn't trust worthy we just have to kick out\n\t\t\t\tif (blame.commit.isUncommitted) {\n\t\t\t\t\treturn Messages.showLineUncommittedWarningMessage('Unable to show commit file details');\n\t\t\t\t}\n\n\t\t\t\targs.sha = blame.commit.sha;\n\n\t\t\t\targs.commit = blame.commit;\n\t\t\t} catch (ex) {\n\t\t\t\tLogger.error(ex, 'ShowQuickCommitFileDetailsCommand', `getBlameForLine(${blameline})`);\n\t\t\t\treturn window.showErrorMessage(\n\t\t\t\t\t'Unable to show commit file details. See output channel for more details'\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (args.commit === undefined || !args.commit.isFile) {\n\t\t\t\tif (args.fileLog !== undefined) {\n\t\t\t\t\targs.commit = args.fileLog.commits.get(args.sha);\n\t\t\t\t\t// If we can't find the commit, kill the fileLog\n\t\t\t\t\tif (args.commit === undefined) {\n\t\t\t\t\t\targs.fileLog = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (args.fileLog === undefined) {\n\t\t\t\t\tconst repoPath = args.commit === undefined ? gitUri.repoPath : args.commit.repoPath;\n\t\t\t\t\targs.commit = await Container.git.getCommitForFile(repoPath, gitUri.fsPath, { ref: args.sha });\n\t\t\t\t\tif (args.commit === undefined) {\n\t\t\t\t\t\treturn Messages.showCommitNotFoundWarningMessage('Unable to show commit file details');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (args.commit === undefined) {\n\t\t\t\treturn Messages.showCommitNotFoundWarningMessage('Unable to show commit file details');\n\t\t\t}\n\n\t\t\tconst shortSha = GitService.shortenSha(args.sha);\n\n\t\t\tif (args.goBackCommand === undefined) {\n\t\t\t\tconst commandArgs: ShowQuickCommitDetailsCommandArgs = {\n\t\t\t\t\tcommit: args.commit,\n\t\t\t\t\tsha: args.sha\n\t\t\t\t};\n\n\t\t\t\t// Create a command to get back to the commit details\n\t\t\t\targs.goBackCommand = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\t\tdescription: `to details of ${GlyphChars.Space}$(git-commit) ${shortSha}`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickCommitDetails,\n\t\t\t\t\t[args.commit.toGitUri(), commandArgs]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Create a command to get back to where we are right now\n\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\tdescription: `to details of ${args.commit.getFormattedPath()} from ${\n\t\t\t\t\t\tGlyphChars.Space\n\t\t\t\t\t}$(git-commit) ${shortSha}`\n\t\t\t\t},\n\t\t\t\tCommands.ShowQuickCommitFileDetails,\n\t\t\t\t[args.commit.toGitUri(), args]\n\t\t\t);\n\n\t\t\tconst pick = await CommitFileQuickPick.show(\n\t\t\t\targs.commit as GitLogCommit,\n\t\t\t\turi,\n\t\t\t\targs.goBackCommand,\n\t\t\t\tcurrentCommand,\n\t\t\t\targs.fileLog\n\t\t\t);\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickCommitFileDetailsCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show commit file details');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, TextEditor, Uri } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport { ActiveEditorCachedCommand, command, Commands, getCommandUri, getRepoPathOrActiveOrPrompt } from './common';\nimport { ShowQuickBranchHistoryCommandArgs } from './showQuickBranchHistory';\n\nexport interface ShowQuickCurrentBranchHistoryCommandArgs {\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickCurrentBranchHistoryCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickCurrentBranchHistory);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickCurrentBranchHistoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\ttry {\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\t\turi,\n\t\t\t\teditor,\n\t\t\t\t`Show current branch history for which repository${GlyphChars.Ellipsis}`\n\t\t\t);\n\t\t\tif (!repoPath) return undefined;\n\n\t\t\tconst branch = await Container.git.getBranch(repoPath);\n\t\t\tif (branch === undefined) return undefined;\n\n\t\t\tconst commandArgs: ShowQuickBranchHistoryCommandArgs = {\n\t\t\t\tbranch: branch.name,\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tgoBackCommand: args && args.goBackCommand\n\t\t\t};\n\t\t\treturn commands.executeCommand(Commands.ShowQuickBranchHistory, uri, commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickCurrentBranchHistoryCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show branch history');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands, Range, TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitBranch, GitLog, GitReference, GitTag, GitUri } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport {\n\tCommandQuickPickItem,\n\tFileHistoryQuickPick,\n\tOpenInFileHistoryViewQuickPickItem,\n\tShowFileHistoryFromQuickPickItem\n} from '../quickpicks';\nimport { Iterables, Strings } from '../system';\nimport { ActiveEditorCachedCommand, command, CommandContext, Commands, getCommandUri } from './common';\nimport { ShowQuickCommitFileDetailsCommandArgs } from './showQuickCommitFileDetails';\n\nexport interface ShowQuickFileHistoryCommandArgs {\n\treference?: GitBranch | GitTag | GitReference;\n\tlog?: GitLog;\n\tmaxCount?: number;\n\trange?: Range;\n\tshowInView?: boolean;\n\n\tgoBackCommand?: CommandQuickPickItem;\n\tnextPageCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickFileHistoryCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper([Commands.ShowFileHistoryInView, Commands.ShowQuickFileHistory]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: ShowQuickFileHistoryCommandArgs) {\n\t\tif (context.command === Commands.ShowFileHistoryInView) {\n\t\t\targs = { ...args };\n\t\t\targs.showInView = true;\n\t\t}\n\n\t\treturn this.execute(context.editor, context.uri, args);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickFileHistoryCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\t\tif (uri == null) return commands.executeCommand(Commands.ShowQuickCurrentBranchHistory);\n\n\t\tconst gitUri = await GitUri.fromUri(uri);\n\n\t\targs = { ...args };\n\n\t\tif (args.showInView) {\n\t\t\tawait Container.fileHistoryView.showHistoryForUri(gitUri);\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst placeHolder = `${gitUri.getFormattedPath({\n\t\t\tsuffix: args.reference ? ` (${args.reference.name})` : undefined\n\t\t})}${gitUri.sha ? ` ${Strings.pad(GlyphChars.Dot, 1, 1)} ${gitUri.shortSha}` : ''}`;\n\n\t\tconst progressCancellation = FileHistoryQuickPick.showProgress(placeHolder);\n\n\t\ttry {\n\t\t\tif (args.log === undefined) {\n\t\t\t\targs.log = await Container.git.getLogForFile(gitUri.repoPath, gitUri.fsPath, {\n\t\t\t\t\tmaxCount: args.maxCount,\n\t\t\t\t\trange: args.range,\n\t\t\t\t\tref: (args.reference && args.reference.ref) || gitUri.sha\n\t\t\t\t});\n\t\t\t\tif (args.log === undefined) {\n\t\t\t\t\tif (args.reference) {\n\t\t\t\t\t\treturn window.showWarningMessage(`The file could not be found in ${args.reference.name}`);\n\t\t\t\t\t}\n\t\t\t\t\treturn Messages.showFileNotUnderSourceControlWarningMessage('Unable to show file history');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (progressCancellation !== undefined && progressCancellation.token.isCancellationRequested) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tlet previousPageCommand: CommandQuickPickItem | undefined = undefined;\n\n\t\t\tif (args.log.truncated) {\n\t\t\t\tlet commandArgs: ShowQuickFileHistoryCommandArgs;\n\t\t\t\tcommandArgs = { ...args, log: undefined };\n\t\t\t\tconst npc = new CommandQuickPickItem(\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '$(arrow-right) Show Next Commits',\n\t\t\t\t\t\tdescription: `shows ${args.log.maxCount} newer commits`\n\t\t\t\t\t},\n\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t[gitUri, commandArgs]\n\t\t\t\t);\n\n\t\t\t\tconst last = Iterables.last(args.log.commits.values());\n\t\t\t\tif (last != null) {\n\t\t\t\t\tcommandArgs = { ...args, log: undefined, nextPageCommand: npc };\n\t\t\t\t\tpreviousPageCommand = new CommandQuickPickItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '$(arrow-left) Show Previous Commits',\n\t\t\t\t\t\t\tdescription: `shows ${args.log.maxCount} older commits`\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t\t[new GitUri(uri, last), commandArgs]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst icon = GitTag.isOfRefType(args.reference)\n\t\t\t\t? '$(tag) '\n\t\t\t\t: GitBranch.isOfRefType(args.reference)\n\t\t\t\t? '$(git-branch) '\n\t\t\t\t: '';\n\t\t\t// Create a command to get back to where we are right now\n\t\t\tconst currentCommand = new CommandQuickPickItem(\n\t\t\t\t{\n\t\t\t\t\tlabel: `go back ${GlyphChars.ArrowBack}`,\n\t\t\t\t\tdescription: `to history of ${gitUri.getFormattedPath()}${\n\t\t\t\t\t\targs.reference\n\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}${icon}${args.reference.name}`\n\t\t\t\t\t\t\t: gitUri.sha\n\t\t\t\t\t\t\t? ` from ${GlyphChars.Space}$(git-commit) ${gitUri.shortSha}`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t}`\n\t\t\t\t},\n\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t[uri, args]\n\t\t\t);\n\n\t\t\tconst pick = await FileHistoryQuickPick.show(args.log, gitUri, placeHolder, {\n\t\t\t\tprogressCancellation: progressCancellation,\n\t\t\t\tcurrentCommand: currentCommand,\n\t\t\t\tgoBackCommand: args.goBackCommand,\n\t\t\t\tnextPageCommand: args.nextPageCommand,\n\t\t\t\tpreviousPageCommand: previousPageCommand,\n\t\t\t\tshowAllCommand:\n\t\t\t\t\targs.log !== undefined && args.log.truncated\n\t\t\t\t\t\t? new CommandQuickPickItem(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: '$(sync) Show All Commits',\n\t\t\t\t\t\t\t\t\tdescription: 'this may take a while'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tCommands.ShowQuickFileHistory,\n\t\t\t\t\t\t\t\t[uri, { ...args, log: undefined, maxCount: 0 }]\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: undefined,\n\t\t\t\tshowInViewCommand:\n\t\t\t\t\targs.log !== undefined\n\t\t\t\t\t\t? new OpenInFileHistoryViewQuickPickItem(\n\t\t\t\t\t\t\t\tgitUri,\n\t\t\t\t\t\t\t\t(args.reference && args.reference.ref) || gitUri.sha\n\t\t\t\t\t\t  )\n\t\t\t\t\t\t: undefined\n\t\t\t});\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (pick instanceof ShowFileHistoryFromQuickPickItem) {\n\t\t\t\tconst reference = await pick.execute();\n\t\t\t\tif (reference === undefined) return undefined;\n\t\t\t\tif (reference instanceof CommandQuickPickItem) return reference.execute();\n\n\t\t\t\tconst commandArgs: ShowQuickFileHistoryCommandArgs = {\n\t\t\t\t\t...args,\n\t\t\t\t\tlog: undefined,\n\t\t\t\t\treference: reference.item,\n\t\t\t\t\tgoBackCommand: currentCommand\n\t\t\t\t};\n\t\t\t\treturn commands.executeCommand(Commands.ShowQuickFileHistory, gitUri, commandArgs);\n\t\t\t}\n\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\tconst commandArgs: ShowQuickCommitFileDetailsCommandArgs = {\n\t\t\t\tcommit: pick.item,\n\t\t\t\tfileLog: args.log,\n\t\t\t\tsha: pick.item.sha,\n\t\t\t\tgoBackCommand: currentCommand\n\t\t\t};\n\n\t\t\treturn commands.executeCommand(Commands.ShowQuickCommitFileDetails, pick.item.toGitUri(), commandArgs);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickFileHistoryCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show file history');\n\t\t} finally {\n\t\t\tprogressCancellation && progressCancellation.cancel();\n\t\t}\n\t}\n}\n","'use strict';\nimport { TextEditor, Uri, window } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { Messages } from '../messages';\nimport { CommandQuickPickItem, RepoStatusQuickPick } from '../quickpicks';\nimport { ActiveEditorCachedCommand, command, Commands, getCommandUri, getRepoPathOrActiveOrPrompt } from './common';\n\nexport interface ShowQuickRepoStatusCommandArgs {\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickRepoStatusCommand extends ActiveEditorCachedCommand {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickRepoStatus);\n\t}\n\n\tasync execute(editor?: TextEditor, uri?: Uri, args?: ShowQuickRepoStatusCommandArgs) {\n\t\turi = getCommandUri(uri, editor);\n\n\t\ttry {\n\t\t\tconst repoPath = await getRepoPathOrActiveOrPrompt(\n\t\t\t\turi,\n\t\t\t\teditor,\n\t\t\t\t`Show status for which repository${GlyphChars.Ellipsis}`\n\t\t\t);\n\t\t\tif (!repoPath) return undefined;\n\n\t\t\tconst status = await Container.git.getStatusForRepo(repoPath);\n\t\t\tif (status === undefined) return window.showWarningMessage('Unable to show repository status');\n\n\t\t\tconst pick = await RepoStatusQuickPick.show(status, args && args.goBackCommand);\n\t\t\tif (pick === undefined) return undefined;\n\n\t\t\tif (pick instanceof CommandQuickPickItem) return pick.execute();\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'ShowQuickRepoStatusCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to show repository status');\n\t\t}\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Container } from '../container';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport { Command, command, Commands } from './common';\nimport { GitCommandsCommandArgs } from '../commands';\n\nexport interface ShowQuickStashListCommandArgs {\n\trepoPath?: string;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class ShowQuickStashListCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ShowQuickStashList);\n\t}\n\n\tasync execute(args?: ShowQuickStashListCommandArgs) {\n\t\targs = { ...args };\n\n\t\tlet repo;\n\t\tif (args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository(args.repoPath);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'stash',\n\t\t\tstate: {\n\t\t\t\tsubcommand: 'list',\n\t\t\t\trepo: repo\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { command, Command, CommandContext, Commands } from './common';\n\n@command()\nexport class ShowViewCommand extends Command {\n\tconstructor() {\n\t\tsuper([\n\t\t\tCommands.ShowCompareView,\n\t\t\tCommands.ShowFileHistoryView,\n\t\t\tCommands.ShowLineHistoryView,\n\t\t\tCommands.ShowRepositoriesView,\n\t\t\tCommands.ShowSearchView\n\t\t]);\n\t}\n\n\tprotected preExecute(context: CommandContext) {\n\t\treturn this.execute(context.command as Commands);\n\t}\n\n\texecute(command: Commands) {\n\t\tswitch (command) {\n\t\t\tcase Commands.ShowCompareView:\n\t\t\t\treturn Container.compareView.show();\n\t\t\tcase Commands.ShowFileHistoryView:\n\t\t\t\treturn Container.fileHistoryView.show();\n\t\t\tcase Commands.ShowLineHistoryView:\n\t\t\t\treturn Container.lineHistoryView.show();\n\t\t\tcase Commands.ShowRepositoriesView:\n\t\t\t\treturn Container.repositoriesView.show();\n\t\t\tcase Commands.ShowSearchView:\n\t\t\t\treturn Container.searchView.show();\n\t\t}\n\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Container } from '../container';\nimport { GitStashCommit } from '../git/gitService';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport {\n\tcommand,\n\tCommand,\n\tCommandContext,\n\tCommands,\n\tisCommandViewContextWithCommit,\n\tisCommandViewContextWithRepo\n} from './common';\nimport { GitCommandsCommandArgs } from '../commands';\n\nexport interface StashApplyCommandArgs {\n\tdeleteAfter?: boolean;\n\trepoPath?: string;\n\tstashItem?: { stashName: string; message: string; ref: string; repoPath: string };\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class StashApplyCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.StashApply);\n\t}\n\n\tprotected preExecute(context: CommandContext, args: StashApplyCommandArgs = { deleteAfter: false }) {\n\t\tif (isCommandViewContextWithCommit<GitStashCommit>(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.stashItem = context.node.commit;\n\t\t} else if (isCommandViewContextWithRepo(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.repo.path;\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args: StashApplyCommandArgs = { deleteAfter: false }) {\n\t\tlet repo;\n\t\tif (args.stashItem !== undefined || args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository((args.stashItem && args.stashItem.repoPath) || args.repoPath!);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'stash',\n\t\t\tstate: {\n\t\t\t\tsubcommand: args.deleteAfter ? 'pop' : 'apply',\n\t\t\t\trepo: repo,\n\t\t\t\tstash: args.stashItem\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { commands } from 'vscode';\nimport { Container } from '../container';\nimport { GitStashCommit } from '../git/gitService';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport { command, Command, CommandContext, Commands, isCommandViewContextWithCommit } from './common';\nimport { GitCommandsCommandArgs } from '../commands';\n\nexport interface StashDeleteCommandArgs {\n\trepoPath?: string;\n\tstashItem?: { stashName: string; message: string; ref: string; repoPath: string };\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class StashDeleteCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.StashDelete);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: StashDeleteCommandArgs) {\n\t\tif (isCommandViewContextWithCommit<GitStashCommit>(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.stashItem = context.node.commit;\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: StashDeleteCommandArgs) {\n\t\targs = { ...args };\n\n\t\tlet repo;\n\t\tif (args.stashItem !== undefined || args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository((args.stashItem && args.stashItem.repoPath) || args.repoPath!);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'stash',\n\t\t\tstate: {\n\t\t\t\tsubcommand: 'drop',\n\t\t\t\trepo: repo,\n\t\t\t\tstash: args.stashItem\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { commands, Uri } from 'vscode';\nimport { Container } from '../container';\nimport { GitUri } from '../git/gitUri';\nimport { CommandQuickPickItem } from '../quickpicks';\nimport {\n\tcommand,\n\tCommand,\n\tCommandContext,\n\tCommands,\n\tisCommandViewContextWithFile,\n\tisCommandViewContextWithRepo,\n\tisCommandViewContextWithRepoPath\n} from './common';\nimport { GitCommandsCommandArgs } from '../commands';\n\nconst enum ResourceGroupType {\n\tMerge,\n\tIndex,\n\tWorkingTree\n}\n\nexport interface StashSaveCommandArgs {\n\tmessage?: string;\n\trepoPath?: string;\n\turis?: Uri[];\n\tkeepStaged?: boolean;\n\n\tgoBackCommand?: CommandQuickPickItem;\n}\n\n@command()\nexport class StashSaveCommand extends Command {\n\tconstructor() {\n\t\tsuper([Commands.StashSave, Commands.StashSaveFiles]);\n\t}\n\n\tprotected preExecute(context: CommandContext, args?: StashSaveCommandArgs) {\n\t\tif (isCommandViewContextWithFile(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.file.repoPath || context.node.repoPath;\n\t\t\targs.uris = [GitUri.fromFile(context.node.file, args.repoPath)];\n\t\t} else if (isCommandViewContextWithRepo(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.repo.path;\n\t\t} else if (isCommandViewContextWithRepoPath(context)) {\n\t\t\targs = { ...args };\n\t\t\targs.repoPath = context.node.repoPath;\n\t\t} else if (context.type === 'scm-states') {\n\t\t\targs = { ...args };\n\n\t\t\tif (!context.scmResourceStates.some(s => (s as any).resourceGroupType === ResourceGroupType.Index)) {\n\t\t\t\targs.keepStaged = true;\n\t\t\t}\n\n\t\t\targs.uris = context.scmResourceStates.map(s => s.resourceUri);\n\t\t} else if (context.type === 'scm-groups') {\n\t\t\targs = { ...args };\n\n\t\t\tif (!context.scmResourceGroups.some(g => g.id === 'index')) {\n\t\t\t\targs.keepStaged = true;\n\t\t\t}\n\n\t\t\targs.uris = context.scmResourceGroups.reduce<Uri[]>(\n\t\t\t\t(a, b) => a.concat(b.resourceStates.map(s => s.resourceUri)),\n\t\t\t\t[]\n\t\t\t);\n\t\t}\n\n\t\treturn this.execute(args);\n\t}\n\n\tasync execute(args?: StashSaveCommandArgs) {\n\t\targs = { ...args };\n\n\t\tlet repo;\n\t\tif (args.uris !== undefined || args.repoPath !== undefined) {\n\t\t\trepo = await Container.git.getRepository((args.uris && args.uris[0]) || args.repoPath!);\n\t\t}\n\n\t\tconst gitCommandArgs: GitCommandsCommandArgs = {\n\t\t\tcommand: 'stash',\n\t\t\tstate: {\n\t\t\t\tsubcommand: 'push',\n\t\t\t\trepo: repo,\n\t\t\t\tmessage: args.message,\n\t\t\t\turis: args.uris,\n\t\t\t\tflags: args.keepStaged ? ['--keep-index'] : undefined\n\t\t\t}\n\t\t};\n\t\treturn commands.executeCommand(Commands.GitCommands, gitCommandArgs);\n\t}\n}\n","'use strict';\nimport { Messages } from '../messages';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class SupportGitLensCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.SupportGitLens);\n\t}\n\n\texecute() {\n\t\treturn Messages.showSupportGitLensMessage();\n\t}\n}\n","'use strict';\nimport { ConfigurationTarget } from 'vscode';\nimport { configuration } from '../configuration';\nimport { Container } from '../container';\nimport { ModesQuickPick } from '../quickpicks';\nimport { command, Command, Commands } from './common';\nimport { log } from '../system/decorators/log';\nimport { Logger } from '../logger';\n\n@command()\nexport class SwitchModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.SwitchMode);\n\t}\n\n\t@log({ args: false, correlate: true, singleLine: true, timed: false })\n\tasync execute() {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst pick = await ModesQuickPick.show();\n\t\tif (pick === undefined) return;\n\n\t\tif (cc) {\n\t\t\tcc.exitDetails = ` \\u2014 mode=${pick.key || ''}`;\n\t\t}\n\n\t\tconst active = Container.config.mode.active;\n\t\tif (active === pick.key) return;\n\n\t\t// Check if we have applied any annotations and clear them if we won't be applying them again\n\t\tif (active != null && active.length !== 0) {\n\t\t\tconst activeAnnotations = Container.config.modes[active].annotations;\n\t\t\tif (activeAnnotations != null) {\n\t\t\t\tconst newAnnotations = pick.key != null ? Container.config.modes[pick.key].annotations : undefined;\n\t\t\t\tif (activeAnnotations !== newAnnotations) {\n\t\t\t\t\tawait Container.fileAnnotations.clearAll();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tawait configuration.update('mode', 'active', pick.key, ConfigurationTarget.Global);\n\t}\n}\n\n@command()\nexport class ToggleReviewModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleReviewMode);\n\t}\n\n\t@log({ args: false, singleLine: true, timed: false })\n\tasync execute() {\n\t\tif (!Object.keys(Container.config.modes).includes('review')) return;\n\n\t\tconst mode = Container.config.mode.active === 'review' ? undefined : 'review';\n\t\tawait configuration.update('mode', 'active', mode, ConfigurationTarget.Global);\n\t}\n}\n\n@command()\nexport class ToggleZenModeCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleZenMode);\n\t}\n\n\t@log({ args: false, singleLine: true, timed: false })\n\tasync execute() {\n\t\tif (!Object.keys(Container.config.modes).includes('zen')) return;\n\n\t\tconst mode = Container.config.mode.active === 'zen' ? undefined : 'zen';\n\t\tawait configuration.update('mode', 'active', mode, ConfigurationTarget.Global);\n\t}\n}\n","'use strict';\nimport { Container } from '../container';\nimport { command, Command, Commands } from './common';\n\n@command()\nexport class ToggleCodeLensCommand extends Command {\n\tconstructor() {\n\t\tsuper(Commands.ToggleCodeLens);\n\t}\n\n\texecute() {\n\t\treturn Container.codeLens.toggleCodeLens();\n\t}\n}\n","'use strict';\n\nexport * from './commands/annotations';\nexport * from './commands/closeUnchangedFiles';\nexport * from './commands/common';\nexport * from './commands/copyMessageToClipboard';\nexport * from './commands/copyRemoteFileUrlToClipboard';\nexport * from './commands/copyShaToClipboard';\nexport * from './commands/diffBranchWith';\nexport * from './commands/diffDirectory';\nexport * from './commands/diffLineWithPrevious';\nexport * from './commands/diffLineWithWorking';\nexport * from './commands/diffWith';\nexport * from './commands/diffWithNext';\nexport * from './commands/diffWithPrevious';\nexport * from './commands/diffWithRef';\nexport * from './commands/diffWithRevision';\nexport * from './commands/diffWithWorking';\nexport * from './commands/exploreRepoAtRevision';\nexport * from './commands/externalDiff';\nexport * from './commands/inviteToLiveShare';\nexport * from './commands/openBranchesInRemote';\nexport * from './commands/openBranchInRemote';\nexport * from './commands/openChangedFiles';\nexport * from './commands/openCommitInRemote';\nexport * from './commands/openFileInRemote';\nexport * from './commands/openFileRevision';\nexport * from './commands/openFileRevisionFrom';\nexport * from './commands/openInRemote';\nexport * from './commands/openRepoInRemote';\nexport * from './commands/openRevisionFile';\nexport * from './commands/openWorkingFile';\nexport * from './commands/gitCommands';\nexport * from './commands/repositories';\nexport * from './commands/resetSuppressedWarnings';\nexport * from './commands/searchCommits';\nexport * from './commands/showCommitsInView';\nexport * from './commands/showLastQuickPick';\nexport * from './commands/showQuickBranchHistory';\nexport * from './commands/showQuickCommitDetails';\nexport * from './commands/showQuickCommitFileDetails';\nexport * from './commands/showQuickCurrentBranchHistory';\nexport * from './commands/showQuickFileHistory';\nexport * from './commands/showQuickRepoStatus';\nexport * from './commands/showQuickStashList';\nexport * from './commands/showView';\nexport * from './commands/stashApply';\nexport * from './commands/stashDelete';\nexport * from './commands/stashSave';\nexport * from './commands/supportGitLens';\nexport * from './commands/switchMode';\nexport * from './commands/toggleCodeLens';\n","'use strict';\nimport { ConfigurationTarget, env, MessageItem, Uri, window } from 'vscode';\nimport { configuration } from './configuration';\nimport { CommandContext, setCommandContext } from './constants';\nimport { GitCommit } from './git/gitService';\nimport { Logger } from './logger';\n\nexport enum SuppressedMessages {\n\tCommitHasNoPreviousCommitWarning = 'suppressCommitHasNoPreviousCommitWarning',\n\tCommitNotFoundWarning = 'suppressCommitNotFoundWarning',\n\tFileNotUnderSourceControlWarning = 'suppressFileNotUnderSourceControlWarning',\n\tGitDisabledWarning = 'suppressGitDisabledWarning',\n\tGitVersionWarning = 'suppressGitVersionWarning',\n\tLineUncommittedWarning = 'suppressLineUncommittedWarning',\n\tNoRepositoryWarning = 'suppressNoRepositoryWarning',\n\tSupportGitLensNotification = 'suppressSupportGitLensNotification'\n}\n\nexport class Messages {\n\tstatic showCommitHasNoPreviousCommitWarningMessage(commit?: GitCommit): Promise<MessageItem | undefined> {\n\t\tif (commit === undefined) {\n\t\t\treturn Messages.showMessage(\n\t\t\t\t'info',\n\t\t\t\t'There is no previous commit.',\n\t\t\t\tSuppressedMessages.CommitHasNoPreviousCommitWarning\n\t\t\t);\n\t\t}\n\t\treturn Messages.showMessage(\n\t\t\t'info',\n\t\t\t`Commit ${commit.shortSha} (${commit.author}, ${commit.formattedDate}) has no previous commit.`,\n\t\t\tSuppressedMessages.CommitHasNoPreviousCommitWarning\n\t\t);\n\t}\n\n\tstatic showCommitNotFoundWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The commit could not be found.`,\n\t\t\tSuppressedMessages.CommitNotFoundWarning\n\t\t);\n\t}\n\n\tstatic async showGenericErrorMessage(message: string): Promise<MessageItem | undefined> {\n\t\tconst actions: MessageItem[] = [{ title: 'Open Output Channel' }];\n\t\tconst result = await Messages.showMessage(\n\t\t\t'error',\n\t\t\t`${message}. See output channel for more details`,\n\t\t\tundefined,\n\t\t\tnull,\n\t\t\t...actions\n\t\t);\n\n\t\tif (result !== undefined) {\n\t\t\tLogger.showOutputChannel();\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic showFileNotUnderSourceControlWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The file is probably not under source control.`,\n\t\t\tSuppressedMessages.FileNotUnderSourceControlWarning\n\t\t);\n\t}\n\n\tstatic showGitDisabledErrorMessage() {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t'GitLens requires Git to be enabled. Please re-enable Git \\u2014 set `git.enabled` to true and reload',\n\t\t\tSuppressedMessages.GitDisabledWarning\n\t\t);\n\t}\n\n\tstatic showGitVersionUnsupportedErrorMessage(version: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'error',\n\t\t\t`GitLens requires a newer version of Git (>= 2.2.0) than is currently installed (${version}). Please install a more recent version of Git.`,\n\t\t\tSuppressedMessages.GitVersionWarning\n\t\t);\n\t}\n\n\tstatic showLineUncommittedWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. The line has uncommitted changes.`,\n\t\t\tSuppressedMessages.LineUncommittedWarning\n\t\t);\n\t}\n\n\tstatic showNoRepositoryWarningMessage(message: string): Promise<MessageItem | undefined> {\n\t\treturn Messages.showMessage(\n\t\t\t'warn',\n\t\t\t`${message}. No repository could be found.`,\n\t\t\tSuppressedMessages.NoRepositoryWarning\n\t\t);\n\t}\n\n\tstatic async showSupportGitLensMessage() {\n\t\tconst actions: MessageItem[] = [\n\t\t\t{ title: 'Become a Sponsor' },\n\t\t\t{ title: 'Donate via PayPal' },\n\t\t\t{ title: 'Donate via Cash App' }\n\t\t];\n\n\t\tconst result = await Messages.showMessage(\n\t\t\t'info',\n\t\t\t'While GitLens is offered to everyone for free, if you find it useful, please consider [supporting](https://gitlens.amod.io/#support-gitlens) it. Thank you! ',\n\t\t\tundefined,\n\t\t\tnull,\n\t\t\t...actions\n\t\t);\n\n\t\tif (result != null) {\n\t\t\tlet uri;\n\t\t\tif (result === actions[0]) {\n\t\t\t\turi = Uri.parse('https://www.patreon.com/eamodio');\n\t\t\t} else if (result === actions[1]) {\n\t\t\t\turi = Uri.parse('https://www.paypal.me/eamodio');\n\t\t\t} else if (result === actions[2]) {\n\t\t\t\turi = Uri.parse('https://cash.me/$eamodio');\n\t\t\t}\n\n\t\t\tif (uri !== undefined) {\n\t\t\t\tawait setCommandContext(CommandContext.ViewsHideSupportGitLens, true);\n\t\t\t\tawait this.suppressedMessage(SuppressedMessages.SupportGitLensNotification);\n\t\t\t\tawait env.openExternal(uri);\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic async showWhatsNewMessage(version: string) {\n\t\tconst actions: MessageItem[] = [{ title: \"What's New\" }, { title: 'Release Notes' }, { title: '' }];\n\n\t\tconst result = await Messages.showMessage(\n\t\t\t'info',\n\t\t\t`GitLens has been updated to v${version}  check out what's new!`,\n\t\t\tundefined,\n\t\t\tnull,\n\t\t\t...actions\n\t\t);\n\n\t\tif (result != null) {\n\t\t\tif (result === actions[0]) {\n\t\t\t\tawait env.openExternal(Uri.parse('https://gitlens.amod.io/#whats-new'));\n\t\t\t} else if (result === actions[1]) {\n\t\t\t\tawait env.openExternal(Uri.parse('https://github.com/eamodio/vscode-gitlens/blob/master/CHANGELOG.md'));\n\t\t\t} else if (result === actions[2]) {\n\t\t\t\tawait env.openExternal(Uri.parse('https://gitlens.amod.io/#support-gitlens'));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static async showMessage(\n\t\ttype: 'info' | 'warn' | 'error',\n\t\tmessage: string,\n\t\tsuppressionKey?: SuppressedMessages,\n\t\tdontShowAgain: MessageItem | null = { title: \"Don't Show Again\" },\n\t\t...actions: MessageItem[]\n\t): Promise<MessageItem | undefined> {\n\t\tLogger.log(`ShowMessage(${type}, '${message}', ${suppressionKey}, ${dontShowAgain})`);\n\n\t\tif (suppressionKey !== undefined && configuration.get('advanced', 'messages', suppressionKey)) {\n\t\t\tLogger.log(`ShowMessage(${type}, '${message}', ${suppressionKey}, ${dontShowAgain}) skipped`);\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (suppressionKey !== undefined && dontShowAgain !== null) {\n\t\t\tactions.push(dontShowAgain);\n\t\t}\n\n\t\tlet result: MessageItem | undefined = undefined;\n\t\tswitch (type) {\n\t\t\tcase 'info':\n\t\t\t\tresult = await window.showInformationMessage(message, ...actions);\n\t\t\t\tbreak;\n\n\t\t\tcase 'warn':\n\t\t\t\tresult = await window.showWarningMessage(message, ...actions);\n\t\t\t\tbreak;\n\n\t\t\tcase 'error':\n\t\t\t\tresult = await window.showErrorMessage(message, ...actions);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ((suppressionKey !== undefined && dontShowAgain === null) || result === dontShowAgain) {\n\t\t\tLogger.log(\n\t\t\t\t`ShowMessage(${type}, '${message}', ${suppressionKey}, ${dontShowAgain}) don't show again requested`\n\t\t\t);\n\t\t\tawait this.suppressedMessage(suppressionKey!);\n\n\t\t\tif (result === dontShowAgain) return undefined;\n\t\t}\n\n\t\tLogger.log(\n\t\t\t`ShowMessage(${type}, '${message}', ${suppressionKey}, ${dontShowAgain}) returned ${\n\t\t\t\tresult ? result.title : result\n\t\t\t}`\n\t\t);\n\t\treturn result;\n\t}\n\n\tprivate static suppressedMessage(suppressionKey: SuppressedMessages) {\n\t\tconst messages: { [key: string]: boolean | undefined } = configuration.get('advanced', 'messages');\n\n\t\tmessages[suppressionKey] = true;\n\n\t\tfor (const [key, value] of Object.entries(messages)) {\n\t\t\tif (value !== true) {\n\t\t\t\tmessages[key] = undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn configuration.update('advanced', 'messages', messages as any, ConfigurationTarget.Global);\n\t}\n}\n","'use strict';\n/* eslint-disable constructor-super */\nimport * as paths from 'path';\nimport { Uri } from 'vscode';\nimport { UriComparer } from '../comparers';\nimport { DocumentSchemes, GlyphChars } from '../constants';\nimport { Container } from '../container';\nimport { GitCommit, GitFile, GitService } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { debug, memoize, Strings } from '../system';\n\nconst emptyStr = '';\nconst slash = '/';\n\nexport interface GitCommitish {\n\tfileName?: string;\n\trepoPath: string;\n\tsha?: string;\n\tversionedPath?: string;\n}\n\n// Taken from https://github.com/Microsoft/vscode/blob/master/src/vs/base/common/uri.ts#L331-L337\ninterface UriComponents {\n\tscheme: string;\n\tauthority: string;\n\tpath: string;\n\tquery: string;\n\tfragment: string;\n}\n\ninterface UriEx {\n\tnew (): Uri;\n\tnew (scheme: string, authority: string, path: string, query: string, fragment: string): Uri;\n\t// Use this ctor, because vscode doesn't validate it\n\tnew (components: UriComponents): Uri;\n}\n\nexport class GitUri extends ((Uri as any) as UriEx) {\n\tstatic is(uri: any): uri is GitUri {\n\t\treturn uri instanceof GitUri;\n\t}\n\n\treadonly repoPath?: string;\n\treadonly sha?: string;\n\treadonly versionedPath?: string;\n\n\tconstructor(uri?: Uri);\n\tconstructor(uri: Uri, commit: GitCommitish);\n\tconstructor(uri: Uri, repoPath: string | undefined);\n\tconstructor(uri?: Uri, commitOrRepoPath?: GitCommitish | string) {\n\t\tif (uri == null) {\n\t\t\tsuper('unknown', emptyStr, emptyStr, emptyStr, emptyStr);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens) {\n\t\t\tconst data = JSON.parse(uri.query) as UriRevisionData;\n\n\t\t\t// When Uri's come from the FileSystemProvider, the uri.query only contains the root repo info (not the actual file path), so fix that here\n\t\t\tconst index = uri.path.indexOf(data.path);\n\t\t\tif (index + data.path.length < uri.path.length) {\n\t\t\t\tdata.path = index === 0 ? uri.path : uri.path.substr(index);\n\t\t\t}\n\n\t\t\tsuper({\n\t\t\t\tscheme: uri.scheme,\n\t\t\t\tauthority: uri.authority,\n\t\t\t\tpath: uri.path,\n\t\t\t\tquery: JSON.stringify(data),\n\t\t\t\tfragment: uri.fragment\n\t\t\t});\n\n\t\t\tthis.repoPath = data.repoPath;\n\t\t\tif (GitService.isUncommittedStaged(data.ref) || !GitService.isUncommitted(data.ref)) {\n\t\t\t\tthis.sha = data.ref;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (commitOrRepoPath === undefined) {\n\t\t\tsuper(uri);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof commitOrRepoPath === 'string') {\n\t\t\tsuper(uri);\n\n\t\t\tthis.repoPath = commitOrRepoPath;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst [authority, fsPath] = GitUri.ensureValidUNCPath(\n\t\t\turi.authority,\n\t\t\tGitUri.resolve(commitOrRepoPath.fileName || uri.fsPath, commitOrRepoPath.repoPath)\n\t\t);\n\n\t\tlet path;\n\t\tswitch (uri.scheme) {\n\t\t\tcase 'https':\n\t\t\tcase 'http':\n\t\t\tcase 'file':\n\t\t\t\tif (!fsPath) {\n\t\t\t\t\tpath = slash;\n\t\t\t\t} else if (!fsPath.startsWith(slash)) {\n\t\t\t\t\tpath = `/${fsPath}`;\n\t\t\t\t} else {\n\t\t\t\t\tpath = fsPath;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tpath = fsPath;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tsuper({\n\t\t\tscheme: uri.scheme,\n\t\t\tauthority: authority,\n\t\t\tpath: path,\n\t\t\tquery: uri.query,\n\t\t\tfragment: uri.fragment\n\t\t});\n\t\tthis.repoPath = commitOrRepoPath.repoPath;\n\t\tthis.versionedPath = commitOrRepoPath.versionedPath;\n\t\tif (GitService.isUncommittedStaged(commitOrRepoPath.sha) || !GitService.isUncommitted(commitOrRepoPath.sha)) {\n\t\t\tthis.sha = commitOrRepoPath.sha;\n\t\t}\n\t}\n\n\t@memoize()\n\tget directory(): string {\n\t\treturn GitUri.getDirectory(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget fileName(): string {\n\t\treturn paths.basename(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget isUncommitted() {\n\t\treturn GitService.isUncommitted(this.sha);\n\t}\n\n\t@memoize()\n\tget isUncommittedStaged() {\n\t\treturn GitService.isUncommittedStaged(this.sha);\n\t}\n\n\t@memoize()\n\tprivate get relativeFsPath() {\n\t\treturn this.repoPath == null || this.repoPath.length === 0\n\t\t\t? this.fsPath\n\t\t\t: paths.relative(this.repoPath, this.fsPath);\n\t}\n\n\t@memoize()\n\tget relativePath() {\n\t\treturn Strings.normalizePath(this.relativeFsPath);\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn GitService.shortenSha(this.sha);\n\t}\n\n\t@memoize<GitUri['documentUri']>(options => `${options!.useVersionedPath ? 'versioned' : ''}`)\n\tdocumentUri({ useVersionedPath }: { useVersionedPath?: boolean } = {}) {\n\t\tif (useVersionedPath && this.versionedPath !== undefined) return GitUri.file(this.versionedPath);\n\t\tif (this.scheme !== 'file') return this;\n\n\t\treturn GitUri.file(this.fsPath);\n\t}\n\n\tequals(uri: Uri | undefined) {\n\t\tif (!UriComparer.equals(this, uri)) return false;\n\n\t\treturn this.sha === (GitUri.is(uri) ? uri.sha : undefined);\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; separator?: string; suffix?: string } = {}): string {\n\t\tconst {\n\t\t\trelativeTo = this.repoPath,\n\t\t\tseparator = Strings.pad(GlyphChars.Dot, 2, 2),\n\t\t\tsuffix = emptyStr\n\t\t} = options;\n\n\t\tconst directory = GitUri.getDirectory(this.fsPath, relativeTo);\n\t\treturn `${paths.basename(this.fsPath)}${suffix}${directory ? `${separator}${directory}` : emptyStr}`;\n\t}\n\n\t@memoize()\n\ttoFileUri() {\n\t\treturn GitUri.file(this.fsPath);\n\t}\n\n\tprivate static ensureValidUNCPath(authority: string, fsPath: string): [string, string] {\n\t\t// Taken from https://github.com/Microsoft/vscode/blob/e444eaa768a1e8bd8315f2cee265d725e96a8162/src/vs/base/common/uri.ts#L300-L325\n\t\t// check for authority as used in UNC shares or use the path as given\n\t\tif (fsPath.startsWith(slash) && fsPath[1] === slash) {\n\t\t\tconst index = fsPath.indexOf(slash, 2);\n\t\t\tif (index === -1) {\n\t\t\t\tauthority = fsPath.substring(2);\n\t\t\t\tfsPath = slash;\n\t\t\t} else {\n\t\t\t\tauthority = fsPath.substring(2, index);\n\t\t\t\tfsPath = fsPath.substring(index) || slash;\n\t\t\t}\n\t\t}\n\n\t\treturn [authority, fsPath];\n\t}\n\n\tstatic file(path: string, useVslsScheme?: boolean) {\n\t\tconst uri = Uri.file(path);\n\t\tif (Container.vsls.isMaybeGuest && useVslsScheme !== false) {\n\t\t\treturn uri.with({ scheme: DocumentSchemes.Vsls });\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tstatic fromCommit(commit: GitCommit, previous: boolean = false) {\n\t\tif (!previous) return new GitUri(commit.uri, commit);\n\n\t\treturn new GitUri(commit.previousUri, {\n\t\t\trepoPath: commit.repoPath,\n\t\t\tsha: commit.previousSha\n\t\t});\n\t}\n\n\tstatic fromFile(fileName: string, repoPath: string, ref?: string): GitUri;\n\tstatic fromFile(file: GitFile, repoPath: string, ref?: string, original?: boolean): GitUri;\n\tstatic fromFile(fileOrName: GitFile | string, repoPath: string, ref?: string, original: boolean = false): GitUri {\n\t\tconst uri = GitUri.resolveToUri(\n\t\t\ttypeof fileOrName === 'string'\n\t\t\t\t? fileOrName\n\t\t\t\t: (original && fileOrName.originalFileName) || fileOrName.fileName,\n\t\t\trepoPath\n\t\t);\n\t\treturn ref == null || ref.length === 0\n\t\t\t? new GitUri(uri, repoPath)\n\t\t\t: new GitUri(uri, { repoPath: repoPath, sha: ref });\n\t}\n\n\tstatic fromRepoPath(repoPath: string, ref?: string) {\n\t\treturn ref == null || ref.length === 0\n\t\t\t? new GitUri(GitUri.file(repoPath), repoPath)\n\t\t\t: new GitUri(GitUri.file(repoPath), { repoPath: repoPath, sha: ref });\n\t}\n\n\tstatic fromRevisionUri(uri: Uri): GitUri {\n\t\treturn new GitUri(uri);\n\t}\n\n\t@debug({\n\t\texit: uri => `returned ${Logger.toLoggable(uri)}`\n\t})\n\tstatic async fromUri(uri: Uri) {\n\t\tif (GitUri.is(uri)) return uri;\n\n\t\tif (!Container.git.isTrackable(uri)) return new GitUri(uri);\n\n\t\tif (uri.scheme === DocumentSchemes.GitLens) return new GitUri(uri);\n\n\t\t// If this is a git uri, find its repoPath\n\t\tif (uri.scheme === DocumentSchemes.Git) {\n\t\t\tconst data: { path: string; ref: string } = JSON.parse(uri.query);\n\n\t\t\tconst repoPath = await Container.git.getRepoPath(data.path);\n\n\t\t\tlet ref;\n\t\t\tswitch (data.ref) {\n\t\t\t\tcase emptyStr:\n\t\t\t\tcase '~':\n\t\t\t\t\tref = GitService.uncommittedStagedSha;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase null:\n\t\t\t\t\tref = undefined;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tref = data.ref;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst commitish: GitCommitish = {\n\t\t\t\tfileName: data.path,\n\t\t\t\trepoPath: repoPath!,\n\t\t\t\tsha: ref\n\t\t\t};\n\t\t\treturn new GitUri(uri, commitish);\n\t\t}\n\n\t\treturn new GitUri(uri, await Container.git.getRepoPath(uri));\n\t}\n\n\tstatic getDirectory(fileName: string, relativeTo?: string): string {\n\t\tlet directory: string | undefined = paths.dirname(fileName);\n\t\tif (relativeTo !== undefined) {\n\t\t\tdirectory = paths.relative(relativeTo, directory);\n\t\t}\n\t\tdirectory = Strings.normalizePath(directory);\n\t\treturn directory == null || directory.length === 0 || directory === '.' ? emptyStr : directory;\n\t}\n\n\tstatic getFormattedPath(\n\t\tfileNameOrUri: string | Uri,\n\t\toptions: { relativeTo?: string; separator?: string; suffix?: string } = {}\n\t): string {\n\t\tconst { relativeTo, separator = Strings.pad(GlyphChars.Dot, 2, 2), suffix = emptyStr } = options;\n\n\t\tlet fileName: string;\n\t\tif (fileNameOrUri instanceof Uri) {\n\t\t\tif (GitUri.is(fileNameOrUri)) return fileNameOrUri.getFormattedPath(options);\n\n\t\t\tfileName = fileNameOrUri.fsPath;\n\t\t} else {\n\t\t\tfileName = fileNameOrUri;\n\t\t}\n\n\t\tconst directory = GitUri.getDirectory(fileName, relativeTo);\n\t\treturn !directory\n\t\t\t? `${paths.basename(fileName)}${suffix}`\n\t\t\t: `${paths.basename(fileName)}${suffix}${separator}${directory}`;\n\t}\n\n\tstatic relativeTo(fileNameOrUri: string | Uri, relativeTo: string | undefined): string {\n\t\tconst fileName = fileNameOrUri instanceof Uri ? fileNameOrUri.fsPath : fileNameOrUri;\n\t\tconst relativePath =\n\t\t\trelativeTo == null || relativeTo.length === 0 || !paths.isAbsolute(fileName)\n\t\t\t\t? fileName\n\t\t\t\t: paths.relative(relativeTo, fileName);\n\t\treturn Strings.normalizePath(relativePath);\n\t}\n\n\tstatic git(fileName: string, repoPath?: string) {\n\t\tconst path = GitUri.resolve(fileName, repoPath);\n\t\treturn Uri.parse(\n\t\t\t// Change encoded / back to / otherwise uri parsing won't work properly\n\t\t\t`${DocumentSchemes.Git}:${encodeURIComponent(path).replace(/%2F/g, slash)}?${encodeURIComponent(\n\t\t\t\tJSON.stringify({\n\t\t\t\t\t// Ensure we use the fsPath here, otherwise the url won't open properly\n\t\t\t\t\tpath: Uri.file(path).fsPath,\n\t\t\t\t\tref: '~'\n\t\t\t\t})\n\t\t\t)}`\n\t\t);\n\t}\n\n\tstatic resolve(fileName: string, repoPath?: string) {\n\t\tconst normalizedFileName = Strings.normalizePath(fileName);\n\t\tif (repoPath === undefined) return normalizedFileName;\n\n\t\tconst normalizedRepoPath = Strings.normalizePath(repoPath);\n\t\tif (normalizedFileName == null || normalizedFileName.length === 0) return normalizedRepoPath;\n\n\t\tif (normalizedFileName.startsWith(normalizedRepoPath)) return normalizedFileName;\n\n\t\treturn Strings.normalizePath(paths.join(normalizedRepoPath, normalizedFileName));\n\t}\n\n\tstatic resolveToUri(fileName: string, repoPath?: string) {\n\t\treturn GitUri.file(this.resolve(fileName, repoPath));\n\t}\n\n\tstatic toKey(fileName: string): string;\n\tstatic toKey(uri: Uri): string;\n\tstatic toKey(fileNameOrUri: string | Uri): string;\n\tstatic toKey(fileNameOrUri: string | Uri): string {\n\t\treturn Strings.normalizePath(typeof fileNameOrUri === 'string' ? fileNameOrUri : fileNameOrUri.fsPath);\n\n\t\t// return typeof fileNameOrUri === 'string'\n\t\t//     ? GitUri.file(fileNameOrUri).toString(true)\n\t\t//     : fileNameOrUri.toString(true);\n\t}\n\n\tstatic toRevisionUri(uri: GitUri): Uri;\n\tstatic toRevisionUri(ref: string, fileName: string, repoPath: string): Uri;\n\tstatic toRevisionUri(ref: string, file: GitFile, repoPath: string): Uri;\n\tstatic toRevisionUri(uriOrRef: string | GitUri, fileNameOrFile?: string | GitFile, repoPath?: string): Uri {\n\t\tlet fileName: string;\n\t\tlet ref: string | undefined;\n\t\tlet shortSha: string | undefined;\n\n\t\tif (typeof uriOrRef === 'string') {\n\t\t\tif (typeof fileNameOrFile === 'string') {\n\t\t\t\tfileName = fileNameOrFile;\n\t\t\t} else {\n\t\t\t\tfileName = GitUri.resolve(fileNameOrFile!.fileName, repoPath);\n\t\t\t}\n\n\t\t\tref = uriOrRef;\n\t\t\tshortSha = GitService.shortenSha(ref);\n\t\t} else {\n\t\t\tfileName = uriOrRef.fsPath;\n\n\t\t\tref = uriOrRef.sha;\n\t\t\tshortSha = uriOrRef.shortSha;\n\t\t\trepoPath = uriOrRef.repoPath!;\n\t\t}\n\n\t\tif (ref == null || ref.length === 0) {\n\t\t\treturn Uri.file(fileName);\n\t\t}\n\n\t\tif (GitService.isUncommitted(ref)) {\n\t\t\treturn GitService.isUncommittedStaged(ref) ? GitUri.git(fileName, repoPath) : Uri.file(fileName);\n\t\t}\n\n\t\tconst filePath = Strings.normalizePath(fileName, { addLeadingSlash: true });\n\t\tconst data: UriRevisionData = {\n\t\t\tpath: filePath,\n\t\t\tref: ref,\n\t\t\trepoPath: Strings.normalizePath(repoPath!)\n\t\t};\n\n\t\tconst uri = Uri.parse(\n\t\t\t// Replace / in the authority with a similar unicode characters otherwise parsing will be wrong\n\t\t\t`${DocumentSchemes.GitLens}://${encodeURIComponent(shortSha.replace(/\\//g, '\\u200A\\u2215\\u200A'))}${\n\t\t\t\t// Change encoded / back to / otherwise uri parsing won't work properly\n\t\t\t\tfilePath === slash ? emptyStr : encodeURIComponent(filePath).replace(/%2F/g, slash)\n\t\t\t}?${encodeURIComponent(JSON.stringify(data))}`\n\t\t);\n\t\treturn uri;\n\t}\n}\n\ninterface UriRevisionData {\n\tpath: string;\n\tref?: string;\n\trepoPath: string;\n}\n","module.exports = require(\"path\");","'use strict';\nimport { QuickPickItem } from 'vscode';\nimport { GlyphChars } from '../constants';\nimport { Dates, Strings } from '../system';\nimport {\n\tGitBranch,\n\tGitLogCommit,\n\tGitReference,\n\tGitRemoteType,\n\tGitService,\n\tGitStashCommit,\n\tGitTag,\n\tRepository\n} from '../git/gitService';\nimport { emojify } from '../emojis';\n\nexport interface QuickPickItemOfT<T = any> extends QuickPickItem {\n\treadonly item: T;\n}\n\nexport interface FlagsQuickPickItem<T> extends QuickPickItemOfT<T[]> {}\nexport namespace FlagsQuickPickItem {\n\texport function create<T>(flags: T[], item: T[], options: QuickPickItem) {\n\t\treturn { ...options, item: item, picked: hasFlags(flags, item) };\n\t}\n}\n\nfunction hasFlags<T>(flags: T[], has?: T | T[]): boolean {\n\tif (has === undefined) return flags.length === 0;\n\tif (!Array.isArray(has)) return flags.includes(has);\n\n\treturn has.length === 0 ? flags.length === 0 : has.every(f => flags.includes(f));\n}\n\nexport enum Directive {\n\tBack = 'Back',\n\tCancel = 'Cancel'\n}\n\nexport interface DirectiveQuickPickItem extends QuickPickItem {\n\tdirective: Directive;\n}\n\nexport namespace DirectiveQuickPickItem {\n\texport function create(\n\t\tdirective: Directive,\n\t\tpicked?: boolean,\n\t\toptions: { label?: string; description?: string; detail?: string } = {}\n\t) {\n\t\tconst item: DirectiveQuickPickItem = {\n\t\t\tlabel: options.label || directive,\n\t\t\tdescription: options.description || '',\n\t\t\tdetail: options.detail,\n\t\t\tpicked: picked,\n\t\t\tdirective: directive\n\t\t};\n\n\t\treturn item;\n\t}\n\n\texport function is(item: QuickPickItem): item is DirectiveQuickPickItem {\n\t\treturn item != null && 'directive' in item;\n\t}\n}\n\nexport interface BranchQuickPickItem extends QuickPickItemOfT<GitBranch> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace BranchQuickPickItem {\n\texport async function create(\n\t\tbranch: GitBranch,\n\t\tpicked?: boolean,\n\t\toptions: {\n\t\t\tcurrent?: boolean | 'checkmark';\n\t\t\tchecked?: boolean;\n\t\t\tref?: boolean;\n\t\t\tstatus?: boolean;\n\t\t\ttype?: boolean | 'remote';\n\t\t} = {}\n\t) {\n\t\tlet description = '';\n\t\tif (options.type === true) {\n\t\t\tif (options.current === true && branch.current) {\n\t\t\t\tdescription = 'current branch';\n\t\t\t} else {\n\t\t\t\tdescription = 'branch';\n\t\t\t}\n\t\t} else if (options.type === 'remote') {\n\t\t\tif (branch.remote) {\n\t\t\t\tdescription = 'remote branch';\n\t\t\t}\n\t\t} else if (options.current === true && branch.current) {\n\t\t\tdescription = 'current branch';\n\t\t}\n\n\t\tif (options.status && !branch.remote && branch.tracking !== undefined) {\n\t\t\tlet arrows = GlyphChars.Dash;\n\n\t\t\tconst remote = await branch.getRemote();\n\t\t\tif (remote !== undefined) {\n\t\t\t\tlet left;\n\t\t\t\tlet right;\n\t\t\t\tfor (const { type } of remote.types) {\n\t\t\t\t\tif (type === GitRemoteType.Fetch) {\n\t\t\t\t\t\tleft = true;\n\n\t\t\t\t\t\tif (right) break;\n\t\t\t\t\t} else if (type === GitRemoteType.Push) {\n\t\t\t\t\t\tright = true;\n\n\t\t\t\t\t\tif (left) break;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (left && right) {\n\t\t\t\t\tarrows = GlyphChars.ArrowsRightLeft;\n\t\t\t\t} else if (right) {\n\t\t\t\t\tarrows = GlyphChars.ArrowRight;\n\t\t\t\t} else if (left) {\n\t\t\t\t\tarrows = GlyphChars.ArrowLeft;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst status = `${branch.getTrackingStatus({ suffix: `${GlyphChars.Space} ` })}${arrows}${\n\t\t\t\tGlyphChars.Space\n\t\t\t} ${branch.tracking}`;\n\t\t\tdescription = `${description ? `${description}${GlyphChars.Space.repeat(2)}${status}` : status}`;\n\t\t}\n\n\t\tif (options.ref) {\n\t\t\tif (branch.sha) {\n\t\t\t\tdescription = description\n\t\t\t\t\t? `${description}${Strings.pad('$(git-commit)', 2, 2)}${GitService.shortenSha(branch.sha)}`\n\t\t\t\t\t: `${Strings.pad('$(git-commit)', 0, 2)}${GitService.shortenSha(branch.sha)}`;\n\t\t\t}\n\n\t\t\tif (branch.date !== undefined) {\n\t\t\t\tdescription = description\n\t\t\t\t\t? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${branch.formattedDate}`\n\t\t\t\t\t: branch.formattedDate;\n\t\t\t}\n\t\t}\n\n\t\tconst checked =\n\t\t\toptions.checked || (options.checked === undefined && options.current === 'checkmark' && branch.current);\n\t\tconst item: BranchQuickPickItem = {\n\t\t\tlabel: `${GlyphChars.SpaceThin}${Strings.pad('$(git-branch)', 0, 2)}${GlyphChars.SpaceThinnest}${\n\t\t\t\tbranch.name\n\t\t\t}${checked ? `${GlyphChars.Space.repeat(2)}$(check)${GlyphChars.Space}` : ''}`,\n\t\t\tdescription: description,\n\t\t\tpicked: picked === undefined ? branch.current : picked,\n\t\t\titem: branch,\n\t\t\tcurrent: branch.current,\n\t\t\tref: branch.name,\n\t\t\tremote: branch.remote\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport interface CommitQuickPickItem<T extends GitLogCommit = GitLogCommit> extends QuickPickItemOfT<T> {}\n\nexport namespace CommitQuickPickItem {\n\texport function create<T extends GitLogCommit = GitLogCommit>(\n\t\tcommit: T,\n\t\tpicked?: boolean,\n\t\toptions: { compact?: boolean; icon?: boolean; match?: string } = {}\n\t) {\n\t\tif (GitStashCommit.is(commit)) {\n\t\t\tconst number = commit.number === undefined ? '' : `${commit.number}: `;\n\n\t\t\tif (options.compact) {\n\t\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\t\tlabel: `${number}${commit.getShortMessage()}`,\n\t\t\t\t\tdescription: `${commit.formattedDate}${Strings.pad(\n\t\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t\t2,\n\t\t\t\t\t\t2\n\t\t\t\t\t)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\t\tpicked: picked,\n\t\t\t\t\titem: commit\n\t\t\t\t};\n\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\tlabel: `${number}${commit.getShortMessage()}`,\n\t\t\t\tdescription: '',\n\t\t\t\tdetail: `${GlyphChars.Space.repeat(2)}${commit.formattedDate}${Strings.pad(\n\t\t\t\t\tGlyphChars.Dot,\n\t\t\t\t\t2,\n\t\t\t\t\t2\n\t\t\t\t)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: commit\n\t\t\t};\n\n\t\t\treturn item;\n\t\t}\n\n\t\tif (options.compact) {\n\t\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\t\tlabel: `${options.icon ? Strings.pad('$(git-commit)', 0, 2) : ''}${commit.getShortMessage()}`,\n\t\t\t\tdescription: `${commit.author}, ${commit.formattedDate}${Strings.pad('$(git-commit)', 2, 2)}${\n\t\t\t\t\tcommit.shortSha\n\t\t\t\t}${Strings.pad(GlyphChars.Dot, 2, 2)}${commit.getFormattedDiffStatus({ compact: true })}`,\n\t\t\t\tdetail: options.match,\n\t\t\t\tpicked: picked,\n\t\t\t\titem: commit\n\t\t\t};\n\t\t\treturn item;\n\t\t}\n\n\t\tconst item: CommitQuickPickItem<T> = {\n\t\t\tlabel: `${options.icon ? Strings.pad('$(git-commit)', 0, 2) : ''}${commit.getShortMessage()}`,\n\t\t\tdescription: options.match || '',\n\t\t\tdetail: `${GlyphChars.Space.repeat(2)}${commit.author}, ${commit.formattedDate}${Strings.pad(\n\t\t\t\t'$(git-commit)',\n\t\t\t\t2,\n\t\t\t\t2\n\t\t\t)}${commit.shortSha}${Strings.pad(GlyphChars.Dot, 2, 2)}${commit.getFormattedDiffStatus({\n\t\t\t\tcompact: true\n\t\t\t})}`,\n\t\t\tpicked: picked,\n\t\t\titem: commit\n\t\t};\n\t\treturn item;\n\t}\n}\n\nexport interface RefQuickPickItem extends QuickPickItemOfT<GitReference> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace RefQuickPickItem {\n\texport function create(ref: string, picked?: boolean, options: { ref?: boolean } = {}): RefQuickPickItem {\n\t\tif (ref === '') {\n\t\t\treturn {\n\t\t\t\tlabel: `${Strings.pad('$(file-directory)', 0, 2)}Working Tree`,\n\t\t\t\tdescription: '',\n\t\t\t\tpicked: picked,\n\t\t\t\titem: GitReference.create(ref, { name: 'Working Tree' }),\n\t\t\t\tcurrent: false,\n\t\t\t\tref: ref,\n\t\t\t\tremote: false\n\t\t\t};\n\t\t}\n\n\t\tif (ref === 'HEAD') {\n\t\t\treturn {\n\t\t\t\tlabel: 'HEAD',\n\t\t\t\tdescription: '',\n\t\t\t\tpicked: picked,\n\t\t\t\titem: GitReference.create(ref, { name: 'HEAD' }),\n\t\t\t\tcurrent: false,\n\t\t\t\tref: ref,\n\t\t\t\tremote: false\n\t\t\t};\n\t\t}\n\n\t\tconst gitRef = GitReference.create(ref);\n\n\t\tconst item: RefQuickPickItem = {\n\t\t\tlabel: `Commit ${gitRef.name}`,\n\t\t\tdescription: options.ref ? `$(git-commit) ${ref}` : '',\n\t\t\tpicked: picked,\n\t\t\titem: gitRef,\n\t\t\tcurrent: false,\n\t\t\tref: ref,\n\t\t\tremote: false\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport interface RepositoryQuickPickItem extends QuickPickItemOfT<Repository> {\n\treadonly repoPath: string;\n}\n\nexport namespace RepositoryQuickPickItem {\n\texport async function create(\n\t\trepository: Repository,\n\t\tpicked?: boolean,\n\t\toptions: { branch?: boolean; fetched?: boolean; status?: boolean } = {}\n\t) {\n\t\tlet repoStatus;\n\t\tif (options.branch || options.status) {\n\t\t\trepoStatus = await repository.getStatus();\n\t\t}\n\n\t\tlet description = '';\n\t\tif (options.branch && repoStatus) {\n\t\t\tdescription = repoStatus.branch;\n\t\t}\n\n\t\tif (options.status && repoStatus) {\n\t\t\tlet workingStatus = '';\n\t\t\tif (repoStatus.files.length !== 0) {\n\t\t\t\tworkingStatus = repoStatus.getFormattedDiffStatus({\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tprefix: Strings.pad(GlyphChars.Dot, 2, 2)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst upstreamStatus = repoStatus.getUpstreamStatus({\n\t\t\t\tprefix: description ? `${GlyphChars.Space} ` : ''\n\t\t\t});\n\n\t\t\tconst status = `${upstreamStatus}${workingStatus}`;\n\t\t\tif (status) {\n\t\t\t\tdescription = `${description ? `${description}${status}` : status}`;\n\t\t\t}\n\t\t}\n\n\t\tif (options.fetched) {\n\t\t\tconst lastFetched = await repository.getLastFetched();\n\t\t\tif (lastFetched !== 0) {\n\t\t\t\tconst fetched = `Last fetched ${Dates.getFormatter(new Date(lastFetched)).fromNow()}`;\n\t\t\t\tdescription = `${\n\t\t\t\t\tdescription ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${fetched}` : fetched\n\t\t\t\t}`;\n\t\t\t}\n\t\t}\n\n\t\tconst item: RepositoryQuickPickItem = {\n\t\t\tlabel: repository.formattedName,\n\t\t\tdescription: description,\n\t\t\tpicked: picked,\n\t\t\titem: repository,\n\t\t\trepoPath: repository.path\n\t\t};\n\n\t\treturn item;\n\t}\n}\n\nexport interface TagQuickPickItem extends QuickPickItemOfT<GitTag> {\n\treadonly current: boolean;\n\treadonly ref: string;\n\treadonly remote: boolean;\n}\n\nexport namespace TagQuickPickItem {\n\texport function create(\n\t\ttag: GitTag,\n\t\tpicked?: boolean,\n\t\toptions: {\n\t\t\tannotation?: boolean;\n\t\t\tchecked?: boolean;\n\t\t\tref?: boolean;\n\t\t\ttype?: boolean;\n\t\t} = {}\n\t) {\n\t\tlet description = '';\n\t\tif (options.type) {\n\t\t\tdescription = 'tag';\n\t\t}\n\n\t\tif (options.ref && tag.sha) {\n\t\t\tdescription = description\n\t\t\t\t? `${description}${Strings.pad('$(git-commit)', 2, 2)}${GitService.shortenSha(tag.sha)}`\n\t\t\t\t: `${Strings.pad('$(git-commit)', 0, 2)}${GitService.shortenSha(tag.sha)}`;\n\t\t}\n\n\t\tif (options.annotation && tag.annotation) {\n\t\t\tconst annotation = emojify(tag.annotation);\n\t\t\tdescription = description ? `${description}${Strings.pad(GlyphChars.Dot, 2, 2)}${annotation}` : annotation;\n\t\t}\n\n\t\tconst item: TagQuickPickItem = {\n\t\t\tlabel: `${Strings.pad('$(tag)', 0, 2)}${tag.name}${\n\t\t\t\toptions.checked ? `${GlyphChars.Space.repeat(2)}$(check)${GlyphChars.Space}` : ''\n\t\t\t}`,\n\t\t\tdescription: description,\n\t\t\tpicked: picked,\n\t\t\titem: tag,\n\t\t\tcurrent: false,\n\t\t\tref: tag.name,\n\t\t\tremote: false\n\t\t};\n\n\t\treturn item;\n\t}\n}\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","'use strict';\nimport { commands, Disposable } from 'vscode';\nimport { CommandContext, extensionId, setCommandContext } from './constants';\nimport { Logger } from './logger';\nimport { log } from './system/decorators/log';\n\nexport declare interface KeyCommand {\n\tonDidPressKey?(key: Keys): void | Promise<void>;\n}\n\nconst keyNoopCommand = Object.create(null) as KeyCommand;\nexport { keyNoopCommand as KeyNoopCommand };\n\nexport const keys = [\n\t'left',\n\t'alt+left',\n\t'ctrl+left',\n\t'right',\n\t'alt+right',\n\t'ctrl+right',\n\t'alt+,',\n\t'alt+.',\n\t'escape'\n] as const;\nexport type Keys = typeof keys[number];\n\nexport type KeyMapping = { [K in Keys]?: KeyCommand | (() => Promise<KeyCommand>) };\ntype IndexableKeyMapping = KeyMapping & {\n\t[index: string]: KeyCommand | (() => Promise<KeyCommand>) | undefined;\n};\n\nconst mappings: KeyMapping[] = [];\n\nexport class KeyboardScope implements Disposable {\n\tprivate readonly _mapping: IndexableKeyMapping;\n\tconstructor(mapping: KeyMapping) {\n\t\tthis._mapping = mapping;\n\t\tfor (const key in this._mapping) {\n\t\t\tthis._mapping[key] = this._mapping[key] || keyNoopCommand;\n\t\t}\n\n\t\tmappings.push(this._mapping);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}[${mappings.length}]`\n\t})\n\tasync dispose() {\n\t\tconst index = mappings.indexOf(this._mapping);\n\n\t\tconst cc = Logger.getCorrelationContext();\n\t\tif (cc) {\n\t\t\tcc.exitDetails = ` \\u2022 index=${index}`;\n\t\t}\n\n\t\tif (index === mappings.length - 1) {\n\t\t\tmappings.pop();\n\t\t\tawait this.updateKeyCommandsContext(mappings[mappings.length - 1]);\n\t\t} else {\n\t\t\tmappings.splice(index, 1);\n\t\t}\n\t}\n\n\tprivate _paused = true;\n\tget paused() {\n\t\treturn this._paused;\n\t}\n\n\t@log<KeyboardScope['clearKeyCommand']>({\n\t\targs: false,\n\t\tprefix: (context, key) => `${context.prefix}[${mappings.length}](${key})`\n\t})\n\tasync clearKeyCommand(key: Keys) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst mapping = mappings[mappings.length - 1];\n\t\tif (mapping !== this._mapping || !mapping[key]) {\n\t\t\tif (cc) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tmapping[key] = undefined;\n\t\tawait setCommandContext(`${CommandContext.Key}:${key}`, false);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}(paused=${context.instance._paused})`\n\t})\n\tasync pause(keys?: Keys[]) {\n\t\tif (this._paused) return;\n\n\t\tthis._paused = true;\n\t\tconst mapping = (Object.keys(this._mapping) as Keys[]).reduce(\n\t\t\t(accumulator, key) => {\n\t\t\t\taccumulator[key] = keys === undefined ? false : keys.includes(key) ? false : this._mapping[key];\n\t\t\t\treturn accumulator;\n\t\t\t},\n\t\t\t{} as any\n\t\t);\n\n\t\tawait this.updateKeyCommandsContext(mapping);\n\t}\n\n\t@log({\n\t\targs: false,\n\t\tprefix: context => `${context.prefix}(paused=${context.instance._paused})`\n\t})\n\tasync resume() {\n\t\tif (!this._paused) return;\n\n\t\tthis._paused = false;\n\t\tawait this.updateKeyCommandsContext(this._mapping);\n\t}\n\n\tasync start() {\n\t\tawait this.resume();\n\t}\n\n\t@log<KeyboardScope['setKeyCommand']>({\n\t\targs: false,\n\t\tprefix: (context, key) => `${context.prefix}[${mappings.length}](${key})`\n\t})\n\tasync setKeyCommand(key: Keys, command: KeyCommand | (() => Promise<KeyCommand>)) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tconst mapping = mappings[mappings.length - 1];\n\t\tif (mapping !== this._mapping) {\n\t\t\tif (cc) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped';\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst set = Boolean(mapping[key]);\n\n\t\tmapping[key] = command;\n\t\tif (!set) {\n\t\t\tawait setCommandContext(`${CommandContext.Key}:${key}`, true);\n\t\t}\n\t}\n\n\tprivate async updateKeyCommandsContext(mapping: KeyMapping) {\n\t\tawait Promise.all(\n\t\t\tkeys.map(key => setCommandContext(`${CommandContext.Key}:${key}`, Boolean(mapping && mapping[key])))\n\t\t);\n\t}\n}\n\nexport class Keyboard implements Disposable {\n\tprivate _disposable: Disposable;\n\n\tconstructor() {\n\t\tconst subscriptions = keys.map(key =>\n\t\t\tcommands.registerCommand(`${extensionId}.key.${key}`, () => this.execute(key), this)\n\t\t);\n\t\tthis._disposable = Disposable.from(...subscriptions);\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\t@log<Keyboard['createScope']>({\n\t\targs: false,\n\t\tprefix: (context, mapping) =>\n\t\t\t`${context.prefix}[${mappings.length}](${mapping === undefined ? '' : Object.keys(mapping).join(',')})`\n\t})\n\tcreateScope(mapping?: KeyMapping): KeyboardScope {\n\t\treturn new KeyboardScope({ ...mapping });\n\t}\n\n\t@log<Keyboard['beginScope']>({\n\t\targs: false,\n\t\tprefix: (context, mapping) =>\n\t\t\t`${context.prefix}[${mappings.length}](${mapping === undefined ? '' : Object.keys(mapping).join(',')})`\n\t})\n\tasync beginScope(mapping?: KeyMapping): Promise<KeyboardScope> {\n\t\tconst scope = this.createScope(mapping);\n\t\tawait scope.start();\n\t\treturn scope;\n\t}\n\n\t@log()\n\tasync execute(key: Keys): Promise<{} | undefined> {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tif (!mappings.length) {\n\t\t\tif (cc) {\n\t\t\t\tcc.exitDetails = ' \\u2022 skipped, no mappings';\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\ttry {\n\t\t\tconst mapping = mappings[mappings.length - 1];\n\n\t\t\tlet command = mapping[key] as KeyCommand | (() => Promise<KeyCommand>);\n\t\t\tif (typeof command === 'function') {\n\t\t\t\tcommand = await command();\n\t\t\t}\n\t\t\tif (!command || typeof command.onDidPressKey !== 'function') {\n\t\t\t\tif (cc) {\n\t\t\t\t\tcc.exitDetails = ' \\u2022 skipped, no callback';\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tawait command.onDidPressKey(key);\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n","'use strict';\nimport { Disposable, Terminal, window } from 'vscode';\nimport { extensionTerminalName } from './constants';\nimport { Container } from './container';\n\nlet _terminal: Terminal | undefined;\nlet _terminalCwd: string | undefined;\nlet _disposable: Disposable | undefined;\n\nfunction ensureTerminal(cwd: string): Terminal {\n\tif (_terminal === undefined) {\n\t\t_terminal = window.createTerminal(extensionTerminalName);\n\t\t_disposable = window.onDidCloseTerminal((e: Terminal) => {\n\t\t\tif (e.name === extensionTerminalName) {\n\t\t\t\t_terminal = undefined;\n\t\t\t\t_disposable!.dispose();\n\t\t\t\t_disposable = undefined;\n\t\t\t}\n\t\t});\n\n\t\tContainer.context.subscriptions.push(_disposable);\n\t\t_terminalCwd = undefined;\n\t}\n\n\tif (_terminalCwd !== cwd) {\n\t\t_terminal.sendText(`cd \"${cwd}\"`, true);\n\t\t_terminalCwd = cwd;\n\t}\n\n\treturn _terminal;\n}\n\nexport function runGitCommandInTerminal(command: string, args: string, cwd: string, execute: boolean = false) {\n\t// let git = GitService.getGitPath();\n\t// if (git.includes(' ')) {\n\t//     git = `\"${git}\"`;\n\t// }\n\n\tconst terminal = ensureTerminal(cwd);\n\tterminal.show(false);\n\tterminal.sendText(`git ${command} ${args}`, execute);\n}\n","'use strict';\nimport { env, Range, Uri, window } from 'vscode';\nimport { Logger } from '../../logger';\nimport { Messages } from '../../messages';\nimport { GitLogCommit } from '../models/logCommit';\n\nexport enum RemoteResourceType {\n\tBranch = 'branch',\n\tBranches = 'branches',\n\tCommit = 'commit',\n\tFile = 'file',\n\tRepo = 'repo',\n\tRevision = 'revision'\n}\n\nexport type RemoteResource =\n\t| {\n\t\t\ttype: RemoteResourceType.Branch;\n\t\t\tbranch: string;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Branches;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Commit;\n\t\t\tsha: string;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.File;\n\t\t\tbranch?: string;\n\t\t\tfileName: string;\n\t\t\trange?: Range;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Repo;\n\t  }\n\t| {\n\t\t\ttype: RemoteResourceType.Revision;\n\t\t\tbranch?: string;\n\t\t\tcommit?: GitLogCommit;\n\t\t\tfileName: string;\n\t\t\trange?: Range;\n\t\t\tsha?: string;\n\t  };\n\nexport function getNameFromRemoteResource(resource: RemoteResource) {\n\tswitch (resource.type) {\n\t\tcase RemoteResourceType.Branch:\n\t\t\treturn 'Branch';\n\t\tcase RemoteResourceType.Branches:\n\t\t\treturn 'Branches';\n\t\tcase RemoteResourceType.Commit:\n\t\t\treturn 'Commit';\n\t\tcase RemoteResourceType.File:\n\t\t\treturn 'File';\n\t\tcase RemoteResourceType.Repo:\n\t\t\treturn 'Repository';\n\t\tcase RemoteResourceType.Revision:\n\t\t\treturn 'Revision';\n\t\tdefault:\n\t\t\treturn '';\n\t}\n}\n\nexport abstract class RemoteProvider {\n\tprivate _name: string | undefined;\n\n\tconstructor(\n\t\tpublic readonly domain: string,\n\t\tpublic readonly path: string,\n\t\tpublic readonly protocol: string = 'https',\n\t\tname?: string,\n\t\tpublic readonly custom: boolean = false\n\t) {\n\t\tthis._name = name;\n\t}\n\n\tget icon(): string {\n\t\treturn 'remote';\n\t}\n\n\tget displayPath(): string {\n\t\treturn this.path;\n\t}\n\n\tabstract get name(): string;\n\n\tprotected get baseUrl() {\n\t\treturn `${this.protocol}://${this.domain}/${this.path}`;\n\t}\n\n\tenrichMessage(message: string): string {\n\t\treturn message;\n\t}\n\n\tprotected formatName(name: string) {\n\t\tif (this._name !== undefined) return this._name;\n\t\treturn `${name}${this.custom ? ` (${this.domain})` : ''}`;\n\t}\n\n\tprotected splitPath(): [string, string] {\n\t\tconst index = this.path.indexOf('/');\n\t\treturn [this.path.substring(0, index), this.path.substring(index + 1)];\n\t}\n\n\tprotected getUrlForRepository(): string {\n\t\treturn this.baseUrl;\n\t}\n\tprotected abstract getUrlForBranches(): string;\n\tprotected abstract getUrlForBranch(branch: string): string;\n\tprotected abstract getUrlForCommit(sha: string): string;\n\tprotected abstract getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string;\n\n\tprivate openUrl(url?: string): Thenable<{} | undefined> {\n\t\tif (url === undefined) return Promise.resolve(undefined);\n\n\t\treturn env.openExternal(Uri.parse(url));\n\t}\n\n\tasync copy(resource: RemoteResource): Promise<{} | undefined> {\n\t\tconst url = this.url(resource);\n\t\tif (url === undefined) return undefined;\n\n\t\ttry {\n\t\t\tvoid (await env.clipboard.writeText(url));\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tif (ex.message.includes(\"Couldn't find the required `xsel` binary\")) {\n\t\t\t\twindow.showErrorMessage(\n\t\t\t\t\t'Unable to copy remote url, xsel is not installed. Please install it via your package manager, e.g. `sudo apt install xsel`'\n\t\t\t\t);\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tLogger.error(ex, 'CopyRemoteUrlToClipboardCommand');\n\t\t\treturn Messages.showGenericErrorMessage('Unable to copy remote url');\n\t\t}\n\t}\n\n\topen(resource: RemoteResource): Thenable<{} | undefined> {\n\t\treturn this.openUrl(this.url(resource));\n\t}\n\n\turl(resource: RemoteResource): string | undefined {\n\t\tswitch (resource.type) {\n\t\t\tcase RemoteResourceType.Branch:\n\t\t\t\treturn this.getUrlForBranch(encodeURIComponent(resource.branch));\n\t\t\tcase RemoteResourceType.Branches:\n\t\t\t\treturn this.getUrlForBranches();\n\t\t\tcase RemoteResourceType.Commit:\n\t\t\t\treturn this.getUrlForCommit(encodeURIComponent(resource.sha));\n\t\t\tcase RemoteResourceType.File:\n\t\t\t\treturn this.getUrlForFile(\n\t\t\t\t\tresource.fileName,\n\t\t\t\t\tresource.branch !== undefined ? encodeURIComponent(resource.branch) : undefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tresource.range\n\t\t\t\t);\n\t\t\tcase RemoteResourceType.Repo:\n\t\t\t\treturn this.getUrlForRepository();\n\t\t\tcase RemoteResourceType.Revision:\n\t\t\t\treturn this.getUrlForFile(\n\t\t\t\t\tresource.fileName,\n\t\t\t\t\tresource.branch !== undefined ? encodeURIComponent(resource.branch) : undefined,\n\t\t\t\t\tresource.sha !== undefined ? encodeURIComponent(resource.sha) : undefined,\n\t\t\t\t\tresource.range\n\t\t\t\t);\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { TextDocument, TextEditor, Uri } from 'vscode';\n\nabstract class Comparer<T> {\n\tabstract equals(lhs: T, rhs: T): boolean;\n}\n\nclass UriComparer extends Comparer<Uri> {\n\tequals(lhs: Uri | undefined, rhs: Uri | undefined, options: { exact?: boolean } = { exact: false }) {\n\t\tif (lhs === rhs) return true;\n\t\tif (lhs === undefined || rhs === undefined) return false;\n\n\t\tif (options.exact) {\n\t\t\treturn lhs.toString(true) === rhs.toString(true);\n\t\t}\n\t\treturn lhs.scheme === rhs.scheme && lhs.fsPath === rhs.fsPath;\n\t}\n}\n\nclass TextDocumentComparer extends Comparer<TextDocument> {\n\tequals(lhs: TextDocument | undefined, rhs: TextDocument | undefined) {\n\t\treturn lhs === rhs;\n\t\t// if (lhs === rhs) return true;\n\t\t// if (lhs === undefined || rhs === undefined) return false;\n\n\t\t// return uriComparer.equals(lhs.uri, rhs.uri);\n\t}\n}\n\nclass TextEditorComparer extends Comparer<TextEditor> {\n\tequals(\n\t\tlhs: TextEditor | undefined,\n\t\trhs: TextEditor | undefined,\n\t\toptions: { useId: boolean; usePosition: boolean } = { useId: false, usePosition: false }\n\t) {\n\t\tif (lhs === rhs) return true;\n\t\tif (lhs === undefined || rhs === undefined) return false;\n\n\t\tif (options.usePosition && lhs.viewColumn !== rhs.viewColumn) return false;\n\n\t\tif (options.useId && (!lhs.document || !rhs.document)) {\n\t\t\tif ((lhs as any).id !== (rhs as any).id) return false;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn textDocumentComparer.equals(lhs.document, rhs.document);\n\t}\n}\n\nconst textDocumentComparer = new TextDocumentComparer();\nconst textEditorComparer = new TextEditorComparer();\nconst uriComparer = new UriComparer();\nexport {\n\ttextDocumentComparer as TextDocumentComparer,\n\ttextEditorComparer as TextEditorComparer,\n\turiComparer as UriComparer\n};\n","'use strict';\nimport { LogCorrelationContext, Logger, TraceLevel } from '../../logger';\nimport { Functions } from '../function';\nimport { Promises } from '../promise';\nimport { Strings } from '../string';\n\nconst emptyStr = '';\n\nconst correlationContext = new Map<number, LogCorrelationContext>();\nlet correlationCounter = 0;\n\nexport function getCorrelationContext() {\n\treturn correlationContext.get(correlationCounter);\n}\n\nexport function getCorrelationId() {\n\treturn correlationCounter;\n}\n\nfunction getNextCorrelationId() {\n\tif (correlationCounter === Number.MAX_SAFE_INTEGER) {\n\t\tcorrelationCounter = 0;\n\t}\n\treturn ++correlationCounter;\n}\n\nfunction clearCorrelationContext(correlationId: number) {\n\tcorrelationContext.delete(correlationId);\n}\n\nfunction setCorrelationContext(correlationId: number, context: LogCorrelationContext) {\n\tcorrelationContext.set(correlationId, context);\n}\n\nexport interface LogContext {\n\tid: number;\n\tinstance: any;\n\tinstanceName: string;\n\tname: string;\n\tprefix: string;\n}\n\nexport const LogInstanceNameFn = Symbol('logInstanceNameFn');\n\nexport function logName<T>(fn: (c: T, name: string) => string) {\n\treturn (target: Function) => {\n\t\t(target as any)[LogInstanceNameFn] = fn;\n\t};\n}\n\nexport function debug<T extends (...arg: any) => any>(\n\toptions: {\n\t\targs?: false | { [arg: string]: (arg: any) => string | false };\n\t\tcondition?(...args: Parameters<T>): boolean;\n\t\tcorrelate?: boolean;\n\t\tenter?(...args: Parameters<T>): string;\n\t\texit?(result: PromiseType<ReturnType<T>>): string;\n\t\tprefix?(context: LogContext, ...args: Parameters<T>): string;\n\t\tsanitize?(key: string, value: any): any;\n\t\tsingleLine?: boolean;\n\t\ttimed?: boolean;\n\t} = { timed: true }\n) {\n\treturn log<T>({ debug: true, ...options });\n}\n\ntype PromiseType<T> = T extends Promise<infer U> ? U : T;\n\nexport function log<T extends (...arg: any) => any>(\n\toptions: {\n\t\targs?: false | { [arg: number]: (arg: any) => string | false };\n\t\tcondition?(...args: Parameters<T>): boolean;\n\t\tcorrelate?: boolean;\n\t\tdebug?: boolean;\n\t\tenter?(...args: Parameters<T>): string;\n\t\texit?(result: PromiseType<ReturnType<T>>): string;\n\t\tprefix?(context: LogContext, ...args: Parameters<T>): string;\n\t\tsanitize?(key: string, value: any): any;\n\t\tsingleLine?: boolean;\n\t\ttimed?: boolean;\n\t} = { timed: true }\n) {\n\toptions = { timed: true, ...options };\n\n\tconst logFn = (options.debug ? Logger.debug.bind(Logger) : Logger.log.bind(Logger)) as\n\t\t| typeof Logger.debug\n\t\t| typeof Logger.log;\n\n\treturn (target: any, key: string, descriptor: PropertyDescriptor) => {\n\t\tlet fn: Function | undefined;\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfn = descriptor.get;\n\t\t}\n\t\tif (fn == null) throw new Error('Not supported');\n\n\t\tconst parameters = Functions.getParameters(fn);\n\n\t\tdescriptor.value = function(this: any, ...args: Parameters<T>) {\n\t\t\tconst correlationId = getNextCorrelationId();\n\n\t\t\tif (\n\t\t\t\t(!Logger.isDebugging &&\n\t\t\t\t\tLogger.level !== TraceLevel.Debug &&\n\t\t\t\t\t!(Logger.level === TraceLevel.Verbose && !options.debug)) ||\n\t\t\t\t(typeof options.condition === 'function' && !options.condition(...args))\n\t\t\t) {\n\t\t\t\treturn fn!.apply(this, args);\n\t\t\t}\n\n\t\t\tlet instanceName: string;\n\t\t\tif (this != null) {\n\t\t\t\tinstanceName = Logger.toLoggableName(this);\n\t\t\t\tif (this.constructor != null && this.constructor[LogInstanceNameFn]) {\n\t\t\t\t\tinstanceName = target.constructor[LogInstanceNameFn](this, instanceName);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tinstanceName = emptyStr;\n\t\t\t}\n\n\t\t\tlet { correlate } = options;\n\t\t\tif (!correlate && options.timed) {\n\t\t\t\tcorrelate = true;\n\t\t\t}\n\n\t\t\tlet prefix = `${correlate ? `[${correlationId.toString(16)}] ` : emptyStr}${\n\t\t\t\tinstanceName ? `${instanceName}.` : emptyStr\n\t\t\t}${key}`;\n\n\t\t\tif (options.prefix != null) {\n\t\t\t\tprefix = options.prefix(\n\t\t\t\t\t{\n\t\t\t\t\t\tid: correlationId,\n\t\t\t\t\t\tinstance: this,\n\t\t\t\t\t\tinstanceName: instanceName,\n\t\t\t\t\t\tname: key,\n\t\t\t\t\t\tprefix: prefix\n\t\t\t\t\t},\n\t\t\t\t\t...args\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet correlationContext: LogCorrelationContext | undefined;\n\t\t\tif (correlate) {\n\t\t\t\tcorrelationContext = { correlationId: correlationId, prefix: prefix };\n\t\t\t\tsetCorrelationContext(correlationId, correlationContext);\n\t\t\t}\n\n\t\t\tconst enter = options.enter != null ? options.enter(...args) : emptyStr;\n\n\t\t\tlet loggableParams: string;\n\t\t\tif (options.args === false || args.length === 0) {\n\t\t\t\tloggableParams = emptyStr;\n\n\t\t\t\tif (!options.singleLine) {\n\t\t\t\t\tlogFn(`${prefix}${enter}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst argFns = typeof options.args === 'object' ? options.args : undefined;\n\t\t\t\tlet argFn;\n\t\t\t\tlet loggable;\n\t\t\t\tloggableParams = args\n\t\t\t\t\t.map((v: any, index: number) => {\n\t\t\t\t\t\tconst p = parameters[index];\n\n\t\t\t\t\t\targFn = argFns !== undefined ? argFns[index] : undefined;\n\t\t\t\t\t\tif (argFn !== undefined) {\n\t\t\t\t\t\t\tloggable = argFn(v);\n\t\t\t\t\t\t\tif (loggable === false) return undefined;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tloggable = Logger.toLoggable(v, options.sanitize);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn p ? `${p}=${loggable}` : loggable;\n\t\t\t\t\t})\n\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t.join(', ');\n\n\t\t\t\tif (!options.singleLine) {\n\t\t\t\t\tif (!options.debug) {\n\t\t\t\t\t\tLogger.logWithDebugParams(`${prefix}${enter}`, loggableParams);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogFn(`${prefix}${enter}`, loggableParams);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.singleLine || options.timed || options.exit != null) {\n\t\t\t\tconst start = options.timed ? process.hrtime() : undefined;\n\n\t\t\t\tconst logError = (ex: Error) => {\n\t\t\t\t\tconst timing =\n\t\t\t\t\t\tstart !== undefined ? ` \\u2022 ${Strings.getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\t\tif (options.singleLine) {\n\t\t\t\t\t\tLogger.error(\n\t\t\t\t\t\t\tex,\n\t\t\t\t\t\t\t`${prefix}${enter}`,\n\t\t\t\t\t\t\t`failed${\n\t\t\t\t\t\t\t\tcorrelationContext !== undefined && correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t? correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t: emptyStr\n\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\tloggableParams\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tLogger.error(\n\t\t\t\t\t\t\tex,\n\t\t\t\t\t\t\tprefix,\n\t\t\t\t\t\t\t`failed${\n\t\t\t\t\t\t\t\tcorrelationContext !== undefined && correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t? correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t: emptyStr\n\t\t\t\t\t\t\t}${timing}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (correlate) {\n\t\t\t\t\t\tclearCorrelationContext(correlationId);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tlet result;\n\t\t\t\ttry {\n\t\t\t\t\tresult = fn!.apply(this, args);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tlogError(ex);\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\n\t\t\t\tconst logResult = (r: any) => {\n\t\t\t\t\tconst timing =\n\t\t\t\t\t\tstart !== undefined ? ` \\u2022 ${Strings.getDurationMilliseconds(start)} ms` : emptyStr;\n\t\t\t\t\tlet exit;\n\t\t\t\t\tif (options.exit != null) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\texit = options.exit(r);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\texit = `@log.exit error: ${ex}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\texit = 'completed';\n\t\t\t\t\t}\n\n\t\t\t\t\tif (options.singleLine) {\n\t\t\t\t\t\tif (!options.debug) {\n\t\t\t\t\t\t\tLogger.logWithDebugParams(\n\t\t\t\t\t\t\t\t`${prefix}${enter} ${exit}${\n\t\t\t\t\t\t\t\t\tcorrelationContext !== undefined && correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t\t? correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t\t: emptyStr\n\t\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\t\tloggableParams\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlogFn(\n\t\t\t\t\t\t\t\t`${prefix}${enter} ${exit}${\n\t\t\t\t\t\t\t\t\tcorrelationContext !== undefined && correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t\t? correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t\t: emptyStr\n\t\t\t\t\t\t\t\t}${timing}`,\n\t\t\t\t\t\t\t\tloggableParams\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogFn(\n\t\t\t\t\t\t\t`${prefix} ${exit}${\n\t\t\t\t\t\t\t\tcorrelationContext !== undefined && correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t? correlationContext.exitDetails\n\t\t\t\t\t\t\t\t\t: emptyStr\n\t\t\t\t\t\t\t}${timing}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (correlate) {\n\t\t\t\t\t\tclearCorrelationContext(correlationId);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tif (result != null && Promises.is(result)) {\n\t\t\t\t\tconst promise = result.then(logResult);\n\t\t\t\t\tpromise.catch(logError);\n\t\t\t\t} else {\n\t\t\t\t\tlogResult(result);\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\treturn fn!.apply(this, args);\n\t\t};\n\t};\n}\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","'use strict';\nimport { GlyphChars } from '../../constants';\nimport { Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitLogCommit } from './logCommit';\n\nexport declare type GitFileStatus = '!' | '?' | 'A' | 'C' | 'D' | 'M' | 'R' | 'T' | 'U' | 'X' | 'B';\n\nexport interface GitFile {\n\tstatus: GitFileStatus;\n\treadonly repoPath?: string;\n\treadonly indexStatus?: GitFileStatus;\n\treadonly workingTreeStatus?: GitFileStatus;\n\treadonly fileName: string;\n\treadonly originalFileName?: string;\n}\n\nexport interface GitFileWithCommit extends GitFile {\n\treadonly commit: GitLogCommit;\n}\n\nexport namespace GitFile {\n\texport function getFormattedDirectory(\n\t\tfile: GitFile,\n\t\tincludeOriginal: boolean = false,\n\t\trelativeTo?: string\n\t): string {\n\t\tconst directory = GitUri.getDirectory(file.fileName, relativeTo);\n\t\treturn includeOriginal && file.status === 'R' && file.originalFileName\n\t\t\t? `${directory} ${Strings.pad(GlyphChars.ArrowLeft, 1, 1)} ${file.originalFileName}`\n\t\t\t: directory;\n\t}\n\n\texport function getFormattedPath(\n\t\tfile: GitFile,\n\t\toptions: { relativeTo?: string; separator?: string; suffix?: string } = {}\n\t): string {\n\t\treturn GitUri.getFormattedPath(file.fileName, options);\n\t}\n\n\texport function getOriginalRelativePath(file: GitFile, relativeTo?: string): string {\n\t\tif (file.originalFileName == null || file.originalFileName.length === 0) return '';\n\n\t\treturn GitUri.relativeTo(file.originalFileName, relativeTo);\n\t}\n\n\texport function getRelativePath(file: GitFile, relativeTo?: string): string {\n\t\treturn GitUri.relativeTo(file.fileName, relativeTo);\n\t}\n\n\tconst statusIconsMap = {\n\t\t'!': 'icon-status-ignored.svg',\n\t\t'?': 'icon-status-untracked.svg',\n\t\tA: 'icon-status-added.svg',\n\t\tC: 'icon-status-copied.svg',\n\t\tD: 'icon-status-deleted.svg',\n\t\tM: 'icon-status-modified.svg',\n\t\tR: 'icon-status-renamed.svg',\n\t\tT: 'icon-status-modified.svg',\n\t\tU: 'icon-status-conflict.svg',\n\t\tX: 'icon-status-unknown.svg',\n\t\tB: 'icon-status-unknown.svg'\n\t};\n\n\texport function getStatusIcon(status: GitFileStatus): string {\n\t\treturn statusIconsMap[status] || statusIconsMap['X'];\n\t}\n\n\tconst statusOcticonsMap = {\n\t\t'!': '$(diff-ignored)',\n\t\t'?': '$(diff-added)',\n\t\tA: '$(diff-added)',\n\t\tC: '$(diff-added)',\n\t\tD: '$(diff-removed)',\n\t\tM: '$(diff-modified)',\n\t\tR: '$(diff-renamed)',\n\t\tT: '$(diff-modified)',\n\t\tU: '$(alert)',\n\t\tX: '$(question)',\n\t\tB: '$(question)'\n\t};\n\n\texport function getStatusOcticon(status: GitFileStatus, missing: string = GlyphChars.Space.repeat(4)): string {\n\t\treturn statusOcticonsMap[status] || missing;\n\t}\n\n\tconst statusTextMap = {\n\t\t'!': 'Ignored',\n\t\t'?': 'Untracked',\n\t\tA: 'Added',\n\t\tC: 'Copied',\n\t\tD: 'Deleted',\n\t\tM: 'Modified',\n\t\tR: 'Renamed',\n\t\tT: 'Modified',\n\t\tU: 'Conflict',\n\t\tX: 'Unknown',\n\t\tB: 'Unknown'\n\t};\n\n\texport function getStatusText(status: GitFileStatus): string {\n\t\treturn statusTextMap[status] || statusTextMap['X'];\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Git, GitAuthor, GitBlame, GitBlameCommit, GitCommitLine } from '../git';\nimport { debug, Strings } from '../../system';\n\nconst emptyStr = '';\nconst slash = '/';\n\ninterface BlameEntry {\n\tsha: string;\n\n\tline: number;\n\toriginalLine: number;\n\tlineCount: number;\n\n\tauthor: string;\n\tauthorDate?: string;\n\tauthorTimeZone?: string;\n\tauthorEmail?: string;\n\n\tcommitterDate?: string;\n\tcommitterTimeZone?: string;\n\n\tpreviousSha?: string;\n\tpreviousFileName?: string;\n\n\tfileName?: string;\n\n\tsummary?: string;\n}\n\nexport class GitBlameParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(\n\t\tdata: string,\n\t\trepoPath: string | undefined,\n\t\tfileName: string,\n\t\tcurrentUser: { name?: string; email?: string } | undefined\n\t): GitBlame | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst authors: Map<string, GitAuthor> = new Map();\n\t\tconst commits: Map<string, GitBlameCommit> = new Map();\n\t\tconst lines: GitCommitLine[] = [];\n\n\t\tlet relativeFileName;\n\n\t\tlet entry: BlameEntry | undefined = undefined;\n\t\tlet line: string;\n\t\tlet lineParts: string[];\n\n\t\tlet first = true;\n\n\t\tfor (line of Strings.lines(data)) {\n\t\t\tlineParts = line.split(' ');\n\t\t\tif (lineParts.length < 2) continue;\n\n\t\t\tif (entry === undefined) {\n\t\t\t\tentry = {\n\t\t\t\t\tauthor: undefined!,\n\t\t\t\t\tsha: lineParts[0],\n\t\t\t\t\toriginalLine: parseInt(lineParts[1], 10),\n\t\t\t\t\tline: parseInt(lineParts[2], 10),\n\t\t\t\t\tlineCount: parseInt(lineParts[3], 10)\n\t\t\t\t};\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch (lineParts[0]) {\n\t\t\t\tcase 'author':\n\t\t\t\t\tif (Git.isUncommitted(entry.sha)) {\n\t\t\t\t\t\tentry.author = 'You';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentry.author = lineParts\n\t\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t\t.join(' ')\n\t\t\t\t\t\t\t.trim();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'author-mail': {\n\t\t\t\t\tif (Git.isUncommitted(entry.sha)) {\n\t\t\t\t\t\tentry.authorEmail = currentUser !== undefined ? currentUser.email : undefined;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tentry.authorEmail = lineParts\n\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t.join(' ')\n\t\t\t\t\t\t.trim();\n\t\t\t\t\tconst start = entry.authorEmail.indexOf('<');\n\t\t\t\t\tif (start >= 0) {\n\t\t\t\t\t\tconst end = entry.authorEmail.indexOf('>', start);\n\t\t\t\t\t\tif (end > start) {\n\t\t\t\t\t\t\tentry.authorEmail = entry.authorEmail.substring(start + 1, end);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.authorEmail = entry.authorEmail.substring(start + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'author-time':\n\t\t\t\t\tentry.authorDate = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'author-tz':\n\t\t\t\t\tentry.authorTimeZone = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'committer-time':\n\t\t\t\t\tentry.committerDate = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'committer-tz':\n\t\t\t\t\tentry.committerTimeZone = lineParts[1];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'summary':\n\t\t\t\t\tentry.summary = lineParts\n\t\t\t\t\t\t.slice(1)\n\t\t\t\t\t\t.join(' ')\n\t\t\t\t\t\t.trim();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'previous':\n\t\t\t\t\tentry.previousSha = lineParts[1];\n\t\t\t\t\tentry.previousFileName = lineParts.slice(2).join(' ');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'filename':\n\t\t\t\t\tentry.fileName = lineParts.slice(1).join(' ');\n\n\t\t\t\t\tif (first && repoPath === undefined) {\n\t\t\t\t\t\t// Try to get the repoPath from the most recent commit\n\t\t\t\t\t\trepoPath = Strings.normalizePath(\n\t\t\t\t\t\t\tfileName.replace(\n\t\t\t\t\t\t\t\tfileName.startsWith(slash) ? `/${entry.fileName}` : entry.fileName,\n\t\t\t\t\t\t\t\temptyStr\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelativeFileName = Strings.normalizePath(paths.relative(repoPath, fileName));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trelativeFileName = entry.fileName;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = false;\n\n\t\t\t\t\tGitBlameParser.parseEntry(entry, repoPath, relativeFileName, commits, authors, lines, currentUser);\n\n\t\t\t\t\tentry = undefined;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (const [, c] of commits) {\n\t\t\tif (c.author === undefined) return undefined;\n\n\t\t\tconst author = authors.get(c.author);\n\t\t\tif (author === undefined) return undefined;\n\n\t\t\tauthor.lineCount += c.lines.length;\n\t\t}\n\n\t\tconst sortedAuthors = new Map([...authors.entries()].sort((a, b) => b[1].lineCount - a[1].lineCount));\n\n\t\tconst blame: GitBlame = {\n\t\t\trepoPath: repoPath!,\n\t\t\tauthors: sortedAuthors,\n\t\t\tcommits: commits,\n\t\t\tlines: lines\n\t\t};\n\t\treturn blame;\n\t}\n\n\tprivate static parseEntry(\n\t\tentry: BlameEntry,\n\t\trepoPath: string | undefined,\n\t\trelativeFileName: string,\n\t\tcommits: Map<string, GitBlameCommit>,\n\t\tauthors: Map<string, GitAuthor>,\n\t\tlines: GitCommitLine[],\n\t\tcurrentUser: { name?: string; email?: string } | undefined\n\t) {\n\t\tlet commit = commits.get(entry.sha);\n\t\tif (commit === undefined) {\n\t\t\tif (entry.author !== undefined) {\n\t\t\t\tif (\n\t\t\t\t\tcurrentUser !== undefined &&\n\t\t\t\t\t// Name or e-mail is configured\n\t\t\t\t\t(currentUser.name !== undefined || currentUser.email !== undefined) &&\n\t\t\t\t\t// Match on name if configured\n\t\t\t\t\t(currentUser.name === undefined || currentUser.name === entry.author) &&\n\t\t\t\t\t// Match on email if configured\n\t\t\t\t\t(currentUser.email === undefined || currentUser.email === entry.authorEmail)\n\t\t\t\t) {\n\t\t\t\t\tentry.author = 'You';\n\t\t\t\t}\n\n\t\t\t\tlet author = authors.get(entry.author);\n\t\t\t\tif (author === undefined) {\n\t\t\t\t\tauthor = {\n\t\t\t\t\t\tname: entry.author,\n\t\t\t\t\t\tlineCount: 0\n\t\t\t\t\t};\n\t\t\t\t\tauthors.set(entry.author, author);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcommit = new GitBlameCommit(\n\t\t\t\trepoPath!,\n\t\t\t\tentry.sha,\n\t\t\t\tentry.author,\n\t\t\t\tentry.authorEmail,\n\t\t\t\tnew Date((entry.authorDate as any) * 1000),\n\t\t\t\tnew Date((entry.committerDate as any) * 1000),\n\t\t\t\tentry.summary!,\n\t\t\t\trelativeFileName,\n\t\t\t\tentry.previousFileName !== undefined && entry.previousFileName !== entry.fileName\n\t\t\t\t\t? entry.previousFileName\n\t\t\t\t\t: undefined,\n\t\t\t\tentry.previousSha,\n\t\t\t\tentry.previousSha && entry.previousFileName,\n\t\t\t\t[]\n\t\t\t);\n\n\t\t\tcommits.set(entry.sha, commit);\n\t\t}\n\n\t\tfor (let i = 0, len = entry.lineCount; i < len; i++) {\n\t\t\tconst line: GitCommitLine = {\n\t\t\t\tsha: entry.sha,\n\t\t\t\tline: entry.line + i,\n\t\t\t\toriginalLine: entry.originalLine + i\n\t\t\t};\n\n\t\t\tif (commit.previousSha) {\n\t\t\t\tline.previousSha = commit.previousSha;\n\t\t\t}\n\n\t\t\tcommit.lines.push(line);\n\t\t\tlines[line.line - 1] = line;\n\t\t}\n\t}\n}\n","'use strict';\nimport { GitBranch } from '../models/branch';\nimport { debug } from '../../system';\n\nconst branchWithTrackingRegex = /^<h>(.+)<n>(.+)<u>(.*)<t>(?:\\[(?:ahead ([0-9]+))?[,\\s]*(?:behind ([0-9]+))?]|\\[gone])?<r>(.*)<d>(.*)$/gm;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%3c'; // `%${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%3e'; // `%${'>'.charCodeAt(0).toString(16)}`;\n\nexport class GitBranchParser {\n\tstatic defaultFormat = [\n\t\t`${lb}h${rb}%(HEAD)`, // HEAD indicator\n\t\t`${lb}n${rb}%(refname)`, // branch name\n\t\t`${lb}u${rb}%(upstream:short)`, // branch upstream\n\t\t`${lb}t${rb}%(upstream:track)`, // branch upstream tracking state\n\t\t`${lb}r${rb}%(objectname)`, // ref\n\t\t`${lb}d${rb}%(committerdate:unix)` // committer date\n\t].join('');\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitBranch[] {\n\t\tconst branches: GitBranch[] = [];\n\n\t\tif (!data) return branches;\n\n\t\tlet current;\n\t\tlet name;\n\t\tlet tracking;\n\t\tlet ahead;\n\t\tlet behind;\n\t\tlet ref;\n\t\tlet date;\n\n\t\tlet remote;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = branchWithTrackingRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, current, name, tracking, ahead, behind, ref, date] = match;\n\n\t\t\tif (name.startsWith('refs/remotes/')) {\n\t\t\t\t// Strip off refs/remotes/\n\t\t\t\tname = name.substr(13);\n\t\t\t\tremote = true;\n\t\t\t} else {\n\t\t\t\t// Strip off refs/heads/\n\t\t\t\tname = name.substr(11);\n\t\t\t\tremote = false;\n\t\t\t}\n\n\t\t\tbranches.push(\n\t\t\t\tnew GitBranch(\n\t\t\t\t\trepoPath,\n\t\t\t\t\tname,\n\t\t\t\t\tremote,\n\t\t\t\t\tcurrent.charCodeAt(0) === 42, // '*',\n\t\t\t\t\tnew Date(Number(date) * 1000),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tref == null || ref.length === 0 ? undefined : ` ${ref}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\ttracking == null || tracking.length === 0 ? undefined : ` ${tracking}`.substr(1),\n\t\t\t\t\tNumber(ahead) || 0,\n\t\t\t\t\tNumber(behind) || 0\n\t\t\t\t)\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn branches;\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { Range } from 'vscode';\nimport { Git, GitAuthor, GitCommitType, GitFile, GitFileStatus, GitLog, GitLogCommit, GitLogCommitLine } from '../git';\nimport { Arrays, debug, Strings } from '../../system';\n\nconst emptyEntry: LogEntry = {};\nconst emptyStr = '';\nconst slash = '/';\n\nconst diffRegex = /diff --git a\\/(.*) b\\/(.*)/;\nconst diffRangeRegex = /^@@ -(\\d+?),(\\d+?) \\+(\\d+?),(\\d+?) @@/;\n\nexport const fileStatusRegex = /(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+))?/;\nconst fileStatusAndSummaryRegex = /^(\\d+?|-)\\s+?(\\d+?|-)\\s+?(.*)(?:\\n\\s(delete|rename|create))?/;\nconst fileStatusAndSummaryRenamedFileRegex = /(.+)\\s=>\\s(.+)/;\nconst fileStatusAndSummaryRenamedFilePathRegex = /(.*?){(.+?)\\s=>\\s(.*?)}(.*)/;\n\nconst logFileSimpleRegex = /^<r> (.*)\\s*(?:(?:diff --git a\\/(.*) b\\/(.*))|(?:(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+))?))/gm;\nconst logFileSimpleRenamedRegex = /^<r> (\\S+)\\s*(.*)$/s;\nconst logFileSimpleRenamedFilesRegex = /^(\\S)\\S*\\t([^\\t\\n]+)(?:\\t(.+)?)$/gm;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\nconst sl = '%x2f'; // `%x${'/'.charCodeAt(0).toString(16)}`;\nconst sp = '%x20'; // `%x${' '.charCodeAt(0).toString(16)}`;\n\ninterface LogEntry {\n\tref?: string;\n\n\tauthor?: string;\n\tdate?: string;\n\tcommittedDate?: string;\n\temail?: string;\n\n\tparentShas?: string[];\n\n\tfileName?: string;\n\toriginalFileName?: string;\n\tfiles?: GitFile[];\n\n\tstatus?: GitFileStatus;\n\tfileStats?: {\n\t\tinsertions: number;\n\t\tdeletions: number;\n\t};\n\n\tsummary?: string;\n\n\tline?: GitLogCommitLine;\n}\n\nexport class GitLogParser {\n\tstatic defaultFormat = [\n\t\t`${lb}${sl}f${rb}`,\n\t\t`${lb}r${rb}${sp}%H`, // ref\n\t\t`${lb}a${rb}${sp}%aN`, // author\n\t\t`${lb}e${rb}${sp}%aE`, // email\n\t\t`${lb}d${rb}${sp}%at`, // date\n\t\t`${lb}c${rb}${sp}%ct`, // committed date\n\t\t`${lb}p${rb}${sp}%P`, // parents\n\t\t`${lb}s${rb}`,\n\t\t'%B', // summary\n\t\t`${lb}${sl}s${rb}`,\n\t\t`${lb}f${rb}`\n\t].join('%n');\n\n\tstatic simpleFormat = `${lb}r${rb}${sp}%H`;\n\n\t@debug({ args: false })\n\tstatic parse(\n\t\tdata: string,\n\t\ttype: GitCommitType,\n\t\trepoPath: string | undefined,\n\t\tfileName: string | undefined,\n\t\tsha: string | undefined,\n\t\tcurrentUser: { name?: string; email?: string } | undefined,\n\t\tmaxCount: number | undefined,\n\t\treverse: boolean,\n\t\trange: Range | undefined\n\t): GitLog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tlet relativeFileName: string;\n\t\tlet recentCommit: GitLogCommit | undefined = undefined;\n\n\t\tlet entry: LogEntry = emptyEntry;\n\t\tlet line: string | undefined = undefined;\n\t\tlet token: number;\n\n\t\tlet i = 0;\n\t\tlet first = true;\n\n\t\tconst lines = Strings.lines(`${data}</f>`);\n\t\t// Skip the first line since it will always be </f>\n\t\tlet next = lines.next();\n\t\tif (next.done) return undefined;\n\n\t\tif (repoPath !== undefined) {\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\t\t}\n\n\t\tconst authors: Map<string, GitAuthor> = new Map();\n\t\tconst commits: Map<string, GitLogCommit> = new Map();\n\t\tlet truncationCount = maxCount;\n\n\t\tlet match;\n\t\tlet renamedFileName;\n\t\tlet renamedMatch;\n\n\t\twhile (true) {\n\t\t\tnext = lines.next();\n\t\t\tif (next.done) break;\n\n\t\t\tline = next.value;\n\n\t\t\t// Since log --reverse doesn't properly honor a max count -- enforce it here\n\t\t\tif (reverse && maxCount && i >= maxCount) break;\n\n\t\t\t// <1-char token> data\n\t\t\t// e.g. <r> bd1452a2dc\n\t\t\ttoken = line.charCodeAt(1);\n\n\t\t\tswitch (token) {\n\t\t\t\tcase 114: // 'r': // ref\n\t\t\t\t\tentry = {\n\t\t\t\t\t\tref: line.substring(4)\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 97: // 'a': // author\n\t\t\t\t\tif (Git.isUncommitted(entry.ref)) {\n\t\t\t\t\t\tentry.author = 'You';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentry.author = line.substring(4);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 101: // 'e': // author-mail\n\t\t\t\t\tentry.email = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 100: // 'd': // author-date\n\t\t\t\t\tentry.date = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 99: // 'c': // committer-date\n\t\t\t\t\tentry.committedDate = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 112: // 'p': // parents\n\t\t\t\t\tentry.parentShas = line.substring(4).split(' ');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 115: // 's': // summary\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</s>') break;\n\n\t\t\t\t\t\tif (entry.summary === undefined) {\n\t\t\t\t\t\t\tentry.summary = line;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.summary += `\\n${line}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove the trailing newline\n\t\t\t\t\tif (entry.summary != null && entry.summary.charCodeAt(entry.summary.length - 1) === 10) {\n\t\t\t\t\t\tentry.summary = entry.summary.slice(0, -1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 102: {\n\t\t\t\t\t// 'f': // files\n\t\t\t\t\t// Skip the blank line git adds before the files\n\t\t\t\t\tnext = lines.next();\n\t\t\t\t\tif (next.done || next.value === '</f>') break;\n\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</f>') break;\n\n\t\t\t\t\t\tif (line.startsWith('warning:')) continue;\n\n\t\t\t\t\t\tif (type === GitCommitType.Log) {\n\t\t\t\t\t\t\tmatch = fileStatusRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\tif (entry.files === undefined) {\n\t\t\t\t\t\t\t\t\tentry.files = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\tif (renamedFileName !== undefined) {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: renamedFileName,\n\t\t\t\t\t\t\t\t\t\toriginalFileName: match[2]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: match[2]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmatch = diffRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\t[, entry.originalFileName, entry.fileName] = match;\n\t\t\t\t\t\t\t\tif (entry.fileName === entry.originalFileName) {\n\t\t\t\t\t\t\t\t\tentry.originalFileName = undefined;\n\t\t\t\t\t\t\t\t\tentry.status = 'M';\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.status = 'R';\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tvoid lines.next();\n\t\t\t\t\t\t\t\tvoid lines.next();\n\t\t\t\t\t\t\t\tnext = lines.next();\n\n\t\t\t\t\t\t\t\tmatch = diffRangeRegex.exec(next.value);\n\t\t\t\t\t\t\t\tif (match !== null) {\n\t\t\t\t\t\t\t\t\tentry.line = {\n\t\t\t\t\t\t\t\t\t\tfrom: {\n\t\t\t\t\t\t\t\t\t\t\tline: parseInt(match[1], 10),\n\t\t\t\t\t\t\t\t\t\t\tcount: parseInt(match[2], 10)\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tto: {\n\t\t\t\t\t\t\t\t\t\t\tline: parseInt(match[3], 10),\n\t\t\t\t\t\t\t\t\t\t\tcount: parseInt(match[4], 10)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\t\t\tif (next.done || next.value === '</f>') break;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\t\tmatch = fileStatusAndSummaryRegex.exec(`${line}\\n${next.value}`);\n\t\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\t\tentry.fileStats = {\n\t\t\t\t\t\t\t\t\t\tinsertions: Number(match[1]) || 0,\n\t\t\t\t\t\t\t\t\t\tdeletions: Number(match[2]) || 0\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tswitch (match[4]) {\n\t\t\t\t\t\t\t\t\t\tcase undefined:\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'M' as GitFileStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'rename':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'R' as GitFileStatus;\n\n\t\t\t\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\trenamedMatch = fileStatusAndSummaryRenamedFilePathRegex.exec(\n\t\t\t\t\t\t\t\t\t\t\t\trenamedFileName\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tif (renamedMatch != null) {\n\t\t\t\t\t\t\t\t\t\t\t\t// If there is no new path, the path part was removed so ensure we don't end up with //\n\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName =\n\t\t\t\t\t\t\t\t\t\t\t\t\trenamedMatch[3] === ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `${renamedMatch[1]}${renamedMatch[4]}`.replace('//', '/')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `${renamedMatch[1]}${renamedMatch[3]}${renamedMatch[4]}`;\n\t\t\t\t\t\t\t\t\t\t\t\tentry.originalFileName = `${renamedMatch[1]}${renamedMatch[2]}${renamedMatch[4]}`;\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\trenamedMatch = fileStatusAndSummaryRenamedFileRegex.exec(\n\t\t\t\t\t\t\t\t\t\t\t\t\trenamedFileName\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\tif (renamedMatch != null) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName = renamedMatch[2];\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.originalFileName = renamedMatch[1];\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tentry.fileName = renamedFileName;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'create':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'A' as GitFileStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'delete':\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'D' as GitFileStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\tentry.status = 'M' as GitFileStatus;\n\t\t\t\t\t\t\t\t\t\t\tentry.fileName = match[3];\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (next.done || next.value === '</f>') break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (entry.files !== undefined) {\n\t\t\t\t\t\tentry.fileName = Arrays.filterMap(entry.files, f => (f.fileName ? f.fileName : undefined)).join(\n\t\t\t\t\t\t\t', '\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (first && repoPath === undefined && type === GitCommitType.LogFile && fileName !== undefined) {\n\t\t\t\t\t\t// Try to get the repoPath from the most recent commit\n\t\t\t\t\t\trepoPath = Strings.normalizePath(\n\t\t\t\t\t\t\tfileName.replace(\n\t\t\t\t\t\t\t\tfileName.startsWith(slash) ? `/${entry.fileName}` : entry.fileName!,\n\t\t\t\t\t\t\t\temptyStr\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t\trelativeFileName = Strings.normalizePath(paths.relative(repoPath, fileName));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trelativeFileName = entry.fileName!;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = false;\n\n\t\t\t\t\tconst commit = commits.get(entry.ref!);\n\t\t\t\t\tif (commit === undefined) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t} else if (truncationCount) {\n\t\t\t\t\t\t// Since this matches an existing commit it will be skipped, so reduce our truncationCount to ensure accurate truncation detection\n\t\t\t\t\t\ttruncationCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\trecentCommit = GitLogParser.parseEntry(\n\t\t\t\t\t\tentry,\n\t\t\t\t\t\tcommit,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\trepoPath,\n\t\t\t\t\t\trelativeFileName,\n\t\t\t\t\t\tcommits,\n\t\t\t\t\t\tauthors,\n\t\t\t\t\t\trecentCommit,\n\t\t\t\t\t\tcurrentUser\n\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst log: GitLog = {\n\t\t\trepoPath: repoPath!,\n\t\t\tauthors: authors,\n\t\t\tcommits: commits,\n\t\t\tsha: sha,\n\t\t\tcount: i,\n\t\t\tmaxCount: maxCount,\n\t\t\trange: range,\n\t\t\ttruncated: Boolean(truncationCount && i >= truncationCount && truncationCount !== 1)\n\t\t};\n\t\treturn log;\n\t}\n\n\tprivate static parseEntry(\n\t\tentry: LogEntry,\n\t\tcommit: GitLogCommit | undefined,\n\t\ttype: GitCommitType,\n\t\trepoPath: string | undefined,\n\t\trelativeFileName: string,\n\t\tcommits: Map<string, GitLogCommit>,\n\t\tauthors: Map<string, GitAuthor>,\n\t\trecentCommit: GitLogCommit | undefined,\n\t\tcurrentUser: { name?: string; email?: string } | undefined\n\t): GitLogCommit | undefined {\n\t\tif (commit === undefined) {\n\t\t\tif (entry.author !== undefined) {\n\t\t\t\tif (\n\t\t\t\t\tcurrentUser !== undefined &&\n\t\t\t\t\t// Name or e-mail is configured\n\t\t\t\t\t(currentUser.name !== undefined || currentUser.email !== undefined) &&\n\t\t\t\t\t// Match on name if configured\n\t\t\t\t\t(currentUser.name === undefined || currentUser.name === entry.author) &&\n\t\t\t\t\t// Match on email if configured\n\t\t\t\t\t(currentUser.email === undefined || currentUser.email === entry.email)\n\t\t\t\t) {\n\t\t\t\t\tentry.author = 'You';\n\t\t\t\t}\n\n\t\t\t\tlet author = authors.get(entry.author);\n\t\t\t\tif (author === undefined) {\n\t\t\t\t\tauthor = {\n\t\t\t\t\t\tname: entry.author,\n\t\t\t\t\t\tlineCount: 0\n\t\t\t\t\t};\n\t\t\t\t\tauthors.set(entry.author, author);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst originalFileName =\n\t\t\t\tentry.originalFileName || (relativeFileName !== entry.fileName ? entry.fileName : undefined);\n\n\t\t\tif (type === GitCommitType.LogFile) {\n\t\t\t\tentry.files = [\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus: entry.status!,\n\t\t\t\t\t\tfileName: relativeFileName,\n\t\t\t\t\t\toriginalFileName: originalFileName\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tcommit = new GitLogCommit(\n\t\t\t\ttype,\n\t\t\t\trepoPath!,\n\t\t\t\tentry.ref!,\n\t\t\t\tentry.author!,\n\t\t\t\tentry.email,\n\t\t\t\tnew Date((entry.date! as any) * 1000),\n\t\t\t\tnew Date((entry.committedDate! as any) * 1000),\n\t\t\t\tentry.summary === undefined ? emptyStr : entry.summary,\n\t\t\t\trelativeFileName,\n\t\t\t\tentry.files || [],\n\t\t\t\tentry.status,\n\t\t\t\toriginalFileName,\n\t\t\t\ttype === GitCommitType.Log ? entry.parentShas![0] : undefined,\n\t\t\t\tundefined,\n\t\t\t\tentry.fileStats,\n\t\t\t\tentry.parentShas,\n\t\t\t\tentry.line\n\t\t\t);\n\n\t\t\tcommits.set(entry.ref!, commit);\n\t\t}\n\t\t// else {\n\t\t//     Logger.log(`merge commit? ${entry.sha}`);\n\t\t// }\n\n\t\tif (recentCommit !== undefined) {\n\t\t\t// If the commit sha's match (merge commit), just forward it along\n\t\t\tcommit.nextSha = commit.sha !== recentCommit.sha ? recentCommit.sha : recentCommit.nextSha;\n\n\t\t\t// Only add a filename if this is a file log\n\t\t\tif (type === GitCommitType.LogFile) {\n\t\t\t\trecentCommit.previousFileName = commit.originalFileName || commit.fileName;\n\t\t\t\tcommit.nextFileName = recentCommit.originalFileName || recentCommit.fileName;\n\t\t\t}\n\t\t}\n\t\treturn commit;\n\t}\n\n\t@debug({ args: false })\n\tstatic parseSimple(\n\t\tdata: string,\n\t\tskip: number,\n\t\tskipRef?: string\n\t): [string | undefined, string | undefined, GitFileStatus | undefined] {\n\t\tlet ref;\n\t\tlet diffFile;\n\t\tlet diffRenamed;\n\t\tlet status;\n\t\tlet file;\n\t\tlet renamed;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = logFileSimpleRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\tif (match[1] === skipRef) continue;\n\t\t\tif (skip-- > 0) continue;\n\n\t\t\t[, ref, diffFile, diffRenamed, status, file, renamed] = match;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tfile = ` ${diffRenamed || diffFile || renamed || file}`.substr(1);\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tstatus = status == null || status.length === 0 ? undefined : ` ${status}`.substr(1);\n\t\t} while (skip >= 0);\n\n\t\t// Ensure the regex state is reset\n\t\tlogFileSimpleRegex.lastIndex = 0;\n\n\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\treturn [\n\t\t\tref == null || ref.length === 0 ? undefined : ` ${ref}`.substr(1),\n\t\t\tfile,\n\t\t\tstatus as GitFileStatus | undefined\n\t\t];\n\t}\n\n\t@debug({ args: false })\n\tstatic parseSimpleRenamed(\n\t\tdata: string,\n\t\toriginalFileName: string\n\t): [string | undefined, string | undefined, GitFileStatus | undefined] {\n\t\tlet match = logFileSimpleRenamedRegex.exec(data);\n\t\tif (match == null) return [undefined, undefined, undefined];\n\n\t\tconst [, ref, files] = match;\n\n\t\tlet status;\n\t\tlet file;\n\t\tlet renamed;\n\n\t\tdo {\n\t\t\tmatch = logFileSimpleRenamedFilesRegex.exec(files);\n\t\t\tif (match == null) break;\n\n\t\t\t[, status, file, renamed] = match;\n\n\t\t\tif (originalFileName !== file) continue;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tfile = ` ${renamed || file}`.substr(1);\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\tstatus = status == null || status.length === 0 ? undefined : ` ${status}`.substr(1);\n\n\t\t\tbreak;\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\tlogFileSimpleRenamedFilesRegex.lastIndex = 0;\n\n\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\treturn [\n\t\t\tref == null || ref.length === 0 ? undefined : ` ${ref}`.substr(1),\n\t\t\tfile,\n\t\t\tstatus as GitFileStatus | undefined\n\t\t];\n\t}\n}\n","'use strict';\nimport { debug } from '../../system';\nimport { GitReflog, GitReflogRecord } from '../models/reflog';\n\nconst reflogRegex = /^<r>(.+)<d>(.+?)@{(.+)}<s>(\\w*)(.*?)(?::(.*))?$/gm;\n// const reflogRegex = /^<r>(.+)<d>(.+?)@{(.+)}<s>(\\w*)(.*?)(?::(.*))?<n>(.*)$/gm;\nconst reflogHEADRegex = /.*?\\/?HEAD$/;\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\n\nexport class GitReflogParser {\n\tstatic defaultFormat = [\n\t\t`${lb}r${rb}%H`, // ref\n\t\t`${lb}d${rb}%gD`, // reflog selector (with UNIX timestamp)\n\t\t`${lb}s${rb}%gs` // reflog subject\n\t\t// `${lb}n${rb}%D` // ref names\n\t].join('');\n\n\t@debug({ args: false })\n\tstatic parse(data: string, repoPath: string, commands: string[], maxCount: number): GitReflog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst records: GitReflogRecord[] = [];\n\n\t\tlet sha;\n\t\tlet selector;\n\t\tlet date;\n\t\tlet command;\n\t\tlet commandArgs;\n\t\tlet details;\n\n\t\tlet head;\n\t\tlet headDate;\n\t\tlet headSha;\n\n\t\tlet count = 0;\n\t\tlet recordDate;\n\t\tlet record: GitReflogRecord | undefined;\n\t\tlet truncated = false;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = reflogRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, sha, selector, date, command, commandArgs, details] = match;\n\n\t\t\tif (record !== undefined) {\n\t\t\t\t// If the next record has the same sha as the previous, use it if it is not pointing to just HEAD and the previous is\n\t\t\t\tif (\n\t\t\t\t\tsha === record.sha &&\n\t\t\t\t\t(date !== recordDate || !reflogHEADRegex.test(record.selector) || reflogHEADRegex.test(selector))\n\t\t\t\t) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (sha !== record.sha) {\n\t\t\t\t\tif (\n\t\t\t\t\t\thead != null &&\n\t\t\t\t\t\theadDate === recordDate &&\n\t\t\t\t\t\theadSha == record.sha &&\n\t\t\t\t\t\treflogHEADRegex.test(record.selector)\n\t\t\t\t\t) {\n\t\t\t\t\t\trecord.update(sha, head);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trecord.update(sha);\n\t\t\t\t\t}\n\n\t\t\t\t\trecords.push(record);\n\t\t\t\t\trecord = undefined;\n\t\t\t\t\trecordDate = undefined;\n\n\t\t\t\t\tcount++;\n\t\t\t\t\tif (maxCount !== 0 && count >= maxCount) {\n\t\t\t\t\t\ttruncated = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (command === 'HEAD') {\n\t\t\t\thead = selector;\n\t\t\t\theadDate = date;\n\t\t\t\theadSha = sha;\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (commands.includes(command)) {\n\t\t\t\trecord = new GitReflogRecord(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${sha}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${selector}`.substr(1),\n\t\t\t\t\tnew Date(Number(date) * 1000),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${command}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tcommandArgs == null || commandArgs.length === 0 ? undefined : commandArgs.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tdetails == null || details.length === 0 ? undefined : details.substr(1)\n\t\t\t\t);\n\t\t\t\trecordDate = date;\n\t\t\t}\n\t\t} while (true);\n\n\t\t// Ensure the regex state is reset\n\t\treflogRegex.lastIndex = 0;\n\n\t\treturn {\n\t\t\trepoPath: repoPath,\n\t\t\trecords: records,\n\t\t\tcount: count,\n\t\t\tmaxCount: maxCount,\n\t\t\ttruncated: truncated\n\t\t};\n\t}\n}\n","'use strict';\nimport { GitRemoteType } from '../models/remote';\nimport { RemoteProvider } from '../remotes/factory';\nimport { GitRemote } from '../git';\nimport { debug } from '../../system';\n\nconst emptyStr = '';\n\nconst remoteRegex = /^(.*)\\t(.*)\\s\\((.*)\\)$/gm;\nconst urlRegex = /^(?:(git:\\/\\/)(.*?)\\/|(https?:\\/\\/)(?:.*?@)?(.*?)\\/|git@(.*):|(ssh:\\/\\/)(?:.*@)?(.*?)(?::.*?)?(?:\\/|(?=~))|(?:.*?@)(.*?):)(.*)$/;\n\n// Test git urls\n/*\nhttp://host.xz/user/project.git\nhttp://host.xz/path/to/repo.git\nhttp://host.xz/path/to/repo.git/\nhttp://username@host.xz/user/project.git\nhttp://username:password@host.xz/user/project.git\nhttps://host.xz/user/project.git\nhttps://host.xz/path/to/repo.git\nhttps://host.xz/path/to/repo.git/\nhttps://username@host.xz/user/project.git\nhttps://username:password@host.xz/user/project.git\n\ngit@host.xz:user/project.git\ngit://host.xz/path/to/repo.git/\ngit://host.xz/~user/path/to/repo.git/\n\nssh://host.xz/project.git\nssh://host.xz/path/to/repo.git\nssh://host.xz/path/to/repo.git/\nssh://host.xz:~project.git\nssh://host.xz:port/path/to/repo.git/\nssh://user@host.xz/project.git\nssh://user@host.xz/path/to/repo.git\nssh://user@host.xz/path/to/repo.git/\nssh://user@host.xz:port/path/to/repo.git/\nssh://user:password@host.xz/project.git\nssh://user:password@host.xz/path/to/repo.git\nssh://user:password@host.xz/path/to/repo.git/\n\nuser@host.xz:project.git\nuser@host.xz:path/to/repo.git\nuser@host.xz:/path/to/repo.git/\nuser:password@host.xz:project.git\nuser:password@host.xz:/path/to/repo.git\nuser:password@host.xz:/path/to/repo.git/\n*/\n\nexport class GitRemoteParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(\n\t\tdata: string,\n\t\trepoPath: string,\n\t\tproviderFactory: (domain: string, path: string) => RemoteProvider | undefined\n\t): GitRemote[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst remotes: GitRemote[] = [];\n\t\tconst groups = Object.create(null);\n\n\t\tlet name;\n\t\tlet url;\n\t\tlet type;\n\n\t\tlet scheme;\n\t\tlet domain;\n\t\tlet path;\n\n\t\tlet uniqueness;\n\t\tlet remote: GitRemote | undefined;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = remoteRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, name, url, type] = match;\n\n\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\turl = ` ${url}`.substr(1);\n\n\t\t\t[scheme, domain, path] = this.parseGitUrl(url);\n\n\t\t\tuniqueness = `${domain ? `${domain}/` : ''}${path}`;\n\t\t\tremote = groups[uniqueness];\n\t\t\tif (remote === undefined) {\n\t\t\t\tconst provider = providerFactory(domain, path);\n\n\t\t\t\tremote = new GitRemote(\n\t\t\t\t\trepoPath,\n\t\t\t\t\tuniqueness,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\tscheme,\n\t\t\t\t\tprovider !== undefined ? provider.domain : domain,\n\t\t\t\t\tprovider !== undefined ? provider.path : path,\n\t\t\t\t\tprovider,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t[{ url: url, type: ` ${type}`.substr(1) as GitRemoteType }]\n\t\t\t\t);\n\t\t\t\tremotes.push(remote);\n\t\t\t\tgroups[uniqueness] = remote;\n\t\t\t} else {\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tremote.types.push({ url: url, type: ` ${type}`.substr(1) as GitRemoteType });\n\t\t\t}\n\t\t} while (true);\n\n\t\treturn remotes;\n\t}\n\n\tstatic parseGitUrl(url: string): [string, string, string] {\n\t\tconst match = urlRegex.exec(url);\n\t\tif (match == null) return [emptyStr, emptyStr, url];\n\n\t\treturn [\n\t\t\tmatch[1] || match[3] || match[6],\n\t\t\tmatch[2] || match[4] || match[5] || match[7] || match[8],\n\t\t\tmatch[9].replace(/\\.git\\/?$/, emptyStr)\n\t\t];\n\t}\n}\n","'use strict';\nimport { GitContributor, GitShortLog } from '../git';\nimport { debug } from '../../system';\n\nconst shortlogRegex = /^(.*?)\\t(.*?) <(.*?)>$/gm;\n\nexport class GitShortLogParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitShortLog | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst contributors: GitContributor[] = [];\n\n\t\tlet count;\n\t\tlet name;\n\t\tlet email;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = shortlogRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, count, name, email] = match;\n\n\t\t\tcontributors.push(\n\t\t\t\tnew GitContributor(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${email}`.substr(1),\n\t\t\t\t\tNumber(count) || 0\n\t\t\t\t)\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn { repoPath: repoPath, contributors: contributors };\n\t}\n}\n","'use strict';\nimport { fileStatusRegex, GitCommitType, GitFile, GitFileStatus, GitStash, GitStashCommit } from '../git';\nimport { Arrays, debug, Strings } from '../../system';\n// import { Logger } from './logger';\n\n// Using %x00 codes because some shells seem to try to expand things if not\nconst lb = '%x3c'; // `%x${'<'.charCodeAt(0).toString(16)}`;\nconst rb = '%x3e'; // `%x${'>'.charCodeAt(0).toString(16)}`;\nconst sl = '%x2f'; // `%x${'/'.charCodeAt(0).toString(16)}`;\nconst sp = '%x20'; // `%x${' '.charCodeAt(0).toString(16)}`;\n\nconst emptyStr = '';\nconst emptyEntry: StashEntry = {};\n\ninterface StashEntry {\n\tref?: string;\n\tdate?: string;\n\tcommittedDate?: string;\n\tfileNames?: string;\n\tfiles?: GitFile[];\n\tsummary?: string;\n\tstashName?: string;\n}\n\nexport class GitStashParser {\n\tstatic defaultFormat = [\n\t\t`${lb}${sl}f${rb}`,\n\t\t`${lb}r${rb}${sp}%H`, // ref\n\t\t`${lb}d${rb}${sp}%at`, // date\n\t\t`${lb}c${rb}${sp}%ct`, // committed date\n\t\t`${lb}l${rb}${sp}%gd`, // reflog-selector\n\t\t`${lb}s${rb}`,\n\t\t'%B', // summary\n\t\t`${lb}${sl}s${rb}`,\n\t\t`${lb}f${rb}`\n\t].join('%n');\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitStash | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst lines = Strings.lines(`${data}</f>`);\n\t\t// Skip the first line since it will always be </f>\n\t\tlet next = lines.next();\n\t\tif (next.done) return undefined;\n\n\t\tif (repoPath !== undefined) {\n\t\t\trepoPath = Strings.normalizePath(repoPath);\n\t\t}\n\n\t\tconst commits: Map<string, GitStashCommit> = new Map();\n\n\t\tlet entry: StashEntry = emptyEntry;\n\t\tlet line: string | undefined = undefined;\n\t\tlet token: number;\n\n\t\tlet match;\n\t\tlet renamedFileName;\n\n\t\twhile (true) {\n\t\t\tnext = lines.next();\n\t\t\tif (next.done) break;\n\n\t\t\tline = next.value;\n\n\t\t\t// <<1-char token>> <data>\n\t\t\t// e.g. <r> bd1452a2dc\n\t\t\ttoken = line.charCodeAt(1);\n\n\t\t\tswitch (token) {\n\t\t\t\tcase 114: // 'r': // ref\n\t\t\t\t\tentry = {\n\t\t\t\t\t\tref: line.substring(4)\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 100: // 'd': // author-date\n\t\t\t\t\tentry.date = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 99: // 'c': // committer-date\n\t\t\t\t\tentry.committedDate = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 108: // 'l': // reflog-selector\n\t\t\t\t\tentry.stashName = line.substring(4);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 115: // 's': // summary\n\t\t\t\t\twhile (true) {\n\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\tif (line === '</s>') break;\n\n\t\t\t\t\t\tif (entry.summary === undefined) {\n\t\t\t\t\t\t\tentry.summary = line;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tentry.summary += `\\n${line}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove the trailing newline\n\t\t\t\t\tif (entry.summary != null && entry.summary.charCodeAt(entry.summary.length - 1) === 10) {\n\t\t\t\t\t\tentry.summary = entry.summary.slice(0, -1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 102: // 'f': // files\n\t\t\t\t\t// Skip the blank line git adds before the files\n\t\t\t\t\tnext = lines.next();\n\t\t\t\t\tif (!next.done && next.value !== '</f>') {\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\tnext = lines.next();\n\t\t\t\t\t\t\tif (next.done) break;\n\n\t\t\t\t\t\t\tline = next.value;\n\t\t\t\t\t\t\tif (line === '</f>') break;\n\n\t\t\t\t\t\t\tif (line.startsWith('warning:')) continue;\n\n\t\t\t\t\t\t\tmatch = fileStatusRegex.exec(line);\n\t\t\t\t\t\t\tif (match != null) {\n\t\t\t\t\t\t\t\tif (entry.files === undefined) {\n\t\t\t\t\t\t\t\t\tentry.files = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trenamedFileName = match[3];\n\t\t\t\t\t\t\t\tif (renamedFileName !== undefined) {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: renamedFileName,\n\t\t\t\t\t\t\t\t\t\toriginalFileName: match[2]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tentry.files.push({\n\t\t\t\t\t\t\t\t\t\tstatus: match[1] as GitFileStatus,\n\t\t\t\t\t\t\t\t\t\tfileName: match[2]\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (entry.files !== undefined) {\n\t\t\t\t\t\t\tentry.fileNames = Arrays.filterMap(entry.files, f =>\n\t\t\t\t\t\t\t\tf.fileName ? f.fileName : undefined\n\t\t\t\t\t\t\t).join(', ');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tGitStashParser.parseEntry(entry, repoPath, commits);\n\t\t\t}\n\t\t}\n\n\t\tconst stash: GitStash = {\n\t\t\trepoPath: repoPath,\n\t\t\tcommits: commits\n\t\t};\n\t\treturn stash;\n\t}\n\n\tprivate static parseEntry(entry: StashEntry, repoPath: string, commits: Map<string, GitStashCommit>) {\n\t\tlet commit = commits.get(entry.ref!);\n\t\tif (commit === undefined) {\n\t\t\tcommit = new GitStashCommit(\n\t\t\t\tGitCommitType.Stash,\n\t\t\t\tentry.stashName!,\n\t\t\t\trepoPath,\n\t\t\t\tentry.ref!,\n\t\t\t\tnew Date((entry.date! as any) * 1000),\n\t\t\t\tnew Date((entry.committedDate! as any) * 1000),\n\t\t\t\tentry.summary === undefined ? emptyStr : entry.summary,\n\t\t\t\tentry.fileNames!,\n\t\t\t\tentry.files || []\n\t\t\t);\n\t\t}\n\n\t\tcommits.set(entry.ref!, commit);\n\t}\n}\n","'use strict';\nimport { debug, Strings } from '../../system';\nimport { GitFileStatus, GitStatus, GitStatusFile } from '../git';\n\nconst emptyStr = '';\n\nconst aheadStatusV1Regex = /(?:ahead ([0-9]+))/;\nconst behindStatusV1Regex = /(?:behind ([0-9]+))/;\n\nexport class GitStatusParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string, porcelainVersion: number): GitStatus | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst lines = data.split('\\n').filter(Boolean);\n\t\tif (lines.length === 0) return undefined;\n\n\t\tif (porcelainVersion < 2) return this.parseV1(lines, repoPath);\n\n\t\treturn this.parseV2(lines, repoPath);\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tprivate static parseV1(lines: string[], repoPath: string): GitStatus {\n\t\tlet branch: string | undefined;\n\t\tconst files = [];\n\t\tconst state = {\n\t\t\tahead: 0,\n\t\t\tbehind: 0\n\t\t};\n\t\tlet upstream;\n\n\t\tlet position = -1;\n\t\twhile (++position < lines.length) {\n\t\t\tconst line = lines[position];\n\t\t\t// Header\n\t\t\tif (line.startsWith('##')) {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\t[branch, upstream] = lineParts[1].split('...');\n\t\t\t\tif (lineParts.length > 2) {\n\t\t\t\t\tconst upstreamStatus = lineParts.slice(2).join(' ');\n\n\t\t\t\t\tconst aheadStatus = aheadStatusV1Regex.exec(upstreamStatus);\n\t\t\t\t\tstate.ahead = aheadStatus == null ? 0 : Number(aheadStatus[1]) || 0;\n\n\t\t\t\t\tconst behindStatus = behindStatusV1Regex.exec(upstreamStatus);\n\t\t\t\t\tstate.behind = behindStatus == null ? 0 : Number(behindStatus[1]) || 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst rawStatus = line.substring(0, 2);\n\t\t\t\tconst fileName = line.substring(3);\n\t\t\t\tif (rawStatus.startsWith('R')) {\n\t\t\t\t\tconst [file1, file2] = fileName.replace(/\"/g, emptyStr).split('->');\n\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, rawStatus, file2.trim(), file1.trim()));\n\t\t\t\t} else {\n\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, rawStatus, fileName));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatus(Strings.normalizePath(repoPath), branch || emptyStr, emptyStr, files, state, upstream);\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tprivate static parseV2(lines: string[], repoPath: string): GitStatus {\n\t\tlet branch: string | undefined;\n\t\tconst files = [];\n\t\tlet sha: string | undefined;\n\t\tconst state = {\n\t\t\tahead: 0,\n\t\t\tbehind: 0\n\t\t};\n\t\tlet upstream;\n\n\t\tlet position = -1;\n\t\twhile (++position < lines.length) {\n\t\t\tconst line = lines[position];\n\t\t\t// Headers\n\t\t\tif (line.startsWith('#')) {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\tswitch (lineParts[1]) {\n\t\t\t\t\tcase 'branch.oid':\n\t\t\t\t\t\tsha = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.head':\n\t\t\t\t\t\tbranch = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.upstream':\n\t\t\t\t\t\tupstream = lineParts[2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'branch.ab':\n\t\t\t\t\t\tstate.ahead = Number(lineParts[2].substring(1));\n\t\t\t\t\t\tstate.behind = Number(lineParts[3].substring(1));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst lineParts = line.split(' ');\n\t\t\t\tswitch (lineParts[0][0]) {\n\t\t\t\t\tcase '1': // normal\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], lineParts.slice(8).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '2': {\n\t\t\t\t\t\t// rename\n\t\t\t\t\t\tconst file = lineParts\n\t\t\t\t\t\t\t.slice(9)\n\t\t\t\t\t\t\t.join(' ')\n\t\t\t\t\t\t\t.split('\\t');\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], file[0], file[1]));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase 'u': // unmerged\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, lineParts[1], lineParts.slice(10).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '?': // untracked\n\t\t\t\t\t\tfiles.push(this.parseStatusFile(repoPath, ' ?', lineParts.slice(1).join(' ')));\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatus(\n\t\t\tStrings.normalizePath(repoPath),\n\t\t\tbranch || emptyStr,\n\t\t\tsha || emptyStr,\n\t\t\tfiles,\n\t\t\tstate,\n\t\t\tupstream\n\t\t);\n\t}\n\n\tstatic parseStatusFile(\n\t\trepoPath: string,\n\t\trawStatus: string,\n\t\tfileName: string,\n\t\toriginalFileName?: string\n\t): GitStatusFile {\n\t\tlet indexStatus = !rawStatus.startsWith('.') ? rawStatus[0].trim() : undefined;\n\t\tif (indexStatus == null || indexStatus.length === 0) {\n\t\t\tindexStatus = undefined;\n\t\t}\n\n\t\tlet workTreeStatus = undefined;\n\t\tif (rawStatus.length > 1) {\n\t\t\tworkTreeStatus = rawStatus[1] !== '.' ? rawStatus[1].trim() : undefined;\n\t\t\tif (workTreeStatus == null || workTreeStatus.length === 0) {\n\t\t\t\tworkTreeStatus = undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn new GitStatusFile(\n\t\t\trepoPath,\n\t\t\tindexStatus as GitFileStatus | undefined,\n\t\t\tworkTreeStatus as GitFileStatus | undefined,\n\t\t\tfileName,\n\t\t\toriginalFileName\n\t\t);\n\t}\n}\n","'use strict';\nimport { GitTag } from '../git';\nimport { debug } from '../../system';\n\nconst tagWithRefRegex = /([0-9,a-f]+)\\srefs\\/tags\\/(.*)/gm;\nconst tagWithAnnotationRegex = /^(.+?)(?:$|(?:\\s+)(.*)$)/gm;\n\nexport class GitTagParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, repoPath: string): GitTag[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst tags: GitTag[] = [];\n\n\t\tlet name;\n\t\tlet annotation;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = tagWithAnnotationRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, name, annotation] = match;\n\n\t\t\ttags.push(\n\t\t\t\tnew GitTag(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\tundefined,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\tannotation == null || annotation.length === 0 ? undefined : ` ${annotation}`.substr(1)\n\t\t\t\t)\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn tags;\n\t}\n\n\tstatic parseWithRef(data: string, repoPath: string): GitTag[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst tags: GitTag[] = [];\n\n\t\tlet sha;\n\t\tlet name;\n\n\t\tlet match: RegExpExecArray | null;\n\t\tdo {\n\t\t\tmatch = tagWithRefRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, sha, name] = match;\n\n\t\t\ttags.push(\n\t\t\t\tnew GitTag(\n\t\t\t\t\trepoPath,\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${name}`.substr(1),\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${sha}`.substr(1)\n\t\t\t\t)\n\t\t\t);\n\t\t} while (true);\n\n\t\treturn tags;\n\t}\n}\n","'use strict';\nimport { GitTree } from '../git';\nimport { debug } from '../../system';\n\nconst emptyStr = '';\nconst treeRegex = /(?:.+?)\\s+(.+?)\\s+(.+?)\\s+(.+?)\\s+(.+)/gm;\n\nexport class GitTreeParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string | undefined): GitTree[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst trees: GitTree[] = [];\n\n\t\tlet type;\n\t\tlet sha;\n\t\tlet size;\n\t\tlet filePath;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = treeRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, type, sha, size, filePath] = match;\n\n\t\t\ttrees.push({\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tcommitSha: sha == null || sha.length === 0 ? emptyStr : ` ${sha}`.substr(1),\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tpath: filePath == null || filePath.length === 0 ? emptyStr : ` ${filePath}`.substr(1),\n\t\t\t\tsize: Number(size) || 0,\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\ttype: (type == null || type.length === 0 ? emptyStr : ` ${type}`.substr(1)) as 'blob' | 'tree'\n\t\t\t});\n\t\t} while (true);\n\n\t\treturn trees;\n\t}\n}\n","'use strict';\n\nexport * from './blameParser';\nexport * from './branchParser';\nexport * from './diffParser';\nexport * from './logParser';\nexport * from './reflogParser';\nexport * from './remoteParser';\nexport * from './shortlogParser';\nexport * from './stashParser';\nexport * from './statusParser';\nexport * from './tagParser';\nexport * from './treeParser';\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","module.exports = require(\"fs\");","'use strict';\nimport { TraceLevel } from './logger';\n\nexport interface Config {\n\tblame: {\n\t\tavatars: boolean;\n\t\tcompact: boolean;\n\t\tdateFormat: string | null;\n\t\tformat: string;\n\t\theatmap: {\n\t\t\tenabled: boolean;\n\t\t\tlocation: 'left' | 'right';\n\t\t};\n\t\thighlight: {\n\t\t\tenabled: boolean;\n\t\t\tlocations: HighlightLocations[];\n\t\t};\n\t\tignoreWhitespace: boolean;\n\t\tseparateLines: boolean;\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\tcurrentLine: {\n\t\tdateFormat: string | null;\n\t\tenabled: boolean;\n\t\tformat: string;\n\t\tscrollable: boolean;\n\t};\n\tcodeLens: CodeLensConfig;\n\tdebug: boolean;\n\tdefaultDateFormat: string | null;\n\tdefaultDateShortFormat: string | null;\n\tdefaultDateSource: DateSource;\n\tdefaultDateStyle: DateStyle;\n\tdefaultGravatarsStyle: GravatarDefaultStyle;\n\tgitCommands: {\n\t\tcloseOnFocusOut: boolean;\n\t\tsearch: {\n\t\t\tmatchAll: boolean;\n\t\t\tmatchCase: boolean;\n\t\t\tmatchRegex: boolean;\n\t\t\tshowResultsInView: boolean;\n\t\t};\n\t\tskipConfirmations: string[];\n\t};\n\theatmap: {\n\t\tageThreshold: number;\n\t\tcoldColor: string;\n\t\thotColor: string;\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\thovers: {\n\t\tannotations: {\n\t\t\tchanges: boolean;\n\t\t\tdetails: boolean;\n\t\t\tenabled: boolean;\n\t\t\tover: 'line' | 'annotation';\n\t\t};\n\t\tcurrentLine: {\n\t\t\tchanges: boolean;\n\t\t\tdetails: boolean;\n\t\t\tenabled: boolean;\n\t\t\tover: 'line' | 'annotation';\n\t\t};\n\t\tavatars: boolean;\n\t\tchangesDiff: 'line' | 'hunk';\n\t\tdetailsMarkdownFormat: string;\n\t\tenabled: boolean;\n\t};\n\tinsiders: boolean;\n\tkeymap: KeyMap;\n\tliveshare: {\n\t\tallowGuestAccess: boolean;\n\t};\n\tmenus: boolean | MenuConfig;\n\tmode: {\n\t\tactive: string;\n\t\tstatusBar: {\n\t\t\tenabled: boolean;\n\t\t\talignment: 'left' | 'right';\n\t\t};\n\t};\n\tmodes: { [key: string]: ModeConfig };\n\toutputLevel: TraceLevel;\n\trecentChanges: {\n\t\thighlight: {\n\t\t\tlocations: HighlightLocations[];\n\t\t};\n\t\ttoggleMode: AnnotationsToggleMode;\n\t};\n\tremotes: RemotesConfig[];\n\tshowWhatsNewAfterUpgrades: boolean;\n\tsortBranchesBy: BranchSorting;\n\tsortTagsBy: TagSorting;\n\tstatusBar: {\n\t\talignment: 'left' | 'right';\n\t\tcommand: StatusBarCommand;\n\t\tdateFormat: string | null;\n\t\tenabled: boolean;\n\t\tformat: string;\n\t\treduceFlicker: boolean;\n\t};\n\tstrings: {\n\t\tcodeLens: {\n\t\t\tunsavedChanges: {\n\t\t\t\trecentChangeAndAuthors: string;\n\t\t\t\trecentChangeOnly: string;\n\t\t\t\tauthorsOnly: string;\n\t\t\t};\n\t\t};\n\t};\n\tviews: ViewsConfig;\n\tadvanced: AdvancedConfig;\n}\n\nexport enum AnnotationsToggleMode {\n\tFile = 'file',\n\tWindow = 'window'\n}\n\nexport enum BranchSorting {\n\tNameDesc = 'name:desc',\n\tNameAsc = 'name:asc',\n\tDateDesc = 'date:desc',\n\tDateAsc = 'date:asc'\n}\n\nexport enum CodeLensCommand {\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tRevealCommitInView = 'gitlens.revealCommitInView',\n\tShowCommitsInView = 'gitlens.showCommitsInView',\n\tShowQuickCommitDetails = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFileDetails = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tToggleFileBlame = 'gitlens.toggleFileBlame'\n}\n\nexport enum CodeLensScopes {\n\tDocument = 'document',\n\tContainers = 'containers',\n\tBlocks = 'blocks'\n}\n\nexport enum CustomRemoteType {\n\tBitbucket = 'Bitbucket',\n\tBitbucketServer = 'BitbucketServer',\n\tCustom = 'Custom',\n\tGitHub = 'GitHub',\n\tGitLab = 'GitLab'\n}\n\nexport enum DateSource {\n\tAuthored = 'authored',\n\tCommitted = 'committed'\n}\n\nexport enum DateStyle {\n\tAbsolute = 'absolute',\n\tRelative = 'relative'\n}\n\nexport enum FileAnnotationType {\n\tBlame = 'blame',\n\tHeatmap = 'heatmap',\n\tRecentChanges = 'recentChanges'\n}\n\nexport enum GravatarDefaultStyle {\n\tFaces = 'wavatar',\n\tGeometric = 'identicon',\n\tMonster = 'monsterid',\n\tMysteryPerson = 'mp',\n\tRetro = 'retro',\n\tRobot = 'robohash'\n}\n\nexport enum HighlightLocations {\n\tGutter = 'gutter',\n\tLine = 'line',\n\tOverview = 'overview'\n}\n\nexport enum KeyMap {\n\tAlternate = 'alternate',\n\tChorded = 'chorded',\n\tNone = 'none'\n}\n\nexport enum StatusBarCommand {\n\tDiffWithPrevious = 'gitlens.diffWithPrevious',\n\tDiffWithWorking = 'gitlens.diffWithWorking',\n\tShowQuickCommitDetails = 'gitlens.showQuickCommitDetails',\n\tShowQuickCommitFileDetails = 'gitlens.showQuickCommitFileDetails',\n\tShowQuickCurrentBranchHistory = 'gitlens.showQuickRepoHistory',\n\tShowQuickFileHistory = 'gitlens.showQuickFileHistory',\n\tToggleCodeLens = 'gitlens.toggleCodeLens',\n\tToggleFileBlame = 'gitlens.toggleFileBlame'\n}\n\nexport enum TagSorting {\n\tNameDesc = 'name:desc',\n\tNameAsc = 'name:asc'\n}\n\nexport enum ViewBranchesLayout {\n\tList = 'list',\n\tTree = 'tree'\n}\n\nexport enum ViewFilesLayout {\n\tAuto = 'auto',\n\tList = 'list',\n\tTree = 'tree'\n}\n\nexport enum ViewLocation {\n\tExplorer = 'explorer',\n\tGitLens = 'gitlens',\n\tSourceControl = 'scm'\n}\n\nexport enum ViewShowBranchComparison {\n\tBranch = 'branch',\n\tWorking = 'working'\n}\n\nexport interface AdvancedConfig {\n\tabbreviatedShaLength: number;\n\tblame: {\n\t\tcustomArguments: string[] | null;\n\t\tdelayAfterEdit: number;\n\t\tsizeThresholdAfterEdit: number;\n\t};\n\tcaching: {\n\t\tenabled: boolean;\n\t};\n\tfileHistoryFollowsRenames: boolean;\n\tmaxListItems: number;\n\tmaxSearchItems: number;\n\tmessages: {\n\t\tsuppressCommitHasNoPreviousCommitWarning: boolean;\n\t\tsuppressCommitNotFoundWarning: boolean;\n\t\tsuppressFileNotUnderSourceControlWarning: boolean;\n\t\tsuppressGitDisabledWarning: boolean;\n\t\tsuppressGitVersionWarning: boolean;\n\t\tsuppressLineUncommittedWarning: boolean;\n\t\tsuppressNoRepositoryWarning: boolean;\n\t\tsuppressSupportGitLensNotification: boolean;\n\t};\n\tquickPick: {\n\t\tcloseOnFocusOut: boolean;\n\t};\n\trepositorySearchDepth: number;\n\tsimilarityThreshold: number;\n\ttelemetry: {\n\t\tenabled: boolean;\n\t};\n\tuseSymmetricDifferenceNotation: boolean;\n}\n\nexport interface CodeLensConfig {\n\tauthors: {\n\t\tenabled: boolean;\n\t\tcommand: CodeLensCommand;\n\t};\n\tenabled: boolean;\n\tincludeSingleLineSymbols: boolean;\n\trecentChange: {\n\t\tenabled: boolean;\n\t\tcommand: CodeLensCommand;\n\t};\n\tscopes: CodeLensScopes[];\n\tscopesByLanguage: CodeLensLanguageScope[];\n\tsymbolScopes: string[];\n}\n\nexport interface CodeLensLanguageScope {\n\tlanguage: string | undefined;\n\tscopes?: CodeLensScopes[];\n\tsymbolScopes?: string[];\n}\n\nexport interface CompareViewConfig {\n\tavatars: boolean;\n\tenabled: boolean;\n\tfiles: ViewsFilesConfig;\n\tlocation: ViewLocation;\n}\n\nexport interface FileHistoryViewConfig {\n\tavatars: boolean;\n\tenabled: boolean;\n\tlocation: ViewLocation;\n}\n\nexport interface LineHistoryViewConfig {\n\tavatars: boolean;\n\tenabled: boolean;\n\tlocation: ViewLocation;\n}\n\nexport interface MenuConfig {\n\teditor:\n\t\t| false\n\t\t| {\n\t\t\t\tblame: boolean;\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\tdetails: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\teditorGroup:\n\t\t| false\n\t\t| {\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t  };\n\teditorTab:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\texplorer:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t  };\n\tscmGroup:\n\t\t| false\n\t\t| {\n\t\t\t\tcompare: boolean;\n\t\t\t\topenClose: boolean;\n\t\t\t\tstash: boolean;\n\t\t\t\tstashInline: boolean;\n\t\t  };\n\tscmItem:\n\t\t| false\n\t\t| {\n\t\t\t\tclipboard: boolean;\n\t\t\t\tcompare: boolean;\n\t\t\t\thistory: boolean;\n\t\t\t\tremote: boolean;\n\t\t\t\tstash: boolean;\n\t\t  };\n}\n\nexport interface ModeConfig {\n\tname: string;\n\tstatusBarItemName?: string;\n\tdescription?: string;\n\tannotations?: 'blame' | 'heatmap' | 'recentChanges';\n\tcodeLens?: boolean;\n\tcurrentLine?: boolean;\n\thovers?: boolean;\n\tstatusBar?: boolean;\n\tviews?: boolean;\n}\n\nexport interface RemotesConfig {\n\tdomain: string;\n\tname?: string;\n\tprotocol?: string;\n\ttype: CustomRemoteType;\n\turls?: RemotesUrlsConfig;\n}\n\nexport interface RemotesUrlsConfig {\n\trepository: string;\n\tbranches: string;\n\tbranch: string;\n\tcommit: string;\n\tfile: string;\n\tfileInBranch: string;\n\tfileInCommit: string;\n\tfileLine: string;\n\tfileRange: string;\n}\n\nexport interface RepositoriesViewConfig {\n\tautoRefresh: boolean;\n\tautoReveal: boolean;\n\tavatars: boolean;\n\tbranches: {\n\t\tlayout: ViewBranchesLayout;\n\t};\n\tcompact: boolean;\n\tenabled: boolean;\n\tfiles: ViewsFilesConfig;\n\tincludeWorkingTree: boolean;\n\tlocation: ViewLocation;\n\tshowBranchComparison: false | ViewShowBranchComparison;\n\tshowTrackingBranch: boolean;\n}\n\nexport interface SearchViewConfig {\n\tavatars: boolean;\n\tenabled: boolean;\n\tfiles: ViewsFilesConfig;\n\tlocation: ViewLocation;\n}\n\nexport interface ViewsConfig {\n\tfileHistory: FileHistoryViewConfig;\n\tcommitFileDescriptionFormat: string;\n\tcommitFileFormat: string;\n\tcommitDescriptionFormat: string;\n\tcommitFormat: string;\n\tcompare: CompareViewConfig;\n\tdefaultItemLimit: number;\n\tlineHistory: LineHistoryViewConfig;\n\tpageItemLimit: number;\n\trepositories: RepositoriesViewConfig;\n\tsearch: SearchViewConfig;\n\tshowRelativeDateMarkers: boolean;\n\tstashFileDescriptionFormat: string;\n\tstashFileFormat: string;\n\tstashDescriptionFormat: string;\n\tstashFormat: string;\n\tstatusFileDescriptionFormat: string;\n\tstatusFileFormat: string;\n}\n\nexport interface ViewsFilesConfig {\n\tcompact: boolean;\n\tlayout: ViewFilesLayout;\n\tthreshold: number;\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { configuration, DateSource, DateStyle, GravatarDefaultStyle } from '../../configuration';\nimport { Container } from '../../container';\nimport { Dates, memoize } from '../../system';\nimport { CommitFormatter } from '../formatters/formatters';\nimport { Git } from '../git';\nimport { GitUri } from '../gitUri';\nimport { getAvatarUri } from '../../avatars';\nimport { GitReference } from './models';\n\nexport interface GitAuthor {\n\tname: string;\n\tlineCount: number;\n}\n\nexport interface GitCommitLine {\n\tsha: string;\n\tpreviousSha?: string;\n\tline: number;\n\toriginalLine: number;\n\tcode?: string;\n}\n\nexport enum GitCommitType {\n\tBlame = 'blame',\n\tLog = 'log',\n\tLogFile = 'logFile',\n\tStash = 'stash',\n\tStashFile = 'stashFile'\n}\n\nexport const CommitDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateSource: undefined! as DateSource,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tCommitDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tCommitDateFormatting.dateSource = configuration.get('defaultDateSource');\n\t\tCommitDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t}\n};\n\nexport abstract class GitCommit implements GitReference {\n\tstatic is(commit: any): commit is GitCommit {\n\t\treturn commit instanceof GitCommit;\n\t}\n\n\tstatic isOfRefType(branch: GitReference | undefined) {\n\t\treturn branch !== undefined && branch.refType === 'revision';\n\t}\n\n\treadonly refType = 'revision';\n\n\tconstructor(\n\t\tpublic readonly type: GitCommitType,\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly sha: string,\n\t\tpublic readonly author: string,\n\t\tpublic readonly email: string | undefined,\n\t\tpublic readonly authorDate: Date,\n\t\tpublic readonly committerDate: Date,\n\t\tpublic readonly message: string,\n\t\tfileName: string,\n\t\tpublic readonly originalFileName: string | undefined,\n\t\tpublic previousSha: string | undefined,\n\t\tpublic previousFileName: string | undefined\n\t) {\n\t\tthis._fileName = fileName || '';\n\t}\n\n\tget ref() {\n\t\treturn this.sha;\n\t}\n\n\tget name() {\n\t\treturn this.shortSha;\n\t}\n\n\tprivate readonly _fileName: string;\n\tget fileName() {\n\t\t// If we aren't a single-file commit, return an empty file name (makes it default to the repoPath)\n\t\treturn this.isFile ? this._fileName : '';\n\t}\n\n\tget date(): Date {\n\t\treturn CommitDateFormatting.dateSource === DateSource.Committed ? this.committerDate : this.authorDate;\n\t}\n\n\tget formattedDate(): string {\n\t\treturn CommitDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(CommitDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn Git.shortenSha(this.sha);\n\t}\n\n\tget isFile() {\n\t\treturn (\n\t\t\tthis.type === GitCommitType.Blame ||\n\t\t\tthis.type === GitCommitType.LogFile ||\n\t\t\tthis.type === GitCommitType.StashFile\n\t\t);\n\t}\n\n\tget isStash() {\n\t\treturn this.type === GitCommitType.Stash || this.type === GitCommitType.StashFile;\n\t}\n\n\t@memoize()\n\tget isUncommitted(): boolean {\n\t\treturn Git.isUncommitted(this.sha);\n\t}\n\n\t@memoize()\n\tget isUncommittedStaged(): boolean {\n\t\treturn Git.isUncommittedStaged(this.sha);\n\t}\n\n\t@memoize()\n\tget originalUri(): Uri {\n\t\treturn this.originalFileName ? GitUri.resolveToUri(this.originalFileName, this.repoPath) : this.uri;\n\t}\n\n\tget previousFileSha(): string {\n\t\treturn `${this.sha}^`;\n\t}\n\n\tget previousShortSha() {\n\t\treturn this.previousSha && Git.shortenSha(this.previousSha);\n\t}\n\n\tget previousUri(): Uri {\n\t\treturn this.previousFileName ? GitUri.resolveToUri(this.previousFileName, this.repoPath) : this.uri;\n\t}\n\n\t@memoize()\n\tget uri(): Uri {\n\t\treturn GitUri.resolveToUri(this.fileName, this.repoPath);\n\t}\n\n\t@memoize<GitCommit['getPreviousLineDiffUris']>(\n\t\t(uri, editorLine, ref) => `${uri.toString(true)}|${editorLine || ''}|${ref || ''}`\n\t)\n\tgetPreviousLineDiffUris(uri: Uri, editorLine: number, ref: string | undefined) {\n\t\tif (!this.isFile) return Promise.resolve(undefined);\n\n\t\treturn Container.git.getPreviousLineDiffUris(this.repoPath, uri, editorLine, ref);\n\t}\n\n\t@memoize()\n\tgetWorkingUri(): Promise<Uri | undefined> {\n\t\tif (!this.isFile) return Promise.resolve(undefined);\n\n\t\treturn Container.git.getWorkingUri(this.repoPath, this.uri);\n\t}\n\n\t@memoize()\n\tprivate get authorDateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.authorDate);\n\t}\n\n\t@memoize()\n\tprivate get committerDateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.committerDate);\n\t}\n\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn CommitDateFormatting.dateSource === DateSource.Committed\n\t\t\t? this.committerDateFormatter\n\t\t\t: this.authorDateFormatter;\n\t}\n\n\t@memoize<GitCommit['formatAuthorDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatAuthorDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.authorDateFormatter.format(format);\n\t}\n\n\tformatAuthorDateFromNow() {\n\t\treturn this.authorDateFormatter.fromNow();\n\t}\n\n\t@memoize<GitCommit['formatCommitterDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatCommitterDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.committerDateFormatter.format(format);\n\t}\n\n\tformatCommitterDateFromNow() {\n\t\treturn this.committerDateFormatter.fromNow();\n\t}\n\n\t@memoize<GitCommit['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter.fromNow();\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; separator?: string; suffix?: string } = {}): string {\n\t\treturn GitUri.getFormattedPath(this.fileName, options);\n\t}\n\n\tgetGravatarUri(fallback: GravatarDefaultStyle, size: number = 16): Uri {\n\t\treturn getAvatarUri(this.email, fallback, size);\n\t}\n\n\t@memoize()\n\tgetShortMessage() {\n\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\treturn CommitFormatter.fromTemplate('${message}', this, { truncateMessageAtNewLine: true });\n\t}\n\n\t@memoize()\n\ttoGitUri(previous: boolean = false): GitUri {\n\t\treturn GitUri.fromCommit(this, previous);\n\t}\n\n\tabstract with(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t}): GitCommit;\n\n\tprotected getChangedValue<T>(change: T | null | undefined, original: T | undefined): T | undefined {\n\t\tif (change === undefined) return original;\n\t\treturn change !== null ? change : undefined;\n\t}\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","'use strict';\nimport { createHash, HexBase64Latin1Encoding } from 'crypto';\n\nconst emptyStr = '';\n\nexport namespace Strings {\n\texport const enum CharCode {\n\t\t/**\n\t\t * The `/` character.\n\t\t */\n\t\tSlash = 47,\n\t\t/**\n\t\t * The `\\` character.\n\t\t */\n\t\tBackslash = 92\n\t}\n\n\tconst escapeMarkdownRegex = /[\\\\`*_{}[\\]()#+\\-.!]/g;\n\tconst escapeMarkdownHeaderRegex = /^===/gm;\n\t// const sampleMarkdown = '## message `not code` *not important* _no underline_ \\n> don\\'t quote me \\n- don\\'t list me \\n+ don\\'t list me \\n1. don\\'t list me \\nnot h1 \\n=== \\nnot h2 \\n---\\n***\\n---\\n___';\n\tconst markdownQuotedRegex = /\\n/g;\n\n\texport function escapeMarkdown(s: string, options: { quoted?: boolean } = {}): string {\n\t\ts = s\n\t\t\t// Escape markdown\n\t\t\t.replace(escapeMarkdownRegex, '\\\\$&')\n\t\t\t// Escape markdown header (since the above regex won't match it)\n\t\t\t.replace(escapeMarkdownHeaderRegex, '\\u200b===');\n\n\t\tif (!options.quoted) return s;\n\n\t\t// Keep under the same block-quote but with line breaks\n\t\treturn s.replace(markdownQuotedRegex, '\\t\\n>  ');\n\t}\n\n\texport function getCommonBase(s1: string, s2: string, delimiter: string) {\n\t\tlet char;\n\t\tlet index = 0;\n\t\tfor (let i = 0; i < s1.length; i++) {\n\t\t\tchar = s1[i];\n\t\t\tif (char !== s2[i]) break;\n\n\t\t\tif (char === delimiter) {\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t}\n\n\t\treturn index > 0 ? s1.substring(0, index + 1) : undefined;\n\t}\n\n\texport function getDurationMilliseconds(start: [number, number]) {\n\t\tconst [secs, nanosecs] = process.hrtime(start);\n\t\treturn secs * 1000 + Math.floor(nanosecs / 1000000);\n\t}\n\n\tconst pathNormalizeRegex = /\\\\/g;\n\tconst pathStripTrailingSlashRegex = /\\/$/g;\n\tconst tokenRegex = /\\$\\{(\\W*)?([^|]*?)(?:\\|(\\d+)(-|\\?)?)?(\\W*)?\\}/g;\n\tconst tokenSanitizeRegex = /\\$\\{(?:\\W*)?(\\w*?)(?:[\\W\\d]*)\\}/g;\n\t// eslint-disable-next-line no-template-curly-in-string\n\tconst tokenSanitizeReplacement = '$${this.$1}';\n\n\texport interface TokenOptions {\n\t\tcollapseWhitespace: boolean;\n\t\tpadDirection: 'left' | 'right';\n\t\tprefix: string | undefined;\n\t\tsuffix: string | undefined;\n\t\ttruncateTo: number | undefined;\n\t}\n\n\texport function getTokensFromTemplate(template: string) {\n\t\tconst tokens: { key: string; options: TokenOptions }[] = [];\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = tokenRegex.exec(template);\n\t\t\tif (match == null) break;\n\n\t\t\tconst [, prefix, key, truncateTo, option, suffix] = match;\n\t\t\ttokens.push({\n\t\t\t\tkey: key,\n\t\t\t\toptions: {\n\t\t\t\t\tcollapseWhitespace: option === '?',\n\t\t\t\t\tpadDirection: option === '-' ? 'left' : 'right',\n\t\t\t\t\tprefix: prefix,\n\t\t\t\t\tsuffix: suffix,\n\t\t\t\t\ttruncateTo: truncateTo == null ? undefined : parseInt(truncateTo, 10)\n\t\t\t\t}\n\t\t\t});\n\t\t} while (true);\n\n\t\treturn tokens;\n\t}\n\n\tconst interpolationMap = new Map<string, Function>();\n\n\texport function interpolate(template: string, context: object | undefined): string {\n\t\tif (template == null || template.length === 0) return template;\n\t\tif (context === undefined) return template.replace(tokenSanitizeRegex, emptyStr);\n\n\t\tlet fn = interpolationMap.get(template);\n\t\tif (fn === undefined) {\n\t\t\tfn = new Function(`return \\`${template.replace(tokenSanitizeRegex, tokenSanitizeReplacement)}\\`;`);\n\t\t\tinterpolationMap.set(template, fn);\n\t\t}\n\n\t\treturn fn.call(context);\n\t}\n\n\texport function* lines(s: string): IterableIterator<string> {\n\t\tlet i = 0;\n\t\twhile (i < s.length) {\n\t\t\tlet j = s.indexOf('\\n', i);\n\t\t\tif (j === -1) {\n\t\t\t\tj = s.length;\n\t\t\t}\n\n\t\t\tyield s.substring(i, j);\n\t\t\ti = j + 1;\n\t\t}\n\t}\n\n\texport function md5(s: string, encoding: HexBase64Latin1Encoding = 'base64'): string {\n\t\treturn createHash('md5')\n\t\t\t.update(s)\n\t\t\t.digest(encoding);\n\t}\n\n\texport function normalizePath(\n\t\tfileName: string,\n\t\toptions: { addLeadingSlash?: boolean; stripTrailingSlash?: boolean } = { stripTrailingSlash: true }\n\t) {\n\t\tif (fileName == null || fileName.length === 0) return fileName;\n\n\t\tlet normalized = fileName.replace(pathNormalizeRegex, '/');\n\n\t\tconst { addLeadingSlash, stripTrailingSlash } = { stripTrailingSlash: true, ...options };\n\n\t\tif (stripTrailingSlash) {\n\t\t\tnormalized = normalized.replace(pathStripTrailingSlashRegex, emptyStr);\n\t\t}\n\n\t\tif (addLeadingSlash && normalized.charCodeAt(0) !== CharCode.Slash) {\n\t\t\tnormalized = `/${normalized}`;\n\t\t}\n\n\t\treturn normalized;\n\t}\n\n\texport function pad(s: string, before: number = 0, after: number = 0, padding: string = '\\u00a0') {\n\t\tif (before === 0 && after === 0) return s;\n\n\t\treturn `${before === 0 ? emptyStr : padding.repeat(before)}${s}${\n\t\t\tafter === 0 ? emptyStr : padding.repeat(after)\n\t\t}`;\n\t}\n\n\texport function padLeft(s: string, padTo: number, padding: string = '\\u00a0', width?: number) {\n\t\tconst diff = padTo - (width || getWidth(s));\n\t\treturn diff <= 0 ? s : padding.repeat(diff) + s;\n\t}\n\n\texport function padLeftOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\t\twidth = width || getWidth(s);\n\t\tif (width < max) return padLeft(s, max, padding, width);\n\t\tif (width > max) return truncate(s, max, undefined, width);\n\t\treturn s;\n\t}\n\n\texport function padRight(s: string, padTo: number, padding: string = '\\u00a0', width?: number) {\n\t\tconst diff = padTo - (width || getWidth(s));\n\t\treturn diff <= 0 ? s : s + padding.repeat(diff);\n\t}\n\n\texport function padOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\t\tconst left = max < 0;\n\t\tmax = Math.abs(max);\n\n\t\twidth = width || getWidth(s);\n\t\tif (width < max) return left ? padLeft(s, max, padding, width) : padRight(s, max, padding, width);\n\t\tif (width > max) return truncate(s, max, undefined, width);\n\t\treturn s;\n\t}\n\n\texport function padRightOrTruncate(s: string, max: number, padding?: string, width?: number) {\n\t\twidth = width || getWidth(s);\n\t\tif (width < max) return padRight(s, max, padding, width);\n\t\tif (width > max) return truncate(s, max);\n\t\treturn s;\n\t}\n\n\texport function pluralize(\n\t\ts: string,\n\t\tcount: number,\n\t\toptions?: { number?: string; plural?: string; suffix?: string; zero?: string }\n\t) {\n\t\tif (options === undefined) return `${count} ${s}${count === 1 ? emptyStr : 's'}`;\n\n\t\treturn `${count === 0 ? options.zero || count : options.number || count} ${\n\t\t\tcount === 1 ? s : options.plural || `${s}${options.suffix || 's'}`\n\t\t}`;\n\t}\n\n\t// Removes \\ / : * ? \" < > | and C0 and C1 control codes\n\t// eslint-disable-next-line no-control-regex\n\tconst illegalCharsForFSRegex = /[\\\\/:*?\"<>|\\x00-\\x1f\\x80-\\x9f]/g;\n\n\texport function sanitizeForFileSystem(s: string, replacement: string = '_') {\n\t\tif (!s) return s;\n\t\treturn s.replace(illegalCharsForFSRegex, replacement);\n\t}\n\n\texport function sha1(s: string, encoding: HexBase64Latin1Encoding = 'base64'): string {\n\t\treturn createHash('sha1')\n\t\t\t.update(s)\n\t\t\t.digest(encoding);\n\t}\n\n\texport function splitLast(s: string, splitter: string) {\n\t\tconst index = s.lastIndexOf(splitter);\n\t\tif (index === -1) return [s];\n\n\t\treturn [s.substr(index), s.substring(0, index - 1)];\n\t}\n\n\texport function splitSingle(s: string, splitter: string) {\n\t\tconst parts = s.split(splitter, 1);\n\t\tconst first = parts[0];\n\t\treturn first.length === s.length ? parts : [first, s.substr(first.length + 1)];\n\t}\n\n\texport function truncate(s: string, truncateTo: number, ellipsis: string = '\\u2026', width?: number) {\n\t\tif (!s) return s;\n\n\t\twidth = width || getWidth(s);\n\t\tif (width <= truncateTo) return s;\n\t\tif (width === s.length) return `${s.substring(0, truncateTo - 1)}${ellipsis}`;\n\n\t\t// Skip ahead to start as far as we can by assuming all the double-width characters won't be truncated\n\t\tlet chars = Math.floor(truncateTo / (width / s.length));\n\t\tlet count = getWidth(s.substring(0, chars));\n\t\twhile (count < truncateTo) {\n\t\t\tcount += getWidth(s[chars++]);\n\t\t}\n\n\t\tif (count >= truncateTo) {\n\t\t\tchars--;\n\t\t}\n\n\t\treturn `${s.substring(0, chars)}${ellipsis}`;\n\t}\n\n\t// Lifted from https://github.com/chalk/ansi-regex\n\t// eslint-disable-next-line no-control-regex\n\tconst ansiRegex = /[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d/#&.:=?%@~_]*)*)?\\u0007)|(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))/g;\n\tconst containsNonAsciiRegex = /[^\\x20-\\x7F\\u00a0\\u2026]/;\n\n\texport function getWidth(s: string): number {\n\t\tif (s == null || s.length === 0) return 0;\n\n\t\t// Shortcut to avoid needless string `RegExp`s, replacements, and allocations\n\t\tif (!containsNonAsciiRegex.test(s)) return s.length;\n\n\t\ts = s.replace(ansiRegex, emptyStr);\n\n\t\tlet count = 0;\n\t\tlet emoji = 0;\n\t\tlet joiners = 0;\n\n\t\tconst graphemes = [...s];\n\t\tfor (let i = 0; i < graphemes.length; i++) {\n\t\t\tconst code = graphemes[i].codePointAt(0)!;\n\n\t\t\t// Ignore control characters\n\t\t\tif (code <= 0x1f || (code >= 0x7f && code <= 0x9f)) continue;\n\n\t\t\t// Ignore combining characters\n\t\t\tif (code >= 0x300 && code <= 0x36f) continue;\n\n\t\t\t// https://stackoverflow.com/questions/30757193/find-out-if-character-in-string-is-emoji\n\t\t\tif (\n\t\t\t\t(code >= 0x1f600 && code <= 0x1f64f) || // Emoticons\n\t\t\t\t(code >= 0x1f300 && code <= 0x1f5ff) || // Misc Symbols and Pictographs\n\t\t\t\t(code >= 0x1f680 && code <= 0x1f6ff) || // Transport and Map\n\t\t\t\t(code >= 0x2600 && code <= 0x26ff) || // Misc symbols\n\t\t\t\t(code >= 0x2700 && code <= 0x27bf) || // Dingbats\n\t\t\t\t(code >= 0xfe00 && code <= 0xfe0f) || // Variation Selectors\n\t\t\t\t(code >= 0x1f900 && code <= 0x1f9ff) || // Supplemental Symbols and Pictographs\n\t\t\t\t(code >= 65024 && code <= 65039) || // Variation selector\n\t\t\t\t(code >= 8400 && code <= 8447) // Combining Diacritical Marks for Symbols\n\t\t\t) {\n\t\t\t\tif (code >= 0x1f3fb && code <= 0x1f3ff) continue; // emoji modifier fitzpatrick type\n\n\t\t\t\temoji++;\n\t\t\t\tcount += 2;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Ignore zero-width joiners '\\u200d'\n\t\t\tif (code === 8205) {\n\t\t\t\tjoiners++;\n\t\t\t\tcount -= 2;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Surrogates\n\t\t\tif (code > 0xffff) {\n\t\t\t\ti++;\n\t\t\t}\n\n\t\t\tcount += isFullwidthCodePoint(code) ? 2 : 1;\n\t\t}\n\n\t\tconst offset = emoji - joiners;\n\t\tif (offset > 1) {\n\t\t\tcount += offset - 1;\n\t\t}\n\t\treturn count;\n\t}\n\n\tfunction isFullwidthCodePoint(cp: number) {\n\t\t// code points are derived from:\n\t\t// http://www.unix.org/Public/UNIDATA/EastAsianWidth.txt\n\t\tif (\n\t\t\tcp >= 0x1100 &&\n\t\t\t(cp <= 0x115f || // Hangul Jamo\n\t\t\tcp === 0x2329 || // LEFT-POINTING ANGLE BRACKET\n\t\t\tcp === 0x232a || // RIGHT-POINTING ANGLE BRACKET\n\t\t\t\t// CJK Radicals Supplement .. Enclosed CJK Letters and Months\n\t\t\t\t(cp >= 0x2e80 && cp <= 0x3247 && cp !== 0x303f) ||\n\t\t\t\t// Enclosed CJK Letters and Months .. CJK Unified Ideographs Extension A\n\t\t\t\t(cp >= 0x3250 && cp <= 0x4dbf) ||\n\t\t\t\t// CJK Unified Ideographs .. Yi Radicals\n\t\t\t\t(cp >= 0x4e00 && cp <= 0xa4c6) ||\n\t\t\t\t// Hangul Jamo Extended-A\n\t\t\t\t(cp >= 0xa960 && cp <= 0xa97c) ||\n\t\t\t\t// Hangul Syllables\n\t\t\t\t(cp >= 0xac00 && cp <= 0xd7a3) ||\n\t\t\t\t// CJK Compatibility Ideographs\n\t\t\t\t(cp >= 0xf900 && cp <= 0xfaff) ||\n\t\t\t\t// Vertical Forms\n\t\t\t\t(cp >= 0xfe10 && cp <= 0xfe19) ||\n\t\t\t\t// CJK Compatibility Forms .. Small Form Variants\n\t\t\t\t(cp >= 0xfe30 && cp <= 0xfe6b) ||\n\t\t\t\t// Halfwidth and Fullwidth Forms\n\t\t\t\t(cp >= 0xff01 && cp <= 0xff60) ||\n\t\t\t\t(cp >= 0xffe0 && cp <= 0xffe6) ||\n\t\t\t\t// Kana Supplement\n\t\t\t\t(cp >= 0x1b000 && cp <= 0x1b001) ||\n\t\t\t\t// Enclosed Ideographic Supplement\n\t\t\t\t(cp >= 0x1f200 && cp <= 0x1f251) ||\n\t\t\t\t// CJK Unified Ideographs Extension B .. Tertiary Ideographic Plane\n\t\t\t\t(cp >= 0x20000 && cp <= 0x3fffd))\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","'use strict';\nimport * as fs from 'fs';\nimport { Uri } from 'vscode';\nimport { GravatarDefaultStyle } from './config';\nimport { Strings } from './system';\nimport { ContactPresenceStatus } from './vsls/vsls';\nimport { Container } from './container';\n\nconst avatarCache = new Map<string, Uri>();\nconst missingGravatarHash = '00000000000000000000000000000000';\n\nconst presenceCache = new Map<ContactPresenceStatus, string>();\n\nconst gitHubNoReplyAddressRegex = /^(?:(?<userId>\\d+)\\+)?(?<userName>[a-zA-Z\\d-]{1,39})@users.noreply.github.com$/;\n\nexport function clearAvatarCache() {\n\tavatarCache.clear();\n}\n\nfunction getAvatarUriFromGitHubNoReplyAddress(email: string | undefined, size: number = 16): Uri | undefined {\n\tif (email == null || email.length === 0) return undefined;\n\n\tconst match = gitHubNoReplyAddressRegex.exec(email);\n\tif (match == null) return undefined;\n\n\tconst [, userId, userName] = match;\n\treturn Uri.parse(`https://avatars.githubusercontent.com/${userId ? `u/${userId}` : userName}?size=${size}`);\n}\n\nexport function getAvatarUri(email: string | undefined, fallback: GravatarDefaultStyle, size: number = 16): Uri {\n\tconst hash =\n\t\temail != null && email.length !== 0 ? Strings.md5(email.trim().toLowerCase(), 'hex') : missingGravatarHash;\n\n\tconst key = `${hash}:${size}`;\n\tlet avatar = avatarCache.get(key);\n\tif (avatar !== undefined) return avatar;\n\n\tavatar =\n\t\tgetAvatarUriFromGitHubNoReplyAddress(email, size) ||\n\t\tUri.parse(`https://www.gravatar.com/avatar/${hash}.jpg?s=${size}&d=${fallback}`);\n\tavatarCache.set(key, avatar);\n\n\treturn avatar;\n}\n\nexport function getPresenceDataUri(status: ContactPresenceStatus) {\n\tlet dataUri = presenceCache.get(status);\n\tif (dataUri === undefined) {\n\t\tconst contents = fs\n\t\t\t.readFileSync(Container.context.asAbsolutePath(`images/dark/icon-presence-${status}.svg`))\n\t\t\t.toString('base64');\n\n\t\tdataUri = encodeURI(`data:image/svg+xml;base64,${contents}`);\n\t\tpresenceCache.set(status, dataUri);\n\t}\n\n\treturn dataUri;\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemoteProvider } from './provider';\n\nconst issueEnricherRegex = /(^|\\s)(#([0-9]+))\\b/gi;\n\nconst gitRegex = /\\/_git\\/?/i;\nconst legacyDefaultCollectionRegex = /^DefaultCollection\\//i;\nconst orgAndProjectRegex = /^(.*?)\\/(.*?)\\/(.*)/;\nconst sshDomainRegex = /^(ssh|vs-ssh)\\./i;\nconst sshPathRegex = /^\\/?v\\d\\//i;\n\nexport class AzureDevOpsRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, legacy: boolean = false) {\n\t\tif (sshDomainRegex.test(domain)) {\n\t\t\tpath = path.replace(sshPathRegex, '');\n\t\t\tdomain = domain.replace(sshDomainRegex, '');\n\n\t\t\t// Add in /_git/ into ssh urls\n\t\t\tconst match = orgAndProjectRegex.exec(path);\n\t\t\tif (match != null) {\n\t\t\t\tconst [, org, project, rest] = match;\n\n\t\t\t\t// Handle legacy vsts urls\n\t\t\t\tif (legacy) {\n\t\t\t\t\tdomain = `${org}.${domain}`;\n\t\t\t\t\tpath = `${project}/_git/${rest}`;\n\t\t\t\t} else {\n\t\t\t\t\tpath = `${org}/${project}/_git/${rest}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper(domain, path, protocol, name);\n\t}\n\n\tget icon() {\n\t\treturn 'vsts';\n\t}\n\n\tget name() {\n\t\treturn 'Azure DevOps';\n\t}\n\n\tprivate _displayPath: string | undefined;\n\tget displayPath(): string {\n\t\tif (this._displayPath === undefined) {\n\t\t\tthis._displayPath = this.path.replace(gitRegex, '/').replace(legacyDefaultCollectionRegex, '');\n\t\t}\n\t\treturn this._displayPath;\n\t}\n\n\tenrichMessage(message: string): string {\n\t\t// Strip off any `_git` part from the repo url\n\t\tconst baseUrl = this.baseUrl.replace(gitRegex, '/');\n\t\t// Matches #123\n\t\treturn message.replace(issueEnricherRegex, `$1[$2](${baseUrl}/_workitems/edit/$3 \"Open Work Item $2\")`);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/?version=GB${branch}&_a=history`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commit/${sha}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `&line=${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `&line=${range.start.line}&lineEnd=${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.baseUrl}/commit/${sha}/?_a=contents&path=%2F${fileName}${line}`;\n\t\tif (branch) return `${this.baseUrl}/?path=%2F${fileName}&version=GB${branch}&_a=contents${line}`;\n\t\treturn `${this.baseUrl}?path=%2F${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemoteProvider } from './provider';\n\nconst issueEnricherRegex = /(^|\\s)(issue #([0-9]+))\\b/gi;\nconst prEnricherRegex = /(^|\\s)(pull request #([0-9]+))\\b/gi;\n\nexport class BitbucketRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tget icon() {\n\t\treturn 'bitbucket';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Bitbucket');\n\t}\n\n\tenrichMessage(message: string): string {\n\t\treturn (\n\t\t\tmessage\n\t\t\t\t// Matches issue #123\n\t\t\t\t.replace(issueEnricherRegex, `$1[$2](${this.baseUrl}/issues/$3 \"Open Issue $2\")`)\n\t\t\t\t// Matches pull request #123\n\t\t\t\t.replace(prEnricherRegex, `$1[$2](${this.baseUrl}/pull-requests/$3 \"Open PR $2\")`)\n\t\t);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/commits/branch/${branch}`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commits/${sha}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#${fileName}-${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#${fileName}-${range.start.line}:${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.baseUrl}/src/${sha}/${fileName}${line}`;\n\t\tif (branch) return `${this.baseUrl}/src/${branch}/${fileName}${line}`;\n\t\treturn `${this.baseUrl}?path=${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemoteProvider } from './provider';\n\nconst issueEnricherRegex = /(^|\\s)(issue #([0-9]+))\\b/gi;\nconst prEnricherRegex = /(^|\\s)(pull request #([0-9]+))\\b/gi;\n\nexport class BitbucketServerRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tprotected get baseUrl() {\n\t\tconst [project, repo] = this.path.startsWith('scm/')\n\t\t\t? this.path.replace('scm/', '').split('/')\n\t\t\t: this.splitPath();\n\t\treturn `${this.protocol}://${this.domain}/projects/${project}/repos/${repo}`;\n\t}\n\n\tget icon() {\n\t\treturn 'bitbucket';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Bitbucket Server');\n\t}\n\n\tenrichMessage(message: string): string {\n\t\treturn (\n\t\t\tmessage\n\t\t\t\t// Matches issue #123\n\t\t\t\t.replace(issueEnricherRegex, `$1[$2](${this.baseUrl}/issues/$3 \"Open Issue $2\")`)\n\t\t\t\t// Matches pull request #123\n\t\t\t\t.replace(prEnricherRegex, `$1[$2](${this.baseUrl}/pull-requests/$3 \"Open PR $2\")`)\n\t\t);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/commits?until=${branch}`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commits/${sha}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#${range.start.line}-${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\t\tif (sha) return `${this.baseUrl}/browse/${fileName}?at=${sha}${line}`;\n\t\tif (branch) return `${this.baseUrl}/browse/${fileName}?at=${branch}${line}`;\n\t\treturn `${this.baseUrl}/browse/${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemotesUrlsConfig } from '../../configuration';\nimport { Strings } from '../../system';\nimport { RemoteProvider } from './provider';\n\nexport class CustomRemote extends RemoteProvider {\n\tprivate readonly urls: RemotesUrlsConfig;\n\n\tconstructor(domain: string, path: string, urls: RemotesUrlsConfig, protocol?: string, name?: string) {\n\t\tsuper(domain, path, protocol, name, true);\n\t\tthis.urls = urls;\n\t}\n\n\tget name() {\n\t\treturn this.formatName('Custom');\n\t}\n\n\tprotected getUrlForRepository(): string {\n\t\treturn Strings.interpolate(this.urls.repository, this.getContext());\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn Strings.interpolate(this.urls.branches, this.getContext());\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn Strings.interpolate(this.urls.branch, this.getContext({ branch: branch }));\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn Strings.interpolate(this.urls.commit, this.getContext({ id: sha }));\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = Strings.interpolate(this.urls.fileLine, { line: range.start.line });\n\t\t\t} else {\n\t\t\t\tline = Strings.interpolate(this.urls.fileRange, { start: range.start.line, end: range.end.line });\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) {\n\t\t\treturn Strings.interpolate(\n\t\t\t\tthis.urls.fileInCommit,\n\t\t\t\tthis.getContext({ id: sha, file: fileName, line: line })\n\t\t\t);\n\t\t}\n\t\tif (branch) {\n\t\t\treturn Strings.interpolate(\n\t\t\t\tthis.urls.fileInBranch,\n\t\t\t\tthis.getContext({ branch: branch, file: fileName, line: line })\n\t\t\t);\n\t\t}\n\t\treturn Strings.interpolate(this.urls.file, this.getContext({ file: fileName, line: line }));\n\t}\n\n\tprivate getContext(context?: {}) {\n\t\tconst [repoBase, repoPath] = this.splitPath();\n\t\treturn {\n\t\t\trepo: this.path,\n\t\t\trepoBase: repoBase,\n\t\t\trepoPath: repoPath,\n\t\t\t...(context || {})\n\t\t};\n\t}\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemoteProvider } from './provider';\n\nconst issueEnricherRegex = /(^|\\s)((?:#|gh-)([0-9]+))\\b/gi;\nconst issueEnricher3rdParyRegex = /\\b((\\w+-?\\w+(?!-)\\/\\w+-?\\w+(?!-))#([0-9]+))\\b/g;\n\nexport class GitHubRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tget icon() {\n\t\treturn 'github';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('GitHub');\n\t}\n\n\tenrichMessage(message: string): string {\n\t\treturn (\n\t\t\tmessage\n\t\t\t\t// Matches #123 or gh-123 or GH-123\n\t\t\t\t.replace(issueEnricherRegex, `$1[$2](${this.baseUrl}/issues/$3 \"Open Issue $2\")`)\n\t\t\t\t// Matches eamodio/vscode-gitlens#123\n\t\t\t\t.replace(\n\t\t\t\t\tissueEnricher3rdParyRegex,\n\t\t\t\t\t`[$1](${this.protocol}://${this.domain}/$2/issues/$3 \"Open Issue #$3 from $2\")`\n\t\t\t\t)\n\t\t);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/commits/${branch}`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commit/${sha}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#L${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#L${range.start.line}-L${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.baseUrl}/blob/${sha}/${fileName}${line}`;\n\t\tif (branch) return `${this.baseUrl}/blob/${branch}/${fileName}${line}`;\n\t\treturn `${this.baseUrl}?path=${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { Range } from 'vscode';\nimport { RemoteProvider } from './provider';\n\nconst issueEnricherRegex = /(^|\\s)(#([0-9]+))\\b/gi;\n\nexport class GitLabRemote extends RemoteProvider {\n\tconstructor(domain: string, path: string, protocol?: string, name?: string, custom: boolean = false) {\n\t\tsuper(domain, path, protocol, name, custom);\n\t}\n\n\tget icon() {\n\t\treturn 'gitlab';\n\t}\n\n\tget name() {\n\t\treturn this.formatName('GitLab');\n\t}\n\n\tenrichMessage(message: string): string {\n\t\t// Matches #123\n\t\treturn message.replace(issueEnricherRegex, `$1[$2](${this.baseUrl}/issues/$3 \"Open Issue $2\")`);\n\t}\n\n\tprotected getUrlForBranches(): string {\n\t\treturn `${this.baseUrl}/branches`;\n\t}\n\n\tprotected getUrlForBranch(branch: string): string {\n\t\treturn `${this.baseUrl}/commits/${branch}`;\n\t}\n\n\tprotected getUrlForCommit(sha: string): string {\n\t\treturn `${this.baseUrl}/commit/${sha}`;\n\t}\n\n\tprotected getUrlForFile(fileName: string, branch?: string, sha?: string, range?: Range): string {\n\t\tlet line;\n\t\tif (range) {\n\t\t\tif (range.start.line === range.end.line) {\n\t\t\t\tline = `#L${range.start.line}`;\n\t\t\t} else {\n\t\t\t\tline = `#L${range.start.line}-${range.end.line}`;\n\t\t\t}\n\t\t} else {\n\t\t\tline = '';\n\t\t}\n\n\t\tif (sha) return `${this.baseUrl}/blob/${sha}/${fileName}${line}`;\n\t\tif (branch) return `${this.baseUrl}/blob/${branch}/${fileName}${line}`;\n\t\treturn `${this.baseUrl}?path=${fileName}${line}`;\n\t}\n}\n","'use strict';\nimport { CustomRemoteType, RemotesConfig } from '../../configuration';\nimport { Logger } from '../../logger';\nimport { AzureDevOpsRemote } from './azure-devops';\nimport { BitbucketRemote } from './bitbucket';\nimport { BitbucketServerRemote } from './bitbucket-server';\nimport { CustomRemote } from './custom';\nimport { GitHubRemote } from './github';\nimport { GitLabRemote } from './gitlab';\nimport { RemoteProvider } from './provider';\n\nexport { RemoteProvider };\nexport type RemoteProviders = [string | RegExp, ((domain: string, path: string) => RemoteProvider)][];\n\nconst defaultProviders: RemoteProviders = [\n\t['bitbucket.org', (domain: string, path: string) => new BitbucketRemote(domain, path)],\n\t['github.com', (domain: string, path: string) => new GitHubRemote(domain, path)],\n\t['gitlab.com', (domain: string, path: string) => new GitLabRemote(domain, path)],\n\t[/\\bdev\\.azure\\.com$/i, (domain: string, path: string) => new AzureDevOpsRemote(domain, path)],\n\t[/\\bbitbucket\\b/i, (domain: string, path: string) => new BitbucketServerRemote(domain, path)],\n\t[/\\bgitlab\\b/i, (domain: string, path: string) => new GitLabRemote(domain, path)],\n\t[\n\t\t/\\bvisualstudio\\.com$/i,\n\t\t(domain: string, path: string) => new AzureDevOpsRemote(domain, path, undefined, undefined, true)\n\t]\n];\n\nexport class RemoteProviderFactory {\n\tstatic factory(providers: RemoteProviders): (domain: string, path: string) => RemoteProvider | undefined {\n\t\treturn (domain: string, path: string) => this.create(providers, domain, path);\n\t}\n\n\tstatic create(providers: RemoteProviders, domain: string, path: string): RemoteProvider | undefined {\n\t\ttry {\n\t\t\tconst key = domain.toLowerCase();\n\t\t\tfor (const [matcher, creator] of providers) {\n\t\t\t\tif (\n\t\t\t\t\t(typeof matcher === 'string' && matcher === key) ||\n\t\t\t\t\t(typeof matcher !== 'string' && matcher.test(key))\n\t\t\t\t) {\n\t\t\t\t\treturn creator(domain, path);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, 'RemoteProviderFactory');\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tstatic loadProviders(cfg: RemotesConfig[] | null | undefined): RemoteProviders {\n\t\tconst providers: RemoteProviders = [];\n\n\t\tif (cfg != null && cfg.length > 0) {\n\t\t\tfor (const rc of cfg) {\n\t\t\t\tconst provider = this.getCustomProvider(rc);\n\t\t\t\tif (provider === undefined) continue;\n\n\t\t\t\tproviders.push([rc.domain.toLowerCase(), provider]);\n\t\t\t}\n\t\t}\n\n\t\tproviders.push(...defaultProviders);\n\t\treturn providers;\n\t}\n\n\tprivate static getCustomProvider(cfg: RemotesConfig) {\n\t\tswitch (cfg.type) {\n\t\t\tcase CustomRemoteType.Bitbucket:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew BitbucketRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.BitbucketServer:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew BitbucketServerRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.Custom:\n\t\t\t\treturn (domain: string, path: string) =>\n\t\t\t\t\tnew CustomRemote(domain, path, cfg.urls!, cfg.protocol, cfg.name);\n\t\t\tcase CustomRemoteType.GitHub:\n\t\t\t\treturn (domain: string, path: string) => new GitHubRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t\tcase CustomRemoteType.GitLab:\n\t\t\t\treturn (domain: string, path: string) => new GitLabRemote(domain, path, cfg.protocol, cfg.name, true);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n","'use strict';\nimport { execFile } from 'child_process';\nimport * as fs from 'fs';\nimport * as paths from 'path';\nimport * as iconv from 'iconv-lite';\nimport { Logger } from '../logger';\n\nconst isWindows = process.platform === 'win32';\n\nconst slashesRegex = /[\\\\/]/;\nconst ps1Regex = /\\.ps1$/i;\nconst batOrCmdRegex = /\\.(bat|cmd)$/i;\nconst jsRegex = /\\.(js)$/i;\n\n/**\n * Search PATH to see if a file exists in any of the path folders.\n *\n * @param  {string} exe The file to search for\n * @return {string}     A fully qualified path, or the original path if nothing\n *                      is found\n *\n * @private\n */\nfunction runDownPath(exe: string): string {\n\t// NB: Windows won't search PATH looking for executables in spawn like\n\t// Posix does\n\n\t// Files with any directory path don't get this applied\n\tif (slashesRegex.test(exe)) return exe;\n\n\tconst target = paths.join('.', exe);\n\ttry {\n\t\tconst stats = fs.statSync(target);\n\t\tif (stats && stats.isFile() && isExecutable(stats)) return target;\n\t} catch {}\n\n\tconst path = process.env.PATH;\n\tif (path != null && path.length !== 0) {\n\t\tconst haystack = path.split(isWindows ? ';' : ':');\n\t\tlet stats;\n\t\tfor (const p of haystack) {\n\t\t\tconst needle = paths.join(p, exe);\n\t\t\ttry {\n\t\t\t\tstats = fs.statSync(needle);\n\t\t\t\tif (stats && stats.isFile() && isExecutable(stats)) return needle;\n\t\t\t} catch {}\n\t\t}\n\t}\n\n\treturn exe;\n}\n\nfunction isExecutable(stats: fs.Stats) {\n\tif (isWindows) return true;\n\n\tconst isGroup = stats.gid ? process.getgid && stats.gid === process.getgid() : true;\n\tconst isUser = stats.uid ? process.getuid && stats.uid === process.getuid() : true;\n\n\treturn Boolean(stats.mode & 0o0001 || (stats.mode & 0o0010 && isGroup) || (stats.mode & 0o0100 && isUser));\n}\n\n/**\n * Finds the executable and parameters to run on Windows. This method\n * mimics the POSIX behavior of being able to run scripts as executables by\n * replacing the passed-in executable with the script runner, for PowerShell,\n * CMD, and node scripts.\n *\n * This method also does the work of running down PATH, which spawn on Windows\n * also doesn't do, unlike on POSIX.\n */\nexport function findExecutable(exe: string, args: string[]): { cmd: string; args: string[] } {\n\t// POSIX can just execute scripts directly, no need for silly goosery\n\tif (!isWindows) return { cmd: runDownPath(exe), args: args };\n\n\tif (!fs.existsSync(exe)) {\n\t\t// NB: When you write something like `surf-client ... -- surf-build` on Windows,\n\t\t// a shell would normally convert that to surf-build.cmd, but since it's passed\n\t\t// in as an argument, it doesn't happen\n\t\tconst possibleExts = ['.exe', '.bat', '.cmd', '.ps1'];\n\t\tfor (const ext of possibleExts) {\n\t\t\tconst possibleFullPath = runDownPath(`${exe}${ext}`);\n\n\t\t\tif (fs.existsSync(possibleFullPath)) return findExecutable(possibleFullPath, args);\n\t\t}\n\t}\n\n\tif (ps1Regex.test(exe)) {\n\t\tconst cmd = paths.join(\n\t\t\tprocess.env.SYSTEMROOT || 'C:\\\\WINDOWS',\n\t\t\t'System32',\n\t\t\t'WindowsPowerShell',\n\t\t\t'v1.0',\n\t\t\t'PowerShell.exe'\n\t\t);\n\t\tconst psargs = ['-ExecutionPolicy', 'Unrestricted', '-NoLogo', '-NonInteractive', '-File', exe];\n\n\t\treturn { cmd: cmd, args: psargs.concat(args) };\n\t}\n\n\tif (batOrCmdRegex.test(exe)) {\n\t\tconst cmd = paths.join(process.env.SYSTEMROOT || 'C:\\\\WINDOWS', 'System32', 'cmd.exe');\n\t\tconst cmdArgs = ['/C', exe, ...args];\n\n\t\treturn { cmd: cmd, args: cmdArgs };\n\t}\n\n\tif (jsRegex.test(exe)) {\n\t\tconst cmd = process.execPath;\n\t\tconst nodeArgs = [exe];\n\n\t\treturn { cmd: cmd, args: nodeArgs.concat(args) };\n\t}\n\n\treturn { cmd: exe, args: args };\n}\n\nexport interface RunOptions {\n\tcwd?: string;\n\treadonly env?: Record<string, any>;\n\treadonly encoding?: BufferEncoding | 'buffer';\n\t/**\n\t * The size the output buffer to allocate to the spawned process. Set this\n\t * if you are anticipating a large amount of output.\n\t *\n\t * If not specified, this will be 10MB (10485760 bytes) which should be\n\t * enough for most Git operations.\n\t */\n\treadonly maxBuffer?: number;\n\t/**\n\t * An optional string or buffer which will be written to\n\t * the child process stdin stream immediately immediately\n\t * after spawning the process.\n\t */\n\treadonly stdin?: string | Buffer;\n\t/**\n\t * The encoding to use when writing to stdin, if the stdin\n\t * parameter is a string.\n\t */\n\treadonly stdinEncoding?: string;\n}\n\nconst bufferExceededRegex = /stdout maxBuffer( length)? exceeded/;\n\nexport function run<TOut extends string | Buffer>(\n\tcommand: string,\n\targs: any[],\n\tencoding: BufferEncoding | 'buffer',\n\toptions: RunOptions = {}\n): Promise<TOut> {\n\tconst { stdin, stdinEncoding, ...opts }: RunOptions = { maxBuffer: 100 * 1024 * 1024, ...options };\n\n\treturn new Promise<TOut>((resolve, reject) => {\n\t\tconst proc = execFile(\n\t\t\tcommand,\n\t\t\targs,\n\t\t\topts,\n\t\t\t(error: (Error & { stdout?: TOut | undefined }) | null, stdout, stderr) => {\n\t\t\t\tif (error != null) {\n\t\t\t\t\tif (bufferExceededRegex.test(error.message)) {\n\t\t\t\t\t\terror.message = `Command output exceeded the allocated stdout buffer. Set 'options.maxBuffer' to a larger value than ${opts.maxBuffer} bytes`;\n\t\t\t\t\t}\n\n\t\t\t\t\terror.stdout =\n\t\t\t\t\t\tencoding === 'utf8' || encoding === 'binary' || encoding === 'buffer'\n\t\t\t\t\t\t\t? (stdout as TOut)\n\t\t\t\t\t\t\t: (iconv.decode(Buffer.from(stdout, 'binary'), encoding) as TOut);\n\t\t\t\t\treject(error);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (stderr) {\n\t\t\t\t\tLogger.warn(`Warning(${command} ${args.join(' ')}): ${stderr}`);\n\t\t\t\t}\n\n\t\t\t\tresolve(\n\t\t\t\t\tencoding === 'utf8' || encoding === 'binary' || encoding === 'buffer'\n\t\t\t\t\t\t? (stdout as TOut)\n\t\t\t\t\t\t: (iconv.decode(Buffer.from(stdout, 'binary'), encoding) as TOut)\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\n\t\tif (stdin) {\n\t\t\tproc.stdin.end(stdin, stdinEncoding || 'utf8');\n\t\t}\n\t});\n}\n","/* eslint-disable node/no-deprecated-api */\n\n'use strict'\n\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\nvar safer = {}\n\nvar key\n\nfor (key in buffer) {\n  if (!buffer.hasOwnProperty(key)) continue\n  if (key === 'SlowBuffer' || key === 'Buffer') continue\n  safer[key] = buffer[key]\n}\n\nvar Safer = safer.Buffer = {}\nfor (key in Buffer) {\n  if (!Buffer.hasOwnProperty(key)) continue\n  if (key === 'allocUnsafe' || key === 'allocUnsafeSlow') continue\n  Safer[key] = Buffer[key]\n}\n\nsafer.Buffer.prototype = Buffer.prototype\n\nif (!Safer.from || Safer.from === Uint8Array.from) {\n  Safer.from = function (value, encodingOrOffset, length) {\n    if (typeof value === 'number') {\n      throw new TypeError('The \"value\" argument must not be of type number. Received type ' + typeof value)\n    }\n    if (value && typeof value.length === 'undefined') {\n      throw new TypeError('The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type ' + typeof value)\n    }\n    return Buffer(value, encodingOrOffset, length)\n  }\n}\n\nif (!Safer.alloc) {\n  Safer.alloc = function (size, fill, encoding) {\n    if (typeof size !== 'number') {\n      throw new TypeError('The \"size\" argument must be of type number. Received type ' + typeof size)\n    }\n    if (size < 0 || size >= 2 * (1 << 30)) {\n      throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n    }\n    var buf = Buffer(size)\n    if (!fill || fill.length === 0) {\n      buf.fill(0)\n    } else if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n    return buf\n  }\n}\n\nif (!safer.kStringMaxLength) {\n  try {\n    safer.kStringMaxLength = process.binding('buffer').kStringMaxLength\n  } catch (e) {\n    // we can't determine kStringMaxLength in environments where process.binding\n    // is unsupported, so let's not set it\n  }\n}\n\nif (!safer.constants) {\n  safer.constants = {\n    MAX_LENGTH: safer.kMaxLength\n  }\n  if (safer.kStringMaxLength) {\n    safer.constants.MAX_STRING_LENGTH = safer.kStringMaxLength\n  }\n}\n\nmodule.exports = safer\n","'use strict';\nimport { StarredBranches, WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { Git, GitRemote } from '../git';\nimport { GitStatus } from './status';\nimport { Dates, memoize } from '../../system';\nimport { GitReference } from './models';\nimport { BranchSorting, configuration, DateStyle } from '../../configuration';\n\nconst whitespaceRegex = /\\s/;\n\nexport const BranchDateFormatting = {\n\tdateFormat: undefined! as string | null,\n\tdateStyle: undefined! as DateStyle,\n\n\treset: () => {\n\t\tBranchDateFormatting.dateFormat = configuration.get('defaultDateFormat');\n\t\tBranchDateFormatting.dateStyle = configuration.get('defaultDateStyle');\n\t}\n};\n\nexport interface GitTrackingState {\n\tahead: number;\n\tbehind: number;\n}\n\nexport class GitBranch implements GitReference {\n\tstatic is(branch: any): branch is GitBranch {\n\t\treturn branch instanceof GitBranch;\n\t}\n\n\tstatic isOfRefType(branch: GitReference | undefined) {\n\t\treturn branch !== undefined && branch.refType === 'branch';\n\t}\n\n\tstatic sort(branches: GitBranch[]) {\n\t\tconst order = configuration.get('sortBranchesBy');\n\n\t\tswitch (order) {\n\t\t\tcase BranchSorting.DateAsc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\t(a.date === undefined ? -1 : a.date.getTime()) - (b.date === undefined ? -1 : b.date.getTime())\n\t\t\t\t);\n\t\t\tcase BranchSorting.DateDesc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\t(b.date === undefined ? -1 : b.date.getTime()) - (a.date === undefined ? -1 : a.date.getTime())\n\t\t\t\t);\n\t\t\tcase BranchSorting.NameAsc:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\tb.name.localeCompare(a.name, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn branches.sort(\n\t\t\t\t\t(a, b) =>\n\t\t\t\t\t\t(a.current ? -1 : 1) - (b.current ? -1 : 1) ||\n\t\t\t\t\t\t(a.starred ? -1 : 1) - (b.starred ? -1 : 1) ||\n\t\t\t\t\t\t(b.remote ? -1 : 1) - (a.remote ? -1 : 1) ||\n\t\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t\t);\n\t\t}\n\t}\n\n\treadonly refType = 'branch';\n\treadonly detached: boolean;\n\treadonly id: string;\n\treadonly tracking?: string;\n\treadonly state: GitTrackingState;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly remote: boolean,\n\t\tpublic readonly current: boolean,\n\t\tpublic readonly date: Date | undefined,\n\t\tpublic readonly sha?: string,\n\t\ttracking?: string,\n\t\tahead: number = 0,\n\t\tbehind: number = 0,\n\t\tdetached: boolean = false\n\t) {\n\t\tthis.id = `${repoPath}|${remote ? 'remotes/' : 'heads/'}${name}`;\n\n\t\tthis.detached = detached || (this.current ? GitBranch.isDetached(name) : false);\n\t\tif (this.detached) {\n\t\t\tthis.name = GitBranch.formatDetached(this.sha!);\n\t\t}\n\n\t\tthis.tracking = tracking == null || tracking.length === 0 ? undefined : tracking;\n\t\tthis.state = {\n\t\t\tahead: ahead,\n\t\t\tbehind: behind\n\t\t};\n\t}\n\n\tget formattedDate(): string {\n\t\treturn BranchDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(BranchDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\tget ref() {\n\t\treturn this.detached ? this.sha! : this.name;\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter | undefined {\n\t\treturn this.date === undefined ? undefined : Dates.getFormatter(this.date);\n\t}\n\n\t@memoize<GitBranch['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter === undefined ? '' : this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter === undefined ? '' : this.dateFormatter.fromNow();\n\t}\n\n\t@memoize()\n\tgetBasename(): string {\n\t\tconst name = this.getName();\n\t\tconst index = name.lastIndexOf('/');\n\t\treturn index !== -1 ? name.substring(index + 1) : name;\n\t}\n\n\t@memoize()\n\tgetName(): string {\n\t\treturn this.remote ? this.name.substring(this.name.indexOf('/') + 1) : this.name;\n\t}\n\n\t@memoize()\n\tasync getRemote(): Promise<GitRemote | undefined> {\n\t\tconst remoteName = this.getRemoteName();\n\t\tif (remoteName === undefined) return undefined;\n\n\t\tconst remotes = await Container.git.getRemotes(this.repoPath);\n\t\tif (remotes.length === 0) return undefined;\n\n\t\treturn remotes.find(r => r.name === remoteName);\n\t}\n\n\t@memoize()\n\tgetRemoteName(): string | undefined {\n\t\tif (this.remote) return GitBranch.getRemote(this.name);\n\t\tif (this.tracking !== undefined) return GitBranch.getRemote(this.tracking);\n\n\t\treturn undefined;\n\t}\n\n\tgetTrackingStatus(options?: {\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t}): string {\n\t\treturn GitStatus.getUpstreamStatus(this.tracking, this.state, options);\n\t}\n\n\tget starred() {\n\t\tconst starred = Container.context.workspaceState.get<StarredBranches>(WorkspaceState.StarredBranches);\n\t\treturn starred !== undefined && starred[this.id] === true;\n\t}\n\n\tstar() {\n\t\treturn this.updateStarred(true);\n\t}\n\n\tunstar() {\n\t\treturn this.updateStarred(false);\n\t}\n\n\tprivate async updateStarred(star: boolean) {\n\t\tlet starred = Container.context.workspaceState.get<StarredBranches>(WorkspaceState.StarredBranches);\n\t\tif (starred === undefined) {\n\t\t\tstarred = Object.create(null);\n\t\t}\n\n\t\tif (star) {\n\t\t\tstarred![this.id] = true;\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\tconst { [this.id]: _, ...rest } = starred!;\n\t\t\tstarred = rest;\n\t\t}\n\t\tawait Container.context.workspaceState.update(WorkspaceState.StarredBranches, starred);\n\t}\n\n\tstatic formatDetached(sha: string): string {\n\t\treturn `(${Git.shortenSha(sha)}...)`;\n\t}\n\n\tstatic getRemote(branch: string): string {\n\t\treturn branch.substring(0, branch.indexOf('/'));\n\t}\n\n\tstatic isDetached(name: string): boolean {\n\t\t// If there is whitespace in the name assume this is not a valid branch name\n\t\t// Deals with detached HEAD states\n\t\treturn whitespaceRegex.test(name) || name.includes('(detached)');\n\t}\n}\n","'use strict';\nimport { Disposable, Event, EventEmitter, TextDocument, TextEditor, Uri } from 'vscode';\nimport { CommandContext, getEditorIfActive, isActiveDocument, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { GitService, GitUri, Repository, RepositoryChange, RepositoryChangeEvent } from '../git/gitService';\nimport { Logger } from '../logger';\nimport { Functions } from '../system';\n\nexport interface DocumentBlameStateChangeEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n\treadonly blameable: boolean;\n}\n\nexport class TrackedDocument<T> implements Disposable {\n\tprivate _onDidBlameStateChange = new EventEmitter<DocumentBlameStateChangeEvent<T>>();\n\tget onDidBlameStateChange(): Event<DocumentBlameStateChangeEvent<T>> {\n\t\treturn this._onDidBlameStateChange.event;\n\t}\n\n\tstate: T | undefined;\n\n\tprivate _disposable: Disposable | undefined;\n\tprivate _disposed: boolean = false;\n\tprivate _repo: Promise<Repository | undefined>;\n\tprivate _uri!: GitUri;\n\n\tconstructor(\n\t\tprivate readonly _document: TextDocument,\n\t\tpublic readonly key: string,\n\t\tpublic dirty: boolean,\n\t\tprivate _eventDelegates: { onDidBlameStateChange(e: DocumentBlameStateChangeEvent<T>): void }\n\t) {\n\t\tthis._repo = this.initialize(_document.uri);\n\t}\n\n\tdispose() {\n\t\tthis._disposed = true;\n\t\tthis.reset('dispose');\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate async initialize(uri: Uri): Promise<Repository | undefined> {\n\t\t// Since there is a bit of a chicken & egg problem with the DocumentTracker and the GitService, wait for the GitService to load if it isn't\n\t\tif (Container.git === undefined) {\n\t\t\tif (!(await Functions.waitUntil(() => Container.git !== undefined, 2000))) {\n\t\t\t\tLogger.log(\n\t\t\t\t\t`TrackedDocument.initialize(${uri.toString(true)})`,\n\t\t\t\t\t'Timed out waiting for the GitService to start'\n\t\t\t\t);\n\t\t\t\tthrow new Error('TrackedDocument timed out waiting for the GitService to start');\n\t\t\t}\n\t\t}\n\n\t\tthis._uri = await GitUri.fromUri(uri);\n\t\tif (this._disposed) return undefined;\n\n\t\tconst repo = await Container.git.getRepository(this._uri);\n\t\tif (this._disposed) return undefined;\n\n\t\tif (repo !== undefined) {\n\t\t\tthis._disposable = repo.onDidChange(this.onRepositoryChanged, this);\n\t\t}\n\n\t\tawait this.update({ initializing: true, repo: repo });\n\n\t\treturn repo;\n\t}\n\n\tprivate onRepositoryChanged(e: RepositoryChangeEvent) {\n\t\tif (!e.changed(RepositoryChange.Repository)) return;\n\n\t\t// Reset any cached state\n\t\tthis.reset('repository');\n\t\tvoid this.update();\n\t}\n\n\tprivate _forceDirtyStateChangeOnNextDocumentChange: boolean = false;\n\tget forceDirtyStateChangeOnNextDocumentChange() {\n\t\treturn this._forceDirtyStateChangeOnNextDocumentChange;\n\t}\n\n\tprivate _hasRemotes: boolean = false;\n\tget hasRemotes() {\n\t\treturn this._hasRemotes;\n\t}\n\n\tget isBlameable() {\n\t\tif (this._blameFailed) return false;\n\n\t\treturn this._isTracked;\n\t}\n\n\tprivate _isDirtyIdle: boolean = false;\n\tget isDirtyIdle() {\n\t\treturn this._isDirtyIdle;\n\t}\n\tset isDirtyIdle(value: boolean) {\n\t\tthis._isDirtyIdle = value;\n\t}\n\n\tget isRevision() {\n\t\treturn this._uri !== undefined\n\t\t\t? Boolean(this._uri.sha) && this._uri.sha !== GitService.deletedOrMissingSha\n\t\t\t: false;\n\t}\n\n\tprivate _isTracked: boolean = false;\n\tget isTracked() {\n\t\treturn this._isTracked;\n\t}\n\n\tget lineCount(): number {\n\t\treturn this._document.lineCount;\n\t}\n\n\tget uri() {\n\t\treturn this._uri;\n\t}\n\n\tactivate() {\n\t\tsetCommandContext(CommandContext.ActiveFileStatus, this.getStatus());\n\t}\n\n\tasync ensureInitialized() {\n\t\tawait this._repo;\n\t}\n\n\tis(document: TextDocument) {\n\t\treturn document === this._document;\n\t}\n\n\treset(reason: 'config' | 'dispose' | 'document' | 'repository') {\n\t\tthis._blameFailed = false;\n\t\tthis._isDirtyIdle = false;\n\n\t\tif (this.state === undefined) return;\n\n\t\t// // Don't remove broken blame on change (since otherwise we'll have to run the broken blame again)\n\t\t// if (!this.state.hasErrors) {\n\n\t\tthis.state = undefined;\n\t\tLogger.log(`Reset state for '${this.key}', reason=${reason}`);\n\n\t\t// }\n\t}\n\n\tprivate _blameFailed: boolean = false;\n\tsetBlameFailure() {\n\t\tconst wasBlameable = this.isBlameable;\n\n\t\tthis._blameFailed = true;\n\n\t\tif (wasBlameable && isActiveDocument(this._document)) {\n\t\t\tvoid this.update({ forceBlameChange: true });\n\t\t}\n\t}\n\n\tresetForceDirtyStateChangeOnNextDocumentChange() {\n\t\tthis._forceDirtyStateChangeOnNextDocumentChange = false;\n\t}\n\n\tsetForceDirtyStateChangeOnNextDocumentChange() {\n\t\tthis._forceDirtyStateChangeOnNextDocumentChange = true;\n\t}\n\n\tasync update(options: { forceBlameChange?: boolean; initializing?: boolean; repo?: Repository } = {}) {\n\t\tif (this._disposed || this._uri === undefined) {\n\t\t\tthis._hasRemotes = false;\n\t\t\tthis._isTracked = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isDirtyIdle = false;\n\n\t\tconst active = getEditorIfActive(this._document);\n\t\tconst wasBlameable = options.forceBlameChange ? undefined : this.isBlameable;\n\n\t\tthis._isTracked = await Container.git.isTracked(this._uri);\n\n\t\tlet repo = undefined;\n\t\tif (this._isTracked) {\n\t\t\trepo = options.repo;\n\t\t\tif (repo === undefined) {\n\t\t\t\trepo = await this._repo;\n\t\t\t}\n\t\t}\n\n\t\tif (repo !== undefined) {\n\t\t\tthis._hasRemotes = await repo.hasRemotes();\n\t\t} else {\n\t\t\tthis._hasRemotes = false;\n\t\t}\n\n\t\tif (active !== undefined) {\n\t\t\tconst blameable = this.isBlameable;\n\n\t\t\tsetCommandContext(CommandContext.ActiveFileStatus, this.getStatus());\n\n\t\t\tif (!options.initializing && wasBlameable !== blameable) {\n\t\t\t\tconst e: DocumentBlameStateChangeEvent<T> = { editor: active, document: this, blameable: blameable };\n\t\t\t\tthis._onDidBlameStateChange.fire(e);\n\t\t\t\tthis._eventDelegates.onDidBlameStateChange(e);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getStatus() {\n\t\tlet status = '';\n\t\tif (this.isTracked) {\n\t\t\tstatus += 'tracked|';\n\t\t}\n\t\tif (this.isBlameable) {\n\t\t\tstatus += 'blameable|';\n\t\t}\n\t\tif (this.isRevision) {\n\t\t\tstatus += 'revision|';\n\t\t}\n\t\tif (this.hasRemotes) {\n\t\t\tstatus += 'remotes|';\n\t\t}\n\n\t\treturn status ? status : undefined;\n\t}\n}\n","'use strict';\nimport {\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEndOfLine,\n\tEvent,\n\tEventEmitter,\n\tPosition,\n\tRange,\n\tTextDocument,\n\tTextDocumentChangeEvent,\n\tTextEditor,\n\tTextLine,\n\tUri,\n\twindow,\n\tworkspace\n} from 'vscode';\nimport { configuration } from '../configuration';\nimport { CommandContext, DocumentSchemes, isActiveDocument, isTextEditor, setCommandContext } from '../constants';\nimport { GitUri } from '../git/gitService';\nimport { Deferrable, Functions } from '../system';\nimport { DocumentBlameStateChangeEvent, TrackedDocument } from './trackedDocument';\n\nexport * from './trackedDocument';\n\nexport interface DocumentDirtyStateChangeEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n\treadonly dirty: boolean;\n}\n\nexport interface DocumentDirtyIdleTriggerEvent<T> {\n\treadonly editor: TextEditor;\n\treadonly document: TrackedDocument<T>;\n}\n\nexport class DocumentTracker<T> implements Disposable {\n\tprivate _onDidChangeBlameState = new EventEmitter<DocumentBlameStateChangeEvent<T>>();\n\tget onDidChangeBlameState(): Event<DocumentBlameStateChangeEvent<T>> {\n\t\treturn this._onDidChangeBlameState.event;\n\t}\n\n\tprivate _onDidChangeDirtyState = new EventEmitter<DocumentDirtyStateChangeEvent<T>>();\n\tget onDidChangeDirtyState(): Event<DocumentDirtyStateChangeEvent<T>> {\n\t\treturn this._onDidChangeDirtyState.event;\n\t}\n\n\tprivate _onDidTriggerDirtyIdle = new EventEmitter<DocumentDirtyIdleTriggerEvent<T>>();\n\tget onDidTriggerDirtyIdle(): Event<DocumentDirtyIdleTriggerEvent<T>> {\n\t\treturn this._onDidTriggerDirtyIdle.event;\n\t}\n\n\tprivate _dirtyIdleTriggerDelay!: number;\n\tprivate readonly _disposable: Disposable | undefined;\n\tprivate readonly _documentMap: Map<TextDocument | string, TrackedDocument<T>> = new Map();\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this),\n\t\t\twindow.onDidChangeActiveTextEditor(this.onActiveTextEditorChanged, this),\n\t\t\t// window.onDidChangeVisibleTextEditors(Functions.debounce(this.onVisibleEditorsChanged, 5000), this),\n\t\t\tworkspace.onDidChangeTextDocument(Functions.debounce(this.onTextDocumentChanged, 50), this),\n\t\t\tworkspace.onDidCloseTextDocument(this.onTextDocumentClosed, this),\n\t\t\tworkspace.onDidSaveTextDocument(this.onTextDocumentSaved, this)\n\t\t);\n\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\n\t\tthis.clear();\n\t}\n\n\tinitialize() {\n\t\tthis.onActiveTextEditorChanged(window.activeTextEditor);\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\t// Only rest the cached state if we aren't initializing\n\t\tif (\n\t\t\t!configuration.initializing(e) &&\n\t\t\t(configuration.changed(e, 'blame', 'ignoreWhitespace', null) ||\n\t\t\t\tconfiguration.changed(e, 'advanced', 'caching', 'enabled'))\n\t\t) {\n\t\t\tfor (const d of this._documentMap.values()) {\n\t\t\t\td.reset('config');\n\t\t\t}\n\t\t}\n\n\t\tif (configuration.changed(e, 'advanced', 'blame', 'delayAfterEdit')) {\n\t\t\tthis._dirtyIdleTriggerDelay = configuration.get('advanced', 'blame', 'delayAfterEdit');\n\t\t\tthis._dirtyIdleTriggeredDebounced = undefined;\n\t\t}\n\t}\n\n\tprivate _timer: NodeJS.Timer | undefined;\n\tprivate onActiveTextEditorChanged(editor: TextEditor | undefined) {\n\t\tif (editor !== undefined && !isTextEditor(editor)) return;\n\n\t\tif (this._timer !== undefined) {\n\t\t\tclearTimeout(this._timer);\n\t\t\tthis._timer = undefined;\n\t\t}\n\n\t\tif (editor === undefined) {\n\t\t\tthis._timer = setTimeout(() => {\n\t\t\t\tthis._timer = undefined;\n\n\t\t\t\tsetCommandContext(CommandContext.ActiveFileStatus, undefined);\n\t\t\t}, 250);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst doc = this._documentMap.get(editor.document);\n\t\tif (doc !== undefined) {\n\t\t\tdoc.activate();\n\n\t\t\treturn;\n\t\t}\n\n\t\t// No need to activate this, as it is implicit in initialization if currently active\n\t\tthis.addCore(editor.document);\n\t}\n\n\tprivate onTextDocumentChanged(e: TextDocumentChangeEvent) {\n\t\tconst { scheme } = e.document.uri;\n\t\tif (scheme !== DocumentSchemes.File && scheme !== DocumentSchemes.Vsls) return;\n\n\t\tlet doc = this._documentMap.get(e.document);\n\t\tif (doc === undefined) {\n\t\t\tdoc = this.addCore(e.document);\n\t\t}\n\n\t\tdoc.reset('document');\n\n\t\tconst dirty = e.document.isDirty;\n\t\tconst editor = window.activeTextEditor;\n\n\t\t// If we have an idle tracker, either reset or cancel it\n\t\tif (this._dirtyIdleTriggeredDebounced !== undefined) {\n\t\t\tif (dirty) {\n\t\t\t\tthis._dirtyIdleTriggeredDebounced({ editor: editor!, document: doc });\n\t\t\t} else {\n\t\t\t\tthis._dirtyIdleTriggeredDebounced.cancel();\n\t\t\t}\n\t\t}\n\n\t\tif (!doc.forceDirtyStateChangeOnNextDocumentChange && doc.dirty === dirty) return;\n\n\t\tdoc.resetForceDirtyStateChangeOnNextDocumentChange();\n\t\tdoc.dirty = dirty;\n\n\t\t// Only fire state change events for the active document\n\t\tif (editor === undefined || editor.document !== e.document) return;\n\n\t\tthis.fireDocumentDirtyStateChanged({ editor: editor, document: doc, dirty: doc.dirty });\n\t}\n\n\tprivate onTextDocumentClosed(document: TextDocument) {\n\t\tconst doc = this._documentMap.get(document);\n\t\tif (doc === undefined) return;\n\n\t\tdoc.dispose();\n\t\tthis._documentMap.delete(document);\n\t\tthis._documentMap.delete(doc.key);\n\t}\n\n\tprivate onTextDocumentSaved(document: TextDocument) {\n\t\tconst doc = this._documentMap.get(document);\n\t\tif (doc !== undefined) {\n\t\t\tvoid doc.update({ forceBlameChange: true });\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If we are saving the active document make sure we are tracking it\n\t\tif (isActiveDocument(document)) {\n\t\t\tvoid this.addCore(document);\n\t\t}\n\t}\n\n\t// private onVisibleEditorsChanged(editors: TextEditor[]) {\n\t//     if (this._documentMap.size === 0) return;\n\n\t//     // If we have no visible editors, or no \"real\" visible editors reset our cache\n\t//     if (editors.length === 0 || editors.every(e => !isTextEditor(e))) {\n\t//         this.clear();\n\t//     }\n\t// }\n\n\tadd(document: TextDocument): Promise<TrackedDocument<T>>;\n\tadd(uri: Uri): Promise<TrackedDocument<T>>;\n\tadd(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\treturn this._add(documentOrId);\n\t}\n\n\tclear() {\n\t\tfor (const d of this._documentMap.values()) {\n\t\t\td.dispose();\n\t\t}\n\n\t\tthis._documentMap.clear();\n\t}\n\n\tget(fileName: string): Promise<TrackedDocument<T> | undefined>;\n\tget(document: TextDocument): Promise<TrackedDocument<T> | undefined>;\n\tget(uri: Uri): Promise<TrackedDocument<T> | undefined>;\n\tget(documentOrId: string | TextDocument | Uri): Promise<TrackedDocument<T> | undefined> {\n\t\treturn this._get(documentOrId);\n\t}\n\n\tasync getOrAdd(document: TextDocument): Promise<TrackedDocument<T>>;\n\tasync getOrAdd(uri: Uri): Promise<TrackedDocument<T>>;\n\tasync getOrAdd(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\tlet doc = await this._get(documentOrId);\n\t\tif (doc === undefined) {\n\t\t\tdoc = await this._add(documentOrId);\n\t\t}\n\t\treturn doc;\n\t}\n\n\thas(fileName: string): boolean;\n\thas(document: TextDocument): boolean;\n\thas(uri: Uri): boolean;\n\thas(key: string | TextDocument | Uri): boolean {\n\t\tif (typeof key === 'string' || key instanceof Uri) {\n\t\t\tkey = GitUri.toKey(key);\n\t\t}\n\t\treturn this._documentMap.has(key);\n\t}\n\n\tprivate async _add(documentOrId: TextDocument | Uri): Promise<TrackedDocument<T>> {\n\t\tlet document;\n\t\tif (GitUri.is(documentOrId)) {\n\t\t\ttry {\n\t\t\t\tdocument = await workspace.openTextDocument(documentOrId.documentUri({ useVersionedPath: true }));\n\t\t\t} catch (ex) {\n\t\t\t\tconst msg = ex.toString();\n\t\t\t\tif (msg.includes('File seems to be binary and cannot be opened as text')) {\n\t\t\t\t\tdocument = new BinaryTextDocument(documentOrId);\n\t\t\t\t} else if (msg.includes('File not found')) {\n\t\t\t\t\t// If we can't find the file, assume it is because the file has been renamed or deleted at some point\n\t\t\t\t\tdocument = new MissingRevisionTextDocument(documentOrId);\n\n\t\t\t\t\t// const [fileName, repoPath] = await Container.git.findWorkingFileName(documentOrId, undefined, ref);\n\t\t\t\t\t// if (fileName === undefined) throw new Error(`Failed to add tracking for document: ${documentOrId}`);\n\n\t\t\t\t\t// documentOrId = await workspace.openTextDocument(path.resolve(repoPath!, fileName));\n\t\t\t\t} else {\n\t\t\t\t\tthrow ex;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (documentOrId instanceof Uri) {\n\t\t\tdocument = await workspace.openTextDocument(documentOrId);\n\t\t} else {\n\t\t\tdocument = documentOrId;\n\t\t}\n\n\t\tconst doc = this.addCore(document);\n\t\tawait doc.ensureInitialized();\n\n\t\treturn doc;\n\t}\n\n\tprivate async _get(documentOrId: string | TextDocument | Uri) {\n\t\tif (GitUri.is(documentOrId)) {\n\t\t\tdocumentOrId = GitUri.toKey(documentOrId.documentUri({ useVersionedPath: true }));\n\t\t} else if (typeof documentOrId === 'string' || documentOrId instanceof Uri) {\n\t\t\tdocumentOrId = GitUri.toKey(documentOrId);\n\t\t}\n\n\t\tconst doc = this._documentMap.get(documentOrId);\n\t\tif (doc === undefined) return undefined;\n\n\t\tawait doc.ensureInitialized();\n\t\treturn doc;\n\t}\n\n\tprivate addCore(document: TextDocument): TrackedDocument<T> {\n\t\tconst key = GitUri.toKey(document.uri);\n\n\t\t// Always start out false, so we will fire the event if needed\n\t\tconst doc = new TrackedDocument<T>(document, key, false, {\n\t\t\tonDidBlameStateChange: (e: DocumentBlameStateChangeEvent<T>) => this._onDidChangeBlameState.fire(e)\n\t\t});\n\t\tthis._documentMap.set(document, doc);\n\t\tthis._documentMap.set(key, doc);\n\n\t\treturn doc;\n\t}\n\n\tprivate _dirtyIdleTriggeredDebounced: (((e: DocumentDirtyIdleTriggerEvent<T>) => void) & Deferrable) | undefined;\n\tprivate _dirtyStateChangedDebounced: (((e: DocumentDirtyStateChangeEvent<T>) => void) & Deferrable) | undefined;\n\tprivate fireDocumentDirtyStateChanged(e: DocumentDirtyStateChangeEvent<T>) {\n\t\tif (e.dirty) {\n\t\t\tsetImmediate(async () => {\n\t\t\t\tif (this._dirtyStateChangedDebounced !== undefined) {\n\t\t\t\t\tthis._dirtyStateChangedDebounced.cancel();\n\t\t\t\t}\n\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tawait e.document.ensureInitialized();\n\t\t\t\tthis._onDidChangeDirtyState.fire(e);\n\t\t\t});\n\n\t\t\tif (this._dirtyIdleTriggerDelay > 0) {\n\t\t\t\tif (this._dirtyIdleTriggeredDebounced === undefined) {\n\t\t\t\t\tthis._dirtyIdleTriggeredDebounced = Functions.debounce(\n\t\t\t\t\t\tasync (e: DocumentDirtyIdleTriggerEvent<T>) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis._dirtyIdleTriggeredDebounced !== undefined &&\n\t\t\t\t\t\t\t\tthis._dirtyIdleTriggeredDebounced.pending!()\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tawait e.document.ensureInitialized();\n\n\t\t\t\t\t\t\te.document.isDirtyIdle = true;\n\t\t\t\t\t\t\tthis._onDidTriggerDirtyIdle.fire(e);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tthis._dirtyIdleTriggerDelay,\n\t\t\t\t\t\t{ track: true }\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis._dirtyIdleTriggeredDebounced({ editor: e.editor, document: e.document });\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._dirtyStateChangedDebounced === undefined) {\n\t\t\tthis._dirtyStateChangedDebounced = Functions.debounce(async (e: DocumentDirtyStateChangeEvent<T>) => {\n\t\t\t\tif (window.activeTextEditor !== e.editor) return;\n\n\t\t\t\tawait e.document.ensureInitialized();\n\t\t\t\tthis._onDidChangeDirtyState.fire(e);\n\t\t\t}, 250);\n\t\t}\n\n\t\tthis._dirtyStateChangedDebounced(e);\n\t}\n}\n\nclass EmptyTextDocument implements TextDocument {\n\treadonly eol: EndOfLine;\n\treadonly fileName: string;\n\treadonly isClosed: boolean;\n\treadonly isDirty: boolean;\n\treadonly isUntitled: boolean;\n\treadonly languageId: string;\n\treadonly lineCount: number;\n\treadonly uri: Uri;\n\treadonly version: number;\n\n\tconstructor(public readonly gitUri: GitUri) {\n\t\tthis.uri = gitUri.documentUri({ useVersionedPath: true });\n\n\t\tthis.eol = EndOfLine.LF;\n\t\tthis.fileName = this.uri.fsPath;\n\t\tthis.isClosed = false;\n\t\tthis.isDirty = false;\n\t\tthis.isUntitled = false;\n\t\tthis.languageId = '';\n\t\tthis.lineCount = 0;\n\t\tthis.version = 0;\n\t}\n\n\tgetText(range?: Range | undefined): string {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tgetWordRangeAtPosition(position: Position, regex?: RegExp | undefined): Range | undefined {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tlineAt(line: number): TextLine;\n\tlineAt(position: Position): TextLine;\n\tlineAt(position: any): TextLine {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\toffsetAt(position: Position): number {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tpositionAt(offset: number): Position {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tsave(): Thenable<boolean> {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tvalidatePosition(position: Position): Position {\n\t\tthrow new Error('Method not supported.');\n\t}\n\n\tvalidateRange(range: Range): Range {\n\t\tthrow new Error('Method not supported.');\n\t}\n}\n\nclass BinaryTextDocument extends EmptyTextDocument {}\nclass MissingRevisionTextDocument extends EmptyTextDocument {}\n","'use strict';\nimport { GitBlame, GitDiff, GitLog } from '../git/git';\nimport { DocumentTracker } from './documentTracker';\n\nexport * from './documentTracker';\n\ninterface CachedItem<T> {\n\titem: Promise<T>;\n\terrorMessage?: string;\n}\n\nexport type CachedBlame = CachedItem<GitBlame>;\nexport type CachedDiff = CachedItem<GitDiff>;\nexport type CachedLog = CachedItem<GitLog>;\n\nexport class GitDocumentState {\n\tprivate cache: Map<string, CachedBlame | CachedDiff | CachedLog> = new Map();\n\n\tconstructor(public readonly key: string) {}\n\n\tget<T extends CachedBlame | CachedDiff | CachedLog>(key: string): T | undefined {\n\t\treturn this.cache.get(key) as T;\n\t}\n\n\tset<T extends CachedBlame | CachedDiff | CachedLog>(key: string, value: T) {\n\t\tthis.cache.set(key, value);\n\t}\n}\n\nexport class GitDocumentTracker extends DocumentTracker<GitDocumentState> {}\n","'use strict';\nimport { CancellationToken } from 'vscode';\n\nexport namespace Promises {\n\texport function cancellable<T>(promise: Promise<T>, token: CancellationToken): Promise<T | undefined> {\n\t\treturn new Promise<T | undefined>((resolve, reject) => {\n\t\t\ttoken.onCancellationRequested(() => resolve(undefined));\n\n\t\t\tpromise.then(resolve, reject);\n\t\t});\n\t}\n\n\texport function is<T>(obj: T | Promise<T>): obj is Promise<T> {\n\t\treturn obj && typeof (obj as Promise<T>).then === 'function';\n\t}\n\n\texport class TimeoutError<T> extends Error {\n\t\tconstructor(public readonly promise: T) {\n\t\t\tsuper('Promise timed out');\n\t\t}\n\t}\n\n\texport function timeout<T>(promise: Promise<T>, ms: number): Promise<T> {\n\t\treturn new Promise<T>((resolve, reject) => {\n\t\t\tsetTimeout(() => reject(new TimeoutError(promise)), ms);\n\n\t\t\tpromise.then(resolve, reject);\n\t\t});\n\t}\n}\n","'use strict';\nimport * as emojis from './emojis.json';\n\nconst emojiMap: { [key: string]: string } = (emojis as any).default;\nconst emojiRegex = /:([-+_a-z0-9]+):/g;\n\nexport function emojify(message: string) {\n\treturn message.replace(emojiRegex, (s, code) => {\n\t\treturn emojiMap[code] || s;\n\t});\n}\n","module.exports = require(\"buffer\");","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","\"use strict\";\n\n// Some environments don't have global Buffer (e.g. React Native).\n// Solution would be installing npm modules \"buffer\" and \"stream\" explicitly.\nvar Buffer = require(\"safer-buffer\").Buffer;\n\nvar bomHandling = require(\"./bom-handling\"),\n    iconv = module.exports;\n\n// All codecs and aliases are kept here, keyed by encoding name/alias.\n// They are lazy loaded in `iconv.getCodec` from `encodings/index.js`.\niconv.encodings = null;\n\n// Characters emitted in case of error.\niconv.defaultCharUnicode = '';\niconv.defaultCharSingleByte = '?';\n\n// Public API.\niconv.encode = function encode(str, encoding, options) {\n    str = \"\" + (str || \"\"); // Ensure string.\n\n    var encoder = iconv.getEncoder(encoding, options);\n\n    var res = encoder.write(str);\n    var trail = encoder.end();\n    \n    return (trail && trail.length > 0) ? Buffer.concat([res, trail]) : res;\n}\n\niconv.decode = function decode(buf, encoding, options) {\n    if (typeof buf === 'string') {\n        if (!iconv.skipDecodeWarning) {\n            console.error('Iconv-lite warning: decode()-ing strings is deprecated. Refer to https://github.com/ashtuchkin/iconv-lite/wiki/Use-Buffers-when-decoding');\n            iconv.skipDecodeWarning = true;\n        }\n\n        buf = Buffer.from(\"\" + (buf || \"\"), \"binary\"); // Ensure buffer.\n    }\n\n    var decoder = iconv.getDecoder(encoding, options);\n\n    var res = decoder.write(buf);\n    var trail = decoder.end();\n\n    return trail ? (res + trail) : res;\n}\n\niconv.encodingExists = function encodingExists(enc) {\n    try {\n        iconv.getCodec(enc);\n        return true;\n    } catch (e) {\n        return false;\n    }\n}\n\n// Legacy aliases to convert functions\niconv.toEncoding = iconv.encode;\niconv.fromEncoding = iconv.decode;\n\n// Search for a codec in iconv.encodings. Cache codec data in iconv._codecDataCache.\niconv._codecDataCache = {};\niconv.getCodec = function getCodec(encoding) {\n    if (!iconv.encodings)\n        iconv.encodings = require(\"../encodings\"); // Lazy load all encoding definitions.\n    \n    // Canonicalize encoding name: strip all non-alphanumeric chars and appended year.\n    var enc = iconv._canonicalizeEncoding(encoding);\n\n    // Traverse iconv.encodings to find actual codec.\n    var codecOptions = {};\n    while (true) {\n        var codec = iconv._codecDataCache[enc];\n        if (codec)\n            return codec;\n\n        var codecDef = iconv.encodings[enc];\n\n        switch (typeof codecDef) {\n            case \"string\": // Direct alias to other encoding.\n                enc = codecDef;\n                break;\n\n            case \"object\": // Alias with options. Can be layered.\n                for (var key in codecDef)\n                    codecOptions[key] = codecDef[key];\n\n                if (!codecOptions.encodingName)\n                    codecOptions.encodingName = enc;\n                \n                enc = codecDef.type;\n                break;\n\n            case \"function\": // Codec itself.\n                if (!codecOptions.encodingName)\n                    codecOptions.encodingName = enc;\n\n                // The codec function must load all tables and return object with .encoder and .decoder methods.\n                // It'll be called only once (for each different options object).\n                codec = new codecDef(codecOptions, iconv);\n\n                iconv._codecDataCache[codecOptions.encodingName] = codec; // Save it to be reused later.\n                return codec;\n\n            default:\n                throw new Error(\"Encoding not recognized: '\" + encoding + \"' (searched as: '\"+enc+\"')\");\n        }\n    }\n}\n\niconv._canonicalizeEncoding = function(encoding) {\n    // Canonicalize encoding name: strip all non-alphanumeric chars and appended year.\n    return (''+encoding).toLowerCase().replace(/:\\d{4}$|[^0-9a-z]/g, \"\");\n}\n\niconv.getEncoder = function getEncoder(encoding, options) {\n    var codec = iconv.getCodec(encoding),\n        encoder = new codec.encoder(options, codec);\n\n    if (codec.bomAware && options && options.addBOM)\n        encoder = new bomHandling.PrependBOM(encoder, options);\n\n    return encoder;\n}\n\niconv.getDecoder = function getDecoder(encoding, options) {\n    var codec = iconv.getCodec(encoding),\n        decoder = new codec.decoder(options, codec);\n\n    if (codec.bomAware && !(options && options.stripBOM === false))\n        decoder = new bomHandling.StripBOM(decoder, options);\n\n    return decoder;\n}\n\n\n// Load extensions in Node. All of them are omitted in Browserify build via 'browser' field in package.json.\nvar nodeVer = typeof process !== 'undefined' && process.versions && process.versions.node;\nif (nodeVer) {\n\n    // Load streaming support in Node v0.10+\n    var nodeVerArr = nodeVer.split(\".\").map(Number);\n    if (nodeVerArr[0] > 0 || nodeVerArr[1] >= 10) {\n        require(\"./streams\")(iconv);\n    }\n\n    // Load Node primitive extensions.\n    require(\"./extend-node\")(iconv);\n}\n\nif (\"\" != \"\\u0100\") {\n    console.error(\"iconv-lite warning: javascript files use encoding different from utf-8. See https://github.com/ashtuchkin/iconv-lite/wiki/Javascript-source-file-encodings for more info.\");\n}\n","'use strict';\n\nimport { Git } from '../git';\n\nexport interface GitReference {\n\treadonly refType: 'branch' | 'tag' | 'revision';\n\tname: string;\n\tref: string;\n}\n\nexport namespace GitReference {\n\texport function create(\n\t\tref: string,\n\t\t{ name, refType }: { name?: string; refType?: 'branch' | 'tag' } = {}\n\t): GitReference {\n\t\treturn { name: name || Git.shortenSha(ref, { force: true }), ref: ref, refType: refType || 'revision' };\n\t}\n\n\texport function isOfRefType(ref: GitReference | undefined, refType: 'branch' | 'tag' | 'revision' = 'revision') {\n\t\treturn ref !== undefined && ref.refType === refType;\n\t}\n}\n\nexport * from './blame';\nexport * from './blameCommit';\nexport * from './branch';\nexport * from './commit';\nexport * from './contributor';\nexport * from './diff';\nexport * from './file';\nexport * from './log';\nexport * from './logCommit';\nexport * from './remote';\nexport * from './repository';\nexport * from './reflog';\nexport * from './shortlog';\nexport * from './stash';\nexport * from './stashCommit';\nexport * from './status';\nexport * from './tag';\nexport * from './tree';\n","'use strict';\nimport { Uri } from 'vscode';\nimport { GlyphChars } from '../../constants';\nimport { memoize, Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitBranch, GitTrackingState } from './branch';\nimport { GitFile, GitFileStatus } from './file';\n\nexport class GitStatus {\n\treadonly detached: boolean;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly branch: string,\n\t\tpublic readonly sha: string,\n\t\tpublic readonly files: GitStatusFile[],\n\t\tpublic readonly state: GitTrackingState,\n\t\tpublic readonly upstream?: string\n\t) {\n\t\tthis.detached = GitBranch.isDetached(branch);\n\t\tif (this.detached) {\n\t\t\tthis.branch = GitBranch.formatDetached(this.sha);\n\t\t}\n\t}\n\n\tget ref() {\n\t\treturn this.detached ? this.sha : this.branch;\n\t}\n\n\t@memoize()\n\tgetDiffStatus() {\n\t\tconst diff = {\n\t\t\tadded: 0,\n\t\t\tdeleted: 0,\n\t\t\tchanged: 0\n\t\t};\n\n\t\tif (this.files.length === 0) return diff;\n\n\t\tfor (const f of this.files) {\n\t\t\tswitch (f.status) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tdiff.added++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tdiff.deleted++;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdiff.changed++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\tgetFormattedDiffStatus({\n\t\tcompact,\n\t\tempty,\n\t\texpand,\n\t\tprefix = '',\n\t\tseparator = ' ',\n\t\tsuffix = ''\n\t}: {\n\t\tcompact?: boolean;\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t} = {}): string {\n\t\tconst { added, changed, deleted } = this.getDiffStatus();\n\t\tif (added === 0 && changed === 0 && deleted === 0) return empty || '';\n\n\t\tif (expand) {\n\t\t\tlet status = '';\n\t\t\tif (added) {\n\t\t\t\tstatus += `${Strings.pluralize('file', added)} added`;\n\t\t\t}\n\t\t\tif (changed) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('file', changed)} changed`;\n\t\t\t}\n\t\t\tif (deleted) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('file', deleted)} deleted`;\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\tlet status = '';\n\t\tif (compact) {\n\t\t\tif (added !== 0) {\n\t\t\t\tstatus += `+${added}`;\n\t\t\t}\n\t\t\tif (changed !== 0) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}~${changed}`;\n\t\t\t}\n\t\t\tif (deleted !== 0) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}-${deleted}`;\n\t\t\t}\n\t\t} else {\n\t\t\tstatus += `+${added}${separator}~${changed}${separator}-${deleted}`;\n\t\t}\n\n\t\treturn `${prefix}${status}${suffix}`;\n\t}\n\n\tgetUpstreamStatus(options: {\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t}): string {\n\t\treturn GitStatus.getUpstreamStatus(this.upstream, this.state, options);\n\t}\n\n\tstatic getUpstreamStatus(\n\t\tupstream: string | undefined,\n\t\tstate: { ahead: number; behind: number },\n\t\toptions: { empty?: string; expand?: boolean; prefix?: string; separator?: string; suffix?: string } = {}\n\t): string {\n\t\tif (upstream === undefined || (state.behind === 0 && state.ahead === 0)) return options.empty || '';\n\n\t\tconst { expand, prefix = '', separator = ' ', suffix = '' } = options;\n\t\tif (expand) {\n\t\t\tlet status = '';\n\t\t\tif (state.behind) {\n\t\t\t\tstatus += `${Strings.pluralize('commit', state.behind)} behind`;\n\t\t\t}\n\t\t\tif (state.ahead) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize('commit', state.ahead)} ahead`;\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\treturn `${prefix}${state.behind}${GlyphChars.ArrowDown}${separator}${state.ahead}${GlyphChars.ArrowUp}${suffix}`;\n\t}\n}\n\nexport class GitStatusFile implements GitFile {\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly indexStatus: GitFileStatus | undefined,\n\t\tpublic readonly workingTreeStatus: GitFileStatus | undefined,\n\t\tpublic readonly fileName: string,\n\t\tpublic readonly originalFileName?: string\n\t) {}\n\n\tget status(): GitFileStatus {\n\t\treturn this.indexStatus || this.workingTreeStatus || '?';\n\t}\n\n\tget staged() {\n\t\treturn this.indexStatus !== undefined;\n\t}\n\n\t@memoize()\n\tget uri(): Uri {\n\t\treturn GitUri.resolveToUri(this.fileName, this.repoPath);\n\t}\n\n\tgetFormattedDirectory(includeOriginal: boolean = false): string {\n\t\treturn GitFile.getFormattedDirectory(this, includeOriginal);\n\t}\n\n\tgetFormattedPath(options: { relativeTo?: string; separator?: string; suffix?: string } = {}): string {\n\t\treturn GitFile.getFormattedPath(this, options);\n\t}\n\n\tgetOcticon() {\n\t\treturn GitFile.getStatusOcticon(this.status);\n\t}\n\n\tgetStatusText(): string {\n\t\treturn GitFile.getStatusText(this.status);\n\t}\n\n\twith(changes: {\n\t\tindexStatus?: GitFileStatus | null;\n\t\tworkTreeStatus?: GitFileStatus | null;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t}): GitStatusFile {\n\t\treturn new GitStatusFile(\n\t\t\tthis.repoPath,\n\t\t\tthis.getChangedValue(changes.indexStatus, this.indexStatus) as GitFileStatus,\n\t\t\tthis.getChangedValue(changes.workTreeStatus, this.workingTreeStatus) as GitFileStatus,\n\t\t\tchanges.fileName || this.fileName,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName)\n\t\t);\n\t}\n\n\tprotected getChangedValue<T>(change: T | null | undefined, original: T | undefined): T | undefined {\n\t\tif (change === undefined) return original;\n\t\treturn change !== null ? change : undefined;\n\t}\n}\n","'use strict';\nimport { GitDiff, GitDiffHunk, GitDiffHunkLine, GitDiffLine, GitDiffShortStat, GitFile, GitFileStatus } from '../git';\nimport { debug, Strings } from '../../system';\n\nconst nameStatusDiffRegex = /^(.*?)\\t(.*?)(?:\\t(.*?))?$/gm;\nconst shortStatDiffRegex = /^\\s*(\\d+)\\sfiles? changed(?:,\\s+(\\d+)\\s+insertions?\\(\\+\\))?(?:,\\s+(\\d+)\\s+deletions?\\(-\\))?/;\nconst unifiedDiffRegex = /^@@ -([\\d]+)(?:,([\\d]+))? \\+([\\d]+)(?:,([\\d]+))? @@(?:.*?)\\n([\\s\\S]*?)(?=^@@)/gm;\n\nexport class GitDiffParser {\n\t@debug({ args: false, singleLine: true })\n\tstatic parse(data: string, debug: boolean = false): GitDiff | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst hunks: GitDiffHunk[] = [];\n\n\t\tlet previousStart;\n\t\tlet previousCount;\n\t\tlet currentStart;\n\t\tlet currentCount;\n\t\tlet hunk;\n\n\t\tlet match;\n\t\tdo {\n\t\t\tmatch = unifiedDiffRegex.exec(`${data}\\n@@`);\n\t\t\tif (match == null) break;\n\n\t\t\t[, previousStart, previousCount, currentStart, currentCount, hunk] = match;\n\n\t\t\tpreviousStart = Number(previousStart) || 0;\n\t\t\tcurrentStart = Number(currentStart) || 0;\n\n\t\t\thunks.push(\n\t\t\t\tnew GitDiffHunk(\n\t\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\t\t` ${hunk}`.substr(1),\n\t\t\t\t\t{\n\t\t\t\t\t\tstart: currentStart,\n\t\t\t\t\t\tend: currentStart + (Number(currentCount) || 0)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tstart: previousStart,\n\t\t\t\t\t\tend: previousStart + (Number(previousCount) || 0)\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t} while (true);\n\n\t\tif (!hunks.length) return undefined;\n\n\t\tconst diff: GitDiff = {\n\t\t\tdiff: debug ? data : undefined,\n\t\t\thunks: hunks\n\t\t};\n\t\treturn diff;\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseHunk(hunk: GitDiffHunk): GitDiffHunkLine[] {\n\t\tconst currentLines: (GitDiffLine | undefined)[] = [];\n\t\tconst previousLines: (GitDiffLine | undefined)[] = [];\n\n\t\tlet removed = 0;\n\t\tfor (const l of Strings.lines(hunk.diff)) {\n\t\t\tswitch (l[0]) {\n\t\t\t\tcase '+':\n\t\t\t\t\tcurrentLines.push({\n\t\t\t\t\t\tline: ` ${l.substring(1)}`,\n\t\t\t\t\t\tstate: 'added'\n\t\t\t\t\t});\n\n\t\t\t\t\tif (removed > 0) {\n\t\t\t\t\t\tremoved--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpreviousLines.push(undefined);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '-':\n\t\t\t\t\tremoved++;\n\n\t\t\t\t\tpreviousLines.push({\n\t\t\t\t\t\tline: ` ${l.substring(1)}`,\n\t\t\t\t\t\tstate: 'removed'\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\twhile (removed > 0) {\n\t\t\t\t\t\tremoved--;\n\t\t\t\t\t\tcurrentLines.push(undefined);\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentLines.push({ line: l, state: 'unchanged' });\n\t\t\t\t\tpreviousLines.push({ line: l, state: 'unchanged' });\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\twhile (removed > 0) {\n\t\t\tremoved--;\n\t\t\tcurrentLines.push(undefined);\n\t\t}\n\n\t\tconst hunkLines: GitDiffHunkLine[] = [];\n\n\t\tfor (let i = 0; i < currentLines.length; i++) {\n\t\t\thunkLines.push({\n\t\t\t\thunk: hunk,\n\t\t\t\tcurrent: currentLines[i],\n\t\t\t\tprevious: previousLines[i]\n\t\t\t});\n\t\t}\n\n\t\treturn hunkLines;\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseNameStatus(data: string, repoPath: string): GitFile[] | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst files: GitFile[] = [];\n\n\t\tlet status: string;\n\t\tlet fileName: string;\n\t\tlet originalFileName: string;\n\n\t\tlet match: RegExpExecArray | null;\n\t\tdo {\n\t\t\tmatch = nameStatusDiffRegex.exec(data);\n\t\t\tif (match == null) break;\n\n\t\t\t[, status, fileName, originalFileName] = match;\n\n\t\t\tfiles.push({\n\t\t\t\trepoPath: repoPath,\n\t\t\t\tstatus: (!status.startsWith('.') ? status[0].trim() : '?') as GitFileStatus,\n\t\t\t\tindexStatus: undefined,\n\t\t\t\tworkingTreeStatus: undefined,\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\tfileName: ` ${fileName}`.substr(1),\n\t\t\t\t// Stops excessive memory usage -- https://bugs.chromium.org/p/v8/issues/detail?id=2869\n\t\t\t\toriginalFileName:\n\t\t\t\t\toriginalFileName == null || originalFileName.length === 0\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: ` ${originalFileName}`.substr(1)\n\t\t\t});\n\t\t} while (true);\n\n\t\treturn files;\n\t}\n\n\t@debug({ args: false, singleLine: true })\n\tstatic parseShortStat(data: string): GitDiffShortStat | undefined {\n\t\tif (!data) return undefined;\n\n\t\tconst match = shortStatDiffRegex.exec(data);\n\t\tif (match == null) return undefined;\n\n\t\tconst [, files, insertions, deletions] = match;\n\n\t\tconst diffShortStat: GitDiffShortStat = {\n\t\t\tfiles: files == null ? 0 : parseInt(files, 10),\n\t\t\tinsertions: insertions == null ? 0 : parseInt(insertions, 10),\n\t\t\tdeletions: deletions == null ? 0 : parseInt(deletions, 10)\n\t\t};\n\n\t\treturn diffShortStat;\n\t}\n}\n","'use strict';\nimport { Dates, memoize } from '../../system';\nimport { CommitDateFormatting, Git } from '../git';\nimport { DateStyle } from '../../config';\n\nexport interface GitReflog {\n\treadonly repoPath: string;\n\treadonly records: GitReflogRecord[];\n\n\treadonly count: number;\n\treadonly maxCount: number | undefined;\n\treadonly truncated: boolean;\n}\n\nexport class GitReflogRecord {\n\tprivate _previousSha: string | undefined;\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly sha: string,\n\t\tprivate _selector: string,\n\t\tpublic readonly date: Date,\n\t\tpublic readonly command: string,\n\t\tpublic readonly commandArgs: string | undefined,\n\t\tpublic readonly details: string | undefined\n\t) {}\n\n\t@memoize<GitReflogRecord['formatDate']>(format => (format == null ? 'MMMM Do, YYYY h:mma' : format))\n\tformatDate(format?: string | null) {\n\t\tif (format == null) {\n\t\t\tformat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\treturn this.dateFormatter.format(format);\n\t}\n\n\tformatDateFromNow() {\n\t\treturn this.dateFormatter.fromNow();\n\t}\n\n\tget formattedDate(): string {\n\t\treturn CommitDateFormatting.dateStyle === DateStyle.Absolute\n\t\t\t? this.formatDate(CommitDateFormatting.dateFormat)\n\t\t\t: this.formatDateFromNow();\n\t}\n\n\t@memoize()\n\tget HEAD() {\n\t\tif (this._selector == null || this._selector.length === 0) return '';\n\n\t\tif (this._selector.startsWith('refs/heads')) {\n\t\t\treturn this._selector.substr(11);\n\t\t}\n\n\t\tif (this._selector.startsWith('refs/remotes')) {\n\t\t\treturn this._selector.substr(13);\n\t\t}\n\n\t\treturn this._selector;\n\t}\n\n\tget previousSha() {\n\t\treturn this._previousSha;\n\t}\n\n\t@memoize()\n\tget previousShortSha() {\n\t\treturn Git.shortenSha(this._previousSha);\n\t}\n\n\tget selector() {\n\t\treturn this._selector;\n\t}\n\n\t@memoize()\n\tget shortSha() {\n\t\treturn Git.shortenSha(this.sha);\n\t}\n\n\tupdate(previousSha?: string, selector?: string) {\n\t\tif (previousSha !== undefined) {\n\t\t\tthis._previousSha = previousSha;\n\t\t}\n\t\tif (selector !== undefined) {\n\t\t\tthis._selector = selector;\n\t\t}\n\t}\n\n\t@memoize()\n\tprivate get dateFormatter(): Dates.DateFormatter {\n\t\treturn Dates.getFormatter(this.date);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { memoize, Strings } from '../../system';\nimport { GitUri } from '../gitUri';\nimport { GitCommit, GitCommitType } from './commit';\nimport { GitFile, GitFileStatus } from './file';\n\nconst emptyStats = Object.freeze({\n\tadded: 0,\n\tdeleted: 0,\n\tchanged: 0\n});\n\nexport interface GitLogCommitLine {\n\tfrom: {\n\t\tline: number;\n\t\tcount: number;\n\t};\n\tto: {\n\t\tline: number;\n\t\tcount: number;\n\t};\n}\n\nexport class GitLogCommit extends GitCommit {\n\tstatic is(commit: any): commit is GitLogCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitLogCommit\n\t\t\t// || (commit.repoPath !== undefined &&\n\t\t\t//     commit.sha !== undefined &&\n\t\t\t//     (commit.type === GitCommitType.Log || commit.type === GitCommitType.LogFile))\n\t\t);\n\t}\n\n\tnextSha?: string;\n\tnextFileName?: string;\n\n\tconstructor(\n\t\ttype: GitCommitType,\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthor: string,\n\t\temail: string | undefined,\n\t\tauthorDate: Date,\n\t\tcommitterDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\tpublic readonly files: GitFile[],\n\t\tpublic readonly status?: GitFileStatus | undefined,\n\t\toriginalFileName?: string | undefined,\n\t\tpreviousSha?: string | undefined,\n\t\tpreviousFileName?: string | undefined,\n\t\tprivate readonly _fileStats?:\n\t\t\t| {\n\t\t\t\t\tinsertions: number;\n\t\t\t\t\tdeletions: number;\n\t\t\t  }\n\t\t\t| undefined,\n\t\tpublic readonly parentShas?: string[],\n\t\tpublic readonly line?: GitLogCommitLine\n\t) {\n\t\tsuper(\n\t\t\ttype,\n\t\t\trepoPath,\n\t\t\tsha,\n\t\t\tauthor,\n\t\t\temail,\n\t\t\tauthorDate,\n\t\t\tcommitterDate,\n\t\t\tmessage,\n\t\t\tfileName,\n\t\t\toriginalFileName,\n\t\t\tpreviousSha || `${sha}^`,\n\t\t\tpreviousFileName\n\t\t);\n\t}\n\n\tget isMerge() {\n\t\treturn this.parentShas && this.parentShas.length > 1;\n\t}\n\n\tget nextUri(): Uri {\n\t\treturn this.nextFileName ? GitUri.resolveToUri(this.nextFileName, this.repoPath) : this.uri;\n\t}\n\n\tget previousFileSha(): string {\n\t\treturn this.isFile ? this.previousSha! : `${this.sha}^`;\n\t}\n\n\t@memoize()\n\tgetDiffStatus() {\n\t\tif (this._fileStats !== undefined) {\n\t\t\treturn {\n\t\t\t\tadded: this._fileStats.insertions,\n\t\t\t\tdeleted: this._fileStats.deletions,\n\t\t\t\tchanged: 0\n\t\t\t};\n\t\t}\n\n\t\tif (this.isFile || this.files.length === 0) return emptyStats;\n\n\t\tconst diff = {\n\t\t\tadded: 0,\n\t\t\tdeleted: 0,\n\t\t\tchanged: 0\n\t\t};\n\t\tfor (const f of this.files) {\n\t\t\tswitch (f.status) {\n\t\t\t\tcase 'A':\n\t\t\t\tcase '?':\n\t\t\t\t\tdiff.added++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tdiff.deleted++;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdiff.changed++;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn diff;\n\t}\n\n\tgetFormattedDiffStatus({\n\t\tcompact,\n\t\tempty,\n\t\texpand,\n\t\tprefix = '',\n\t\tseparator = ' ',\n\t\tsuffix = ''\n\t}: {\n\t\tcompact?: boolean;\n\t\tempty?: string;\n\t\texpand?: boolean;\n\t\tprefix?: string;\n\t\tseparator?: string;\n\t\tsuffix?: string;\n\t} = {}): string {\n\t\tconst { added, changed, deleted } = this.getDiffStatus();\n\t\tif (added === 0 && changed === 0 && deleted === 0) return empty || '';\n\n\t\tif (expand) {\n\t\t\tconst type = this.isFile ? 'line' : 'file';\n\n\t\t\tlet status = '';\n\t\t\tif (added) {\n\t\t\t\tstatus += `${Strings.pluralize(type, added)} added`;\n\t\t\t}\n\t\t\tif (changed) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize(type, changed)} changed`;\n\t\t\t}\n\t\t\tif (deleted) {\n\t\t\t\tstatus += `${status.length === 0 ? '' : separator}${Strings.pluralize(type, deleted)} deleted`;\n\t\t\t}\n\t\t\treturn `${prefix}${status}${suffix}`;\n\t\t}\n\n\t\t// When `isFile` we are getting line changes -- and we can't get changed lines (only inserts and deletes)\n\t\treturn `${prefix}${compact && added === 0 ? '' : `+${added}${separator}`}${\n\t\t\t(compact || this.isFile) && changed === 0 ? '' : `~${changed}${separator}`\n\t\t}${compact && deleted === 0 ? '' : `-${deleted}`}${suffix}`;\n\t}\n\n\ttoFileCommit(fileName: string): GitLogCommit | undefined;\n\ttoFileCommit(file: GitFile): GitLogCommit;\n\ttoFileCommit(fileNameOrFile: string | GitFile): GitLogCommit | undefined {\n\t\tconst fileName =\n\t\t\ttypeof fileNameOrFile === 'string'\n\t\t\t\t? GitUri.relativeTo(fileNameOrFile, this.repoPath)\n\t\t\t\t: fileNameOrFile.fileName;\n\t\tconst file = this.files.find(f => f.fileName === fileName);\n\t\tif (file === undefined) return undefined;\n\n\t\tlet sha;\n\t\t// If this is a stash commit with an untracked file\n\t\tif (this.type === GitCommitType.Stash && file.status === '?') {\n\t\t\tsha = `${this.sha}^3`;\n\t\t}\n\n\t\t// If this isn't a single-file commit, we can't trust the previousSha\n\t\tconst previousSha = this.isFile ? this.previousSha : `${this.sha}^`;\n\n\t\treturn this.with({\n\t\t\ttype: this.isStash ? GitCommitType.StashFile : GitCommitType.LogFile,\n\t\t\tsha: sha,\n\t\t\tfileName: file.fileName,\n\t\t\toriginalFileName: file.originalFileName,\n\t\t\tpreviousSha: previousSha,\n\t\t\tpreviousFileName: file.originalFileName || file.fileName,\n\t\t\tstatus: file.status,\n\t\t\tfiles: [file]\n\t\t});\n\t}\n\n\twith(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string | null;\n\t\tfileName?: string;\n\t\tauthor?: string;\n\t\temail?: string;\n\t\tauthorDate?: Date;\n\t\tcommittedDate?: Date;\n\t\tmessage?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t\tstatus?: GitFileStatus;\n\t\tfiles?: GitFile[] | null;\n\t}): GitLogCommit {\n\t\treturn new GitLogCommit(\n\t\t\tchanges.type || this.type,\n\t\t\tthis.repoPath,\n\t\t\tthis.getChangedValue(changes.sha, this.sha)!,\n\t\t\tchanges.author || this.author,\n\t\t\tchanges.email || this.email,\n\t\t\tchanges.authorDate || this.authorDate,\n\t\t\tchanges.committedDate || this.committerDate,\n\t\t\tchanges.message || this.message,\n\t\t\tchanges.fileName || this.fileName,\n\t\t\tthis.getChangedValue(changes.files, this.files) || [],\n\t\t\tchanges.status || this.status,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName),\n\t\t\tthis.getChangedValue(changes.previousSha, this.previousSha),\n\t\t\tthis.getChangedValue(changes.previousFileName, this.previousFileName),\n\t\t\tthis._fileStats,\n\t\t\tthis.parentShas,\n\t\t\tthis.line\n\t\t);\n\t}\n}\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import toNumber from './toNumber.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nexport default toFinite;\n","import toFinite from './toFinite.js';\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nexport default toInteger;\n","import toInteger from './toInteger.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that invokes `func`, with the `this` binding and arguments\n * of the created function, while it's called less than `n` times. Subsequent\n * calls to the created function return the result of the last `func` invocation.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {number} n The number of calls at which `func` is no longer invoked.\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * jQuery(element).on('click', _.before(5, addContactToList));\n * // => Allows adding up to 4 contacts to the list.\n */\nfunction before(n, func) {\n  var result;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  n = toInteger(n);\n  return function() {\n    if (--n > 0) {\n      result = func.apply(this, arguments);\n    }\n    if (n <= 1) {\n      func = undefined;\n    }\n    return result;\n  };\n}\n\nexport default before;\n","import before from './before.js';\n\n/**\n * Creates a function that is restricted to invoking `func` once. Repeat calls\n * to the function return the value of the first invocation. The `func` is\n * invoked with the `this` binding and arguments of the created function.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * var initialize = _.once(createApplication);\n * initialize();\n * initialize();\n * // => `createApplication` is invoked once\n */\nfunction once(func) {\n  return before(2, func);\n}\n\nexport default once;\n","'use strict';\nimport { debounce as _debounce, once as _once } from 'lodash-es';\nimport { Disposable } from 'vscode';\n\nexport interface Deferrable {\n\tcancel(): void;\n\tflush(...args: any[]): void;\n\tpending?(): boolean;\n}\n\ninterface PropOfValue {\n\t(): any;\n\tvalue: string | undefined;\n}\n\nexport namespace Functions {\n\texport function cachedOnce<T>(fn: (...args: any[]) => Promise<T>, seed: T): (...args: any[]) => Promise<T> {\n\t\tlet cached: T | undefined = seed;\n\t\treturn (...args: any[]) => {\n\t\t\tif (cached !== undefined) {\n\t\t\t\tconst promise = Promise.resolve(cached);\n\t\t\t\tcached = undefined;\n\n\t\t\t\treturn promise;\n\t\t\t}\n\t\t\treturn fn(...args);\n\t\t};\n\t}\n\n\texport interface DebounceOptions {\n\t\tleading?: boolean;\n\t\tmaxWait?: number;\n\t\ttrack?: boolean;\n\t\ttrailing?: boolean;\n\t}\n\n\texport function debounce<T extends (...args: any[]) => any>(\n\t\tfn: T,\n\t\twait?: number,\n\t\toptions?: DebounceOptions\n\t): T & Deferrable {\n\t\tconst { track, ...opts }: DebounceOptions = {\n\t\t\ttrack: false,\n\t\t\t...(options || {})\n\t\t};\n\n\t\tif (track !== true) return _debounce(fn, wait, opts);\n\n\t\tlet pending = false;\n\n\t\tconst debounced = _debounce(\n\t\t\t(function(this: any, ...args: any[]) {\n\t\t\t\tpending = false;\n\t\t\t\treturn fn.apply(this, args);\n\t\t\t} as any) as T,\n\t\t\twait,\n\t\t\toptions\n\t\t) as T & Deferrable;\n\n\t\tconst tracked = (function(this: any, ...args: any[]) {\n\t\t\tpending = true;\n\t\t\treturn debounced.apply(this, args);\n\t\t} as any) as T & Deferrable;\n\n\t\ttracked.pending = function() {\n\t\t\treturn pending;\n\t\t};\n\t\ttracked.cancel = function() {\n\t\t\treturn debounced.cancel.apply(debounced);\n\t\t};\n\t\ttracked.flush = function(...args: any[]) {\n\t\t\t// eslint-disable-next-line prefer-spread\n\t\t\treturn debounced.flush.apply(debounced, args);\n\t\t};\n\n\t\treturn tracked;\n\t}\n\n\tconst comma = ',';\n\tconst emptyStr = '';\n\tconst equals = '=';\n\tconst openBrace = '{';\n\tconst openParen = '(';\n\tconst closeParen = ')';\n\n\tconst fnBodyRegex = /\\(([\\s\\S]*)\\)/;\n\tconst fnBodyStripCommentsRegex = /(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/gm;\n\tconst fnBodyStripParamDefaultValueRegex = /\\s?=.*$/;\n\n\texport function getParameters(fn: Function): string[] {\n\t\tif (typeof fn !== 'function') throw new Error('Not supported');\n\n\t\tif (fn.length === 0) return [];\n\n\t\tlet fnBody: string = Function.prototype.toString.call(fn);\n\t\tfnBody = fnBody.replace(fnBodyStripCommentsRegex, emptyStr) || fnBody;\n\t\tfnBody = fnBody.slice(0, fnBody.indexOf(openBrace));\n\n\t\tlet open = fnBody.indexOf(openParen);\n\t\tlet close = fnBody.indexOf(closeParen);\n\n\t\topen = open >= 0 ? open + 1 : 0;\n\t\tclose = close > 0 ? close : fnBody.indexOf(equals);\n\n\t\tfnBody = fnBody.slice(open, close);\n\t\tfnBody = `(${fnBody})`;\n\n\t\tconst match = fnBodyRegex.exec(fnBody);\n\t\treturn match != null\n\t\t\t? match[1].split(comma).map(param => param.trim().replace(fnBodyStripParamDefaultValueRegex, emptyStr))\n\t\t\t: [];\n\t}\n\n\texport function is<T extends object>(o: object, prop: keyof T, value?: any): o is T;\n\texport function is<T extends object>(o: object, matcher: (o: object) => boolean): o is T;\n\texport function is<T extends object>(\n\t\to: object,\n\t\tpropOrMatcher: keyof T | ((o: any) => boolean),\n\t\tvalue?: any\n\t): o is T {\n\t\tif (typeof propOrMatcher === 'function') {\n\t\t\treturn propOrMatcher(o);\n\t\t}\n\n\t\treturn value === undefined ? (o as any)[propOrMatcher] !== undefined : (o as any)[propOrMatcher] === value;\n\t}\n\n\texport function once<T extends (...args: any[]) => any>(fn: T): T {\n\t\treturn _once(fn);\n\t}\n\n\texport function propOf<T, K extends Extract<keyof T, string>>(o: T, key: K) {\n\t\tconst propOfCore = <T, K extends Extract<keyof T, string>>(o: T, key: K) => {\n\t\t\tconst value: string =\n\t\t\t\t(propOfCore as PropOfValue).value === undefined ? key : `${(propOfCore as PropOfValue).value}.${key}`;\n\t\t\t(propOfCore as PropOfValue).value = value;\n\t\t\tconst fn = <Y extends Extract<keyof T[K], string>>(k: Y) => propOfCore(o[key], k);\n\t\t\treturn Object.assign(fn, { value: value });\n\t\t};\n\t\treturn propOfCore(o, key);\n\t}\n\n\texport function interval(fn: (...args: any[]) => void, ms: number): Disposable {\n\t\tlet timer: NodeJS.Timer | undefined;\n\t\tconst disposable = {\n\t\t\tdispose: () => {\n\t\t\t\tif (timer !== undefined) {\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\ttimer = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\ttimer = setInterval(fn, ms);\n\n\t\treturn disposable;\n\t}\n\n\texport async function wait(ms: number) {\n\t\tawait new Promise(resolve => setTimeout(resolve, ms));\n\t}\n\n\texport async function waitUntil(fn: (...args: any[]) => boolean, timeout: number): Promise<boolean> {\n\t\tconst max = Math.round(timeout / 100);\n\t\tlet counter = 0;\n\t\twhile (true) {\n\t\t\tif (fn()) return true;\n\t\t\tif (counter > max) return false;\n\n\t\t\tawait wait(100);\n\t\t\tcounter++;\n\t\t}\n\t}\n}\n","'use strict';\nimport { Strings } from '../../system';\n\nconst emptyStr = '';\n\nexport interface FormatOptions {\n\tdateFormat?: string | null;\n\ttokenOptions?: { [id: string]: Strings.TokenOptions | undefined };\n}\n\ntype Constructor<T = {}> = new (...args: any[]) => T;\n\nconst spaceReplacementRegex = / /g;\n\ndeclare type RequiredTokenOptions<TOptions extends FormatOptions> = TOptions & Required<Pick<TOptions, 'tokenOptions'>>;\n\nexport abstract class Formatter<TItem = any, TOptions extends FormatOptions = FormatOptions> {\n\tprotected _item!: TItem;\n\tprotected _options!: RequiredTokenOptions<TOptions>;\n\n\tconstructor(item: TItem, options?: TOptions) {\n\t\tthis.reset(item, options);\n\t}\n\n\treset(item: TItem, options?: TOptions) {\n\t\tthis._item = item;\n\n\t\tif (options === undefined && this._options !== undefined) return;\n\n\t\tif (options === undefined) {\n\t\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\t\toptions = {} as TOptions;\n\t\t}\n\n\t\tif (options.dateFormat == null) {\n\t\t\toptions.dateFormat = 'MMMM Do, YYYY h:mma';\n\t\t}\n\n\t\tif (options.tokenOptions == null) {\n\t\t\toptions.tokenOptions = {};\n\t\t}\n\n\t\tthis._options = options as RequiredTokenOptions<TOptions>;\n\t}\n\n\tprivate collapsableWhitespace: number = 0;\n\n\tprotected _padOrTruncate(s: string, options: Strings.TokenOptions | undefined) {\n\t\tif (s == null || s.length === 0) return s;\n\n\t\t// NOTE: the collapsable whitespace logic relies on the javascript template evaluation to be left to right\n\t\tif (options === undefined) {\n\t\t\toptions = {\n\t\t\t\tcollapseWhitespace: false,\n\t\t\t\tpadDirection: 'left',\n\t\t\t\tprefix: undefined,\n\t\t\t\tsuffix: undefined,\n\t\t\t\ttruncateTo: undefined\n\t\t\t};\n\t\t}\n\n\t\tlet max = options.truncateTo;\n\t\tif (max === undefined) {\n\t\t\tthis.collapsableWhitespace = 0;\n\t\t} else {\n\t\t\tmax += this.collapsableWhitespace;\n\t\t\tthis.collapsableWhitespace = 0;\n\n\t\t\tconst width = Strings.getWidth(s);\n\t\t\tconst diff = max - width;\n\t\t\tif (diff > 0) {\n\t\t\t\tif (options.collapseWhitespace) {\n\t\t\t\t\tthis.collapsableWhitespace = diff;\n\t\t\t\t}\n\n\t\t\t\tif (options.padDirection === 'left') {\n\t\t\t\t\ts = Strings.padLeft(s, max, undefined, width);\n\t\t\t\t} else {\n\t\t\t\t\tif (options.collapseWhitespace) {\n\t\t\t\t\t\tmax -= diff;\n\t\t\t\t\t}\n\t\t\t\t\ts = Strings.padRight(s, max, undefined, width);\n\t\t\t\t}\n\t\t\t} else if (diff < 0) {\n\t\t\t\ts = Strings.truncate(s, max, undefined, width);\n\t\t\t}\n\t\t}\n\n\t\tif (options.prefix || options.suffix) {\n\t\t\ts = `${options.prefix || emptyStr}${s}${options.suffix || emptyStr}`;\n\t\t}\n\n\t\treturn s;\n\t}\n\n\tprivate static _formatter: Formatter | undefined = undefined;\n\n\tprotected static fromTemplateCore<\n\t\tTFormatter extends Formatter<TItem, TOptions>,\n\t\tTItem,\n\t\tTOptions extends FormatOptions\n\t>(\n\t\tformatter: TFormatter | Constructor<TFormatter>,\n\t\ttemplate: string,\n\t\titem: TItem,\n\t\tdateFormatOrOptions?: string | null | TOptions\n\t): string {\n\t\t// Preserve spaces\n\t\ttemplate = template.replace(spaceReplacementRegex, '\\u00a0');\n\t\tif (formatter instanceof Formatter) return Strings.interpolate(template, formatter);\n\n\t\tlet options: TOptions | undefined = undefined;\n\t\tif (dateFormatOrOptions == null || typeof dateFormatOrOptions === 'string') {\n\t\t\t// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n\t\t\toptions = {\n\t\t\t\tdateFormat: dateFormatOrOptions\n\t\t\t} as TOptions;\n\t\t} else {\n\t\t\toptions = dateFormatOrOptions;\n\t\t}\n\n\t\tif (options.tokenOptions == null) {\n\t\t\tconst tokenOptions = Strings.getTokensFromTemplate(template).reduce<{\n\t\t\t\t[token: string]: Strings.TokenOptions | undefined;\n\t\t\t}>((map, token) => {\n\t\t\t\tmap[token.key] = token.options;\n\t\t\t\treturn map;\n\t\t\t}, Object.create(null));\n\n\t\t\toptions.tokenOptions = tokenOptions;\n\t\t}\n\n\t\tif (this._formatter === undefined) {\n\t\t\tthis._formatter = new formatter(item, options);\n\t\t} else {\n\t\t\tthis._formatter.reset(item, options);\n\t\t}\n\n\t\treturn Strings.interpolate(template, this._formatter);\n\t}\n}\n","'use strict';\nimport {\n\tDiffWithCommand,\n\tInviteToLiveShareCommand,\n\tOpenCommitInRemoteCommand,\n\tOpenFileRevisionCommand,\n\tShowQuickCommitDetailsCommand,\n\tShowQuickCommitFileDetailsCommand\n} from '../../commands';\nimport { DateStyle, FileAnnotationType } from '../../configuration';\nimport { GlyphChars } from '../../constants';\nimport { Container } from '../../container';\nimport { GitCommit, GitLogCommit, GitRemote, GitService, GitUri } from '../gitService';\nimport { Strings } from '../../system';\nimport { FormatOptions, Formatter } from './formatter';\nimport { ContactPresence } from '../../vsls/vsls';\nimport { getPresenceDataUri } from '../../avatars';\nimport { emojify } from '../../emojis';\n\nconst emptyStr = '';\n\nconst hasTokenRegexMap = new Map<string, RegExp>();\n\nexport interface CommitFormatOptions extends FormatOptions {\n\tannotationType?: FileAnnotationType;\n\tdateStyle?: DateStyle;\n\tgetBranchAndTagTips?: (sha: string) => string | undefined;\n\tline?: number;\n\tmarkdown?: boolean;\n\tpresence?: ContactPresence;\n\tpreviousLineDiffUris?: { current: GitUri; previous: GitUri | undefined };\n\tremotes?: GitRemote[];\n\ttruncateMessageAtNewLine?: boolean;\n\n\ttokenOptions?: {\n\t\tago?: Strings.TokenOptions;\n\t\tagoOrDate?: Strings.TokenOptions;\n\t\tauthor?: Strings.TokenOptions;\n\t\tauthorAgo?: Strings.TokenOptions;\n\t\tauthorAgoOrDate?: Strings.TokenOptions;\n\t\tauthorDate?: Strings.TokenOptions;\n\t\tchanges?: Strings.TokenOptions;\n\t\tchangesShort?: Strings.TokenOptions;\n\t\tcommitterAgo?: Strings.TokenOptions;\n\t\tcommitterAgoOrDate?: Strings.TokenOptions;\n\t\tcommitterDate?: Strings.TokenOptions;\n\t\tdate?: Strings.TokenOptions;\n\t\temail?: Strings.TokenOptions;\n\t\tid?: Strings.TokenOptions;\n\t\tmessage?: Strings.TokenOptions;\n\t\ttips?: Strings.TokenOptions;\n\t};\n}\n\nexport class CommitFormatter extends Formatter<GitCommit, CommitFormatOptions> {\n\tprivate get _authorDate() {\n\t\treturn this._item.formatAuthorDate(this._options.dateFormat);\n\t}\n\n\tprivate get _authorDateAgo() {\n\t\treturn this._item.formatAuthorDateFromNow();\n\t}\n\n\tprivate get _authorDateOrAgo() {\n\t\tconst dateStyle =\n\t\t\tthis._options.dateStyle !== undefined ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn dateStyle === DateStyle.Absolute ? this._authorDate : this._authorDateAgo;\n\t}\n\n\tprivate get _committerDate() {\n\t\treturn this._item.formatCommitterDate(this._options.dateFormat);\n\t}\n\n\tprivate get _committerDateAgo() {\n\t\treturn this._item.formatCommitterDateFromNow();\n\t}\n\n\tprivate get _committerDateOrAgo() {\n\t\tconst dateStyle =\n\t\t\tthis._options.dateStyle !== undefined ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn dateStyle === DateStyle.Absolute ? this._committerDate : this._committerDateAgo;\n\t}\n\n\tprivate get _date() {\n\t\treturn this._item.formatDate(this._options.dateFormat);\n\t}\n\n\tprivate get _dateAgo() {\n\t\treturn this._item.formatDateFromNow();\n\t}\n\n\tprivate get _dateOrAgo() {\n\t\tconst dateStyle =\n\t\t\tthis._options.dateStyle !== undefined ? this._options.dateStyle : Container.config.defaultDateStyle;\n\t\treturn dateStyle === DateStyle.Absolute ? this._date : this._dateAgo;\n\t}\n\n\tget ago() {\n\t\treturn this._padOrTruncate(this._dateAgo, this._options.tokenOptions.ago);\n\t}\n\n\tget agoOrDate() {\n\t\treturn this._padOrTruncate(this._dateOrAgo, this._options.tokenOptions.agoOrDate);\n\t}\n\n\tget author() {\n\t\tconst author = this._padOrTruncate(this._item.author, this._options.tokenOptions.author);\n\t\tif (!this._options.markdown) {\n\t\t\treturn author;\n\t\t}\n\n\t\treturn `[${author}](mailto:${this._item.email} \"Email ${this._item.author} (${this._item.email})\")`;\n\t}\n\n\tget authorAgo() {\n\t\treturn this._padOrTruncate(this._authorDateAgo, this._options.tokenOptions.authorAgo);\n\t}\n\n\tget authorAgoOrDate() {\n\t\treturn this._padOrTruncate(this._authorDateOrAgo, this._options.tokenOptions.authorAgoOrDate);\n\t}\n\n\tget authorDate() {\n\t\treturn this._padOrTruncate(this._authorDate, this._options.tokenOptions.authorDate);\n\t}\n\n\tget avatar() {\n\t\tif (!this._options.markdown || !Container.config.hovers.avatars) {\n\t\t\treturn emptyStr;\n\t\t}\n\n\t\tlet avatar = `![](${this._item.getGravatarUri(Container.config.defaultGravatarsStyle).toString(true)})`;\n\n\t\tconst presence = this._options.presence;\n\t\tif (presence != null) {\n\t\t\tconst title = `${this._item.author} ${this._item.author === 'You' ? 'are' : 'is'} ${\n\t\t\t\tpresence.status === 'dnd' ? 'in ' : ''\n\t\t\t}${presence.statusText.toLocaleLowerCase()}`;\n\n\t\t\tavatar += `![${title}](${getPresenceDataUri(presence.status)})`;\n\t\t\tavatar = `[${avatar}](# \"${title}\")`;\n\t\t}\n\n\t\treturn avatar;\n\t}\n\n\tget changes() {\n\t\treturn this._padOrTruncate(\n\t\t\tGitLogCommit.is(this._item) ? this._item.getFormattedDiffStatus() : emptyStr,\n\t\t\tthis._options.tokenOptions.changes\n\t\t);\n\t}\n\n\tget changesShort() {\n\t\treturn this._padOrTruncate(\n\t\t\tGitLogCommit.is(this._item)\n\t\t\t\t? this._item.getFormattedDiffStatus({ compact: true, separator: emptyStr })\n\t\t\t\t: emptyStr,\n\t\t\tthis._options.tokenOptions.changesShort\n\t\t);\n\t}\n\n\tget commands() {\n\t\tif (!this._options.markdown) return emptyStr;\n\n\t\tlet commands;\n\t\tif (this._item.isUncommitted) {\n\t\t\tconst { previousLineDiffUris: diffUris } = this._options;\n\t\t\tif (diffUris !== undefined && diffUris.previous !== undefined) {\n\t\t\t\tcommands = `\\`${this._padOrTruncate(\n\t\t\t\t\tGitService.shortenSha(\n\t\t\t\t\t\tGitService.isUncommittedStaged(diffUris.current.sha)\n\t\t\t\t\t\t\t? diffUris.current.sha\n\t\t\t\t\t\t\t: GitService.uncommittedSha\n\t\t\t\t\t)!,\n\t\t\t\t\tthis._options.tokenOptions.id\n\t\t\t\t)}\\``;\n\n\t\t\t\tcommands += ` **[\\`${GlyphChars.MuchLessThan}\\`](${DiffWithCommand.getMarkdownCommandArgs({\n\t\t\t\t\tlhs: {\n\t\t\t\t\t\tsha: diffUris.previous.sha || '',\n\t\t\t\t\t\turi: diffUris.previous.documentUri()\n\t\t\t\t\t},\n\t\t\t\t\trhs: {\n\t\t\t\t\t\tsha: diffUris.current.sha || '',\n\t\t\t\t\t\turi: diffUris.current.documentUri()\n\t\t\t\t\t},\n\t\t\t\t\trepoPath: this._item.repoPath,\n\t\t\t\t\tline: this._options.line\n\t\t\t\t})} \"Open Changes\")** `;\n\t\t\t} else {\n\t\t\t\tcommands = `\\`${this._padOrTruncate(\n\t\t\t\t\tGitService.shortenSha(\n\t\t\t\t\t\tthis._item.isUncommittedStaged ? GitService.uncommittedStagedSha : GitService.uncommittedSha\n\t\t\t\t\t)!,\n\t\t\t\t\tthis._options.tokenOptions.id\n\t\t\t\t)}\\``;\n\t\t\t}\n\n\t\t\treturn commands;\n\t\t}\n\n\t\tcommands = `[\\`${this.id}\\`](${ShowQuickCommitDetailsCommand.getMarkdownCommandArgs(\n\t\t\tthis._item.sha\n\t\t)} \"Show Commit Details\") `;\n\n\t\tcommands += `**[\\`${GlyphChars.MuchLessThan}\\`](${DiffWithCommand.getMarkdownCommandArgs(\n\t\t\tthis._item,\n\t\t\tthis._options.line\n\t\t)} \"Open Changes\")** `;\n\n\t\tif (this._item.previousSha !== undefined) {\n\t\t\tlet annotationType = this._options.annotationType;\n\t\t\tif (annotationType === FileAnnotationType.RecentChanges) {\n\t\t\t\tannotationType = FileAnnotationType.Blame;\n\t\t\t}\n\n\t\t\tconst uri = GitUri.toRevisionUri(\n\t\t\t\tthis._item.previousSha,\n\t\t\t\tthis._item.previousUri.fsPath,\n\t\t\t\tthis._item.repoPath\n\t\t\t);\n\t\t\tcommands += `**[\\` ${GlyphChars.EqualsTriple} \\`](${OpenFileRevisionCommand.getMarkdownCommandArgs(\n\t\t\t\turi,\n\t\t\t\tannotationType || FileAnnotationType.Blame,\n\t\t\t\tthis._options.line\n\t\t\t)} \"Blame Previous Revision\")** `;\n\t\t}\n\n\t\tif (this._options.remotes !== undefined && this._options.remotes.length !== 0) {\n\t\t\tcommands += `**[\\` ${GlyphChars.ArrowUpRight} \\`](${OpenCommitInRemoteCommand.getMarkdownCommandArgs(\n\t\t\t\tthis._item.sha\n\t\t\t)} \"Open on Remote\")** `;\n\t\t}\n\n\t\tif (this._item.author !== 'You') {\n\t\t\tconst presence = this._options.presence;\n\t\t\tif (presence != null) {\n\t\t\t\tcommands += `[\\` ${GlyphChars.Envelope}+ \\`](${InviteToLiveShareCommand.getMarkdownCommandArgs(\n\t\t\t\t\tthis._item.email\n\t\t\t\t)} \"Invite ${this._item.author} (${presence.statusText}) to a Live Share Session\") `;\n\t\t\t}\n\t\t}\n\n\t\tcommands += `[\\`${GlyphChars.MiddleEllipsis}\\`](${ShowQuickCommitFileDetailsCommand.getMarkdownCommandArgs({\n\t\t\trevisionUri: GitUri.toRevisionUri(this._item.toGitUri()).toString(true)\n\t\t})} \"Show More Actions\")`;\n\n\t\treturn commands;\n\t}\n\n\tget committerAgo() {\n\t\treturn this._padOrTruncate(this._committerDateAgo, this._options.tokenOptions.committerAgo);\n\t}\n\n\tget committerAgoOrDate() {\n\t\treturn this._padOrTruncate(this._committerDateOrAgo, this._options.tokenOptions.committerAgoOrDate);\n\t}\n\n\tget committerDate() {\n\t\treturn this._padOrTruncate(this._committerDate, this._options.tokenOptions.committerDate);\n\t}\n\n\tget date() {\n\t\treturn this._padOrTruncate(this._date, this._options.tokenOptions.date);\n\t}\n\n\tget email() {\n\t\treturn this._padOrTruncate(this._item.email || emptyStr, this._options.tokenOptions.email);\n\t}\n\n\tget id() {\n\t\treturn this._padOrTruncate(this._item.shortSha || emptyStr, this._options.tokenOptions.id);\n\t}\n\n\tget message() {\n\t\tlet message: string;\n\t\tif (this._item.isUncommitted) {\n\t\t\tif (\n\t\t\t\tthis._item.isUncommittedStaged ||\n\t\t\t\t(this._options.previousLineDiffUris !== undefined &&\n\t\t\t\t\tthis._options.previousLineDiffUris.current.isUncommittedStaged)\n\t\t\t) {\n\t\t\t\tmessage = 'Staged changes';\n\t\t\t} else {\n\t\t\t\tmessage = 'Uncommitted changes';\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._options.truncateMessageAtNewLine) {\n\t\t\t\tconst index = this._item.message.indexOf('\\n');\n\t\t\t\tmessage =\n\t\t\t\t\tindex === -1\n\t\t\t\t\t\t? this._item.message\n\t\t\t\t\t\t: `${this._item.message.substring(0, index)}${GlyphChars.Space}${GlyphChars.Ellipsis}`;\n\t\t\t} else {\n\t\t\t\tmessage = this._item.message;\n\t\t\t}\n\n\t\t\tmessage = emojify(message);\n\t\t}\n\n\t\tmessage = this._padOrTruncate(message, this._options.tokenOptions.message);\n\n\t\tif (!this._options.markdown) {\n\t\t\treturn message;\n\t\t}\n\n\t\tif (this._options.remotes !== undefined) {\n\t\t\tfor (const r of this._options.remotes) {\n\t\t\t\tif (r.provider === undefined) continue;\n\n\t\t\t\tmessage = r.provider.enrichMessage(message);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn `\\n> ${Strings.escapeMarkdown(message, { quoted: true })}`;\n\t}\n\n\tget sha() {\n\t\treturn this.id;\n\t}\n\n\tget tips() {\n\t\tconst branchAndTagTips = this._options.getBranchAndTagTips && this._options.getBranchAndTagTips(this._item.sha);\n\t\tif (branchAndTagTips === undefined) return emptyStr;\n\n\t\treturn this._padOrTruncate(branchAndTagTips, this._options.tokenOptions.tips);\n\t}\n\n\tstatic fromTemplate(template: string, commit: GitCommit, dateFormat: string | null): string;\n\tstatic fromTemplate(template: string, commit: GitCommit, options?: CommitFormatOptions): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions\n\t): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tcommit: GitCommit,\n\t\tdateFormatOrOptions?: string | null | CommitFormatOptions\n\t): string {\n\t\treturn super.fromTemplateCore(this, template, commit, dateFormatOrOptions);\n\t}\n\n\tstatic has(format: string, token: string) {\n\t\tlet regex = hasTokenRegexMap.get(token);\n\t\tif (regex === undefined) {\n\t\t\tregex = new RegExp(`\\\\b${token}\\\\b`);\n\t\t\thasTokenRegexMap.set(token, regex);\n\t\t}\n\n\t\treturn regex.test(format);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport { GlyphChars } from '../../constants';\nimport { Strings } from '../../system';\nimport { GitFile, GitFileWithCommit } from '../models/file';\nimport { FormatOptions, Formatter } from './formatter';\n\nexport interface StatusFormatOptions extends FormatOptions {\n\trelativePath?: string;\n\n\ttokenOptions?: {\n\t\tdirectory?: Strings.TokenOptions;\n\t\tfile?: Strings.TokenOptions;\n\t\tfilePath?: Strings.TokenOptions;\n\t\toriginalPath?: Strings.TokenOptions;\n\t\tpath?: Strings.TokenOptions;\n\t\tstatus?: Strings.TokenOptions;\n\t\tworking?: Strings.TokenOptions;\n\t};\n}\n\nexport class StatusFileFormatter extends Formatter<GitFile, StatusFormatOptions> {\n\tget directory() {\n\t\tconst directory = GitFile.getFormattedDirectory(this._item, false, this._options.relativePath);\n\t\treturn this._padOrTruncate(directory, this._options.tokenOptions.directory);\n\t}\n\n\tget file() {\n\t\tconst file = paths.basename(this._item.fileName);\n\t\treturn this._padOrTruncate(file, this._options.tokenOptions.file);\n\t}\n\n\tget filePath() {\n\t\tconst filePath = GitFile.getFormattedPath(this._item, { relativeTo: this._options.relativePath });\n\t\treturn this._padOrTruncate(filePath, this._options.tokenOptions.filePath);\n\t}\n\n\tget originalPath() {\n\t\t// if (\n\t\t//     // this._item.status !== 'R' ||\n\t\t//     this._item.originalFileName == null ||\n\t\t//     this._item.originalFileName.length === 0\n\t\t// ) {\n\t\t//     return '';\n\t\t// }\n\n\t\tconst originalPath = GitFile.getOriginalRelativePath(this._item, this._options.relativePath);\n\t\treturn this._padOrTruncate(originalPath, this._options.tokenOptions.originalPath);\n\t}\n\n\tget path() {\n\t\tconst directory = GitFile.getRelativePath(this._item, this._options.relativePath);\n\t\treturn this._padOrTruncate(directory, this._options.tokenOptions.path);\n\t}\n\n\tget status() {\n\t\tconst status = GitFile.getStatusText(this._item.status);\n\t\treturn this._padOrTruncate(status, this._options.tokenOptions.status);\n\t}\n\n\tget working() {\n\t\tconst commit = (this._item as GitFileWithCommit).commit;\n\t\tconst statusFile = commit === undefined ? this._item : commit.files[0];\n\n\t\tlet icon;\n\t\tif (statusFile.workingTreeStatus !== undefined && statusFile.indexStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Pencil}${GlyphChars.Space}${GlyphChars.SpaceThinnest}${GlyphChars.Check}`;\n\t\t} else if (statusFile.workingTreeStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Pencil}${GlyphChars.SpaceThin}${GlyphChars.SpaceThinnest}${GlyphChars.EnDash}${GlyphChars.Space}`;\n\t\t} else if (statusFile.indexStatus !== undefined) {\n\t\t\ticon = `${GlyphChars.Space}${GlyphChars.EnDash}${GlyphChars.Space.repeat(2)}${GlyphChars.Check}`;\n\t\t} else {\n\t\t\ticon = '';\n\t\t}\n\t\treturn this._padOrTruncate(icon, this._options.tokenOptions.working);\n\t}\n\n\tstatic fromTemplate(template: string, file: GitFile | GitFileWithCommit, dateFormat: string | null): string;\n\tstatic fromTemplate(template: string, file: GitFile | GitFileWithCommit, options?: StatusFormatOptions): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tfile: GitFile,\n\t\tdateFormatOrOptions?: string | null | StatusFormatOptions\n\t): string;\n\tstatic fromTemplate(\n\t\ttemplate: string,\n\t\tfile: GitFile,\n\t\tdateFormatOrOptions?: string | null | StatusFormatOptions\n\t): string {\n\t\treturn super.fromTemplateCore(this, template, file, dateFormatOrOptions);\n\t}\n}\n","'use strict';\n\nexport * from './commitFormatter';\nexport * from './statusFormatter';\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tFileChangeEvent,\n\tFileStat,\n\tFileSystemError,\n\tFileSystemProvider,\n\tFileType,\n\tUri,\n\tworkspace\n} from 'vscode';\nimport { DocumentSchemes } from '../constants';\nimport { Container } from '../container';\nimport { GitService, GitTree, GitUri } from '../git/gitService';\nimport { Iterables, Strings, TernarySearchTree } from '../system';\n\nconst emptyArray = new Uint8Array(0);\n\nexport function fromGitLensFSUri(uri: Uri): { path: string; ref: string; repoPath: string } {\n\tconst gitUri = GitUri.is(uri) ? uri : GitUri.fromRevisionUri(uri);\n\treturn { path: gitUri.relativePath, ref: gitUri.sha!, repoPath: gitUri.repoPath! };\n}\n\nexport function toGitLensFSUri(ref: string, repoPath: string): Uri {\n\treturn GitUri.toRevisionUri(ref, repoPath, repoPath);\n}\n\nexport class GitFileSystemProvider implements FileSystemProvider, Disposable {\n\tprivate readonly _disposable: Disposable;\n\tprivate readonly _searchTreeMap = new Map<string, Promise<TernarySearchTree<GitTree>>>();\n\n\tconstructor() {\n\t\tthis._disposable = Disposable.from(\n\t\t\tworkspace.registerFileSystemProvider(DocumentSchemes.GitLens, this, {\n\t\t\t\tisCaseSensitive: true,\n\t\t\t\tisReadonly: true\n\t\t\t})\n\t\t);\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate _onDidChangeFile = new EventEmitter<FileChangeEvent[]>();\n\tget onDidChangeFile(): Event<FileChangeEvent[]> {\n\t\treturn this._onDidChangeFile.event;\n\t}\n\n\tcopy?(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\tcreateDirectory(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\tdelete(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\tasync readDirectory(uri: Uri): Promise<[string, FileType][]> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tconst tree = await this.getTree(path, ref, repoPath);\n\t\tif (tree === undefined) throw FileSystemError.FileNotFound(uri);\n\n\t\tconst items = [\n\t\t\t...Iterables.map<GitTree, [string, FileType]>(tree, t => [\n\t\t\t\tpath != null && path.length !== 0 ? Strings.normalizePath(paths.relative(path, t.path)) : t.path,\n\t\t\t\ttypeToFileType(t.type)\n\t\t\t])\n\t\t];\n\t\treturn items;\n\t}\n\n\tasync readFile(uri: Uri): Promise<Uint8Array> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tif (ref === GitService.deletedOrMissingSha) return emptyArray;\n\n\t\tconst buffer = await Container.git.getVersionedFileBuffer(repoPath, path, ref);\n\t\tif (buffer === undefined) return emptyArray;\n\n\t\treturn buffer;\n\t}\n\n\trename(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\tasync stat(uri: Uri): Promise<FileStat> {\n\t\tconst { path, ref, repoPath } = fromGitLensFSUri(uri);\n\n\t\tif (ref === GitService.deletedOrMissingSha) {\n\t\t\treturn {\n\t\t\t\ttype: FileType.File,\n\t\t\t\tsize: 0,\n\t\t\t\tctime: 0,\n\t\t\t\tmtime: 0\n\t\t\t};\n\t\t}\n\n\t\tlet treeItem;\n\n\t\tconst searchTree = this._searchTreeMap.get(ref);\n\t\tif (searchTree !== undefined) {\n\t\t\t// Add the fake root folder to the path\n\t\t\ttreeItem = (await searchTree).get(`/~/${path}`);\n\t\t} else {\n\t\t\tif (path == null || path.length === 0) {\n\t\t\t\tconst tree = await this.getTree(path, ref, repoPath);\n\t\t\t\tif (tree === undefined) throw FileSystemError.FileNotFound(uri);\n\n\t\t\t\treturn {\n\t\t\t\t\ttype: FileType.Directory,\n\t\t\t\t\tsize: 0,\n\t\t\t\t\tctime: 0,\n\t\t\t\t\tmtime: 0\n\t\t\t\t};\n\t\t\t}\n\n\t\t\ttreeItem = await Container.git.getTreeFileForRevision(repoPath, path, ref);\n\t\t}\n\n\t\tif (treeItem === undefined) {\n\t\t\tthrow FileSystemError.FileNotFound(uri);\n\t\t}\n\n\t\treturn {\n\t\t\ttype: typeToFileType(treeItem.type),\n\t\t\tsize: treeItem.size,\n\t\t\tctime: 0,\n\t\t\tmtime: 0\n\t\t};\n\t}\n\n\twatch(): Disposable {\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\t// nothing to dispose\n\t\t\t}\n\t\t};\n\t}\n\n\twriteFile(): void | Thenable<void> {\n\t\tthrow FileSystemError.NoPermissions;\n\t}\n\n\tprivate async createSearchTree(ref: string, repoPath: string) {\n\t\tconst searchTree = TernarySearchTree.forPaths<GitTree>();\n\t\tconst trees = await Container.git.getTreeForRevision(repoPath, ref);\n\n\t\t// Add a fake root folder so that searches will work\n\t\tsearchTree.set('~', { commitSha: '', path: '~', size: 0, type: 'tree' });\n\t\tfor (const item of trees) {\n\t\t\tsearchTree.set(`~/${item.path}`, item);\n\t\t}\n\n\t\treturn searchTree;\n\t}\n\n\tprivate getOrCreateSearchTree(ref: string, repoPath: string) {\n\t\tlet searchTree = this._searchTreeMap.get(ref);\n\t\tif (searchTree === undefined) {\n\t\t\tsearchTree = this.createSearchTree(ref, repoPath);\n\t\t\tthis._searchTreeMap.set(ref, searchTree);\n\t\t}\n\n\t\treturn searchTree;\n\t}\n\n\tprivate async getTree(path: string, ref: string, repoPath: string) {\n\t\tconst searchTree = await this.getOrCreateSearchTree(ref, repoPath);\n\t\t// Add the fake root folder to the path\n\t\treturn searchTree.findSuperstr(`/~/${path}`, true);\n\t}\n}\n\nfunction typeToFileType(type: 'blob' | 'tree' | undefined | null) {\n\tswitch (type) {\n\t\tcase 'blob':\n\t\t\treturn FileType.File;\n\t\tcase 'tree':\n\t\t\treturn FileType.Directory;\n\t\tdefault:\n\t\t\treturn FileType.Unknown;\n\t}\n}\n","'use strict';\nimport { GitCommandOptions } from '../git/git';\n\nexport class RequestType<TRequest, TResponse> {\n\tconstructor(public readonly name: string) {}\n}\n\nexport interface GitCommandRequest {\n\toptions: GitCommandOptions;\n\targs: any[];\n}\n\nexport interface GitCommandResponse {\n\tdata: string;\n\tisBuffer?: boolean;\n}\n\nexport const GitCommandRequestType = new RequestType<GitCommandRequest, GitCommandResponse>('git');\n\nexport interface RepositoryProxy {\n\tfolderUri: string;\n\tpath: string;\n\troot: boolean;\n\tclosed: boolean;\n}\n\nexport interface RepositoriesInFolderRequest {\n\tfolderUri: string;\n}\n\nexport interface RepositoriesInFolderResponse {\n\trepositories: RepositoryProxy[];\n}\n\nexport const RepositoriesInFolderRequestType = new RequestType<\n\tRepositoriesInFolderRequest,\n\tRepositoriesInFolderResponse\n>('repositories/inFolder');\n","'use strict';\nimport { CancellationToken, Disposable, Uri, workspace, WorkspaceFoldersChangeEvent } from 'vscode';\nimport { LiveShare, SharedService } from 'vsls';\nimport { Container } from '../container';\nimport { git } from '../git/git';\nimport { GitUri } from '../git/gitUri';\nimport { Logger } from '../logger';\nimport { debug, Iterables, log, Strings } from '../system';\nimport {\n\tGitCommandRequest,\n\tGitCommandRequestType,\n\tGitCommandResponse,\n\tRepositoriesInFolderRequest,\n\tRepositoriesInFolderRequestType,\n\tRepositoriesInFolderResponse,\n\tRequestType\n} from './protocol';\nimport { vslsUriRootRegex } from './vsls';\n\nconst defaultWhitelistFn = () => true;\nconst gitWhitelist = new Map<string, (args: any[]) => boolean>([\n\t['blame', defaultWhitelistFn],\n\t['branch', args => args[1] === '--contains'],\n\t['cat-file', defaultWhitelistFn],\n\t['check-mailmap', defaultWhitelistFn],\n\t['check-ref-format', defaultWhitelistFn],\n\t['config', args => args[1] === '--get' || args[1] === '--get-regex'],\n\t['diff', defaultWhitelistFn],\n\t['difftool', defaultWhitelistFn],\n\t['for-each-ref', defaultWhitelistFn],\n\t['log', defaultWhitelistFn],\n\t['ls-files', defaultWhitelistFn],\n\t['ls-tree', defaultWhitelistFn],\n\t['merge-base', defaultWhitelistFn],\n\t['remote', args => args[1] === '-v' || args[1] === 'get-url'],\n\t['rev-list', defaultWhitelistFn],\n\t['rev-parse', defaultWhitelistFn],\n\t['shortlog', defaultWhitelistFn],\n\t['show', defaultWhitelistFn],\n\t['show-ref', defaultWhitelistFn],\n\t['stash', args => args[1] === 'list'],\n\t['status', defaultWhitelistFn],\n\t['symbolic-ref', defaultWhitelistFn],\n\t['tag', args => args[1] === '-l']\n]);\n\nconst leadingSlashRegex = /^[/|\\\\]/;\n\nexport class VslsHostService implements Disposable {\n\tstatic ServiceId = 'proxy';\n\n\t@log()\n\tstatic async share(api: LiveShare) {\n\t\tconst service = await api.shareService(this.ServiceId);\n\t\tif (service == null) {\n\t\t\tthrow new Error('Failed to share host service');\n\t\t}\n\n\t\treturn new VslsHostService(api, service);\n\t}\n\n\tprivate readonly _disposable: Disposable;\n\tprivate _localPathsRegex: RegExp | undefined;\n\tprivate _localToSharedPaths = new Map<string, string>();\n\tprivate _sharedPathsRegex: RegExp | undefined;\n\tprivate _sharedToLocalPaths = new Map<string, string>();\n\n\tconstructor(private readonly _api: LiveShare, private readonly _service: SharedService) {\n\t\t_service.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this));\n\n\t\tthis._disposable = Disposable.from(workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged, this));\n\n\t\tthis.onRequest(GitCommandRequestType, this.onGitCommandRequest.bind(this));\n\t\tthis.onRequest(RepositoriesInFolderRequestType, this.onRepositoriesInFolderRequest.bind(this));\n\n\t\tvoid this.onWorkspaceFoldersChanged();\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t\tvoid this._api.unshareService(VslsHostService.ServiceId);\n\t}\n\n\tprivate onRequest<TRequest, TResponse>(\n\t\trequestType: RequestType<TRequest, TResponse>,\n\t\thandler: (request: TRequest, cancellation: CancellationToken) => Promise<TResponse>\n\t) {\n\t\tthis._service.onRequest(requestType.name, (args: any[], cancellation: CancellationToken) =>\n\t\t\thandler(args[0], cancellation)\n\t\t);\n\t}\n\n\t@log()\n\tprivate onAvailabilityChanged(available: boolean) {\n\t\t// TODO\n\t}\n\n\t@debug()\n\tprivate onWorkspaceFoldersChanged(e?: WorkspaceFoldersChangeEvent) {\n\t\tif (workspace.workspaceFolders === undefined || workspace.workspaceFolders.length === 0) return;\n\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tthis._localToSharedPaths.clear();\n\t\tthis._sharedToLocalPaths.clear();\n\n\t\tlet localPath;\n\t\tlet sharedPath;\n\t\tfor (const f of workspace.workspaceFolders) {\n\t\t\tlocalPath = Strings.normalizePath(f.uri.fsPath);\n\t\t\tsharedPath = Strings.normalizePath(this.convertLocalUriToShared(f.uri).fsPath);\n\n\t\t\tLogger.debug(cc, `shared='${sharedPath}' \\u2194 local='${localPath}'`);\n\t\t\tthis._localToSharedPaths.set(localPath, sharedPath);\n\t\t\tthis._sharedToLocalPaths.set(sharedPath, localPath);\n\t\t}\n\n\t\tlet localPaths = Iterables.join(this._sharedToLocalPaths.values(), '|');\n\t\tlocalPaths = localPaths.replace(/(\\/|\\\\)/g, '[\\\\\\\\/|\\\\\\\\]');\n\t\tthis._localPathsRegex = new RegExp(`(${localPaths})`, 'gi');\n\n\t\tlet sharedPaths = Iterables.join(this._localToSharedPaths.values(), '|');\n\t\tsharedPaths = sharedPaths.replace(/(\\/|\\\\)/g, '[\\\\\\\\/|\\\\\\\\]');\n\t\tthis._sharedPathsRegex = new RegExp(`^(${sharedPaths})`, 'i');\n\t}\n\n\t@log()\n\tprivate async onGitCommandRequest(\n\t\trequest: GitCommandRequest,\n\t\tcancellation: CancellationToken\n\t): Promise<GitCommandResponse> {\n\t\tconst { options, args } = request;\n\n\t\tconst fn = gitWhitelist.get(request.args[0]);\n\t\tif (fn === undefined || !fn(request.args)) throw new Error(`Git ${request.args[0]} command is not allowed`);\n\n\t\tlet isRootWorkspace = false;\n\t\tif (options.cwd !== undefined && options.cwd.length > 0 && this._sharedToLocalPaths !== undefined) {\n\t\t\t// This is all so ugly, but basically we are converting shared paths to local paths\n\t\t\tif (this._sharedPathsRegex !== undefined && this._sharedPathsRegex.test(options.cwd)) {\n\t\t\t\toptions.cwd = Strings.normalizePath(options.cwd).replace(this._sharedPathsRegex, (match, shared) => {\n\t\t\t\t\tif (!isRootWorkspace) {\n\t\t\t\t\t\tisRootWorkspace = shared === '/~0';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst local = this._sharedToLocalPaths.get(shared);\n\t\t\t\t\treturn local != null ? local : shared;\n\t\t\t\t});\n\t\t\t} else if (leadingSlashRegex.test(options.cwd)) {\n\t\t\t\tconst localCwd = this._sharedToLocalPaths.get('/~0');\n\t\t\t\tif (localCwd !== undefined) {\n\t\t\t\t\tisRootWorkspace = true;\n\t\t\t\t\toptions.cwd = GitUri.resolve(options.cwd, localCwd);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet files = false;\n\t\tlet i = -1;\n\t\tfor (const arg of args) {\n\t\t\ti++;\n\t\t\tif (arg === '--') {\n\t\t\t\tfiles = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!files) continue;\n\n\t\t\tif (typeof arg === 'string') {\n\t\t\t\t// If we are the \"root\" workspace, then we need to remove the leading slash off the path (otherwise it will not be treated as a relative path)\n\t\t\t\tif (isRootWorkspace && leadingSlashRegex.test(arg[0])) {\n\t\t\t\t\targs.splice(i, 1, arg.substr(1));\n\t\t\t\t}\n\n\t\t\t\tif (this._sharedPathsRegex !== undefined && this._sharedPathsRegex.test(arg)) {\n\t\t\t\t\targs.splice(\n\t\t\t\t\t\ti,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\tStrings.normalizePath(arg).replace(this._sharedPathsRegex, (match, shared) => {\n\t\t\t\t\t\t\tconst local = this._sharedToLocalPaths.get(shared);\n\t\t\t\t\t\t\treturn local != null ? local : shared;\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet data = await git(options, ...args);\n\t\tif (typeof data === 'string') {\n\t\t\t// And then we convert local paths to shared paths\n\t\t\tif (this._localPathsRegex !== undefined && data.length > 0) {\n\t\t\t\tdata = data.replace(this._localPathsRegex, (match, local) => {\n\t\t\t\t\tconst shared = this._localToSharedPaths.get(local);\n\t\t\t\t\treturn shared != null ? shared : local;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn { data: data };\n\t\t}\n\n\t\treturn { data: data.toString('binary'), isBuffer: true };\n\t}\n\n\t@log()\n\tprivate async onRepositoriesInFolderRequest(\n\t\trequest: RepositoriesInFolderRequest,\n\t\tcancellation: CancellationToken\n\t): Promise<RepositoriesInFolderResponse> {\n\t\tconst uri = this.convertSharedUriToLocal(Uri.parse(request.folderUri));\n\t\tconst normalized = Strings.normalizePath(uri.fsPath, { stripTrailingSlash: true }).toLowerCase();\n\n\t\tconst repos = [\n\t\t\t...Iterables.filterMap(await Container.git.getRepositories(), r => {\n\t\t\t\tif (!r.normalizedPath.startsWith(normalized)) return undefined;\n\n\t\t\t\tconst vslsUri = this.convertLocalUriToShared(r.folder.uri);\n\t\t\t\treturn {\n\t\t\t\t\tfolderUri: vslsUri.toString(true),\n\t\t\t\t\tpath: vslsUri.path,\n\t\t\t\t\troot: r.root,\n\t\t\t\t\tclosed: r.closed\n\t\t\t\t};\n\t\t\t})\n\t\t];\n\n\t\treturn {\n\t\t\trepositories: repos\n\t\t};\n\t}\n\n\t@debug({\n\t\texit: result => `returned ${result.toString(true)}`\n\t})\n\tprivate convertLocalUriToShared(localUri: Uri) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\tlet sharedUri = this._api.convertLocalUriToShared(localUri);\n\t\tLogger.debug(\n\t\t\tcc,\n\t\t\t`LiveShare.convertLocalUriToShared(${localUri.toString(true)}) returned ${sharedUri.toString(true)}`\n\t\t);\n\n\t\tconst localPath = localUri.path;\n\t\tlet sharedPath = sharedUri.path;\n\t\tif (sharedUri.authority.length > 0) {\n\t\t\tsharedPath = `/${sharedUri.authority}${sharedPath}`;\n\t\t}\n\n\t\tif (new RegExp(`${localPath}$`, 'i').test(sharedPath)) {\n\t\t\tif (sharedPath.length === localPath.length) {\n\t\t\t\tconst folder = workspace.getWorkspaceFolder(localUri)!;\n\t\t\t\tsharedUri = sharedUri.with({ path: `/~${folder.index}` });\n\t\t\t} else {\n\t\t\t\tsharedUri = sharedUri.with({ path: sharedPath.substr(0, sharedPath.length - localPath.length) });\n\t\t\t}\n\t\t} else if (!sharedPath.startsWith('/~')) {\n\t\t\tconst folder = workspace.getWorkspaceFolder(localUri)!;\n\t\t\tsharedUri = sharedUri.with({ path: `/~${folder.index}${sharedPath}` });\n\t\t}\n\n\t\treturn sharedUri;\n\t}\n\n\tprivate convertSharedUriToLocal(sharedUri: Uri) {\n\t\tif (vslsUriRootRegex.test(sharedUri.path)) {\n\t\t\tsharedUri = sharedUri.with({ path: `${sharedUri.path}/` });\n\t\t}\n\n\t\tconst localUri = this._api.convertSharedUriToLocal(sharedUri);\n\n\t\tconst localPath = localUri.path;\n\t\tconst sharedPath = sharedUri.path;\n\t\tif (localPath.endsWith(sharedPath)) {\n\t\t\treturn localUri.with({ path: localPath.substr(0, localPath.length - sharedPath.length) });\n\t\t}\n\t\treturn localUri;\n\t}\n}\n","'use strict';\nimport { CancellationToken, Disposable, window, WorkspaceFolder } from 'vscode';\nimport { LiveShare, SharedServiceProxy } from 'vsls';\nimport { CommandContext, setCommandContext } from '../constants';\nimport { GitCommandOptions, Repository, RepositoryChange } from '../git/git';\nimport { Logger } from '../logger';\nimport { debug, log } from '../system';\nimport { VslsHostService } from './host';\nimport { GitCommandRequestType, RepositoriesInFolderRequestType, RepositoryProxy, RequestType } from './protocol';\n\nexport class VslsGuestService implements Disposable {\n\t@log()\n\tstatic async connect(api: LiveShare) {\n\t\tconst cc = Logger.getCorrelationContext();\n\n\t\ttry {\n\t\t\tconst service = await api.getSharedService(VslsHostService.ServiceId);\n\t\t\tif (service == null) {\n\t\t\t\tthrow new Error('Failed to connect to host service');\n\t\t\t}\n\n\t\t\treturn new VslsGuestService(api, service);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex, cc);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tconstructor(private readonly _api: LiveShare, private readonly _service: SharedServiceProxy) {\n\t\t_service.onDidChangeIsServiceAvailable(this.onAvailabilityChanged.bind(this));\n\t\tthis.onAvailabilityChanged(_service.isServiceAvailable);\n\t}\n\n\tdispose() {\n\t\t// nothing to dispose\n\t}\n\n\t@log()\n\tprivate onAvailabilityChanged(available: boolean) {\n\t\tif (available) {\n\t\t\tvoid setCommandContext(CommandContext.Enabled, true);\n\t\t\treturn;\n\t\t}\n\n\t\tvoid setCommandContext(CommandContext.Enabled, false);\n\t\tvoid window.showWarningMessage(\n\t\t\t'GitLens features will be unavailable. Unable to connect to the host GitLens service. The host may have disabled GitLens guest access or may not have GitLens installed.'\n\t\t);\n\t}\n\n\t@log()\n\tasync git<TOut extends string | Buffer>(options: GitCommandOptions, ...args: any[]) {\n\t\tconst response = await this.sendRequest(GitCommandRequestType, { options: options, args: args });\n\n\t\tif (response.isBuffer) {\n\t\t\treturn new Buffer(response.data, 'binary') as TOut;\n\t\t}\n\t\treturn response.data as TOut;\n\t}\n\n\t@log()\n\tasync getRepositoriesInFolder(\n\t\tfolder: WorkspaceFolder,\n\t\tonAnyRepositoryChanged: (repo: Repository, reason: RepositoryChange) => void\n\t): Promise<Repository[]> {\n\t\tconst response = await this.sendRequest(RepositoriesInFolderRequestType, {\n\t\t\tfolderUri: folder.uri.toString(true)\n\t\t});\n\n\t\treturn response.repositories.map(\n\t\t\t(r: RepositoryProxy) => new Repository(folder, r.path, r.root, onAnyRepositoryChanged, false, r.closed)\n\t\t);\n\t}\n\n\t@debug()\n\tprivate sendRequest<TRequest, TResponse>(\n\t\trequestType: RequestType<TRequest, TResponse>,\n\t\trequest: TRequest,\n\t\tcancellation?: CancellationToken\n\t): Promise<TResponse> {\n\t\treturn this._service.request(requestType.name, [request]);\n\t}\n}\n","'use strict';\nimport { Disposable, workspace } from 'vscode';\nimport { getApi, LiveShare, Role, SessionChangeEvent } from 'vsls';\nimport { CommandContext, DocumentSchemes, setCommandContext } from '../constants';\nimport { Container } from '../container';\nimport { Logger } from '../logger';\nimport { VslsGuestService } from './guest';\nimport { VslsHostService } from './host';\n\nexport const vslsUriPrefixRegex = /^[/|\\\\]~(?:\\d+?|external)(?:[/|\\\\]|$)/;\nexport const vslsUriRootRegex = /^[/|\\\\]~(?:\\d+?|external)$/;\n\nexport interface ContactPresence {\n\tstatus: ContactPresenceStatus;\n\tstatusText: string;\n}\nexport type ContactPresenceStatus = 'online' | 'away' | 'busy' | 'dnd' | 'offline';\n\nexport class VslsController implements Disposable {\n\tprivate _disposable: Disposable | undefined;\n\tprivate _guest: VslsGuestService | undefined;\n\tprivate _host: VslsHostService | undefined;\n\n\tprivate _onReady: (() => void) | undefined;\n\tprivate _waitForReady: Promise<void> | undefined;\n\n\tprivate _api: Promise<LiveShare | null> | undefined;\n\n\tconstructor() {\n\t\tvoid this.initialize();\n\t}\n\n\tdispose() {\n\t\tthis._disposable && this._disposable.dispose();\n\t\tif (this._host !== undefined) {\n\t\t\tthis._host.dispose();\n\t\t}\n\n\t\tif (this._guest !== undefined) {\n\t\t\tthis._guest.dispose();\n\t\t}\n\t}\n\n\tprivate async initialize() {\n\t\ttry {\n\t\t\t// If we have a vsls: workspace open, we might be a guest, so wait until live share transitions into a mode\n\t\t\tif (\n\t\t\t\tworkspace.workspaceFolders !== undefined &&\n\t\t\t\tworkspace.workspaceFolders.some(f => f.uri.scheme === DocumentSchemes.Vsls)\n\t\t\t) {\n\t\t\t\tthis.setReadonly(true);\n\t\t\t\tthis._waitForReady = new Promise(resolve => (this._onReady = resolve));\n\t\t\t}\n\n\t\t\tthis._api = getApi();\n\t\t\tconst api = await this._api;\n\t\t\tif (api == null) {\n\t\t\t\tsetCommandContext(CommandContext.Vsls, false);\n\t\t\t\t// Tear it down if we can't talk to live share\n\t\t\t\tif (this._onReady !== undefined) {\n\t\t\t\t\tthis._onReady();\n\t\t\t\t\tthis._waitForReady = undefined;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetCommandContext(CommandContext.Vsls, true);\n\n\t\t\tthis._disposable = Disposable.from(\n\t\t\t\tapi.onDidChangeSession(e => this.onLiveShareSessionChanged(api, e), this)\n\t\t\t);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t}\n\t}\n\n\tget isMaybeGuest() {\n\t\treturn this._guest !== undefined || this._waitForReady !== undefined;\n\t}\n\n\tprivate _readonly: boolean = false;\n\tget readonly() {\n\t\treturn this._readonly;\n\t}\n\tprivate setReadonly(value: boolean) {\n\t\tthis._readonly = value;\n\t\tsetCommandContext(CommandContext.Readonly, value ? true : undefined);\n\t}\n\n\tasync getContact(email: string | undefined) {\n\t\tif (email === undefined) return undefined;\n\n\t\tconst api = await this._api;\n\t\tif (api == null) return undefined;\n\n\t\tconst contacts = await api.getContacts([email]);\n\t\treturn contacts.contacts[email];\n\t}\n\n\tasync getContactPresence(email: string | undefined): Promise<ContactPresence | undefined> {\n\t\tconst contact = await this.getContact(email);\n\t\tif (contact == null) return undefined;\n\n\t\tswitch (contact.status) {\n\t\t\tcase 'available':\n\t\t\t\treturn { status: 'online', statusText: 'Available' };\n\t\t\tcase 'away':\n\t\t\t\treturn { status: 'away', statusText: 'Away' };\n\t\t\tcase 'busy':\n\t\t\t\treturn { status: 'busy', statusText: 'Busy' };\n\t\t\tcase 'doNotDisturb':\n\t\t\t\treturn { status: 'dnd', statusText: 'DND' };\n\t\t\tdefault:\n\t\t\t\treturn { status: 'offline', statusText: 'Offline' };\n\t\t}\n\t}\n\n\tasync invite(email: string | undefined) {\n\t\tif (email == null) return undefined;\n\n\t\tconst contact = await this.getContact(email);\n\t\tif (contact == null) return undefined;\n\n\t\treturn contact.invite();\n\t}\n\n\tasync startSession() {\n\t\tconst api = await this._api;\n\t\tif (api == null) return undefined;\n\n\t\treturn api.share();\n\t}\n\n\tasync guest() {\n\t\tif (this._waitForReady !== undefined) {\n\t\t\tawait this._waitForReady;\n\t\t\tthis._waitForReady = undefined;\n\t\t}\n\n\t\treturn this._guest;\n\t}\n\n\thost() {\n\t\treturn this._host;\n\t}\n\n\tprivate async onLiveShareSessionChanged(api: LiveShare, e: SessionChangeEvent) {\n\t\tif (this._host !== undefined) {\n\t\t\tthis._host.dispose();\n\t\t}\n\n\t\tif (this._guest !== undefined) {\n\t\t\tthis._guest.dispose();\n\t\t}\n\n\t\tswitch (e.session.role) {\n\t\t\tcase Role.Host:\n\t\t\t\tthis.setReadonly(false);\n\t\t\t\tsetCommandContext(CommandContext.Vsls, 'host');\n\t\t\t\tif (Container.config.liveshare.allowGuestAccess) {\n\t\t\t\t\tthis._host = await VslsHostService.share(api);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase Role.Guest:\n\t\t\t\tthis.setReadonly(true);\n\t\t\t\tsetCommandContext(CommandContext.Vsls, 'guest');\n\t\t\t\tthis._guest = await VslsGuestService.connect(api);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis.setReadonly(false);\n\t\t\t\tsetCommandContext(CommandContext.Vsls, true);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (this._onReady !== undefined) {\n\t\t\tthis._onReady();\n\t\t\tthis._onReady = undefined;\n\t\t}\n\t}\n}\n","!function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=n():\"function\"==typeof define&&define.amd?define(n):t.dayjs=n()}(this,function(){\"use strict\";var t=\"millisecond\",n=\"second\",e=\"minute\",r=\"hour\",i=\"day\",s=\"week\",u=\"month\",a=\"quarter\",o=\"year\",h=/^(\\d{4})-?(\\d{1,2})-?(\\d{0,2})[^0-9]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?.?(\\d{1,3})?$/,f=/\\[([^\\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,n,e){var r=String(t);return!r||r.length>=n?t:\"\"+Array(n+1-r.length).join(e)+t},d={s:c,z:function(t){var n=-t.utcOffset(),e=Math.abs(n),r=Math.floor(e/60),i=e%60;return(n<=0?\"+\":\"-\")+c(r,2,\"0\")+\":\"+c(i,2,\"0\")},m:function(t,n){var e=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(e,u),i=n-r<0,s=t.clone().add(e+(i?-1:1),u);return Number(-(e+(n-r)/(i?r-s:s-r))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return{M:u,y:o,w:s,d:i,h:r,m:e,s:n,ms:t,Q:a}[h]||String(h||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},$={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\")},l=\"en\",m={};m[l]=$;var y=function(t){return t instanceof v},M=function(t,n,e){var r;if(!t)return l;if(\"string\"==typeof t)m[t]&&(r=t),n&&(m[t]=n,r=t);else{var i=t.name;m[i]=t,r=i}return e||(l=r),r},g=function(t,n,e){if(y(t))return t.clone();var r=n?\"string\"==typeof n?{format:n,pl:e}:n:{};return r.date=t,new v(r)},D=d;D.l=M,D.i=y,D.w=function(t,n){return g(t,{locale:n.$L,utc:n.$u})};var v=function(){function c(t){this.$L=this.$L||M(t.locale,null,!0),this.parse(t)}var d=c.prototype;return d.parse=function(t){this.$d=function(t){var n=t.date,e=t.utc;if(null===n)return new Date(NaN);if(D.u(n))return new Date;if(n instanceof Date)return new Date(n);if(\"string\"==typeof n&&!/Z$/i.test(n)){var r=n.match(h);if(r)return e?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(n)}(t),this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return D},d.isValid=function(){return!(\"Invalid Date\"===this.$d.toString())},d.isSame=function(t,n){var e=g(t);return this.startOf(n)<=e&&e<=this.endOf(n)},d.isAfter=function(t,n){return g(t)<this.startOf(n)},d.isBefore=function(t,n){return this.endOf(n)<g(t)},d.$g=function(t,n,e){return D.u(t)?this[n]:this.set(e,t)},d.year=function(t){return this.$g(t,\"$y\",o)},d.month=function(t){return this.$g(t,\"$M\",u)},d.day=function(t){return this.$g(t,\"$W\",i)},d.date=function(t){return this.$g(t,\"$D\",\"date\")},d.hour=function(t){return this.$g(t,\"$H\",r)},d.minute=function(t){return this.$g(t,\"$m\",e)},d.second=function(t){return this.$g(t,\"$s\",n)},d.millisecond=function(n){return this.$g(n,\"$ms\",t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,a){var h=this,f=!!D.u(a)||a,c=D.p(t),d=function(t,n){var e=D.w(h.$u?Date.UTC(h.$y,n,t):new Date(h.$y,n,t),h);return f?e:e.endOf(i)},$=function(t,n){return D.w(h.toDate()[t].apply(h.toDate(),(f?[0,0,0,0]:[23,59,59,999]).slice(n)),h)},l=this.$W,m=this.$M,y=this.$D,M=\"set\"+(this.$u?\"UTC\":\"\");switch(c){case o:return f?d(1,0):d(31,11);case u:return f?d(1,m):d(0,m+1);case s:var g=this.$locale().weekStart||0,v=(l<g?l+7:l)-g;return d(f?y-v:y+(6-v),m);case i:case\"date\":return $(M+\"Hours\",0);case r:return $(M+\"Minutes\",1);case e:return $(M+\"Seconds\",2);case n:return $(M+\"Milliseconds\",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(s,a){var h,f=D.p(s),c=\"set\"+(this.$u?\"UTC\":\"\"),d=(h={},h[i]=c+\"Date\",h.date=c+\"Date\",h[u]=c+\"Month\",h[o]=c+\"FullYear\",h[r]=c+\"Hours\",h[e]=c+\"Minutes\",h[n]=c+\"Seconds\",h[t]=c+\"Milliseconds\",h)[f],$=f===i?this.$D+(a-this.$W):a;if(f===u||f===o){var l=this.clone().set(\"date\",1);l.$d[d]($),l.init(),this.$d=l.set(\"date\",Math.min(this.$D,l.daysInMonth())).toDate()}else d&&this.$d[d]($);return this.init(),this},d.set=function(t,n){return this.clone().$set(t,n)},d.get=function(t){return this[D.p(t)]()},d.add=function(t,a){var h,f=this;t=Number(t);var c=D.p(a),d=function(n){var e=g(f);return D.w(e.date(e.date()+Math.round(n*t)),f)};if(c===u)return this.set(u,this.$M+t);if(c===o)return this.set(o,this.$y+t);if(c===i)return d(1);if(c===s)return d(7);var $=(h={},h[e]=6e4,h[r]=36e5,h[n]=1e3,h)[c]||1,l=this.valueOf()+t*$;return D.w(l,this)},d.subtract=function(t,n){return this.add(-1*t,n)},d.format=function(t){var n=this;if(!this.isValid())return\"Invalid Date\";var e=t||\"YYYY-MM-DDTHH:mm:ssZ\",r=D.z(this),i=this.$locale(),s=this.$H,u=this.$m,a=this.$M,o=i.weekdays,h=i.months,c=function(t,r,i,s){return t&&(t[r]||t(n,e))||i[r].substr(0,s)},d=function(t){return D.s(s%12||12,t,\"0\")},$=i.meridiem||function(t,n,e){var r=t<12?\"AM\":\"PM\";return e?r.toLowerCase():r},l={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:D.s(a+1,2,\"0\"),MMM:c(i.monthsShort,a,h,3),MMMM:h[a]||h(this,e),D:this.$D,DD:D.s(this.$D,2,\"0\"),d:String(this.$W),dd:c(i.weekdaysMin,this.$W,o,2),ddd:c(i.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:D.s(s,2,\"0\"),h:d(1),hh:d(2),a:$(s,u,!0),A:$(s,u,!1),m:String(u),mm:D.s(u,2,\"0\"),s:String(this.$s),ss:D.s(this.$s,2,\"0\"),SSS:D.s(this.$ms,3,\"0\"),Z:r};return e.replace(f,function(t,n){return n||l[t]||r.replace(\":\",\"\")})},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(t,h,f){var c,d=D.p(h),$=g(t),l=6e4*($.utcOffset()-this.utcOffset()),m=this-$,y=D.m(this,$);return y=(c={},c[o]=y/12,c[u]=y,c[a]=y/3,c[s]=(m-l)/6048e5,c[i]=(m-l)/864e5,c[r]=m/36e5,c[e]=m/6e4,c[n]=m/1e3,c)[d]||m,f?y:D.a(y)},d.daysInMonth=function(){return this.endOf(u).$D},d.$locale=function(){return m[this.$L]},d.locale=function(t,n){if(!t)return this.$L;var e=this.clone();return e.$L=M(t,n,!0),e},d.clone=function(){return D.w(this.toDate(),this)},d.toDate=function(){return new Date(this.$d)},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},c}();return g.prototype=v.prototype,g.extend=function(t,n){return t(n,v,g),g},g.locale=M,g.isDayjs=y,g.unix=function(t){return g(1e3*t)},g.en=m[l],g.Ls=m,g});\n","//\n//  Copyright (c) Microsoft Corporation. All rights reserved.\n//\n'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Entrypoint and type definitions for Live Share for VS Code extension API\n */\nconst vscode = require(\"vscode\");\nconst liveShareApiVersion = require('./package.json').version;\n/**\n * Extension ID of the Live Share extension for VS Code.\n */\nexports.extensionId = 'ms-vsliveshare.vsliveshare';\n/**\n * Entrypoint for access to the Live Share API.\n *\n * @returns an instance of the Live Share API, or `null` if the Live Share extension\n * is not installed or failed to activate.\n *\n * @example To access the Live Share API from another extension:\n *\n *     import * as vsls from 'vsls/vscode';\n *     const liveshare = await vsls.getApi();\n */\nasync function getApi() {\n    const liveshareExtension = vscode.extensions.getExtension(exports.extensionId);\n    if (!liveshareExtension) {\n        // The extension is not installed.\n        return null;\n    }\n    const extensionApi = liveshareExtension.isActive ?\n        liveshareExtension.exports : await liveshareExtension.activate();\n    if (!extensionApi) {\n        // The extensibility API is not enabled.\n        return null;\n    }\n    // Support deprecated function name to preserve compatibility with older versions of VSLS.\n    if (!extensionApi.getApi)\n        return extensionApi.getApiAsync(liveShareApiVersion);\n    return extensionApi.getApi(liveShareApiVersion);\n}\nexports.getApi = getApi;\n/** @deprecated */\nfunction getApiAsync() { return getApi(); }\nexports.getApiAsync = getApiAsync;\nvar Role;\n(function (Role) {\n    Role[Role[\"None\"] = 0] = \"None\";\n    Role[Role[\"Host\"] = 1] = \"Host\";\n    Role[Role[\"Guest\"] = 2] = \"Guest\";\n})(Role = exports.Role || (exports.Role = {}));\n/** This is just a placeholder for a richer access control model to be added later. */\nvar Access;\n(function (Access) {\n    Access[Access[\"None\"] = 0] = \"None\";\n    Access[Access[\"ReadOnly\"] = 1] = \"ReadOnly\";\n    Access[Access[\"ReadWrite\"] = 3] = \"ReadWrite\";\n    Access[Access[\"Owner\"] = 255] = \"Owner\";\n})(Access = exports.Access || (exports.Access = {}));\n/**\n * Identifiers for Live Share tree views. These identifiers may be used by other extensions\n * to extend Live Share tree views with additional nodes via the `registerTreeDataProvider()`\n * API.\n */\nvar View;\n(function (View) {\n    View[\"Session\"] = \"liveshare.session\";\n    View[\"ExplorerSession\"] = \"liveshare.session.explorer\";\n    View[\"Contacts\"] = \"liveshare.contacts\";\n    View[\"Help\"] = \"liveshare.help\";\n})(View = exports.View || (exports.View = {}));\n/**\n * Identifiers for Live Share tree view items. These identifiers may be used by other\n * extensions to extend Live Share tree items with additional commands using conditional\n * expressions in the `view/item/context` section of their own package.json.\n */\nvar ViewItem;\n(function (ViewItem) {\n    // session item groups\n    ViewItem[\"Participants\"] = \"participants\";\n    ViewItem[\"Servers\"] = \"servers\";\n    ViewItem[\"Terminals\"] = \"terminals\";\n    // participants\n    ViewItem[\"CurrentUser\"] = \"participants.currentuser\";\n    ViewItem[\"Guest\"] = \"participants.guest\";\n    ViewItem[\"FollowedGuest\"] = \"participants.guest.followed\";\n    ViewItem[\"Participant\"] = \"participants.participant\";\n    ViewItem[\"FollowedParticipant\"] = \"participants.participant.followed\";\n    ViewItem[\"GuestAnonymous\"] = \"participants.guest.anonymous\";\n    ViewItem[\"FollowedGuestAnonymous\"] = \"participants.guest.followed.anonymous\";\n    ViewItem[\"GuestElevated\"] = \"participants.guest.elevated\";\n    ViewItem[\"FollowedGuestElevated\"] = \"participants.guest.followed.elevated\";\n    // servers\n    ViewItem[\"LocalServer\"] = \"servers.local\";\n    ViewItem[\"RemoteServer\"] = \"servers.remote\";\n    // terminals\n    ViewItem[\"LocalTerminalReadOnly\"] = \"terminals.local.readonly\";\n    ViewItem[\"LocalTerminalReadWrite\"] = \"terminals.local.readwrite\";\n    ViewItem[\"RemoteTerminal\"] = \"terminals.remote\";\n    // contacts\n    ViewItem[\"SuggestedContacts\"] = \"contacts.suggested\";\n    ViewItem[\"AvailableContacts\"] = \"contacts.available\";\n    ViewItem[\"ContactsProvider\"] = \"contacts.provider\";\n    ViewItem[\"SelfContact\"] = \"contacts.selfContact\";\n    ViewItem[\"Contact\"] = \"contacts.contact\";\n    ViewItem[\"ContactOffline\"] = \"contacts.contact.offline\";\n    ViewItem[\"RecentContact\"] = \"contacts.recentContact\";\n    ViewItem[\"RecentContactOffline\"] = \"contacts.recentContact.offline\";\n    ViewItem[\"NoContact\"] = \"contacts.noContact\";\n    ViewItem[\"RecentContacts\"] = \"contacts.RecentContacts\";\n    ViewItem[\"NoSuggestedContacts\"] = \"contacts.NoSuggestedUsers\";\n    ViewItem[\"NoRecentContacts\"] = \"contacts.NoRecentContacts\";\n    ViewItem[\"InvitedContact\"] = \"contacts.invited\";\n    // help\n    ViewItem[\"SessionFeedbackQuestion\"] = \"help.sessionFeedback\";\n    ViewItem[\"ReportAProblem\"] = \"help.reportAProblem\";\n    ViewItem[\"TweetUsYourFeedback\"] = \"help.tweetUsYourFeedback\";\n    ViewItem[\"Survey\"] = \"help.survey\";\n    ViewItem[\"GoodFeedback\"] = \"help.goodFeedback\";\n    ViewItem[\"BadFeedback\"] = \"help.badFeedback\";\n    ViewItem[\"DontAskAgain\"] = \"help.dontAskAgain\";\n    ViewItem[\"Thankyou\"] = \"help.thankyou\";\n    ViewItem[\"MoreInfo\"] = \"help.moreinfo\";\n    // Shown while session sharing / joining is in progress\n    ViewItem[\"Loading\"] = \"loading\";\n    // Other / unspecified item type\n    ViewItem[\"Other\"] = \"other\";\n})(ViewItem = exports.ViewItem || (exports.ViewItem = {}));\n\n//# sourceMappingURL=liveShare.js.map\n","module.exports = require(\"stream\");","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","module.exports = require(\"crypto\");","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","'use strict';\nimport { GitCommit, GitCommitLine, GitCommitType } from './commit';\n\nexport class GitBlameCommit extends GitCommit {\n\tstatic is(commit: any): commit is GitBlameCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitBlameCommit\n\t\t\t//|| (commit.repoPath !== undefined && commit.sha !== undefined && commit.type === GitCommitType.Blame)\n\t\t);\n\t}\n\n\tconstructor(\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthor: string,\n\t\temail: string | undefined,\n\t\tauthorDate: Date,\n\t\tcommitterDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\toriginalFileName: string | undefined,\n\t\tpreviousSha: string | undefined,\n\t\tpreviousFileName: string | undefined,\n\t\tpublic readonly lines: GitCommitLine[]\n\t) {\n\t\tsuper(\n\t\t\tGitCommitType.Blame,\n\t\t\trepoPath,\n\t\t\tsha,\n\t\t\tauthor,\n\t\t\temail,\n\t\t\tauthorDate,\n\t\t\tcommitterDate,\n\t\t\tmessage,\n\t\t\tfileName,\n\t\t\toriginalFileName,\n\t\t\tpreviousSha,\n\t\t\tpreviousFileName\n\t\t);\n\t}\n\n\twith(changes: {\n\t\tsha?: string;\n\t\tfileName?: string;\n\t\toriginalFileName?: string | null;\n\t\tpreviousFileName?: string | null;\n\t\tpreviousSha?: string | null;\n\t\tlines?: GitCommitLine[] | null;\n\t}): GitBlameCommit {\n\t\treturn new GitBlameCommit(\n\t\t\tthis.repoPath,\n\t\t\tchanges.sha || this.sha,\n\t\t\tthis.author,\n\t\t\tthis.email,\n\t\t\tthis.authorDate,\n\t\t\tthis.committerDate,\n\t\t\tthis.message,\n\t\t\tchanges.fileName || this.fileName,\n\t\t\tthis.getChangedValue(changes.originalFileName, this.originalFileName),\n\t\t\tthis.getChangedValue(changes.previousSha, this.previousSha),\n\t\t\tthis.getChangedValue(changes.previousFileName, this.previousFileName),\n\t\t\tthis.getChangedValue(changes.lines, changes.sha || changes.fileName ? [] : this.lines) || []\n\t\t);\n\t}\n}\n","'use strict';\nimport { Uri } from 'vscode';\nimport { GravatarDefaultStyle } from '../../configuration';\nimport { getAvatarUri } from '../../avatars';\n\nexport class GitContributor {\n\tstatic is(contributor: any): contributor is GitContributor {\n\t\treturn contributor instanceof GitContributor;\n\t}\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly email: string,\n\t\tpublic readonly count: number\n\t) {}\n\n\tgetGravatarUri(fallback: GravatarDefaultStyle, size: number = 16): Uri {\n\t\treturn getAvatarUri(this.email, fallback, size);\n\t}\n}\n","'use strict';\nimport { GitDiffParser } from '../parsers/diffParser';\nimport { memoize } from '../../system';\n\nexport interface GitDiffLine {\n\tline: string;\n\tstate: 'added' | 'removed' | 'unchanged';\n}\n\nexport interface GitDiffHunkLine {\n\thunk: GitDiffHunk;\n\tcurrent: GitDiffLine | undefined;\n\tprevious: GitDiffLine | undefined;\n}\n\nexport class GitDiffHunk {\n\tconstructor(\n\t\tpublic readonly diff: string,\n\t\tpublic currentPosition: { start: number; end: number },\n\t\tpublic previousPosition: { start: number; end: number }\n\t) {}\n\n\t@memoize()\n\tget lines(): GitDiffHunkLine[] {\n\t\treturn GitDiffParser.parseHunk(this);\n\t}\n}\n\nexport interface GitDiff {\n\treadonly hunks: GitDiffHunk[];\n\n\treadonly diff?: string;\n}\n\nexport interface GitDiffShortStat {\n\treadonly files: number;\n\treadonly insertions: number;\n\treadonly deletions: number;\n}\n","'use strict';\nimport { WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { RemoteProvider } from '../remotes/factory';\n\nexport enum GitRemoteType {\n\tFetch = 'fetch',\n\tPush = 'push'\n}\n\nexport class GitRemote {\n\tstatic is(remote: any): remote is GitRemote {\n\t\treturn remote instanceof GitRemote;\n\t}\n\n\tstatic sort(remotes: GitRemote[]) {\n\t\treturn remotes.sort(\n\t\t\t(a, b) =>\n\t\t\t\t(a.default ? -1 : 1) - (b.default ? -1 : 1) ||\n\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' })\n\t\t);\n\t}\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly id: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly scheme: string,\n\t\tpublic readonly domain: string,\n\t\tpublic readonly path: string,\n\t\tpublic readonly provider: RemoteProvider | undefined,\n\t\tpublic readonly types: { type: GitRemoteType; url: string }[]\n\t) {}\n\n\tget default() {\n\t\tconst defaultRemote = Container.context.workspaceState.get<string>(WorkspaceState.DefaultRemote);\n\t\treturn this.id === defaultRemote;\n\t}\n\n\tsetAsDefault(state: boolean = true) {\n\t\treturn Container.context.workspaceState.update(WorkspaceState.DefaultRemote, state ? this.id : undefined);\n\t}\n}\n","'use strict';\nimport * as paths from 'path';\nimport {\n\tcommands,\n\tConfigurationChangeEvent,\n\tDisposable,\n\tEvent,\n\tEventEmitter,\n\tProgressLocation,\n\tRelativePattern,\n\tUri,\n\twindow,\n\tworkspace,\n\tWorkspaceFolder\n} from 'vscode';\nimport { configuration } from '../../configuration';\nimport { StarredRepositories, WorkspaceState } from '../../constants';\nimport { Container } from '../../container';\nimport { Functions, gate, log } from '../../system';\nimport { GitBranch, GitContributor, GitDiffShortStat, GitRemote, GitStash, GitStatus, GitTag } from '../git';\nimport { GitUri } from '../gitUri';\nimport { RemoteProviderFactory, RemoteProviders } from '../remotes/factory';\nimport { Messages } from '../../messages';\nimport { Logger } from '../../logger';\nimport { logName } from '../../system/decorators/log';\n\nexport enum RepositoryChange {\n\tConfig = 'config',\n\tClosed = 'closed',\n\t// FileSystem = 'file-system',\n\tRemotes = 'remotes',\n\tRepository = 'repository',\n\tStashes = 'stashes',\n\tTags = 'tags'\n}\n\nexport class RepositoryChangeEvent {\n\treadonly changes: RepositoryChange[] = [];\n\n\tconstructor(public readonly repository?: Repository) {}\n\n\tchanged(change: RepositoryChange, solely: boolean = false) {\n\t\tif (solely) return this.changes.length === 1 && this.changes[0] === change;\n\n\t\treturn this.changes.includes(change);\n\n\t\t// const changed = this.changes.includes(change);\n\t\t// if (changed) return true;\n\n\t\t// if (change === RepositoryChange.Repository) {\n\t\t//     return this.changes.includes(RepositoryChange.Stashes);\n\t\t// }\n\n\t\t// return false;\n\t}\n}\n\nexport interface RepositoryFileSystemChangeEvent {\n\treadonly repository?: Repository;\n\treadonly uris: Uri[];\n}\n\n@logName<Repository>((r, name) => `${name}(${r.id})`)\nexport class Repository implements Disposable {\n\tstatic sort(repositories: Repository[]) {\n\t\treturn repositories.sort((a, b) => (a.starred ? -1 : 1) - (b.starred ? -1 : 1) || a.index - b.index);\n\t}\n\n\tprivate _onDidChange = new EventEmitter<RepositoryChangeEvent>();\n\tget onDidChange(): Event<RepositoryChangeEvent> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _onDidChangeFileSystem = new EventEmitter<RepositoryFileSystemChangeEvent>();\n\tget onDidChangeFileSystem(): Event<RepositoryFileSystemChangeEvent> {\n\t\treturn this._onDidChangeFileSystem.event;\n\t}\n\n\treadonly formattedName: string;\n\treadonly id: string;\n\treadonly index: number;\n\treadonly name: string;\n\treadonly normalizedPath: string;\n\treadonly supportsChangeEvents: boolean = true;\n\n\tprivate _branch: Promise<GitBranch | undefined> | undefined;\n\tprivate readonly _disposable: Disposable;\n\tprivate _fireChangeDebounced: ((e: RepositoryChangeEvent) => void) | undefined = undefined;\n\tprivate _fireFileSystemChangeDebounced: ((e: RepositoryFileSystemChangeEvent) => void) | undefined = undefined;\n\tprivate _fsWatchCounter = 0;\n\tprivate _fsWatcherDisposable: Disposable | undefined;\n\tprivate _pendingChanges: { repo?: RepositoryChangeEvent; fs?: RepositoryFileSystemChangeEvent } = {};\n\tprivate _providers: RemoteProviders | undefined;\n\tprivate _remotes: Promise<GitRemote[]> | undefined;\n\tprivate _suspended: boolean;\n\n\tconstructor(\n\t\tpublic readonly folder: WorkspaceFolder,\n\t\tpublic readonly path: string,\n\t\tpublic readonly root: boolean,\n\t\tprivate readonly onAnyRepositoryChanged: (repo: Repository, reason: RepositoryChange) => void,\n\t\tsuspended: boolean,\n\t\tclosed: boolean = false\n\t) {\n\t\tconst relativePath = paths.relative(folder.uri.fsPath, path);\n\t\tif (root) {\n\t\t\t// Check if the repository is not contained by a workspace folder\n\t\t\tconst repoFolder = workspace.getWorkspaceFolder(GitUri.fromRepoPath(path));\n\t\t\tif (repoFolder === undefined) {\n\t\t\t\t// If it isn't within a workspace folder we can't get change events, see: https://github.com/Microsoft/vscode/issues/3025\n\t\t\t\tthis.supportsChangeEvents = false;\n\t\t\t\tthis.formattedName = this.name = paths.basename(path);\n\t\t\t} else {\n\t\t\t\tthis.formattedName = this.name = folder.name;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.formattedName = relativePath ? `${folder.name} (${relativePath})` : folder.name;\n\t\t\tthis.name = folder.name;\n\t\t}\n\t\tthis.index = folder.index;\n\n\t\tthis.normalizedPath = (path.endsWith('/') ? path : `${path}/`).toLowerCase();\n\t\tthis.id = this.normalizedPath;\n\n\t\tthis._suspended = suspended;\n\t\tthis._closed = closed;\n\n\t\t// TODO: createFileSystemWatcher doesn't work unless the folder is part of the workspaceFolders\n\t\t// https://github.com/Microsoft/vscode/issues/3025\n\t\tconst watcher = workspace.createFileSystemWatcher(\n\t\t\tnew RelativePattern(\n\t\t\t\tfolder,\n\t\t\t\t'{\\\n**/.git/config,\\\n**/.git/index,\\\n**/.git/HEAD,\\\n**/.git/refs/stash,\\\n**/.git/refs/heads/**,\\\n**/.git/refs/remotes/**,\\\n**/.git/refs/tags/**,\\\n**/.gitignore\\\n}'\n\t\t\t)\n\t\t);\n\t\tthis._disposable = Disposable.from(\n\t\t\twatcher,\n\t\t\twatcher.onDidChange(this.onRepositoryChanged, this),\n\t\t\twatcher.onDidCreate(this.onRepositoryChanged, this),\n\t\t\twatcher.onDidDelete(this.onRepositoryChanged, this),\n\t\t\tconfiguration.onDidChange(this.onConfigurationChanged, this)\n\t\t);\n\t\tthis.onConfigurationChanged(configuration.initializingChangeEvent);\n\t}\n\n\tdispose() {\n\t\tthis.stopWatchingFileSystem();\n\n\t\t// // Clean up any disposables in storage\n\t\t// for (const item of this.storage.values()) {\n\t\t//     if (item != null && typeof item.dispose === 'function') {\n\t\t//         item.dispose();\n\t\t//     }\n\t\t// }\n\n\t\tthis._disposable && this._disposable.dispose();\n\t}\n\n\tprivate onConfigurationChanged(e: ConfigurationChangeEvent) {\n\t\tif (configuration.changed(e, 'remotes', this.folder.uri)) {\n\t\t\tthis._providers = RemoteProviderFactory.loadProviders(configuration.get('remotes', this.folder.uri));\n\n\t\t\tif (!configuration.initializing(e)) {\n\t\t\t\tthis._remotes = undefined;\n\t\t\t\tthis.fireChange(RepositoryChange.Remotes);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onFileSystemChanged(uri: Uri) {\n\t\t// Ignore .git changes\n\t\tif (/\\.git(?:\\/|\\\\|$)/.test(uri.fsPath)) return;\n\n\t\tthis.fireFileSystemChange(uri);\n\t}\n\n\tprivate onRepositoryChanged(uri: Uri) {\n\t\tif (uri !== undefined && uri.path.endsWith('refs/stash')) {\n\t\t\tthis.fireChange(RepositoryChange.Stashes);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._branch = undefined;\n\n\t\tif (uri !== undefined && uri.path.endsWith('refs/remotes')) {\n\t\t\tthis._remotes = undefined;\n\t\t\tthis.fireChange(RepositoryChange.Remotes);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri !== undefined && uri.path.endsWith('refs/tags')) {\n\t\t\tthis.fireChange(RepositoryChange.Tags);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (uri !== undefined && uri.path.endsWith('config')) {\n\t\t\tthis._remotes = undefined;\n\t\t\tthis.fireChange(RepositoryChange.Config, RepositoryChange.Remotes);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onAnyRepositoryChanged(this, RepositoryChange.Repository);\n\t\tthis.fireChange(RepositoryChange.Repository);\n\t}\n\n\tprivate _closed: boolean = false;\n\tget closed(): boolean {\n\t\treturn this._closed;\n\t}\n\tset closed(value: boolean) {\n\t\tconst changed = this._closed !== value;\n\t\tthis._closed = value;\n\t\tif (changed) {\n\t\t\tthis.onAnyRepositoryChanged(this, RepositoryChange.Closed);\n\t\t\tthis.fireChange(RepositoryChange.Closed);\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tasync checkout(ref: string, options: { createBranch?: string | undefined; progress?: boolean } = {}) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.checkoutCore(ref, opts);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Checking out ${this.formattedName} to ${ref}...`,\n\t\t\t\tcancellable: false\n\t\t\t},\n\t\t\t() => this.checkoutCore(ref, opts)\n\t\t));\n\t}\n\n\tprivate async checkoutCore(ref: string, options: { createBranch?: string } = {}) {\n\t\ttry {\n\t\t\tvoid (await Container.git.checkout(this.path, ref, options));\n\n\t\t\tthis.fireChange(RepositoryChange.Repository);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tMessages.showGenericErrorMessage('Unable to checkout repository');\n\t\t}\n\t}\n\n\tcontainsUri(uri: Uri) {\n\t\tif (GitUri.is(uri)) {\n\t\t\turi = uri.repoPath !== undefined ? GitUri.file(uri.repoPath) : uri.documentUri();\n\t\t}\n\n\t\treturn this.folder === workspace.getWorkspaceFolder(uri);\n\t}\n\n\t@gate()\n\t@log()\n\tasync fetch(options: { all?: boolean; progress?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.fetchCore(opts);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Fetching ${opts.remote ? `${opts.remote} of ` : ''}${this.formattedName}...`\n\t\t\t},\n\t\t\t() => this.fetchCore(opts)\n\t\t));\n\t}\n\n\tprivate async fetchCore(options: { all?: boolean; prune?: boolean; remote?: string } = {}) {\n\t\ttry {\n\t\t\tvoid (await Container.git.fetch(this.path, options));\n\n\t\t\tthis.fireChange(RepositoryChange.Repository);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tMessages.showGenericErrorMessage('Unable to fetch repository');\n\t\t}\n\t}\n\n\tgetBranch(): Promise<GitBranch | undefined> {\n\t\tif (this._branch === undefined || !this.supportsChangeEvents) {\n\t\t\tthis._branch = Container.git.getBranch(this.path);\n\t\t}\n\t\treturn this._branch;\n\t}\n\n\tgetBranches(options: { filter?: (b: GitBranch) => boolean; sort?: boolean } = {}): Promise<GitBranch[]> {\n\t\treturn Container.git.getBranches(this.path, options);\n\t}\n\n\tgetBranchesAndOrTags(\n\t\toptions: {\n\t\t\tfilterBranches?: (b: GitBranch) => boolean;\n\t\t\tfilterTags?: (t: GitTag) => boolean;\n\t\t\tinclude?: 'all' | 'branches' | 'tags';\n\t\t\tsort?: boolean;\n\t\t} = {}\n\t) {\n\t\treturn Container.git.getBranchesAndOrTags(this.path, options);\n\t}\n\n\tgetChangedFilesCount(sha?: string): Promise<GitDiffShortStat | undefined> {\n\t\treturn Container.git.getChangedFilesCount(this.path, sha);\n\t}\n\n\tgetContributors(): Promise<GitContributor[]> {\n\t\treturn Container.git.getContributors(this.path);\n\t}\n\n\tasync getLastFetched(): Promise<number> {\n\t\tconst hasRemotes = await this.hasRemotes();\n\t\tif (!hasRemotes || Container.vsls.isMaybeGuest) return 0;\n\n\t\ttry {\n\t\t\tconst stat = await workspace.fs.stat(Uri.file(paths.join(this.path, '.git/FETCH_HEAD')));\n\t\t\treturn stat.mtime;\n\t\t} catch {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tgetRemotes(options: { sort?: boolean } = {}): Promise<GitRemote[]> {\n\t\tif (this._remotes === undefined || !this.supportsChangeEvents) {\n\t\t\tif (this._providers === undefined) {\n\t\t\t\tconst remotesCfg = configuration.get('remotes', this.folder.uri);\n\t\t\t\tthis._providers = RemoteProviderFactory.loadProviders(remotesCfg);\n\t\t\t}\n\n\t\t\t// Since we are caching the results, always sort\n\t\t\tthis._remotes = Container.git.getRemotesCore(this.path, this._providers, { sort: true });\n\t\t}\n\n\t\treturn this._remotes;\n\t}\n\n\tgetStashList(): Promise<GitStash | undefined> {\n\t\treturn Container.git.getStashList(this.path);\n\t}\n\n\tgetStatus(): Promise<GitStatus | undefined> {\n\t\treturn Container.git.getStatusForRepo(this.path);\n\t}\n\n\tgetTags(options?: { filter?: (t: GitTag) => boolean; includeRefs?: boolean; sort?: boolean }): Promise<GitTag[]> {\n\t\treturn Container.git.getTags(this.path, options);\n\t}\n\n\tasync hasRemotes(): Promise<boolean> {\n\t\tconst remotes = await this.getRemotes();\n\t\treturn remotes !== undefined && remotes.length > 0;\n\t}\n\n\tasync hasTrackingBranch(): Promise<boolean> {\n\t\tconst branch = await this.getBranch();\n\t\treturn branch !== undefined && branch.tracking !== undefined;\n\t}\n\n\t@gate()\n\t@log()\n\tasync pull(options: { progress?: boolean; rebase?: boolean } = {}) {\n\t\tconst { progress, ...opts } = { progress: true, ...options };\n\t\tif (!progress) return this.pullCore();\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pulling ${this.formattedName}...`\n\t\t\t},\n\t\t\t() => this.pullCore(opts)\n\t\t));\n\t}\n\n\tprivate async pullCore(options: { rebase?: boolean } = {}) {\n\t\ttry {\n\t\t\tconst tracking = await this.hasTrackingBranch();\n\t\t\tif (tracking) {\n\t\t\t\tvoid (await commands.executeCommand(options.rebase ? 'git.pullRebase' : 'git.pull', this.path));\n\t\t\t} else if (configuration.getAny<boolean>('git.fetchOnPull', Uri.file(this.path))) {\n\t\t\t\tvoid (await Container.git.fetch(this.path));\n\t\t\t}\n\n\t\t\tthis.fireChange(RepositoryChange.Repository);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tMessages.showGenericErrorMessage('Unable to pull repository');\n\t\t}\n\t}\n\n\t@gate()\n\t@log()\n\tasync push(options: { force?: boolean; progress?: boolean } = {}) {\n\t\tconst { force, progress } = { progress: true, ...options };\n\t\tif (!progress) return this.pushCore(force);\n\n\t\treturn void (await window.withProgress(\n\t\t\t{\n\t\t\t\tlocation: ProgressLocation.Notification,\n\t\t\t\ttitle: `Pushing ${this.formattedName}...`\n\t\t\t},\n\t\t\t() => this.pushCore(force)\n\t\t));\n\t}\n\n\tprivate async pushCore(force: boolean = false) {\n\t\ttry {\n\t\t\tvoid (await commands.executeCommand(force ? 'git.pushForce' : 'git.push', this.path));\n\n\t\t\tthis.fireChange(RepositoryChange.Repository);\n\t\t} catch (ex) {\n\t\t\tLogger.error(ex);\n\t\t\tMessages.showGenericErrorMessage('Unable to push repository');\n\t\t}\n\t}\n\n\tresume() {\n\t\tif (!this._suspended) return;\n\n\t\tthis._suspended = false;\n\n\t\t// If we've come back into focus and we are dirty, fire the change events\n\n\t\tif (this._pendingChanges.repo !== undefined) {\n\t\t\tthis._fireChangeDebounced!(this._pendingChanges.repo);\n\t\t}\n\n\t\tif (this._pendingChanges.fs !== undefined) {\n\t\t\tthis._fireFileSystemChangeDebounced!(this._pendingChanges.fs);\n\t\t}\n\t}\n\n\tget starred() {\n\t\tconst starred = Container.context.workspaceState.get<StarredRepositories>(WorkspaceState.StarredRepositories);\n\t\treturn starred !== undefined && starred[this.id] === true;\n\t}\n\n\tstar() {\n\t\treturn this.updateStarred(true);\n\t}\n\n\tunstar() {\n\t\treturn this.updateStarred(false);\n\t}\n\n\tprivate async updateStarred(star: boolean) {\n\t\tlet starred = Container.context.workspaceState.get<StarredRepositories>(WorkspaceState.StarredRepositories);\n\t\tif (starred === undefined) {\n\t\t\tstarred = Object.create(null);\n\t\t}\n\n\t\tif (star) {\n\t\t\tstarred![this.id] = true;\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\tconst { [this.id]: _, ...rest } = starred!;\n\t\t\tstarred = rest;\n\t\t}\n\t\tawait Container.context.workspaceState.update(WorkspaceState.StarredRepositories, starred);\n\t}\n\n\tstartWatchingFileSystem() {\n\t\tthis._fsWatchCounter++;\n\t\tif (this._fsWatcherDisposable !== undefined) return;\n\n\t\t// TODO: createFileSystemWatcher doesn't work unless the folder is part of the workspaceFolders\n\t\t// https://github.com/Microsoft/vscode/issues/3025\n\t\tconst watcher = workspace.createFileSystemWatcher(new RelativePattern(this.folder, '**'));\n\t\tthis._fsWatcherDisposable = Disposable.from(\n\t\t\twatcher,\n\t\t\twatcher.onDidChange(this.onFileSystemChanged, this),\n\t\t\twatcher.onDidCreate(this.onFileSystemChanged, this),\n\t\t\twatcher.onDidDelete(this.onFileSystemChanged, this)\n\t\t);\n\t}\n\n\tstopWatchingFileSystem() {\n\t\tif (this._fsWatcherDisposable === undefined) return;\n\t\tif (--this._fsWatchCounter > 0) return;\n\n\t\tthis._fsWatcherDisposable.dispose();\n\t\tthis._fsWatcherDisposable = undefined;\n\t}\n\n\tsuspend() {\n\t\tthis._suspended = true;\n\t}\n\n\tprivate fireChange(...reasons: RepositoryChange[]) {\n\t\tif (this._fireChangeDebounced === undefined) {\n\t\t\tthis._fireChangeDebounced = Functions.debounce(this.fireChangeCore.bind(this), 250);\n\t\t}\n\n\t\tif (this._pendingChanges.repo === undefined) {\n\t\t\tthis._pendingChanges.repo = new RepositoryChangeEvent(this);\n\t\t}\n\n\t\tconst e = this._pendingChanges.repo;\n\n\t\tfor (const reason of reasons) {\n\t\t\tif (!e.changes.includes(reason)) {\n\t\t\t\te.changes.push(reason);\n\t\t\t}\n\t\t}\n\n\t\tif (this._suspended) return;\n\n\t\tthis._fireChangeDebounced(e);\n\t}\n\n\tprivate fireChangeCore(e: RepositoryChangeEvent) {\n\t\tthis._pendingChanges.repo = undefined;\n\n\t\tthis._onDidChange.fire(e);\n\t}\n\n\tprivate fireFileSystemChange(uri: Uri) {\n\t\tif (this._fireFileSystemChangeDebounced === undefined) {\n\t\t\tthis._fireFileSystemChangeDebounced = Functions.debounce(this.fireFileSystemChangeCore.bind(this), 2500);\n\t\t}\n\n\t\tif (this._pendingChanges.fs === undefined) {\n\t\t\tthis._pendingChanges.fs = { repository: this, uris: [] };\n\t\t}\n\n\t\tconst e = this._pendingChanges.fs;\n\t\te.uris.push(uri);\n\n\t\tif (this._suspended) return;\n\n\t\tthis._fireFileSystemChangeDebounced(e);\n\t}\n\n\tprivate fireFileSystemChangeCore(e: RepositoryFileSystemChangeEvent) {\n\t\tthis._pendingChanges.fs = undefined;\n\n\t\tthis._onDidChangeFileSystem.fire(e);\n\t}\n}\n","'use strict';\nimport { GitCommitType } from './commit';\nimport { GitFile } from './file';\nimport { GitLogCommit } from './logCommit';\nimport { memoize } from '../../system';\n\nconst stashNumberRegex = /stash@{(\\d+)}/;\n\nexport class GitStashCommit extends GitLogCommit {\n\tstatic is(commit: any): commit is GitStashCommit {\n\t\treturn (\n\t\t\tcommit instanceof GitStashCommit\n\t\t\t// || (commit.repoPath !== undefined &&\n\t\t\t//     commit.sha !== undefined &&\n\t\t\t//     (commit.type === GitCommitType.Stash || commit.type === GitCommitType.StashFile))\n\t\t);\n\t}\n\n\tconstructor(\n\t\ttype: GitCommitType,\n\t\tpublic readonly stashName: string,\n\t\trepoPath: string,\n\t\tsha: string,\n\t\tauthorDate: Date,\n\t\tcommittedDate: Date,\n\t\tmessage: string,\n\t\tfileName: string,\n\t\tfiles: GitFile[]\n\t) {\n\t\tsuper(type, repoPath, sha, 'You', undefined, authorDate, committedDate, message, fileName, files);\n\t}\n\n\t@memoize()\n\tget number() {\n\t\tconst match = stashNumberRegex.exec(this.stashName);\n\t\tif (match == null) return undefined;\n\n\t\treturn match[1];\n\t}\n\n\tget shortSha() {\n\t\treturn this.stashName;\n\t}\n\n\twith(changes: {\n\t\ttype?: GitCommitType;\n\t\tsha?: string | null;\n\t\tfileName?: string;\n\t\tauthorDate?: Date;\n\t\tcommittedDate?: Date;\n\t\tmessage?: string;\n\t\tfiles?: GitFile[] | null;\n\t}): GitLogCommit {\n\t\treturn new GitStashCommit(\n\t\t\tchanges.type || this.type,\n\t\t\tthis.stashName,\n\t\t\tthis.repoPath,\n\t\t\tthis.getChangedValue(changes.sha, this.sha)!,\n\t\t\tchanges.authorDate || this.authorDate,\n\t\t\tchanges.committedDate || this.committerDate,\n\t\t\tchanges.message || this.message,\n\t\t\tchanges.fileName || this.fileName,\n\t\t\tthis.getChangedValue(changes.files, this.files) || []\n\t\t);\n\t}\n}\n","'use strict';\nimport { memoize } from '../../system';\nimport { GitReference } from './models';\nimport { configuration, TagSorting } from '../../configuration';\n\nexport class GitTag implements GitReference {\n\tstatic is(tag: any): tag is GitTag {\n\t\treturn tag instanceof GitTag;\n\t}\n\n\tstatic isOfRefType(tag: GitReference | undefined) {\n\t\treturn tag !== undefined && tag.refType === 'tag';\n\t}\n\n\tstatic sort(tags: GitTag[]) {\n\t\tconst order = configuration.get('sortTagsBy');\n\n\t\tswitch (order) {\n\t\t\tcase TagSorting.NameAsc:\n\t\t\t\treturn tags.sort((a, b) =>\n\t\t\t\t\tb.name.localeCompare(a.name, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t\t);\n\t\t\tdefault:\n\t\t\t\treturn tags.sort((a, b) =>\n\t\t\t\t\ta.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' })\n\t\t\t\t);\n\t\t}\n\t}\n\n\treadonly refType = 'tag';\n\n\tconstructor(\n\t\tpublic readonly repoPath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly sha?: string,\n\t\tpublic readonly annotation?: string\n\t) {}\n\n\tget ref() {\n\t\treturn this.name;\n\t}\n\n\t@memoize()\n\tgetBasename(): string {\n\t\tconst index = this.name.lastIndexOf('/');\n\t\treturn index !== -1 ? this.name.substring(index + 1) : this.name;\n\t}\n}\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):e.dayjs_plugin_advancedFormat=t()}(this,function(){\"use strict\";return function(e,t,r){var n=t.prototype,o=n.format;r.en.ordinal=function(e){var t=[\"th\",\"st\",\"nd\",\"rd\"],r=e%100;return\"[\"+e+(t[(r-20)%10]||t[r]||t[0])+\"]\"},n.format=function(e){var t=this,r=this.$locale(),n=this.$utils(),i=(e||\"YYYY-MM-DDTHH:mm:ssZ\").replace(/\\[([^\\]]+)]|Q|wo|gggg|Do|X|x|k{1,2}|S/g,function(e){switch(e){case\"Q\":return Math.ceil((t.$M+1)/3);case\"Do\":return r.ordinal(t.$D);case\"gggg\":return t.weekYear();case\"wo\":return r.ordinal(t.week(),\"W\");case\"k\":case\"kk\":return n.s(String(0===t.$H?24:t.$H),\"k\"===e?1:2,\"0\");case\"X\":return Math.floor(t.$d.getTime()/1e3);case\"x\":return t.$d.getTime();default:return e}});return o.bind(this)(i)}}});\n","!function(r,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):r.dayjs_plugin_relativeTime=t()}(this,function(){\"use strict\";return function(r,t,e){var n=t.prototype;e.en.relativeTime={future:\"in %s\",past:\"%s ago\",s:\"a few seconds\",m:\"a minute\",mm:\"%d minutes\",h:\"an hour\",hh:\"%d hours\",d:\"a day\",dd:\"%d days\",M:\"a month\",MM:\"%d months\",y:\"a year\",yy:\"%d years\"};var o=function(r,t,n,o){for(var d,i,u=n.$locale().relativeTime,a=[{l:\"s\",r:44,d:\"second\"},{l:\"m\",r:89},{l:\"mm\",r:44,d:\"minute\"},{l:\"h\",r:89},{l:\"hh\",r:21,d:\"hour\"},{l:\"d\",r:35},{l:\"dd\",r:25,d:\"day\"},{l:\"M\",r:45},{l:\"MM\",r:10,d:\"month\"},{l:\"y\",r:17},{l:\"yy\",d:\"year\"}],f=a.length,s=0;s<f;s+=1){var l=a[s];l.d&&(d=o?e(r).diff(n,l.d,!0):n.diff(r,l.d,!0));var h=Math.round(Math.abs(d));if(h<=l.r||!l.r){1===h&&s>0&&(l=a[s-1]),i=u[l.l].replace(\"%d\",h);break}}return t?i:(d>0?u.future:u.past).replace(\"%s\",i)};n.to=function(r,t){return o(r,t,this,!0)},n.from=function(r,t){return o(r,t,this)};var d=function(r){return r.$u?e.utc():e()};n.toNow=function(r){return this.to(d(this),r)},n.fromNow=function(r){return this.from(d(this),r)}}});\n","'use strict';\nimport * as paths from 'path';\nimport { findExecutable, run } from './shell';\n\nexport interface GitLocation {\n\tpath: string;\n\tversion: string;\n}\n\nfunction parseVersion(raw: string): string {\n\treturn raw.replace(/^git version /, '');\n}\n\nasync function findSpecificGit(path: string): Promise<GitLocation> {\n\tlet version = await run<string>(path, ['--version'], 'utf8');\n\t// If needed, let's update our path to avoid the search on every command\n\tif (!path || path === 'git') {\n\t\tconst foundPath = findExecutable(path, ['--version']).cmd;\n\n\t\t// Ensure that the path we found works\n\t\tversion = await run<string>(foundPath, ['--version'], 'utf8');\n\t\tpath = foundPath;\n\t}\n\n\treturn {\n\t\tpath: path,\n\t\tversion: parseVersion(version.trim())\n\t};\n}\n\nasync function findGitDarwin(): Promise<GitLocation> {\n\ttry {\n\t\tlet path = await run<string>('which', ['git'], 'utf8');\n\t\tpath = path.replace(/^\\s+|\\s+$/g, '');\n\n\t\tif (path !== '/usr/bin/git') {\n\t\t\treturn findSpecificGit(path);\n\t\t}\n\n\t\ttry {\n\t\t\tawait run<string>('xcode-select', ['-p'], 'utf8');\n\t\t\treturn findSpecificGit(path);\n\t\t} catch (ex) {\n\t\t\tif (ex.code === 2) {\n\t\t\t\treturn Promise.reject(new Error('Unable to find git'));\n\t\t\t}\n\t\t\treturn findSpecificGit(path);\n\t\t}\n\t} catch (ex) {\n\t\treturn Promise.reject(new Error('Unable to find git'));\n\t}\n}\n\nfunction findSystemGitWin32(basePath: string | null | undefined): Promise<GitLocation> {\n\tif (basePath == null || basePath.length === 0) return Promise.reject(new Error('Unable to find git'));\n\treturn findSpecificGit(paths.join(basePath, 'Git', 'cmd', 'git.exe'));\n}\n\nfunction findGitWin32(): Promise<GitLocation> {\n\treturn findSystemGitWin32(process.env['ProgramW6432'])\n\t\t.then(null, () => findSystemGitWin32(process.env['ProgramFiles(x86)']))\n\t\t.then(null, () => findSystemGitWin32(process.env['ProgramFiles']))\n\t\t.then(null, () => findSpecificGit('git'));\n}\n\nexport async function findGitPath(path?: string): Promise<GitLocation> {\n\ttry {\n\t\treturn await findSpecificGit(path || 'git');\n\t} catch (ex) {\n\t\ttry {\n\t\t\tswitch (process.platform) {\n\t\t\t\tcase 'darwin':\n\t\t\t\t\treturn await findGitDarwin();\n\t\t\t\tcase 'win32':\n\t\t\t\t\treturn await findGitWin32();\n\t\t\t\tdefault:\n\t\t\t\t\treturn Promise.reject('Unable to find git');\n\t\t\t}\n\t\t} catch (ex) {\n\t\t\treturn Promise.reject(new Error('Unable to find git'));\n\t\t}\n\t}\n}\n","module.exports = require(\"child_process\");","'use strict';\nimport { commands, ExtensionContext, extensions, window, workspace } from 'vscode';\nimport { Commands, registerCommands } from './commands';\nimport { ViewShowBranchComparison } from './config';\nimport { configuration, Configuration } from './configuration';\nimport { CommandContext, extensionQualifiedId, GlobalState, GlyphChars, setCommandContext } from './constants';\nimport { Container } from './container';\nimport { GitCommit, GitService, GitUri } from './git/gitService';\nimport { Logger } from './logger';\nimport { Messages } from './messages';\nimport { Strings, Versions } from './system';\n// import { Telemetry } from './telemetry';\n\nexport async function activate(context: ExtensionContext) {\n\tconst start = process.hrtime();\n\n\t// Pretend we are enabled (until we know otherwise) and set the view contexts to reduce flashing on load\n\tsetCommandContext(CommandContext.Enabled, true);\n\n\tLogger.configure(context, configuration.get('outputLevel'), o => {\n\t\tif (GitUri.is(o)) {\n\t\t\treturn `GitUri(${o.toString(true)}${o.repoPath ? ` repoPath=${o.repoPath}` : ''}${\n\t\t\t\to.sha ? ` sha=${o.sha}` : ''\n\t\t\t})`;\n\t\t}\n\n\t\tif (GitCommit.is(o)) {\n\t\t\treturn `GitCommit(${o.sha ? ` sha=${o.sha}` : ''}${o.repoPath ? ` repoPath=${o.repoPath}` : ''})`;\n\t\t}\n\n\t\treturn undefined;\n\t});\n\n\tconst gitlens = extensions.getExtension(extensionQualifiedId)!;\n\tconst gitlensVersion = gitlens.packageJSON.version;\n\n\tconst enabled = workspace.getConfiguration('git', null).get<boolean>('enabled', true);\n\tif (!enabled) {\n\t\tLogger.log(`GitLens (v${gitlensVersion}) was NOT activated -- \"git.enabled\": false`);\n\t\tsetCommandContext(CommandContext.Enabled, false);\n\n\t\tvoid Messages.showGitDisabledErrorMessage();\n\n\t\treturn;\n\t}\n\n\tConfiguration.configure(context);\n\n\tconst cfg = configuration.get();\n\n\tconst previousVersion = context.globalState.get<string>(GlobalState.GitLensVersion);\n\tawait migrateSettings(context, previousVersion);\n\n\ttry {\n\t\tawait GitService.initialize();\n\t} catch (ex) {\n\t\tLogger.error(ex, `GitLens (v${gitlensVersion}) activate`);\n\t\tsetCommandContext(CommandContext.Enabled, false);\n\n\t\tif (ex.message.includes('Unable to find git')) {\n\t\t\tawait window.showErrorMessage(\n\t\t\t\t\"GitLens was unable to find Git. Please make sure Git is installed. Also ensure that Git is either in the PATH, or that 'git.path' is pointed to its installed location.\"\n\t\t\t);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tContainer.initialize(context, cfg);\n\n\tregisterCommands(context);\n\n\tconst gitVersion = GitService.getGitVersion();\n\n\t// Telemetry.configure(ApplicationInsightsKey);\n\n\t// const telemetryContext: { [id: string]: any } = Object.create(null);\n\t// telemetryContext.version = gitlensVersion;\n\t// telemetryContext['git.version'] = gitVersion;\n\t// Telemetry.setContext(telemetryContext);\n\n\tnotifyOnUnsupportedGitVersion(gitVersion);\n\tvoid showWelcomeOrWhatsNew(gitlensVersion, previousVersion);\n\n\tcontext.globalState.update(GlobalState.GitLensVersion, gitlensVersion);\n\n\t// Constantly over my data cap so stop collecting initialized event\n\t// Telemetry.trackEvent('initialized', Objects.flatten(cfg, 'config', true));\n\n\tLogger.log(\n\t\t`GitLens (v${gitlensVersion}${cfg.mode.active ? `, mode: ${cfg.mode.active}` : ''}) activated ${\n\t\t\tGlyphChars.Dot\n\t\t} ${Strings.getDurationMilliseconds(start)} ms`\n\t);\n}\n\nexport function deactivate() {\n\t// nothing to do\n}\n\nasync function migrateSettings(context: ExtensionContext, previousVersion: string | undefined) {\n\tif (previousVersion === undefined) return;\n\n\tconst previous = Versions.fromString(previousVersion);\n\n\ttry {\n\t\tif (Versions.compare(previous, Versions.from(9, 8, 5)) !== 1) {\n\t\t\tconst value = configuration.get('views', 'commitFormat');\n\t\t\tif (!/\\btips\\b/.test(value)) {\n\t\t\t\tawait configuration.updateEffective('views', 'commitFormat', `\\${ tips   }${value}`);\n\t\t\t}\n\t\t} else if (Versions.compare(previous, Versions.from(9, 8, 2)) !== 1) {\n\t\t\tconst name = configuration.name('views', 'repositories', 'showBranchComparison');\n\t\t\tawait configuration.migrate(name, 'views', 'repositories', 'showBranchComparison', {\n\t\t\t\tmigrationFn: (v: boolean) => (v === false ? false : ViewShowBranchComparison.Working)\n\t\t\t});\n\t\t} else if (Versions.compare(previous, Versions.from(9, 6, 3)) !== 1) {\n\t\t\tconst formatMigrationFn = (v: string) => {\n\t\t\t\tif (v == null || v.length === 0) return v;\n\n\t\t\t\treturn (\n\t\t\t\t\tv\n\t\t\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\t\t\t.replace(/\\$\\{authorAgo\\}/g, '${author}, ${ago}')\n\t\t\t\t\t\t// eslint-disable-next-line no-template-curly-in-string\n\t\t\t\t\t\t.replace(/\\$\\{authorAgoOrDate\\}/g, '${author}, ${agoOrDate}')\n\t\t\t\t);\n\t\t\t};\n\n\t\t\tawait Promise.all(\n\t\t\t\t[\n\t\t\t\t\tconfiguration.name('blame', 'format'),\n\t\t\t\t\tconfiguration.name('currentLine', 'format'),\n\t\t\t\t\tconfiguration.name('hovers', 'detailsMarkdownFormat'),\n\t\t\t\t\tconfiguration.name('statusBar', 'format'),\n\t\t\t\t\tconfiguration.name('views', 'commitFormat'),\n\t\t\t\t\tconfiguration.name('views', 'commitDescriptionFormat'),\n\t\t\t\t\tconfiguration.name('views', 'stashFormat'),\n\t\t\t\t\tconfiguration.name('views', 'stashDescriptionFormat')\n\t\t\t\t].map(s =>\n\t\t\t\t\tconfiguration.migrate(s, s as any, {\n\t\t\t\t\t\tmigrationFn: formatMigrationFn\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t} catch (ex) {\n\t\tLogger.error(ex, 'migrateSettings');\n\t}\n}\n\nfunction notifyOnUnsupportedGitVersion(version: string) {\n\tif (GitService.compareGitVersion('2.2.0') !== -1) return;\n\n\t// If git is less than v2.2.0\n\tvoid Messages.showGitVersionUnsupportedErrorMessage(version);\n}\n\nasync function showWelcomeOrWhatsNew(version: string, previousVersion: string | undefined) {\n\tif (previousVersion === undefined) {\n\t\tLogger.log('GitLens first-time install');\n\t\tawait commands.executeCommand(Commands.ShowWelcomePage);\n\n\t\treturn;\n\t}\n\n\tif (previousVersion !== version) {\n\t\tLogger.log(`GitLens upgraded from v${previousVersion} to v${version}`);\n\t}\n\n\tconst [major, minor] = version.split('.').map(v => parseInt(v, 10));\n\tconst [prevMajor, prevMinor] = previousVersion.split('.').map(v => parseInt(v, 10));\n\tif (\n\t\t(major === prevMajor && minor === prevMinor) ||\n\t\t// Don't notify on downgrades\n\t\t(major < prevMajor || (major === prevMajor && minor < prevMinor))\n\t) {\n\t\treturn;\n\t}\n\n\t// Show the Welcome for v10 since its all new\n\tif (major !== prevMajor && major === 10) {\n\t\tawait commands.executeCommand(Commands.ShowWelcomePage);\n\t}\n\n\tif (Container.config.showWhatsNewAfterUpgrades && major !== prevMajor) {\n\t\tawait Messages.showWhatsNewMessage(version);\n\t}\n}\n","\"use strict\";\n\nvar BOMChar = '\\uFEFF';\n\nexports.PrependBOM = PrependBOMWrapper\nfunction PrependBOMWrapper(encoder, options) {\n    this.encoder = encoder;\n    this.addBOM = true;\n}\n\nPrependBOMWrapper.prototype.write = function(str) {\n    if (this.addBOM) {\n        str = BOMChar + str;\n        this.addBOM = false;\n    }\n\n    return this.encoder.write(str);\n}\n\nPrependBOMWrapper.prototype.end = function() {\n    return this.encoder.end();\n}\n\n\n//------------------------------------------------------------------------------\n\nexports.StripBOM = StripBOMWrapper;\nfunction StripBOMWrapper(decoder, options) {\n    this.decoder = decoder;\n    this.pass = false;\n    this.options = options || {};\n}\n\nStripBOMWrapper.prototype.write = function(buf) {\n    var res = this.decoder.write(buf);\n    if (this.pass || !res)\n        return res;\n\n    if (res[0] === BOMChar) {\n        res = res.slice(1);\n        if (typeof this.options.stripBOM === 'function')\n            this.options.stripBOM();\n    }\n\n    this.pass = true;\n    return res;\n}\n\nStripBOMWrapper.prototype.end = function() {\n    return this.decoder.end();\n}\n\n","\"use strict\";\n\n// Update this array if you add/rename/remove files in this directory.\n// We support Browserify by skipping automatic module discovery and requiring modules directly.\nvar modules = [\n    require(\"./internal\"),\n    require(\"./utf32\"),\n    require(\"./utf16\"),\n    require(\"./utf7\"),\n    require(\"./sbcs-codec\"),\n    require(\"./sbcs-data\"),\n    require(\"./sbcs-data-generated\"),\n    require(\"./dbcs-codec\"),\n    require(\"./dbcs-data\"),\n];\n\n// Put all encoding/alias/codec definitions to single object and export it.\nfor (var i = 0; i < modules.length; i++) {\n    var module = modules[i];\n    for (var enc in module)\n        if (Object.prototype.hasOwnProperty.call(module, enc))\n            exports[enc] = module[enc];\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Export Node.js internal encodings.\n\nmodule.exports = {\n    // Encodings\n    utf8:   { type: \"_internal\", bomAware: true},\n    cesu8:  { type: \"_internal\", bomAware: true},\n    unicode11utf8: \"utf8\",\n\n    ucs2:   { type: \"_internal\", bomAware: true},\n    utf16le: \"ucs2\",\n\n    binary: { type: \"_internal\" },\n    base64: { type: \"_internal\" },\n    hex:    { type: \"_internal\" },\n\n    // Codec.\n    _internal: InternalCodec,\n};\n\n//------------------------------------------------------------------------------\n\nfunction InternalCodec(codecOptions, iconv) {\n    this.enc = codecOptions.encodingName;\n    this.bomAware = codecOptions.bomAware;\n\n    if (this.enc === \"base64\")\n        this.encoder = InternalEncoderBase64;\n    else if (this.enc === \"cesu8\") {\n        this.enc = \"utf8\"; // Use utf8 for decoding.\n        this.encoder = InternalEncoderCesu8;\n\n        // Add decoder for versions of Node not supporting CESU-8\n        if (Buffer.from('eda0bdedb2a9', 'hex').toString() !== '') {\n            this.decoder = InternalDecoderCesu8;\n            this.defaultCharUnicode = iconv.defaultCharUnicode;\n        }\n    }\n}\n\nInternalCodec.prototype.encoder = InternalEncoder;\nInternalCodec.prototype.decoder = InternalDecoder;\n\n//------------------------------------------------------------------------------\n\n// We use node.js internal decoder. Its signature is the same as ours.\nvar StringDecoder = require('string_decoder').StringDecoder;\n\nif (!StringDecoder.prototype.end) // Node v0.8 doesn't have this method.\n    StringDecoder.prototype.end = function() {};\n\n\nfunction InternalDecoder(options, codec) {\n    StringDecoder.call(this, codec.enc);\n}\n\nInternalDecoder.prototype = StringDecoder.prototype;\n\n\n//------------------------------------------------------------------------------\n// Encoder is mostly trivial\n\nfunction InternalEncoder(options, codec) {\n    this.enc = codec.enc;\n}\n\nInternalEncoder.prototype.write = function(str) {\n    return Buffer.from(str, this.enc);\n}\n\nInternalEncoder.prototype.end = function() {\n}\n\n\n//------------------------------------------------------------------------------\n// Except base64 encoder, which must keep its state.\n\nfunction InternalEncoderBase64(options, codec) {\n    this.prevStr = '';\n}\n\nInternalEncoderBase64.prototype.write = function(str) {\n    str = this.prevStr + str;\n    var completeQuads = str.length - (str.length % 4);\n    this.prevStr = str.slice(completeQuads);\n    str = str.slice(0, completeQuads);\n\n    return Buffer.from(str, \"base64\");\n}\n\nInternalEncoderBase64.prototype.end = function() {\n    return Buffer.from(this.prevStr, \"base64\");\n}\n\n\n//------------------------------------------------------------------------------\n// CESU-8 encoder is also special.\n\nfunction InternalEncoderCesu8(options, codec) {\n}\n\nInternalEncoderCesu8.prototype.write = function(str) {\n    var buf = Buffer.alloc(str.length * 3), bufIdx = 0;\n    for (var i = 0; i < str.length; i++) {\n        var charCode = str.charCodeAt(i);\n        // Naive implementation, but it works because CESU-8 is especially easy\n        // to convert from UTF-16 (which all JS strings are encoded in).\n        if (charCode < 0x80)\n            buf[bufIdx++] = charCode;\n        else if (charCode < 0x800) {\n            buf[bufIdx++] = 0xC0 + (charCode >>> 6);\n            buf[bufIdx++] = 0x80 + (charCode & 0x3f);\n        }\n        else { // charCode will always be < 0x10000 in javascript.\n            buf[bufIdx++] = 0xE0 + (charCode >>> 12);\n            buf[bufIdx++] = 0x80 + ((charCode >>> 6) & 0x3f);\n            buf[bufIdx++] = 0x80 + (charCode & 0x3f);\n        }\n    }\n    return buf.slice(0, bufIdx);\n}\n\nInternalEncoderCesu8.prototype.end = function() {\n}\n\n//------------------------------------------------------------------------------\n// CESU-8 decoder is not implemented in Node v4.0+\n\nfunction InternalDecoderCesu8(options, codec) {\n    this.acc = 0;\n    this.contBytes = 0;\n    this.accBytes = 0;\n    this.defaultCharUnicode = codec.defaultCharUnicode;\n}\n\nInternalDecoderCesu8.prototype.write = function(buf) {\n    var acc = this.acc, contBytes = this.contBytes, accBytes = this.accBytes, \n        res = '';\n    for (var i = 0; i < buf.length; i++) {\n        var curByte = buf[i];\n        if ((curByte & 0xC0) !== 0x80) { // Leading byte\n            if (contBytes > 0) { // Previous code is invalid\n                res += this.defaultCharUnicode;\n                contBytes = 0;\n            }\n\n            if (curByte < 0x80) { // Single-byte code\n                res += String.fromCharCode(curByte);\n            } else if (curByte < 0xE0) { // Two-byte code\n                acc = curByte & 0x1F;\n                contBytes = 1; accBytes = 1;\n            } else if (curByte < 0xF0) { // Three-byte code\n                acc = curByte & 0x0F;\n                contBytes = 2; accBytes = 1;\n            } else { // Four or more are not supported for CESU-8.\n                res += this.defaultCharUnicode;\n            }\n        } else { // Continuation byte\n            if (contBytes > 0) { // We're waiting for it.\n                acc = (acc << 6) | (curByte & 0x3f);\n                contBytes--; accBytes++;\n                if (contBytes === 0) {\n                    // Check for overlong encoding, but support Modified UTF-8 (encoding NULL as C0 80)\n                    if (accBytes === 2 && acc < 0x80 && acc > 0)\n                        res += this.defaultCharUnicode;\n                    else if (accBytes === 3 && acc < 0x800)\n                        res += this.defaultCharUnicode;\n                    else\n                        // Actually add character.\n                        res += String.fromCharCode(acc);\n                }\n            } else { // Unexpected continuation byte\n                res += this.defaultCharUnicode;\n            }\n        }\n    }\n    this.acc = acc; this.contBytes = contBytes; this.accBytes = accBytes;\n    return res;\n}\n\nInternalDecoderCesu8.prototype.end = function() {\n    var res = 0;\n    if (this.contBytes > 0)\n        res += this.defaultCharUnicode;\n    return res;\n}\n","module.exports = require(\"string_decoder\");","'use strict';\n\nvar Buffer = require('safer-buffer').Buffer;\n\n// == UTF32-LE/BE codec. ==========================================================\n\nexports._utf32 = Utf32Codec;\n\nfunction Utf32Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n    this.bomAware = true;\n    this.isLE = codecOptions.isLE;\n}\n\nexports.utf32le = { type: '_utf32', isLE: true };\nexports.utf32be = { type: '_utf32', isLE: false };\n\n// Aliases\nexports.ucs4le = 'utf32le';\nexports.ucs4be = 'utf32be';\n\nUtf32Codec.prototype.encoder = Utf32Encoder;\nUtf32Codec.prototype.decoder = Utf32Decoder;\n\n// -- Encoding\n\nfunction Utf32Encoder(options, codec) {\n    this.isLE = codec.isLE;\n    this.highSurrogate = 0;\n}\n\nUtf32Encoder.prototype.write = function(str) {\n    var src = Buffer.from(str, 'ucs2');\n    var dst = Buffer.alloc(src.length * 2);\n    var write32 = this.isLE ? dst.writeUInt32LE : dst.writeUInt32BE;\n    var offset = 0;\n\n    for (var i = 0; i < src.length; i += 2) {\n        var code = src.readUInt16LE(i);\n        var isHighSurrogate = (0xD800 <= code && code < 0xDC00);\n        var isLowSurrogate = (0xDC00 <= code && code < 0xE000);\n\n        if (this.highSurrogate) {\n            if (isHighSurrogate || !isLowSurrogate) {\n                // There shouldn't be two high surrogates in a row, nor a high surrogate which isn't followed by a low\n                // surrogate. If this happens, keep the pending high surrogate as a stand-alone semi-invalid character\n                // (technically wrong, but expected by some applications, like Windows file names).\n                write32.call(dst, this.highSurrogate, offset);\n                offset += 4;\n            }\n            else {\n                // Create 32-bit value from high and low surrogates;\n                var codepoint = (((this.highSurrogate - 0xD800) << 10) | (code - 0xDC00)) + 0x10000;\n\n                write32.call(dst, codepoint, offset);\n                offset += 4;\n                this.highSurrogate = 0;\n\n                continue;\n            }\n        }\n\n        if (isHighSurrogate)\n            this.highSurrogate = code;\n        else {\n            // Even if the current character is a low surrogate, with no previous high surrogate, we'll\n            // encode it as a semi-invalid stand-alone character for the same reasons expressed above for\n            // unpaired high surrogates.\n            write32.call(dst, code, offset);\n            offset += 4;\n            this.highSurrogate = 0;\n        }\n    }\n\n    if (offset < dst.length)\n        dst = dst.slice(0, offset);\n\n    return dst;\n};\n\nUtf32Encoder.prototype.end = function() {\n    // Treat any leftover high surrogate as a semi-valid independent character.\n    if (!this.highSurrogate)\n        return;\n\n    var buf = Buffer.alloc(4);\n\n    if (this.isLE)\n        buf.writeUInt32LE(this.highSurrogate, 0);\n    else\n        buf.writeUInt32BE(this.highSurrogate, 0);\n\n    this.highSurrogate = 0;\n\n    return buf;\n};\n\n// -- Decoding\n\nfunction Utf32Decoder(options, codec) {\n    this.isLE = codec.isLE;\n    this.badChar = codec.iconv.defaultCharUnicode.charCodeAt(0);\n    this.overflow = null;\n}\n\nUtf32Decoder.prototype.write = function(src) {\n    if (src.length === 0)\n        return '';\n\n    if (this.overflow)\n        src = Buffer.concat([this.overflow, src]);\n\n    var goodLength = src.length - src.length % 4;\n\n    if (src.length !== goodLength) {\n        this.overflow = src.slice(goodLength);\n        src = src.slice(0, goodLength);\n    }\n    else\n        this.overflow = null;\n\n    var dst = Buffer.alloc(goodLength);\n    var offset = 0;\n\n    for (var i = 0; i < goodLength; i += 4) {\n        var codepoint = this.isLE ? src.readUInt32LE(i) : src.readUInt32BE(i);\n\n        if (codepoint < 0x10000) {\n            // Simple 16-bit character\n            dst.writeUInt16LE(codepoint, offset);\n            offset += 2;\n        }\n        else {\n            if (codepoint > 0x10FFFF) {\n                // Not a valid Unicode codepoint\n                dst.writeUInt16LE(this.badChar, offset);\n                offset += 2;\n            }\n            else {\n                // Create high and low surrogates.\n                codepoint -= 0x10000;\n                var high = 0xD800 | (codepoint >> 10);\n                var low = 0xDC00 + (codepoint & 0x3FF);\n                dst.writeUInt16LE(high, offset);\n                offset += 2;\n                dst.writeUInt16LE(low, offset);\n                offset += 2;\n            }\n        }\n    }\n\n    return dst.slice(0, offset).toString('ucs2');\n};\n\nUtf32Decoder.prototype.end = function() {\n    this.overflow = null;\n};\n\n// == UTF-32 Auto codec =============================================================\n// Decoder chooses automatically from UTF-32LE and UTF-32BE using BOM and space-based heuristic.\n// Defaults to UTF-32LE. http://en.wikipedia.org/wiki/UTF-32\n// Encoder/decoder default can be changed: iconv.decode(buf, 'utf32', {defaultEncoding: 'utf-32be'});\n\n// Encoder prepends BOM (which can be overridden with (addBOM: false}).\n\nexports.utf32 = Utf32AutoCodec;\nexports.ucs4 = Utf32AutoCodec;\n\nfunction Utf32AutoCodec(options, iconv) {\n    this.iconv = iconv;\n}\n\nUtf32AutoCodec.prototype.encoder = Utf32AutoEncoder;\nUtf32AutoCodec.prototype.decoder = Utf32AutoDecoder;\n\n// -- Encoding\n\nfunction Utf32AutoEncoder(options, codec) {\n    options = options || {};\n\n    if (options.addBOM === undefined)\n        options.addBOM = true;\n\n    this.encoder = codec.iconv.getEncoder(options.defaultEncoding || 'utf-32le', options);\n}\n\nUtf32AutoEncoder.prototype.write = function(str) {\n    return this.encoder.write(str);\n};\n\nUtf32AutoEncoder.prototype.end = function() {\n    return this.encoder.end();\n};\n\n// -- Decoding\n\nfunction Utf32AutoDecoder(options, codec) {\n    this.decoder = null;\n    this.initialBytes = [];\n    this.initialBytesLen = 0;\n    this.options = options || {};\n    this.iconv = codec.iconv;\n}\n\nUtf32AutoDecoder.prototype.write = function(buf) {\n    if (!this.decoder) {\n        // Codec is not chosen yet. Accumulate initial bytes.\n        this.initialBytes.push(buf);\n        this.initialBytesLen += buf.length;\n\n        if (this.initialBytesLen < 32) // We need more bytes to use space heuristic (see below)\n            return '';\n\n        // We have enough bytes -> detect endianness.\n        var buf2 = Buffer.concat(this.initialBytes),\n            encoding = detectEncoding(buf2, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n        this.initialBytes.length = this.initialBytesLen = 0;\n    }\n\n    return this.decoder.write(buf);\n};\n\nUtf32AutoDecoder.prototype.end = function() {\n    if (!this.decoder) {\n        var buf = Buffer.concat(this.initialBytes),\n            encoding = detectEncoding(buf, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var res = this.decoder.write(buf),\n            trail = this.decoder.end();\n\n        return trail ? (res + trail) : res;\n    }\n\n    return this.decoder.end();\n};\n\nfunction detectEncoding(buf, defaultEncoding) {\n    var enc = defaultEncoding || 'utf-32le';\n\n    if (buf.length >= 4) {\n        // Check BOM.\n        if (buf.readUInt32BE(0) === 0xFEFF) // UTF-32LE BOM\n            enc = 'utf-32be';\n        else if (buf.readUInt32LE(0) === 0xFEFF) // UTF-32LE BOM\n            enc = 'utf-32le';\n        else {\n            // No BOM found. Try to deduce encoding from initial content.\n            // Using the wrong endian-ism for UTF-32 will very often result in codepoints that are beyond\n            // the valid Unicode limit of 0x10FFFF. That will be used as the primary determinant.\n            //\n            // Further, we can suppose the content is mostly plain ASCII chars (U+00**).\n            // So, we count ASCII as if it was LE or BE, and decide from that.\n            var invalidLE = 0, invalidBE = 0;\n            var asciiCharsLE = 0, asciiCharsBE = 0, // Counts of chars in both positions\n                _len = Math.min(buf.length - (buf.length % 4), 128); // Len is always even.\n\n            for (var i = 0; i < _len; i += 4) {\n                var b0 = buf[i], b1  = buf[i + 1], b2 = buf[i + 2], b3 = buf[i + 3];\n\n                if (b0 !== 0 || b1 > 0x10) ++invalidBE;\n                if (b3 !== 0 || b2 > 0x10) ++invalidLE;\n\n                if (b0 === 0 && b1 === 0 && b2 === 0 && b3 !== 0) asciiCharsBE++;\n                if (b0 !== 0 && b1 === 0 && b2 === 0 && b3 === 0) asciiCharsLE++;\n            }\n\n            if (invalidBE < invalidLE)\n                enc = 'utf-32be';\n            else if (invalidLE < invalidBE)\n                enc = 'utf-32le';\n            if (asciiCharsBE > asciiCharsLE)\n                enc = 'utf-32be';\n            else if (asciiCharsBE < asciiCharsLE)\n                enc = 'utf-32le';\n        }\n    }\n\n    return enc;\n}\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Note: UTF16-LE (or UCS2) codec is Node.js native. See encodings/internal.js\n\n// == UTF16-BE codec. ==========================================================\n\nexports.utf16be = Utf16BECodec;\nfunction Utf16BECodec() {\n}\n\nUtf16BECodec.prototype.encoder = Utf16BEEncoder;\nUtf16BECodec.prototype.decoder = Utf16BEDecoder;\nUtf16BECodec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nfunction Utf16BEEncoder() {\n}\n\nUtf16BEEncoder.prototype.write = function(str) {\n    var buf = Buffer.from(str, 'ucs2');\n    for (var i = 0; i < buf.length; i += 2) {\n        var tmp = buf[i]; buf[i] = buf[i+1]; buf[i+1] = tmp;\n    }\n    return buf;\n}\n\nUtf16BEEncoder.prototype.end = function() {\n}\n\n\n// -- Decoding\n\nfunction Utf16BEDecoder() {\n    this.overflowByte = -1;\n}\n\nUtf16BEDecoder.prototype.write = function(buf) {\n    if (buf.length == 0)\n        return '';\n\n    var buf2 = Buffer.alloc(buf.length + 1),\n        i = 0, j = 0;\n\n    if (this.overflowByte !== -1) {\n        buf2[0] = buf[0];\n        buf2[1] = this.overflowByte;\n        i = 1; j = 2;\n    }\n\n    for (; i < buf.length-1; i += 2, j+= 2) {\n        buf2[j] = buf[i+1];\n        buf2[j+1] = buf[i];\n    }\n\n    this.overflowByte = (i == buf.length-1) ? buf[buf.length-1] : -1;\n\n    return buf2.slice(0, j).toString('ucs2');\n}\n\nUtf16BEDecoder.prototype.end = function() {\n}\n\n\n// == UTF-16 codec =============================================================\n// Decoder chooses automatically from UTF-16LE and UTF-16BE using BOM and space-based heuristic.\n// Defaults to UTF-16LE, as it's prevalent and default in Node.\n// http://en.wikipedia.org/wiki/UTF-16 and http://encoding.spec.whatwg.org/#utf-16le\n// Decoder default can be changed: iconv.decode(buf, 'utf16', {defaultEncoding: 'utf-16be'});\n\n// Encoder uses UTF-16LE and prepends BOM (which can be overridden with addBOM: false).\n\nexports.utf16 = Utf16Codec;\nfunction Utf16Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n}\n\nUtf16Codec.prototype.encoder = Utf16Encoder;\nUtf16Codec.prototype.decoder = Utf16Decoder;\n\n\n// -- Encoding (pass-through)\n\nfunction Utf16Encoder(options, codec) {\n    options = options || {};\n    if (options.addBOM === undefined)\n        options.addBOM = true;\n    this.encoder = codec.iconv.getEncoder('utf-16le', options);\n}\n\nUtf16Encoder.prototype.write = function(str) {\n    return this.encoder.write(str);\n}\n\nUtf16Encoder.prototype.end = function() {\n    return this.encoder.end();\n}\n\n\n// -- Decoding\n\nfunction Utf16Decoder(options, codec) {\n    this.decoder = null;\n    this.initialBytes = [];\n    this.initialBytesLen = 0;\n\n    this.options = options || {};\n    this.iconv = codec.iconv;\n}\n\nUtf16Decoder.prototype.write = function(buf) {\n    if (!this.decoder) {\n        // Codec is not chosen yet. Accumulate initial bytes.\n        this.initialBytes.push(buf);\n        this.initialBytesLen += buf.length;\n        \n        if (this.initialBytesLen < 16) // We need more bytes to use space heuristic (see below)\n            return '';\n\n        // We have enough bytes -> detect endianness.\n        var buf = Buffer.concat(this.initialBytes),\n            encoding = detectEncoding(buf, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n        this.initialBytes.length = this.initialBytesLen = 0;\n    }\n\n    return this.decoder.write(buf);\n}\n\nUtf16Decoder.prototype.end = function() {\n    if (!this.decoder) {\n        var buf = Buffer.concat(this.initialBytes),\n            encoding = detectEncoding(buf, this.options.defaultEncoding);\n        this.decoder = this.iconv.getDecoder(encoding, this.options);\n\n        var res = this.decoder.write(buf),\n            trail = this.decoder.end();\n\n        return trail ? (res + trail) : res;\n    }\n    return this.decoder.end();\n}\n\nfunction detectEncoding(buf, defaultEncoding) {\n    var enc = defaultEncoding || 'utf-16le';\n\n    if (buf.length >= 2) {\n        // Check BOM.\n        if (buf[0] == 0xFE && buf[1] == 0xFF) // UTF-16BE BOM\n            enc = 'utf-16be';\n        else if (buf[0] == 0xFF && buf[1] == 0xFE) // UTF-16LE BOM\n            enc = 'utf-16le';\n        else {\n            // No BOM found. Try to deduce encoding from initial content.\n            // Most of the time, the content has ASCII chars (U+00**), but the opposite (U+**00) is uncommon.\n            // So, we count ASCII as if it was LE or BE, and decide from that.\n            var asciiCharsLE = 0, asciiCharsBE = 0, // Counts of chars in both positions\n                _len = Math.min(buf.length - (buf.length % 2), 64); // Len is always even.\n\n            for (var i = 0; i < _len; i += 2) {\n                if (buf[i] === 0 && buf[i+1] !== 0) asciiCharsBE++;\n                if (buf[i] !== 0 && buf[i+1] === 0) asciiCharsLE++;\n            }\n\n            if (asciiCharsBE > asciiCharsLE)\n                enc = 'utf-16be';\n            else if (asciiCharsBE < asciiCharsLE)\n                enc = 'utf-16le';\n        }\n    }\n\n    return enc;\n}\n\n\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// UTF-7 codec, according to https://tools.ietf.org/html/rfc2152\n// See also below a UTF-7-IMAP codec, according to http://tools.ietf.org/html/rfc3501#section-5.1.3\n\nexports.utf7 = Utf7Codec;\nexports.unicode11utf7 = 'utf7'; // Alias UNICODE-1-1-UTF-7\nfunction Utf7Codec(codecOptions, iconv) {\n    this.iconv = iconv;\n};\n\nUtf7Codec.prototype.encoder = Utf7Encoder;\nUtf7Codec.prototype.decoder = Utf7Decoder;\nUtf7Codec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nvar nonDirectChars = /[^A-Za-z0-9'\\(\\),-\\.\\/:\\? \\n\\r\\t]+/g;\n\nfunction Utf7Encoder(options, codec) {\n    this.iconv = codec.iconv;\n}\n\nUtf7Encoder.prototype.write = function(str) {\n    // Naive implementation.\n    // Non-direct chars are encoded as \"+<base64>-\"; single \"+\" char is encoded as \"+-\".\n    return Buffer.from(str.replace(nonDirectChars, function(chunk) {\n        return \"+\" + (chunk === '+' ? '' : \n            this.iconv.encode(chunk, 'utf16-be').toString('base64').replace(/=+$/, '')) \n            + \"-\";\n    }.bind(this)));\n}\n\nUtf7Encoder.prototype.end = function() {\n}\n\n\n// -- Decoding\n\nfunction Utf7Decoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = '';\n}\n\nvar base64Regex = /[A-Za-z0-9\\/+]/;\nvar base64Chars = [];\nfor (var i = 0; i < 256; i++)\n    base64Chars[i] = base64Regex.test(String.fromCharCode(i));\n\nvar plusChar = '+'.charCodeAt(0), \n    minusChar = '-'.charCodeAt(0),\n    andChar = '&'.charCodeAt(0);\n\nUtf7Decoder.prototype.write = function(buf) {\n    var res = \"\", lastI = 0,\n        inBase64 = this.inBase64,\n        base64Accum = this.base64Accum;\n\n    // The decoder is more involved as we must handle chunks in stream.\n\n    for (var i = 0; i < buf.length; i++) {\n        if (!inBase64) { // We're in direct mode.\n            // Write direct chars until '+'\n            if (buf[i] == plusChar) {\n                res += this.iconv.decode(buf.slice(lastI, i), \"ascii\"); // Write direct chars.\n                lastI = i+1;\n                inBase64 = true;\n            }\n        } else { // We decode base64.\n            if (!base64Chars[buf[i]]) { // Base64 ended.\n                if (i == lastI && buf[i] == minusChar) {// \"+-\" -> \"+\"\n                    res += \"+\";\n                } else {\n                    var b64str = base64Accum + buf.slice(lastI, i).toString();\n                    res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n                }\n\n                if (buf[i] != minusChar) // Minus is absorbed after base64.\n                    i--;\n\n                lastI = i+1;\n                inBase64 = false;\n                base64Accum = '';\n            }\n        }\n    }\n\n    if (!inBase64) {\n        res += this.iconv.decode(buf.slice(lastI), \"ascii\"); // Write direct chars.\n    } else {\n        var b64str = base64Accum + buf.slice(lastI).toString();\n\n        var canBeDecoded = b64str.length - (b64str.length % 8); // Minimal chunk: 2 quads -> 2x3 bytes -> 3 chars.\n        base64Accum = b64str.slice(canBeDecoded); // The rest will be decoded in future.\n        b64str = b64str.slice(0, canBeDecoded);\n\n        res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n    }\n\n    this.inBase64 = inBase64;\n    this.base64Accum = base64Accum;\n\n    return res;\n}\n\nUtf7Decoder.prototype.end = function() {\n    var res = \"\";\n    if (this.inBase64 && this.base64Accum.length > 0)\n        res = this.iconv.decode(Buffer.from(this.base64Accum, 'base64'), \"utf16-be\");\n\n    this.inBase64 = false;\n    this.base64Accum = '';\n    return res;\n}\n\n\n// UTF-7-IMAP codec.\n// RFC3501 Sec. 5.1.3 Modified UTF-7 (http://tools.ietf.org/html/rfc3501#section-5.1.3)\n// Differences:\n//  * Base64 part is started by \"&\" instead of \"+\"\n//  * Direct characters are 0x20-0x7E, except \"&\" (0x26)\n//  * In Base64, \",\" is used instead of \"/\"\n//  * Base64 must not be used to represent direct characters.\n//  * No implicit shift back from Base64 (should always end with '-')\n//  * String must end in non-shifted position.\n//  * \"-&\" while in base64 is not allowed.\n\n\nexports.utf7imap = Utf7IMAPCodec;\nfunction Utf7IMAPCodec(codecOptions, iconv) {\n    this.iconv = iconv;\n};\n\nUtf7IMAPCodec.prototype.encoder = Utf7IMAPEncoder;\nUtf7IMAPCodec.prototype.decoder = Utf7IMAPDecoder;\nUtf7IMAPCodec.prototype.bomAware = true;\n\n\n// -- Encoding\n\nfunction Utf7IMAPEncoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = Buffer.alloc(6);\n    this.base64AccumIdx = 0;\n}\n\nUtf7IMAPEncoder.prototype.write = function(str) {\n    var inBase64 = this.inBase64,\n        base64Accum = this.base64Accum,\n        base64AccumIdx = this.base64AccumIdx,\n        buf = Buffer.alloc(str.length*5 + 10), bufIdx = 0;\n\n    for (var i = 0; i < str.length; i++) {\n        var uChar = str.charCodeAt(i);\n        if (0x20 <= uChar && uChar <= 0x7E) { // Direct character or '&'.\n            if (inBase64) {\n                if (base64AccumIdx > 0) {\n                    bufIdx += buf.write(base64Accum.slice(0, base64AccumIdx).toString('base64').replace(/\\//g, ',').replace(/=+$/, ''), bufIdx);\n                    base64AccumIdx = 0;\n                }\n\n                buf[bufIdx++] = minusChar; // Write '-', then go to direct mode.\n                inBase64 = false;\n            }\n\n            if (!inBase64) {\n                buf[bufIdx++] = uChar; // Write direct character\n\n                if (uChar === andChar)  // Ampersand -> '&-'\n                    buf[bufIdx++] = minusChar;\n            }\n\n        } else { // Non-direct character\n            if (!inBase64) {\n                buf[bufIdx++] = andChar; // Write '&', then go to base64 mode.\n                inBase64 = true;\n            }\n            if (inBase64) {\n                base64Accum[base64AccumIdx++] = uChar >> 8;\n                base64Accum[base64AccumIdx++] = uChar & 0xFF;\n\n                if (base64AccumIdx == base64Accum.length) {\n                    bufIdx += buf.write(base64Accum.toString('base64').replace(/\\//g, ','), bufIdx);\n                    base64AccumIdx = 0;\n                }\n            }\n        }\n    }\n\n    this.inBase64 = inBase64;\n    this.base64AccumIdx = base64AccumIdx;\n\n    return buf.slice(0, bufIdx);\n}\n\nUtf7IMAPEncoder.prototype.end = function() {\n    var buf = Buffer.alloc(10), bufIdx = 0;\n    if (this.inBase64) {\n        if (this.base64AccumIdx > 0) {\n            bufIdx += buf.write(this.base64Accum.slice(0, this.base64AccumIdx).toString('base64').replace(/\\//g, ',').replace(/=+$/, ''), bufIdx);\n            this.base64AccumIdx = 0;\n        }\n\n        buf[bufIdx++] = minusChar; // Write '-', then go to direct mode.\n        this.inBase64 = false;\n    }\n\n    return buf.slice(0, bufIdx);\n}\n\n\n// -- Decoding\n\nfunction Utf7IMAPDecoder(options, codec) {\n    this.iconv = codec.iconv;\n    this.inBase64 = false;\n    this.base64Accum = '';\n}\n\nvar base64IMAPChars = base64Chars.slice();\nbase64IMAPChars[','.charCodeAt(0)] = true;\n\nUtf7IMAPDecoder.prototype.write = function(buf) {\n    var res = \"\", lastI = 0,\n        inBase64 = this.inBase64,\n        base64Accum = this.base64Accum;\n\n    // The decoder is more involved as we must handle chunks in stream.\n    // It is forgiving, closer to standard UTF-7 (for example, '-' is optional at the end).\n\n    for (var i = 0; i < buf.length; i++) {\n        if (!inBase64) { // We're in direct mode.\n            // Write direct chars until '&'\n            if (buf[i] == andChar) {\n                res += this.iconv.decode(buf.slice(lastI, i), \"ascii\"); // Write direct chars.\n                lastI = i+1;\n                inBase64 = true;\n            }\n        } else { // We decode base64.\n            if (!base64IMAPChars[buf[i]]) { // Base64 ended.\n                if (i == lastI && buf[i] == minusChar) { // \"&-\" -> \"&\"\n                    res += \"&\";\n                } else {\n                    var b64str = base64Accum + buf.slice(lastI, i).toString().replace(/,/g, '/');\n                    res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n                }\n\n                if (buf[i] != minusChar) // Minus may be absorbed after base64.\n                    i--;\n\n                lastI = i+1;\n                inBase64 = false;\n                base64Accum = '';\n            }\n        }\n    }\n\n    if (!inBase64) {\n        res += this.iconv.decode(buf.slice(lastI), \"ascii\"); // Write direct chars.\n    } else {\n        var b64str = base64Accum + buf.slice(lastI).toString().replace(/,/g, '/');\n\n        var canBeDecoded = b64str.length - (b64str.length % 8); // Minimal chunk: 2 quads -> 2x3 bytes -> 3 chars.\n        base64Accum = b64str.slice(canBeDecoded); // The rest will be decoded in future.\n        b64str = b64str.slice(0, canBeDecoded);\n\n        res += this.iconv.decode(Buffer.from(b64str, 'base64'), \"utf16-be\");\n    }\n\n    this.inBase64 = inBase64;\n    this.base64Accum = base64Accum;\n\n    return res;\n}\n\nUtf7IMAPDecoder.prototype.end = function() {\n    var res = \"\";\n    if (this.inBase64 && this.base64Accum.length > 0)\n        res = this.iconv.decode(Buffer.from(this.base64Accum, 'base64'), \"utf16-be\");\n\n    this.inBase64 = false;\n    this.base64Accum = '';\n    return res;\n}\n\n\n","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Single-byte codec. Needs a 'chars' string parameter that contains 256 or 128 chars that\n// correspond to encoded bytes (if 128 - then lower half is ASCII). \n\nexports._sbcs = SBCSCodec;\nfunction SBCSCodec(codecOptions, iconv) {\n    if (!codecOptions)\n        throw new Error(\"SBCS codec is called without the data.\")\n    \n    // Prepare char buffer for decoding.\n    if (!codecOptions.chars || (codecOptions.chars.length !== 128 && codecOptions.chars.length !== 256))\n        throw new Error(\"Encoding '\"+codecOptions.type+\"' has incorrect 'chars' (must be of len 128 or 256)\");\n    \n    if (codecOptions.chars.length === 128) {\n        var asciiString = \"\";\n        for (var i = 0; i < 128; i++)\n            asciiString += String.fromCharCode(i);\n        codecOptions.chars = asciiString + codecOptions.chars;\n    }\n\n    this.decodeBuf = Buffer.from(codecOptions.chars, 'ucs2');\n    \n    // Encoding buffer.\n    var encodeBuf = Buffer.alloc(65536, iconv.defaultCharSingleByte.charCodeAt(0));\n\n    for (var i = 0; i < codecOptions.chars.length; i++)\n        encodeBuf[codecOptions.chars.charCodeAt(i)] = i;\n\n    this.encodeBuf = encodeBuf;\n}\n\nSBCSCodec.prototype.encoder = SBCSEncoder;\nSBCSCodec.prototype.decoder = SBCSDecoder;\n\n\nfunction SBCSEncoder(options, codec) {\n    this.encodeBuf = codec.encodeBuf;\n}\n\nSBCSEncoder.prototype.write = function(str) {\n    var buf = Buffer.alloc(str.length);\n    for (var i = 0; i < str.length; i++)\n        buf[i] = this.encodeBuf[str.charCodeAt(i)];\n    \n    return buf;\n}\n\nSBCSEncoder.prototype.end = function() {\n}\n\n\nfunction SBCSDecoder(options, codec) {\n    this.decodeBuf = codec.decodeBuf;\n}\n\nSBCSDecoder.prototype.write = function(buf) {\n    // Strings are immutable in JS -> we use ucs2 buffer to speed up computations.\n    var decodeBuf = this.decodeBuf;\n    var newBuf = Buffer.alloc(buf.length*2);\n    var idx1 = 0, idx2 = 0;\n    for (var i = 0; i < buf.length; i++) {\n        idx1 = buf[i]*2; idx2 = i*2;\n        newBuf[idx2] = decodeBuf[idx1];\n        newBuf[idx2+1] = decodeBuf[idx1+1];\n    }\n    return newBuf.toString('ucs2');\n}\n\nSBCSDecoder.prototype.end = function() {\n}\n","\"use strict\";\n\n// Manually added data to be used by sbcs codec in addition to generated one.\n\nmodule.exports = {\n    // Not supported by iconv, not sure why.\n    \"10029\": \"maccenteuro\",\n    \"maccenteuro\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    \"808\": \"cp808\",\n    \"ibm808\": \"cp808\",\n    \"cp808\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    \"mik\": {\n        \"type\": \"_sbcs\",\n        \"chars\": \"\"\n    },\n\n    // Aliases of generated encodings.\n    \"ascii8bit\": \"ascii\",\n    \"usascii\": \"ascii\",\n    \"ansix34\": \"ascii\",\n    \"ansix341968\": \"ascii\",\n    \"ansix341986\": \"ascii\",\n    \"csascii\": \"ascii\",\n    \"cp367\": \"ascii\",\n    \"ibm367\": \"ascii\",\n    \"isoir6\": \"ascii\",\n    \"iso646us\": \"ascii\",\n    \"iso646irv\": \"ascii\",\n    \"us\": \"ascii\",\n\n    \"latin1\": \"iso88591\",\n    \"latin2\": \"iso88592\",\n    \"latin3\": \"iso88593\",\n    \"latin4\": \"iso88594\",\n    \"latin5\": \"iso88599\",\n    \"latin6\": \"iso885910\",\n    \"latin7\": \"iso885913\",\n    \"latin8\": \"iso885914\",\n    \"latin9\": \"iso885915\",\n    \"latin10\": \"iso885916\",\n\n    \"csisolatin1\": \"iso88591\",\n    \"csisolatin2\": \"iso88592\",\n    \"csisolatin3\": \"iso88593\",\n    \"csisolatin4\": \"iso88594\",\n    \"csisolatincyrillic\": \"iso88595\",\n    \"csisolatinarabic\": \"iso88596\",\n    \"csisolatingreek\" : \"iso88597\",\n    \"csisolatinhebrew\": \"iso88598\",\n    \"csisolatin5\": \"iso88599\",\n    \"csisolatin6\": \"iso885910\",\n\n    \"l1\": \"iso88591\",\n    \"l2\": \"iso88592\",\n    \"l3\": \"iso88593\",\n    \"l4\": \"iso88594\",\n    \"l5\": \"iso88599\",\n    \"l6\": \"iso885910\",\n    \"l7\": \"iso885913\",\n    \"l8\": \"iso885914\",\n    \"l9\": \"iso885915\",\n    \"l10\": \"iso885916\",\n\n    \"isoir14\": \"iso646jp\",\n    \"isoir57\": \"iso646cn\",\n    \"isoir100\": \"iso88591\",\n    \"isoir101\": \"iso88592\",\n    \"isoir109\": \"iso88593\",\n    \"isoir110\": \"iso88594\",\n    \"isoir144\": \"iso88595\",\n    \"isoir127\": \"iso88596\",\n    \"isoir126\": \"iso88597\",\n    \"isoir138\": \"iso88598\",\n    \"isoir148\": \"iso88599\",\n    \"isoir157\": \"iso885910\",\n    \"isoir166\": \"tis620\",\n    \"isoir179\": \"iso885913\",\n    \"isoir199\": \"iso885914\",\n    \"isoir203\": \"iso885915\",\n    \"isoir226\": \"iso885916\",\n\n    \"cp819\": \"iso88591\",\n    \"ibm819\": \"iso88591\",\n\n    \"cyrillic\": \"iso88595\",\n\n    \"arabic\": \"iso88596\",\n    \"arabic8\": \"iso88596\",\n    \"ecma114\": \"iso88596\",\n    \"asmo708\": \"iso88596\",\n\n    \"greek\" : \"iso88597\",\n    \"greek8\" : \"iso88597\",\n    \"ecma118\" : \"iso88597\",\n    \"elot928\" : \"iso88597\",\n\n    \"hebrew\": \"iso88598\",\n    \"hebrew8\": \"iso88598\",\n\n    \"turkish\": \"iso88599\",\n    \"turkish8\": \"iso88599\",\n\n    \"thai\": \"iso885911\",\n    \"thai8\": \"iso885911\",\n\n    \"celtic\": \"iso885914\",\n    \"celtic8\": \"iso885914\",\n    \"isoceltic\": \"iso885914\",\n\n    \"tis6200\": \"tis620\",\n    \"tis62025291\": \"tis620\",\n    \"tis62025330\": \"tis620\",\n\n    \"10000\": \"macroman\",\n    \"10006\": \"macgreek\",\n    \"10007\": \"maccyrillic\",\n    \"10079\": \"maciceland\",\n    \"10081\": \"macturkish\",\n\n    \"cspc8codepage437\": \"cp437\",\n    \"cspc775baltic\": \"cp775\",\n    \"cspc850multilingual\": \"cp850\",\n    \"cspcp852\": \"cp852\",\n    \"cspc862latinhebrew\": \"cp862\",\n    \"cpgr\": \"cp869\",\n\n    \"msee\": \"cp1250\",\n    \"mscyrl\": \"cp1251\",\n    \"msansi\": \"cp1252\",\n    \"msgreek\": \"cp1253\",\n    \"msturk\": \"cp1254\",\n    \"mshebr\": \"cp1255\",\n    \"msarab\": \"cp1256\",\n    \"winbaltrim\": \"cp1257\",\n\n    \"cp20866\": \"koi8r\",\n    \"20866\": \"koi8r\",\n    \"ibm878\": \"koi8r\",\n    \"cskoi8r\": \"koi8r\",\n\n    \"cp21866\": \"koi8u\",\n    \"21866\": \"koi8u\",\n    \"ibm1168\": \"koi8u\",\n\n    \"strk10482002\": \"rk1048\",\n\n    \"tcvn5712\": \"tcvn\",\n    \"tcvn57121\": \"tcvn\",\n\n    \"gb198880\": \"iso646cn\",\n    \"cn\": \"iso646cn\",\n\n    \"csiso14jisc6220ro\": \"iso646jp\",\n    \"jisc62201969ro\": \"iso646jp\",\n    \"jp\": \"iso646jp\",\n\n    \"cshproman8\": \"hproman8\",\n    \"r8\": \"hproman8\",\n    \"roman8\": \"hproman8\",\n    \"xroman8\": \"hproman8\",\n    \"ibm1051\": \"hproman8\",\n\n    \"mac\": \"macintosh\",\n    \"csmacintosh\": \"macintosh\",\n};\n\n","\"use strict\";\n\n// Generated data for sbcs codec. Don't edit manually. Regenerate using generation/gen-sbcs.js script.\nmodule.exports = {\n  \"437\": \"cp437\",\n  \"737\": \"cp737\",\n  \"775\": \"cp775\",\n  \"850\": \"cp850\",\n  \"852\": \"cp852\",\n  \"855\": \"cp855\",\n  \"856\": \"cp856\",\n  \"857\": \"cp857\",\n  \"858\": \"cp858\",\n  \"860\": \"cp860\",\n  \"861\": \"cp861\",\n  \"862\": \"cp862\",\n  \"863\": \"cp863\",\n  \"864\": \"cp864\",\n  \"865\": \"cp865\",\n  \"866\": \"cp866\",\n  \"869\": \"cp869\",\n  \"874\": \"windows874\",\n  \"922\": \"cp922\",\n  \"1046\": \"cp1046\",\n  \"1124\": \"cp1124\",\n  \"1125\": \"cp1125\",\n  \"1129\": \"cp1129\",\n  \"1133\": \"cp1133\",\n  \"1161\": \"cp1161\",\n  \"1162\": \"cp1162\",\n  \"1163\": \"cp1163\",\n  \"1250\": \"windows1250\",\n  \"1251\": \"windows1251\",\n  \"1252\": \"windows1252\",\n  \"1253\": \"windows1253\",\n  \"1254\": \"windows1254\",\n  \"1255\": \"windows1255\",\n  \"1256\": \"windows1256\",\n  \"1257\": \"windows1257\",\n  \"1258\": \"windows1258\",\n  \"28591\": \"iso88591\",\n  \"28592\": \"iso88592\",\n  \"28593\": \"iso88593\",\n  \"28594\": \"iso88594\",\n  \"28595\": \"iso88595\",\n  \"28596\": \"iso88596\",\n  \"28597\": \"iso88597\",\n  \"28598\": \"iso88598\",\n  \"28599\": \"iso88599\",\n  \"28600\": \"iso885910\",\n  \"28601\": \"iso885911\",\n  \"28603\": \"iso885913\",\n  \"28604\": \"iso885914\",\n  \"28605\": \"iso885915\",\n  \"28606\": \"iso885916\",\n  \"windows874\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win874\": \"windows874\",\n  \"cp874\": \"windows874\",\n  \"windows1250\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1250\": \"windows1250\",\n  \"cp1250\": \"windows1250\",\n  \"windows1251\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1251\": \"windows1251\",\n  \"cp1251\": \"windows1251\",\n  \"windows1252\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1252\": \"windows1252\",\n  \"cp1252\": \"windows1252\",\n  \"windows1253\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1253\": \"windows1253\",\n  \"cp1253\": \"windows1253\",\n  \"windows1254\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1254\": \"windows1254\",\n  \"cp1254\": \"windows1254\",\n  \"windows1255\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1255\": \"windows1255\",\n  \"cp1255\": \"windows1255\",\n  \"windows1256\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1256\": \"windows1256\",\n  \"cp1256\": \"windows1256\",\n  \"windows1257\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1257\": \"windows1257\",\n  \"cp1257\": \"windows1257\",\n  \"windows1258\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"win1258\": \"windows1258\",\n  \"cp1258\": \"windows1258\",\n  \"iso88591\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28591\": \"iso88591\",\n  \"iso88592\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28592\": \"iso88592\",\n  \"iso88593\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28593\": \"iso88593\",\n  \"iso88594\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28594\": \"iso88594\",\n  \"iso88595\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28595\": \"iso88595\",\n  \"iso88596\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28596\": \"iso88596\",\n  \"iso88597\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28597\": \"iso88597\",\n  \"iso88598\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28598\": \"iso88598\",\n  \"iso88599\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28599\": \"iso88599\",\n  \"iso885910\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28600\": \"iso885910\",\n  \"iso885911\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28601\": \"iso885911\",\n  \"iso885913\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28603\": \"iso885913\",\n  \"iso885914\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28604\": \"iso885914\",\n  \"iso885915\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28605\": \"iso885915\",\n  \"iso885916\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"cp28606\": \"iso885916\",\n  \"cp437\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm437\": \"cp437\",\n  \"csibm437\": \"cp437\",\n  \"cp737\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm737\": \"cp737\",\n  \"csibm737\": \"cp737\",\n  \"cp775\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm775\": \"cp775\",\n  \"csibm775\": \"cp775\",\n  \"cp850\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm850\": \"cp850\",\n  \"csibm850\": \"cp850\",\n  \"cp852\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm852\": \"cp852\",\n  \"csibm852\": \"cp852\",\n  \"cp855\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm855\": \"cp855\",\n  \"csibm855\": \"cp855\",\n  \"cp856\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm856\": \"cp856\",\n  \"csibm856\": \"cp856\",\n  \"cp857\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm857\": \"cp857\",\n  \"csibm857\": \"cp857\",\n  \"cp858\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm858\": \"cp858\",\n  \"csibm858\": \"cp858\",\n  \"cp860\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm860\": \"cp860\",\n  \"csibm860\": \"cp860\",\n  \"cp861\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm861\": \"cp861\",\n  \"csibm861\": \"cp861\",\n  \"cp862\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm862\": \"cp862\",\n  \"csibm862\": \"cp862\",\n  \"cp863\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm863\": \"cp863\",\n  \"csibm863\": \"cp863\",\n  \"cp864\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"ibm864\": \"cp864\",\n  \"csibm864\": \"cp864\",\n  \"cp865\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm865\": \"cp865\",\n  \"csibm865\": \"cp865\",\n  \"cp866\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm866\": \"cp866\",\n  \"csibm866\": \"cp866\",\n  \"cp869\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm869\": \"cp869\",\n  \"csibm869\": \"cp869\",\n  \"cp922\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm922\": \"cp922\",\n  \"csibm922\": \"cp922\",\n  \"cp1046\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1046\": \"cp1046\",\n  \"csibm1046\": \"cp1046\",\n  \"cp1124\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1124\": \"cp1124\",\n  \"csibm1124\": \"cp1124\",\n  \"cp1125\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1125\": \"cp1125\",\n  \"csibm1125\": \"cp1125\",\n  \"cp1129\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1129\": \"cp1129\",\n  \"csibm1129\": \"cp1129\",\n  \"cp1133\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1133\": \"cp1133\",\n  \"csibm1133\": \"cp1133\",\n  \"cp1161\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1161\": \"cp1161\",\n  \"csibm1161\": \"cp1161\",\n  \"cp1162\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1162\": \"cp1162\",\n  \"csibm1162\": \"cp1162\",\n  \"cp1163\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ibm1163\": \"cp1163\",\n  \"csibm1163\": \"cp1163\",\n  \"maccroatian\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"maccyrillic\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macgreek\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"maciceland\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macroman\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macromania\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macthai\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macturkish\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macukraine\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8r\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8u\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8ru\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"koi8t\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"armscii8\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \")(.,-\"\n  },\n  \"rk1048\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"tcvn\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0003\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"georgianacademy\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"georgianps\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"pt154\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"viscii\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0003\\u0004\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0015\\u0016\\u0017\\u0018\\u001a\\u001b\\u001c\\u001d\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\"\n  },\n  \"iso646cn\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}\"\n  },\n  \"iso646jp\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\b\\t\\n\\u000b\\f\\r\\u000e\\u000f\\u0010\\u0011\\u0012\\u0013\\u0014\\u0015\\u0016\\u0017\\u0018\\u0019\\u001a\\u001b\\u001c\\u001d\\u001e\\u001f !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}\"\n  },\n  \"hproman8\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"macintosh\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"ascii\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  },\n  \"tis620\": {\n    \"type\": \"_sbcs\",\n    \"chars\": \"\"\n  }\n}","\"use strict\";\nvar Buffer = require(\"safer-buffer\").Buffer;\n\n// Multibyte codec. In this scheme, a character is represented by 1 or more bytes.\n// Our codec supports UTF-16 surrogates, extensions for GB18030 and unicode sequences.\n// To save memory and loading time, we read table files only when requested.\n\nexports._dbcs = DBCSCodec;\n\nvar UNASSIGNED = -1,\n    GB18030_CODE = -2,\n    SEQ_START  = -10,\n    NODE_START = -1000,\n    UNASSIGNED_NODE = new Array(0x100),\n    DEF_CHAR = -1;\n\nfor (var i = 0; i < 0x100; i++)\n    UNASSIGNED_NODE[i] = UNASSIGNED;\n\n\n// Class DBCSCodec reads and initializes mapping tables.\nfunction DBCSCodec(codecOptions, iconv) {\n    this.encodingName = codecOptions.encodingName;\n    if (!codecOptions)\n        throw new Error(\"DBCS codec is called without the data.\")\n    if (!codecOptions.table)\n        throw new Error(\"Encoding '\" + this.encodingName + \"' has no data.\");\n\n    // Load tables.\n    var mappingTable = codecOptions.table();\n\n\n    // Decode tables: MBCS -> Unicode.\n\n    // decodeTables is a trie, encoded as an array of arrays of integers. Internal arrays are trie nodes and all have len = 256.\n    // Trie root is decodeTables[0].\n    // Values: >=  0 -> unicode character code. can be > 0xFFFF\n    //         == UNASSIGNED -> unknown/unassigned sequence.\n    //         == GB18030_CODE -> this is the end of a GB18030 4-byte sequence.\n    //         <= NODE_START -> index of the next node in our trie to process next byte.\n    //         <= SEQ_START  -> index of the start of a character code sequence, in decodeTableSeq.\n    this.decodeTables = [];\n    this.decodeTables[0] = UNASSIGNED_NODE.slice(0); // Create root node.\n\n    // Sometimes a MBCS char corresponds to a sequence of unicode chars. We store them as arrays of integers here. \n    this.decodeTableSeq = [];\n\n    // Actual mapping tables consist of chunks. Use them to fill up decode tables.\n    for (var i = 0; i < mappingTable.length; i++)\n        this._addDecodeChunk(mappingTable[i]);\n\n    this.defaultCharUnicode = iconv.defaultCharUnicode;\n\n    \n    // Encode tables: Unicode -> DBCS.\n\n    // `encodeTable` is array mapping from unicode char to encoded char. All its values are integers for performance.\n    // Because it can be sparse, it is represented as array of buckets by 256 chars each. Bucket can be null.\n    // Values: >=  0 -> it is a normal char. Write the value (if <=256 then 1 byte, if <=65536 then 2 bytes, etc.).\n    //         == UNASSIGNED -> no conversion found. Output a default char.\n    //         <= SEQ_START  -> it's an index in encodeTableSeq, see below. The character starts a sequence.\n    this.encodeTable = [];\n    \n    // `encodeTableSeq` is used when a sequence of unicode characters is encoded as a single code. We use a tree of\n    // objects where keys correspond to characters in sequence and leafs are the encoded dbcs values. A special DEF_CHAR key\n    // means end of sequence (needed when one sequence is a strict subsequence of another).\n    // Objects are kept separately from encodeTable to increase performance.\n    this.encodeTableSeq = [];\n\n    // Some chars can be decoded, but need not be encoded.\n    var skipEncodeChars = {};\n    if (codecOptions.encodeSkipVals)\n        for (var i = 0; i < codecOptions.encodeSkipVals.length; i++) {\n            var val = codecOptions.encodeSkipVals[i];\n            if (typeof val === 'number')\n                skipEncodeChars[val] = true;\n            else\n                for (var j = val.from; j <= val.to; j++)\n                    skipEncodeChars[j] = true;\n        }\n        \n    // Use decode trie to recursively fill out encode tables.\n    this._fillEncodeTable(0, 0, skipEncodeChars);\n\n    // Add more encoding pairs when needed.\n    if (codecOptions.encodeAdd) {\n        for (var uChar in codecOptions.encodeAdd)\n            if (Object.prototype.hasOwnProperty.call(codecOptions.encodeAdd, uChar))\n                this._setEncodeChar(uChar.charCodeAt(0), codecOptions.encodeAdd[uChar]);\n    }\n\n    this.defCharSB  = this.encodeTable[0][iconv.defaultCharSingleByte.charCodeAt(0)];\n    if (this.defCharSB === UNASSIGNED) this.defCharSB = this.encodeTable[0]['?'];\n    if (this.defCharSB === UNASSIGNED) this.defCharSB = \"?\".charCodeAt(0);\n\n\n    // Load & create GB18030 tables when needed.\n    if (typeof codecOptions.gb18030 === 'function') {\n        this.gb18030 = codecOptions.gb18030(); // Load GB18030 ranges.\n\n        // Add GB18030 decode tables.\n        var thirdByteNodeIdx = this.decodeTables.length;\n        var thirdByteNode = this.decodeTables[thirdByteNodeIdx] = UNASSIGNED_NODE.slice(0);\n\n        var fourthByteNodeIdx = this.decodeTables.length;\n        var fourthByteNode = this.decodeTables[fourthByteNodeIdx] = UNASSIGNED_NODE.slice(0);\n\n        for (var i = 0x81; i <= 0xFE; i++) {\n            var secondByteNodeIdx = NODE_START - this.decodeTables[0][i];\n            var secondByteNode = this.decodeTables[secondByteNodeIdx];\n            for (var j = 0x30; j <= 0x39; j++)\n                secondByteNode[j] = NODE_START - thirdByteNodeIdx;\n        }\n        for (var i = 0x81; i <= 0xFE; i++)\n            thirdByteNode[i] = NODE_START - fourthByteNodeIdx;\n        for (var i = 0x30; i <= 0x39; i++)\n            fourthByteNode[i] = GB18030_CODE\n    }        \n}\n\nDBCSCodec.prototype.encoder = DBCSEncoder;\nDBCSCodec.prototype.decoder = DBCSDecoder;\n\n// Decoder helpers\nDBCSCodec.prototype._getDecodeTrieNode = function(addr) {\n    var bytes = [];\n    for (; addr > 0; addr >>= 8)\n        bytes.push(addr & 0xFF);\n    if (bytes.length == 0)\n        bytes.push(0);\n\n    var node = this.decodeTables[0];\n    for (var i = bytes.length-1; i > 0; i--) { // Traverse nodes deeper into the trie.\n        var val = node[bytes[i]];\n\n        if (val == UNASSIGNED) { // Create new node.\n            node[bytes[i]] = NODE_START - this.decodeTables.length;\n            this.decodeTables.push(node = UNASSIGNED_NODE.slice(0));\n        }\n        else if (val <= NODE_START) { // Existing node.\n            node = this.decodeTables[NODE_START - val];\n        }\n        else\n            throw new Error(\"Overwrite byte in \" + this.encodingName + \", addr: \" + addr.toString(16));\n    }\n    return node;\n}\n\n\nDBCSCodec.prototype._addDecodeChunk = function(chunk) {\n    // First element of chunk is the hex mbcs code where we start.\n    var curAddr = parseInt(chunk[0], 16);\n\n    // Choose the decoding node where we'll write our chars.\n    var writeTable = this._getDecodeTrieNode(curAddr);\n    curAddr = curAddr & 0xFF;\n\n    // Write all other elements of the chunk to the table.\n    for (var k = 1; k < chunk.length; k++) {\n        var part = chunk[k];\n        if (typeof part === \"string\") { // String, write as-is.\n            for (var l = 0; l < part.length;) {\n                var code = part.charCodeAt(l++);\n                if (0xD800 <= code && code < 0xDC00) { // Decode surrogate\n                    var codeTrail = part.charCodeAt(l++);\n                    if (0xDC00 <= codeTrail && codeTrail < 0xE000)\n                        writeTable[curAddr++] = 0x10000 + (code - 0xD800) * 0x400 + (codeTrail - 0xDC00);\n                    else\n                        throw new Error(\"Incorrect surrogate pair in \"  + this.encodingName + \" at chunk \" + chunk[0]);\n                }\n                else if (0x0FF0 < code && code <= 0x0FFF) { // Character sequence (our own encoding used)\n                    var len = 0xFFF - code + 2;\n                    var seq = [];\n                    for (var m = 0; m < len; m++)\n                        seq.push(part.charCodeAt(l++)); // Simple variation: don't support surrogates or subsequences in seq.\n\n                    writeTable[curAddr++] = SEQ_START - this.decodeTableSeq.length;\n                    this.decodeTableSeq.push(seq);\n                }\n                else\n                    writeTable[curAddr++] = code; // Basic char\n            }\n        } \n        else if (typeof part === \"number\") { // Integer, meaning increasing sequence starting with prev character.\n            var charCode = writeTable[curAddr - 1] + 1;\n            for (var l = 0; l < part; l++)\n                writeTable[curAddr++] = charCode++;\n        }\n        else\n            throw new Error(\"Incorrect type '\" + typeof part + \"' given in \"  + this.encodingName + \" at chunk \" + chunk[0]);\n    }\n    if (curAddr > 0xFF)\n        throw new Error(\"Incorrect chunk in \"  + this.encodingName + \" at addr \" + chunk[0] + \": too long\" + curAddr);\n}\n\n// Encoder helpers\nDBCSCodec.prototype._getEncodeBucket = function(uCode) {\n    var high = uCode >> 8; // This could be > 0xFF because of astral characters.\n    if (this.encodeTable[high] === undefined)\n        this.encodeTable[high] = UNASSIGNED_NODE.slice(0); // Create bucket on demand.\n    return this.encodeTable[high];\n}\n\nDBCSCodec.prototype._setEncodeChar = function(uCode, dbcsCode) {\n    var bucket = this._getEncodeBucket(uCode);\n    var low = uCode & 0xFF;\n    if (bucket[low] <= SEQ_START)\n        this.encodeTableSeq[SEQ_START-bucket[low]][DEF_CHAR] = dbcsCode; // There's already a sequence, set a single-char subsequence of it.\n    else if (bucket[low] == UNASSIGNED)\n        bucket[low] = dbcsCode;\n}\n\nDBCSCodec.prototype._setEncodeSequence = function(seq, dbcsCode) {\n    \n    // Get the root of character tree according to first character of the sequence.\n    var uCode = seq[0];\n    var bucket = this._getEncodeBucket(uCode);\n    var low = uCode & 0xFF;\n\n    var node;\n    if (bucket[low] <= SEQ_START) {\n        // There's already a sequence with  - use it.\n        node = this.encodeTableSeq[SEQ_START-bucket[low]];\n    }\n    else {\n        // There was no sequence object - allocate a new one.\n        node = {};\n        if (bucket[low] !== UNASSIGNED) node[DEF_CHAR] = bucket[low]; // If a char was set before - make it a single-char subsequence.\n        bucket[low] = SEQ_START - this.encodeTableSeq.length;\n        this.encodeTableSeq.push(node);\n    }\n\n    // Traverse the character tree, allocating new nodes as needed.\n    for (var j = 1; j < seq.length-1; j++) {\n        var oldVal = node[uCode];\n        if (typeof oldVal === 'object')\n            node = oldVal;\n        else {\n            node = node[uCode] = {}\n            if (oldVal !== undefined)\n                node[DEF_CHAR] = oldVal\n        }\n    }\n\n    // Set the leaf to given dbcsCode.\n    uCode = seq[seq.length-1];\n    node[uCode] = dbcsCode;\n}\n\nDBCSCodec.prototype._fillEncodeTable = function(nodeIdx, prefix, skipEncodeChars) {\n    var node = this.decodeTables[nodeIdx];\n    for (var i = 0; i < 0x100; i++) {\n        var uCode = node[i];\n        var mbCode = prefix + i;\n        if (skipEncodeChars[mbCode])\n            continue;\n\n        if (uCode >= 0)\n            this._setEncodeChar(uCode, mbCode);\n        else if (uCode <= NODE_START)\n            this._fillEncodeTable(NODE_START - uCode, mbCode << 8, skipEncodeChars);\n        else if (uCode <= SEQ_START)\n            this._setEncodeSequence(this.decodeTableSeq[SEQ_START - uCode], mbCode);\n    }\n}\n\n\n\n// == Encoder ==================================================================\n\nfunction DBCSEncoder(options, codec) {\n    // Encoder state\n    this.leadSurrogate = -1;\n    this.seqObj = undefined;\n    \n    // Static data\n    this.encodeTable = codec.encodeTable;\n    this.encodeTableSeq = codec.encodeTableSeq;\n    this.defaultCharSingleByte = codec.defCharSB;\n    this.gb18030 = codec.gb18030;\n}\n\nDBCSEncoder.prototype.write = function(str) {\n    var newBuf = Buffer.alloc(str.length * (this.gb18030 ? 4 : 3)),\n        leadSurrogate = this.leadSurrogate,\n        seqObj = this.seqObj, nextChar = -1,\n        i = 0, j = 0;\n\n    while (true) {\n        // 0. Get next character.\n        if (nextChar === -1) {\n            if (i == str.length) break;\n            var uCode = str.charCodeAt(i++);\n        }\n        else {\n            var uCode = nextChar;\n            nextChar = -1;    \n        }\n\n        // 1. Handle surrogates.\n        if (0xD800 <= uCode && uCode < 0xE000) { // Char is one of surrogates.\n            if (uCode < 0xDC00) { // We've got lead surrogate.\n                if (leadSurrogate === -1) {\n                    leadSurrogate = uCode;\n                    continue;\n                } else {\n                    leadSurrogate = uCode;\n                    // Double lead surrogate found.\n                    uCode = UNASSIGNED;\n                }\n            } else { // We've got trail surrogate.\n                if (leadSurrogate !== -1) {\n                    uCode = 0x10000 + (leadSurrogate - 0xD800) * 0x400 + (uCode - 0xDC00);\n                    leadSurrogate = -1;\n                } else {\n                    // Incomplete surrogate pair - only trail surrogate found.\n                    uCode = UNASSIGNED;\n                }\n                \n            }\n        }\n        else if (leadSurrogate !== -1) {\n            // Incomplete surrogate pair - only lead surrogate found.\n            nextChar = uCode; uCode = UNASSIGNED; // Write an error, then current char.\n            leadSurrogate = -1;\n        }\n\n        // 2. Convert uCode character.\n        var dbcsCode = UNASSIGNED;\n        if (seqObj !== undefined && uCode != UNASSIGNED) { // We are in the middle of the sequence\n            var resCode = seqObj[uCode];\n            if (typeof resCode === 'object') { // Sequence continues.\n                seqObj = resCode;\n                continue;\n\n            } else if (typeof resCode == 'number') { // Sequence finished. Write it.\n                dbcsCode = resCode;\n\n            } else if (resCode == undefined) { // Current character is not part of the sequence.\n\n                // Try default character for this sequence\n                resCode = seqObj[DEF_CHAR];\n                if (resCode !== undefined) {\n                    dbcsCode = resCode; // Found. Write it.\n                    nextChar = uCode; // Current character will be written too in the next iteration.\n\n                } else {\n                    // TODO: What if we have no default? (resCode == undefined)\n                    // Then, we should write first char of the sequence as-is and try the rest recursively.\n                    // Didn't do it for now because no encoding has this situation yet.\n                    // Currently, just skip the sequence and write current char.\n                }\n            }\n            seqObj = undefined;\n        }\n        else if (uCode >= 0) {  // Regular character\n            var subtable = this.encodeTable[uCode >> 8];\n            if (subtable !== undefined)\n                dbcsCode = subtable[uCode & 0xFF];\n            \n            if (dbcsCode <= SEQ_START) { // Sequence start\n                seqObj = this.encodeTableSeq[SEQ_START-dbcsCode];\n                continue;\n            }\n\n            if (dbcsCode == UNASSIGNED && this.gb18030) {\n                // Use GB18030 algorithm to find character(s) to write.\n                var idx = findIdx(this.gb18030.uChars, uCode);\n                if (idx != -1) {\n                    var dbcsCode = this.gb18030.gbChars[idx] + (uCode - this.gb18030.uChars[idx]);\n                    newBuf[j++] = 0x81 + Math.floor(dbcsCode / 12600); dbcsCode = dbcsCode % 12600;\n                    newBuf[j++] = 0x30 + Math.floor(dbcsCode / 1260); dbcsCode = dbcsCode % 1260;\n                    newBuf[j++] = 0x81 + Math.floor(dbcsCode / 10); dbcsCode = dbcsCode % 10;\n                    newBuf[j++] = 0x30 + dbcsCode;\n                    continue;\n                }\n            }\n        }\n\n        // 3. Write dbcsCode character.\n        if (dbcsCode === UNASSIGNED)\n            dbcsCode = this.defaultCharSingleByte;\n        \n        if (dbcsCode < 0x100) {\n            newBuf[j++] = dbcsCode;\n        }\n        else if (dbcsCode < 0x10000) {\n            newBuf[j++] = dbcsCode >> 8;   // high byte\n            newBuf[j++] = dbcsCode & 0xFF; // low byte\n        }\n        else {\n            newBuf[j++] = dbcsCode >> 16;\n            newBuf[j++] = (dbcsCode >> 8) & 0xFF;\n            newBuf[j++] = dbcsCode & 0xFF;\n        }\n    }\n\n    this.seqObj = seqObj;\n    this.leadSurrogate = leadSurrogate;\n    return newBuf.slice(0, j);\n}\n\nDBCSEncoder.prototype.end = function() {\n    if (this.leadSurrogate === -1 && this.seqObj === undefined)\n        return; // All clean. Most often case.\n\n    var newBuf = Buffer.alloc(10), j = 0;\n\n    if (this.seqObj) { // We're in the sequence.\n        var dbcsCode = this.seqObj[DEF_CHAR];\n        if (dbcsCode !== undefined) { // Write beginning of the sequence.\n            if (dbcsCode < 0x100) {\n                newBuf[j++] = dbcsCode;\n            }\n            else {\n                newBuf[j++] = dbcsCode >> 8;   // high byte\n                newBuf[j++] = dbcsCode & 0xFF; // low byte\n            }\n        } else {\n            // See todo above.\n        }\n        this.seqObj = undefined;\n    }\n\n    if (this.leadSurrogate !== -1) {\n        // Incomplete surrogate pair - only lead surrogate found.\n        newBuf[j++] = this.defaultCharSingleByte;\n        this.leadSurrogate = -1;\n    }\n    \n    return newBuf.slice(0, j);\n}\n\n// Export for testing\nDBCSEncoder.prototype.findIdx = findIdx;\n\n\n// == Decoder ==================================================================\n\nfunction DBCSDecoder(options, codec) {\n    // Decoder state\n    this.nodeIdx = 0;\n    this.prevBuf = Buffer.alloc(0);\n\n    // Static data\n    this.decodeTables = codec.decodeTables;\n    this.decodeTableSeq = codec.decodeTableSeq;\n    this.defaultCharUnicode = codec.defaultCharUnicode;\n    this.gb18030 = codec.gb18030;\n}\n\nDBCSDecoder.prototype.write = function(buf) {\n    var newBuf = Buffer.alloc(buf.length*2),\n        nodeIdx = this.nodeIdx, \n        prevBuf = this.prevBuf, prevBufOffset = this.prevBuf.length,\n        seqStart = -this.prevBuf.length, // idx of the start of current parsed sequence.\n        uCode;\n\n    if (prevBufOffset > 0) // Make prev buf overlap a little to make it easier to slice later.\n        prevBuf = Buffer.concat([prevBuf, buf.slice(0, 10)]);\n    \n    for (var i = 0, j = 0; i < buf.length; i++) {\n        var curByte = (i >= 0) ? buf[i] : prevBuf[i + prevBufOffset];\n\n        // Lookup in current trie node.\n        var uCode = this.decodeTables[nodeIdx][curByte];\n\n        if (uCode >= 0) { \n            // Normal character, just use it.\n        }\n        else if (uCode === UNASSIGNED) { // Unknown char.\n            // TODO: Callback with seq.\n            //var curSeq = (seqStart >= 0) ? buf.slice(seqStart, i+1) : prevBuf.slice(seqStart + prevBufOffset, i+1 + prevBufOffset);\n            i = seqStart; // Try to parse again, after skipping first byte of the sequence ('i' will be incremented by 'for' cycle).\n            uCode = this.defaultCharUnicode.charCodeAt(0);\n        }\n        else if (uCode === GB18030_CODE) {\n            var curSeq = (seqStart >= 0) ? buf.slice(seqStart, i+1) : prevBuf.slice(seqStart + prevBufOffset, i+1 + prevBufOffset);\n            var ptr = (curSeq[0]-0x81)*12600 + (curSeq[1]-0x30)*1260 + (curSeq[2]-0x81)*10 + (curSeq[3]-0x30);\n            var idx = findIdx(this.gb18030.gbChars, ptr);\n            uCode = this.gb18030.uChars[idx] + ptr - this.gb18030.gbChars[idx];\n        }\n        else if (uCode <= NODE_START) { // Go to next trie node.\n            nodeIdx = NODE_START - uCode;\n            continue;\n        }\n        else if (uCode <= SEQ_START) { // Output a sequence of chars.\n            var seq = this.decodeTableSeq[SEQ_START - uCode];\n            for (var k = 0; k < seq.length - 1; k++) {\n                uCode = seq[k];\n                newBuf[j++] = uCode & 0xFF;\n                newBuf[j++] = uCode >> 8;\n            }\n            uCode = seq[seq.length-1];\n        }\n        else\n            throw new Error(\"iconv-lite internal error: invalid decoding table value \" + uCode + \" at \" + nodeIdx + \"/\" + curByte);\n\n        // Write the character to buffer, handling higher planes using surrogate pair.\n        if (uCode > 0xFFFF) { \n            uCode -= 0x10000;\n            var uCodeLead = 0xD800 + Math.floor(uCode / 0x400);\n            newBuf[j++] = uCodeLead & 0xFF;\n            newBuf[j++] = uCodeLead >> 8;\n\n            uCode = 0xDC00 + uCode % 0x400;\n        }\n        newBuf[j++] = uCode & 0xFF;\n        newBuf[j++] = uCode >> 8;\n\n        // Reset trie node.\n        nodeIdx = 0; seqStart = i+1;\n    }\n\n    this.nodeIdx = nodeIdx;\n    this.prevBuf = (seqStart >= 0) ? buf.slice(seqStart) : prevBuf.slice(seqStart + prevBufOffset);\n    return newBuf.slice(0, j).toString('ucs2');\n}\n\nDBCSDecoder.prototype.end = function() {\n    var ret = '';\n\n    // Try to parse all remaining chars.\n    while (this.prevBuf.length > 0) {\n        // Skip 1 character in the buffer.\n        ret += this.defaultCharUnicode;\n        var buf = this.prevBuf.slice(1);\n\n        // Parse remaining as usual.\n        this.prevBuf = Buffer.alloc(0);\n        this.nodeIdx = 0;\n        if (buf.length > 0)\n            ret += this.write(buf);\n    }\n\n    this.nodeIdx = 0;\n    return ret;\n}\n\n// Binary search for GB18030. Returns largest i such that table[i] <= val.\nfunction findIdx(table, val) {\n    if (table[0] > val)\n        return -1;\n\n    var l = 0, r = table.length;\n    while (l < r-1) { // always table[l] <= val < table[r]\n        var mid = l + Math.floor((r-l+1)/2);\n        if (table[mid] <= val)\n            l = mid;\n        else\n            r = mid;\n    }\n    return l;\n}\n\n","\"use strict\";\n\n// Description of supported double byte encodings and aliases.\n// Tables are not require()-d until they are needed to speed up library load.\n// require()-s are direct to support Browserify.\n\nmodule.exports = {\n    \n    // == Japanese/ShiftJIS ====================================================\n    // All japanese encodings are based on JIS X set of standards:\n    // JIS X 0201 - Single-byte encoding of ASCII +  + Kana chars at 0xA1-0xDF.\n    // JIS X 0208 - Main set of 6879 characters, placed in 94x94 plane, to be encoded by 2 bytes. \n    //              Has several variations in 1978, 1983, 1990 and 1997.\n    // JIS X 0212 - Supplementary plane of 6067 chars in 94x94 plane. 1990. Effectively dead.\n    // JIS X 0213 - Extension and modern replacement of 0208 and 0212. Total chars: 11233.\n    //              2 planes, first is superset of 0208, second - revised 0212.\n    //              Introduced in 2000, revised 2004. Some characters are in Unicode Plane 2 (0x2xxxx)\n\n    // Byte encodings are:\n    //  * Shift_JIS: Compatible with 0201, uses not defined chars in top half as lead bytes for double-byte\n    //               encoding of 0208. Lead byte ranges: 0x81-0x9F, 0xE0-0xEF; Trail byte ranges: 0x40-0x7E, 0x80-0x9E, 0x9F-0xFC.\n    //               Windows CP932 is a superset of Shift_JIS. Some companies added more chars, notably KDDI.\n    //  * EUC-JP:    Up to 3 bytes per character. Used mostly on *nixes.\n    //               0x00-0x7F       - lower part of 0201\n    //               0x8E, 0xA1-0xDF - upper part of 0201\n    //               (0xA1-0xFE)x2   - 0208 plane (94x94).\n    //               0x8F, (0xA1-0xFE)x2 - 0212 plane (94x94).\n    //  * JIS X 208: 7-bit, direct encoding of 0208. Byte ranges: 0x21-0x7E (94 values). Uncommon.\n    //               Used as-is in ISO2022 family.\n    //  * ISO2022-JP: Stateful encoding, with escape sequences to switch between ASCII, \n    //                0201-1976 Roman, 0208-1978, 0208-1983.\n    //  * ISO2022-JP-1: Adds esc seq for 0212-1990.\n    //  * ISO2022-JP-2: Adds esc seq for GB2313-1980, KSX1001-1992, ISO8859-1, ISO8859-7.\n    //  * ISO2022-JP-3: Adds esc seq for 0201-1976 Kana set, 0213-2000 Planes 1, 2.\n    //  * ISO2022-JP-2004: Adds 0213-2004 Plane 1.\n    //\n    // After JIS X 0213 appeared, Shift_JIS-2004, EUC-JISX0213 and ISO2022-JP-2004 followed, with just changing the planes.\n    //\n    // Overall, it seems that it's a mess :( http://www8.plala.or.jp/tkubota1/unicode-symbols-map2.html\n\n    'shiftjis': {\n        type: '_dbcs',\n        table: function() { return require('./tables/shiftjis.json') },\n        encodeAdd: {'\\u00a5': 0x5C, '\\u203E': 0x7E},\n        encodeSkipVals: [{from: 0xED40, to: 0xF940}],\n    },\n    'csshiftjis': 'shiftjis',\n    'mskanji': 'shiftjis',\n    'sjis': 'shiftjis',\n    'windows31j': 'shiftjis',\n    'ms31j': 'shiftjis',\n    'xsjis': 'shiftjis',\n    'windows932': 'shiftjis',\n    'ms932': 'shiftjis',\n    '932': 'shiftjis',\n    'cp932': 'shiftjis',\n\n    'eucjp': {\n        type: '_dbcs',\n        table: function() { return require('./tables/eucjp.json') },\n        encodeAdd: {'\\u00a5': 0x5C, '\\u203E': 0x7E},\n    },\n\n    // TODO: KDDI extension to Shift_JIS\n    // TODO: IBM CCSID 942 = CP932, but F0-F9 custom chars and other char changes.\n    // TODO: IBM CCSID 943 = Shift_JIS = CP932 with original Shift_JIS lower 128 chars.\n\n\n    // == Chinese/GBK ==========================================================\n    // http://en.wikipedia.org/wiki/GBK\n    // We mostly implement W3C recommendation: https://www.w3.org/TR/encoding/#gbk-encoder\n\n    // Oldest GB2312 (1981, ~7600 chars) is a subset of CP936\n    'gb2312': 'cp936',\n    'gb231280': 'cp936',\n    'gb23121980': 'cp936',\n    'csgb2312': 'cp936',\n    'csiso58gb231280': 'cp936',\n    'euccn': 'cp936',\n\n    // Microsoft's CP936 is a subset and approximation of GBK.\n    'windows936': 'cp936',\n    'ms936': 'cp936',\n    '936': 'cp936',\n    'cp936': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json') },\n    },\n\n    // GBK (~22000 chars) is an extension of CP936 that added user-mapped chars and some other.\n    'gbk': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json').concat(require('./tables/gbk-added.json')) },\n    },\n    'xgbk': 'gbk',\n    'isoir58': 'gbk',\n\n    // GB18030 is an algorithmic extension of GBK.\n    // Main source: https://www.w3.org/TR/encoding/#gbk-encoder\n    // http://icu-project.org/docs/papers/gb18030.html\n    // http://source.icu-project.org/repos/icu/data/trunk/charset/data/xml/gb-18030-2000.xml\n    // http://www.khngai.com/chinese/charmap/tblgbk.php?page=0\n    'gb18030': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp936.json').concat(require('./tables/gbk-added.json')) },\n        gb18030: function() { return require('./tables/gb18030-ranges.json') },\n        encodeSkipVals: [0x80],\n        encodeAdd: {'': 0xA2E3},\n    },\n\n    'chinese': 'gb18030',\n\n\n    // == Korean ===============================================================\n    // EUC-KR, KS_C_5601 and KS X 1001 are exactly the same.\n    'windows949': 'cp949',\n    'ms949': 'cp949',\n    '949': 'cp949',\n    'cp949': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp949.json') },\n    },\n\n    'cseuckr': 'cp949',\n    'csksc56011987': 'cp949',\n    'euckr': 'cp949',\n    'isoir149': 'cp949',\n    'korean': 'cp949',\n    'ksc56011987': 'cp949',\n    'ksc56011989': 'cp949',\n    'ksc5601': 'cp949',\n\n\n    // == Big5/Taiwan/Hong Kong ================================================\n    // There are lots of tables for Big5 and cp950. Please see the following links for history:\n    // http://moztw.org/docs/big5/  http://www.haible.de/bruno/charsets/conversion-tables/Big5.html\n    // Variations, in roughly number of defined chars:\n    //  * Windows CP 950: Microsoft variant of Big5. Canonical: http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WINDOWS/CP950.TXT\n    //  * Windows CP 951: Microsoft variant of Big5-HKSCS-2001. Seems to be never public. http://me.abelcheung.org/articles/research/what-is-cp951/\n    //  * Big5-2003 (Taiwan standard) almost superset of cp950.\n    //  * Unicode-at-on (UAO) / Mozilla 1.8. Falling out of use on the Web. Not supported by other browsers.\n    //  * Big5-HKSCS (-2001, -2004, -2008). Hong Kong standard. \n    //    many unicode code points moved from PUA to Supplementary plane (U+2XXXX) over the years.\n    //    Plus, it has 4 combining sequences.\n    //    Seems that Mozilla refused to support it for 10 yrs. https://bugzilla.mozilla.org/show_bug.cgi?id=162431 https://bugzilla.mozilla.org/show_bug.cgi?id=310299\n    //    because big5-hkscs is the only encoding to include astral characters in non-algorithmic way.\n    //    Implementations are not consistent within browsers; sometimes labeled as just big5.\n    //    MS Internet Explorer switches from big5 to big5-hkscs when a patch applied.\n    //    Great discussion & recap of what's going on https://bugzilla.mozilla.org/show_bug.cgi?id=912470#c31\n    //    In the encoder, it might make sense to support encoding old PUA mappings to Big5 bytes seq-s.\n    //    Official spec: http://www.ogcio.gov.hk/en/business/tech_promotion/ccli/terms/doc/2003cmp_2008.txt\n    //                   http://www.ogcio.gov.hk/tc/business/tech_promotion/ccli/terms/doc/hkscs-2008-big5-iso.txt\n    // \n    // Current understanding of how to deal with Big5(-HKSCS) is in the Encoding Standard, http://encoding.spec.whatwg.org/#big5-encoder\n    // Unicode mapping (http://www.unicode.org/Public/MAPPINGS/OBSOLETE/EASTASIA/OTHER/BIG5.TXT) is said to be wrong.\n\n    'windows950': 'cp950',\n    'ms950': 'cp950',\n    '950': 'cp950',\n    'cp950': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp950.json') },\n    },\n\n    // Big5 has many variations and is an extension of cp950. We use Encoding Standard's as a consensus.\n    'big5': 'big5hkscs',\n    'big5hkscs': {\n        type: '_dbcs',\n        table: function() { return require('./tables/cp950.json').concat(require('./tables/big5-added.json')) },\n        encodeSkipVals: [0xa2cc],\n    },\n\n    'cnbig5': 'big5hkscs',\n    'csbig5': 'big5hkscs',\n    'xxbig5': 'big5hkscs',\n};\n","\"use strict\";\n\nvar Buffer = require(\"buffer\").Buffer,\n    Transform = require(\"stream\").Transform;\n\n\n// == Exports ==================================================================\nmodule.exports = function(iconv) {\n    \n    // Additional Public API.\n    iconv.encodeStream = function encodeStream(encoding, options) {\n        return new IconvLiteEncoderStream(iconv.getEncoder(encoding, options), options);\n    }\n\n    iconv.decodeStream = function decodeStream(encoding, options) {\n        return new IconvLiteDecoderStream(iconv.getDecoder(encoding, options), options);\n    }\n\n    iconv.supportsStreams = true;\n\n\n    // Not published yet.\n    iconv.IconvLiteEncoderStream = IconvLiteEncoderStream;\n    iconv.IconvLiteDecoderStream = IconvLiteDecoderStream;\n    iconv._collect = IconvLiteDecoderStream.prototype.collect;\n};\n\n\n// == Encoder stream =======================================================\nfunction IconvLiteEncoderStream(conv, options) {\n    this.conv = conv;\n    options = options || {};\n    options.decodeStrings = false; // We accept only strings, so we don't need to decode them.\n    Transform.call(this, options);\n}\n\nIconvLiteEncoderStream.prototype = Object.create(Transform.prototype, {\n    constructor: { value: IconvLiteEncoderStream }\n});\n\nIconvLiteEncoderStream.prototype._transform = function(chunk, encoding, done) {\n    if (typeof chunk != 'string')\n        return done(new Error(\"Iconv encoding stream needs strings as its input.\"));\n    try {\n        var res = this.conv.write(chunk);\n        if (res && res.length) this.push(res);\n        done();\n    }\n    catch (e) {\n        done(e);\n    }\n}\n\nIconvLiteEncoderStream.prototype._flush = function(done) {\n    try {\n        var res = this.conv.end();\n        if (res && res.length) this.push(res);\n        done();\n    }\n    catch (e) {\n        done(e);\n    }\n}\n\nIconvLiteEncoderStream.prototype.collect = function(cb) {\n    var chunks = [];\n    this.on('error', cb);\n    this.on('data', function(chunk) { chunks.push(chunk); });\n    this.on('end', function() {\n        cb(null, Buffer.concat(chunks));\n    });\n    return this;\n}\n\n\n// == Decoder stream =======================================================\nfunction IconvLiteDecoderStream(conv, options) {\n    this.conv = conv;\n    options = options || {};\n    options.encoding = this.encoding = 'utf8'; // We output strings.\n    Transform.call(this, options);\n}\n\nIconvLiteDecoderStream.prototype = Object.create(Transform.prototype, {\n    constructor: { value: IconvLiteDecoderStream }\n});\n\nIconvLiteDecoderStream.prototype._transform = function(chunk, encoding, done) {\n    if (!Buffer.isBuffer(chunk))\n        return done(new Error(\"Iconv decoding stream needs buffers as its input.\"));\n    try {\n        var res = this.conv.write(chunk);\n        if (res && res.length) this.push(res, this.encoding);\n        done();\n    }\n    catch (e) {\n        done(e);\n    }\n}\n\nIconvLiteDecoderStream.prototype._flush = function(done) {\n    try {\n        var res = this.conv.end();\n        if (res && res.length) this.push(res, this.encoding);                \n        done();\n    }\n    catch (e) {\n        done(e);\n    }\n}\n\nIconvLiteDecoderStream.prototype.collect = function(cb) {\n    var res = '';\n    this.on('error', cb);\n    this.on('data', function(chunk) { res += chunk; });\n    this.on('end', function() {\n        cb(null, res);\n    });\n    return this;\n}\n\n","\"use strict\";\nvar Buffer = require(\"buffer\").Buffer;\n// Note: not polyfilled with safer-buffer on a purpose, as overrides Buffer\n\n// == Extend Node primitives to use iconv-lite =================================\n\nmodule.exports = function (iconv) {\n    var original = undefined; // Place to keep original methods.\n\n    // Node authors rewrote Buffer internals to make it compatible with\n    // Uint8Array and we cannot patch key functions since then.\n    // Note: this does use older Buffer API on a purpose\n    iconv.supportsNodeEncodingsExtension = !(Buffer.from || new Buffer(0) instanceof Uint8Array);\n\n    iconv.extendNodeEncodings = function extendNodeEncodings() {\n        if (original) return;\n        original = {};\n\n        if (!iconv.supportsNodeEncodingsExtension) {\n            console.error(\"ACTION NEEDED: require('iconv-lite').extendNodeEncodings() is not supported in your version of Node\");\n            console.error(\"See more info at https://github.com/ashtuchkin/iconv-lite/wiki/Node-v4-compatibility\");\n            return;\n        }\n\n        var nodeNativeEncodings = {\n            'hex': true, 'utf8': true, 'utf-8': true, 'ascii': true, 'binary': true, \n            'base64': true, 'ucs2': true, 'ucs-2': true, 'utf16le': true, 'utf-16le': true,\n        };\n\n        Buffer.isNativeEncoding = function(enc) {\n            return enc && nodeNativeEncodings[enc.toLowerCase()];\n        }\n\n        // -- SlowBuffer -----------------------------------------------------------\n        var SlowBuffer = require('buffer').SlowBuffer;\n\n        original.SlowBufferToString = SlowBuffer.prototype.toString;\n        SlowBuffer.prototype.toString = function(encoding, start, end) {\n            encoding = String(encoding || 'utf8').toLowerCase();\n\n            // Use native conversion when possible\n            if (Buffer.isNativeEncoding(encoding))\n                return original.SlowBufferToString.call(this, encoding, start, end);\n\n            // Otherwise, use our decoding method.\n            if (typeof start == 'undefined') start = 0;\n            if (typeof end == 'undefined') end = this.length;\n            return iconv.decode(this.slice(start, end), encoding);\n        }\n\n        original.SlowBufferWrite = SlowBuffer.prototype.write;\n        SlowBuffer.prototype.write = function(string, offset, length, encoding) {\n            // Support both (string, offset, length, encoding)\n            // and the legacy (string, encoding, offset, length)\n            if (isFinite(offset)) {\n                if (!isFinite(length)) {\n                    encoding = length;\n                    length = undefined;\n                }\n            } else {  // legacy\n                var swap = encoding;\n                encoding = offset;\n                offset = length;\n                length = swap;\n            }\n\n            offset = +offset || 0;\n            var remaining = this.length - offset;\n            if (!length) {\n                length = remaining;\n            } else {\n                length = +length;\n                if (length > remaining) {\n                    length = remaining;\n                }\n            }\n            encoding = String(encoding || 'utf8').toLowerCase();\n\n            // Use native conversion when possible\n            if (Buffer.isNativeEncoding(encoding))\n                return original.SlowBufferWrite.call(this, string, offset, length, encoding);\n\n            if (string.length > 0 && (length < 0 || offset < 0))\n                throw new RangeError('attempt to write beyond buffer bounds');\n\n            // Otherwise, use our encoding method.\n            var buf = iconv.encode(string, encoding);\n            if (buf.length < length) length = buf.length;\n            buf.copy(this, offset, 0, length);\n            return length;\n        }\n\n        // -- Buffer ---------------------------------------------------------------\n\n        original.BufferIsEncoding = Buffer.isEncoding;\n        Buffer.isEncoding = function(encoding) {\n            return Buffer.isNativeEncoding(encoding) || iconv.encodingExists(encoding);\n        }\n\n        original.BufferByteLength = Buffer.byteLength;\n        Buffer.byteLength = SlowBuffer.byteLength = function(str, encoding) {\n            encoding = String(encoding || 'utf8').toLowerCase();\n\n            // Use native conversion when possible\n            if (Buffer.isNativeEncoding(encoding))\n                return original.BufferByteLength.call(this, str, encoding);\n\n            // Slow, I know, but we don't have a better way yet.\n            return iconv.encode(str, encoding).length;\n        }\n\n        original.BufferToString = Buffer.prototype.toString;\n        Buffer.prototype.toString = function(encoding, start, end) {\n            encoding = String(encoding || 'utf8').toLowerCase();\n\n            // Use native conversion when possible\n            if (Buffer.isNativeEncoding(encoding))\n                return original.BufferToString.call(this, encoding, start, end);\n\n            // Otherwise, use our decoding method.\n            if (typeof start == 'undefined') start = 0;\n            if (typeof end == 'undefined') end = this.length;\n            return iconv.decode(this.slice(start, end), encoding);\n        }\n\n        original.BufferWrite = Buffer.prototype.write;\n        Buffer.prototype.write = function(string, offset, length, encoding) {\n            var _offset = offset, _length = length, _encoding = encoding;\n            // Support both (string, offset, length, encoding)\n            // and the legacy (string, encoding, offset, length)\n            if (isFinite(offset)) {\n                if (!isFinite(length)) {\n                    encoding = length;\n                    length = undefined;\n                }\n            } else {  // legacy\n                var swap = encoding;\n                encoding = offset;\n                offset = length;\n                length = swap;\n            }\n\n            encoding = String(encoding || 'utf8').toLowerCase();\n\n            // Use native conversion when possible\n            if (Buffer.isNativeEncoding(encoding))\n                return original.BufferWrite.call(this, string, _offset, _length, _encoding);\n\n            offset = +offset || 0;\n            var remaining = this.length - offset;\n            if (!length) {\n                length = remaining;\n            } else {\n                length = +length;\n                if (length > remaining) {\n                    length = remaining;\n                }\n            }\n\n            if (string.length > 0 && (length < 0 || offset < 0))\n                throw new RangeError('attempt to write beyond buffer bounds');\n\n            // Otherwise, use our encoding method.\n            var buf = iconv.encode(string, encoding);\n            if (buf.length < length) length = buf.length;\n            buf.copy(this, offset, 0, length);\n            return length;\n\n            // TODO: Set _charsWritten.\n        }\n\n\n        // -- Readable -------------------------------------------------------------\n        if (iconv.supportsStreams) {\n            var Readable = require('stream').Readable;\n\n            original.ReadableSetEncoding = Readable.prototype.setEncoding;\n            Readable.prototype.setEncoding = function setEncoding(enc, options) {\n                // Use our own decoder, it has the same interface.\n                // We cannot use original function as it doesn't handle BOM-s.\n                this._readableState.decoder = iconv.getDecoder(enc, options);\n                this._readableState.encoding = enc;\n            }\n\n            Readable.prototype.collect = iconv._collect;\n        }\n    }\n\n    // Remove iconv-lite Node primitive extensions.\n    iconv.undoExtendNodeEncodings = function undoExtendNodeEncodings() {\n        if (!iconv.supportsNodeEncodingsExtension)\n            return;\n        if (!original)\n            throw new Error(\"require('iconv-lite').undoExtendNodeEncodings(): Nothing to undo; extendNodeEncodings() is not called.\")\n\n        delete Buffer.isNativeEncoding;\n\n        var SlowBuffer = require('buffer').SlowBuffer;\n\n        SlowBuffer.prototype.toString = original.SlowBufferToString;\n        SlowBuffer.prototype.write = original.SlowBufferWrite;\n\n        Buffer.isEncoding = original.BufferIsEncoding;\n        Buffer.byteLength = original.BufferByteLength;\n        Buffer.prototype.toString = original.BufferToString;\n        Buffer.prototype.write = original.BufferWrite;\n\n        if (iconv.supportsStreams) {\n            var Readable = require('stream').Readable;\n\n            Readable.prototype.setEncoding = original.ReadableSetEncoding;\n            delete Readable.prototype.collect;\n        }\n\n        original = undefined;\n    }\n}\n"],"sourceRoot":""}